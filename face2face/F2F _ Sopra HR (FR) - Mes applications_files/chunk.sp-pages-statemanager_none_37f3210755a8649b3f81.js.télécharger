(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[123],{"67N2":function(e,t,n){"use strict";n.d(t,"r",function(){return i}),n.d(t,"s",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"l",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"f",function(){return f}),n.d(t,"t",function(){return p}),n.d(t,"o",function(){return m}),n.d(t,"p",function(){return _}),n.d(t,"u",function(){return h}),n.d(t,"m",function(){return b}),n.d(t,"c",function(){return g});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("bafad34d-40e9-478d-b565-5c812b80031f")}function r(){return a._SPKillSwitch.isActivated("61be9ad0-f47c-405d-9c28-92f9142430a9")}function o(){return a._SPKillSwitch.isActivated("64a2e0f2-6d4c-44de-bc3a-5c806b241a4c")}function s(){return a._SPKillSwitch.isActivated("d9407616-7ba4-4b30-8e26-64e6c81cddcc")}function c(){return a._SPKillSwitch.isActivated("cb5d7cee-5511-4928-bf2e-ed9d5a967e01")}function d(){return a._SPKillSwitch.isActivated("a0cc773e-4b78-4e4f-ba45-deb0cfc86ba1")}function l(){return a._SPKillSwitch.isActivated("1771ca0a-b7a0-4a00-ac4f-33cce7b5a8d8")}function u(){return a._SPKillSwitch.isActivated("77f1af93-cb1a-450c-9b7f-fe4255f81fed")}function f(){return a._SPKillSwitch.isActivated("18f6bae5-696a-4bbf-88ac-6f9d653bca49")}function p(){return a._SPKillSwitch.isActivated("e4ec543e-b34d-4615-b1a0-c00c803f3515")}function m(){return a._SPKillSwitch.isActivated("68d190d9-c1b0-4d51-8263-cbaf1e007b3d")}function _(){return a._SPKillSwitch.isActivated("54a84d15-714a-4db3-b282-0be5a12aaa0a")}function h(){return a._SPKillSwitch.isActivated("a0ab6d80-64ed-43fc-aac3-547bcd967c2c")}function b(){return a._SPKillSwitch.isActivated("b16061bc-5247-4ff6-bd09-60b180b3987a")}function g(){return a._SPKillSwitch.isActivated("64720ed5-b688-4f87-b062-488aa5693a56")}},Fn15:function(e,t,n){"use strict";var a=n("hiL/"),i=n("jyrw"),r=function(){function e(){}return e.pageSaved=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.Saved,e._moduleName,"SPPageSetPageSaved",{SPPageStatus:a.PageSaveStatus.Saved.toString()})},e.pageDirty=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.NotSaved,e._moduleName,"SPPageSetPageDirty",{SPPageStatus:a.PageSaveStatus.NotSaved.toString()})},e.pageCheckedOut=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.UnPublished,e._moduleName,"SPPageSetPageUnPublished",{SPPageStatus:a.PageSaveStatus.UnPublished.toString()})},e._moduleName="[PageStatusStoreAction]",e}();t.e=r},GDsS:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("UWqr");function i(){return a._SPFlight.isEnabled(1482)}},IKdF:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("UWqr"),r=n("ut3N"),o=n("y88i"),s=n("hiL/"),c=n("2q6Q"),d=n("HVbJ"),l=n("ExwJ"),u=n("0IsF"),f=n("XdGY"),p=n("q+wp"),m=n("0SGS"),_=n("onFi"),h=n("k6KK"),b=n("lmp7"),g=n("7plR"),v=n("xs0R"),y=function(){function e(){}return e.insert=function(e,t){var n=new c._QosMonitor("PageCacheInsert");try{var a=JSON.stringify(t);window.sessionStorage.setItem(e,a),n.writeSuccess()}catch(e){n.writeUnexpectedFailure("PageCacheInsert",e)}},e.insertPage=function(e,t,n){e=this._normalize(e),this.insert("page-cache://"+e,{route:e,preloadedData:t,version:n})},e.get=function(e){var t=new c._QosMonitor("PageCacheGet");try{var n=window.sessionStorage.getItem(e),a=JSON.parse(n);return t.writeSuccess(),a}catch(e){t.writeUnexpectedFailure("PageCacheGet",e)}},e.getPage=function(e){return e=this._normalize(e),this.get("page-cache://"+e)},e.remove=function(e){var t=new c._QosMonitor("PageCacheDelete");try{window.sessionStorage.removeItem(e),t.writeSuccess()}catch(e){t.writeUnexpectedFailure("PageCacheDelete",e)}},e.removePage=function(e){e=this._normalize(e),this.remove("page-cache://"+e)},e._normalize=function(e){return p.e.relativizeUrl(p.e.removeQueryString(e.toLowerCase()))},e}(),S=n("UF/m"),D="HomePage",I="ClassicHomepageUrl",x="PageTemplates",C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._logSource=r._LogSource.create("SPPageDataProvider"),t}return Object(a.__extends)(t,e),t.convertSitePageFlagArrayToString=function(e){var t=";#";if(Array.isArray(e)&&(null==e?void 0:e.length)>0)return"".concat(t).concat(e.join(t)).concat(t)},t.prototype.getPageUrlAsync=function(e){var t=this,n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/FileName");b.t.appCacheHit=!1;var a=new c._QosMonitor("GetPageUrlAPI");return this._fetchJson(n).then(function(e){return a.writeSuccess(),e.value}).catch(function(e){return r._TraceLogger.logError(t._logSource,e),404===e.status?a.writeExpectedFailure("FailedResponseNotFound",e):403===e.status?a.writeExpectedFailure("FailedResponseForbidden",e):406===e.status?a.writeExpectedFailure("FailedResponseNotAcceptable",e):a.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.getListItemModerationStatusAsync=function(e){var t=this._webServerRelativeUrl+"/_api/web/lists(guid'".concat(this._pageContext.list.id,"')/Items(").concat(e,")?$select=OData__ModerationStatus");return this._fetchJson(t).then(function(e){if(void 0===e.OData__ModerationStatus)throw"Invalid Moderation Status";return e.OData__ModerationStatus})},t.prototype.getPageTemplates=function(){var e="".concat(x,"_").concat(this._webServerRelativeUrl),t=y.get(e);if(t)return Promise.resolve(t);var n=this._restSitePagesEndPointUrl+"/templates";return this._fetchJson(n).then(function(t){var n=t.value;return y.insert(e,n),n}).catch(function(e){throw e})},t.prototype.savePageToServerAsync=function(e,t,n,a){if(!Object.keys(t).length){var i=new Error("should not save empty page content");return r._TraceLogger.logError(this._logSource,i,a),Promise.reject(i)}var o=t[l.e.PreviewImageUrl];s.ThumbnailUrlGenerator.isStockImage(o)&&(t[l.e.PreviewImageUrl]=this._defaultSitePageThumbnail);var c=n?"SavePageAsDraft":"SavePage",d="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/").concat(c),u=new S.t(t);return r._TraceLogger.logVerbose(this._logSource,"".concat(a," (").concat(e,")")),this._savePage(d,u,a,new S.n("POST"))},t.prototype.createBlankPageAsync=function(e,n,a,i){var r=new c._QosMonitor("CreateBlankPageAPI"),o=v.t.isSpace?this._restSpacesEndPointUrl:this._restSitePagesEndPointUrl,s=new S.t({PromotedState:e||void 0,PageLayoutType:n||void 0,ContentTypeId:a||void 0,SitePageFlags:t.convertSitePageFlagArrayToString(i)});return this.createOrCopyPage(o,new S.n("POST"),s.toString(),r,"createBlankPageAsync")},t.prototype.createPageAsync=function(e,n,a,i,r,o,s){var d=new c._QosMonitor("CreatePageAPI"),l=v.t.isSpace?this._restSpacesEndPointUrl:this._restSitePagesEndPointUrl,u=new S.t({PromotedState:e||void 0,PageLayoutType:n||void 0,ContentTypeId:a||void 0,SitePageFlags:t.convertSitePageFlagArrayToString(i),CanvasContent1:r||void 0,Title:o||void 0,Name:s||void 0});return this.createOrCopyPage(l,new S.n("POST"),u.toString(),d,"createPageAsync")},t.prototype.createTopicPageAsync=function(){var e=new c._QosMonitor("CreateTopicPageAPI"),t=this._restTopicsEndPointUrl,n=v.t.fields.EntityId,a=new S.t({Title:v.t.fields.Title,EntityId:n!==s.NULL_TOPIC_ENTITY.Id?n:"",EntityType:Object(d.isTopicTypesFlightEnabled)(g.e.instance.pageContext.legacyPageContext)?"":"Project",EntityRelations:s.EntityRelationsService.getRelationsAsString(g.e.instance.serviceScope),LayoutWebpartsContent:m.e.serializeLayoutWebPartData(v.t.fields.LayoutWebPartsDataMap),CanvasContent1:JSON.stringify(v.t.fields.CanvasContent1),TopicHeader:"Topic",BannerImageUrl:"/_layouts/15/images/sitepagethumbnail.png",PageLayoutType:u.e.Topic});return this.createOrCopyPage(t,new S.n("POST"),a.toString(),e,"createTopicPageAsync")},t.prototype.copyPage=function(e,n){var a=new c._QosMonitor("CopyPageAPI"),i=this._shouldCreateNewsCopy();i&&(g.e.instance.promoteOnPublish=!1);var r="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/").concat("CopyWithConfiguration");return this.createOrCopyPage(r,new S.n("POST"),JSON.stringify({sitePageFlags:t.convertSitePageFlagArrayToString(n),isNews:i}),a,"copyPage")},t.prototype.savePageAsTemplate=function(e){if(p.e.isScribeCopyTemplateEnabled()){var t="SavePageAsTemplate",n=new c._QosMonitor("SavePageAsTemplateAPI");return this._savePageAsTemplateInternal(e,t,n)}var a="".concat(x,"_").concat(this._webServerRelativeUrl);y.remove(a),n=new c._QosMonitor("SavePageAsTemplateAPI"),t="SavePageAsTemplate";var i="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/").concat(t);return this.createOrCopyPage(i,new S.n("POST"),(new S.t).toString(),n,"savePageAsTemplate")},t.prototype.savePageAsTemplateOnMySite=function(e){var t=new r._AutoAlertableQosMonitor("SavePageAsTemplateOnMySiteAPI",r._AutoAlertableMonitorType.StaticReliabilityQos95Sev4);return this._savePageAsTemplateInternal(e,"SavePageAsTemplateOnMySite",t)},t.prototype.getTemplateFolderUrl=function(){var e=this._webServerRelativeUrl+"/_api/lists/EnsureClientRenderedSitePagesLibrary/GetSpecialFolderUrl",t=new c._QosMonitor("GetTemplateFolderUrl");return this._fetchJson(e,new S.n("POST"),JSON.stringify({type:9,bForceCreate:!1})).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedGettingTemplateFolderUrl",e),Promise.reject(e)})},t.prototype.createOrCopyPage=function(e,n,a,i,o){var s=this;r._TraceLogger.logVerbose(this._logSource,o);var c=window._isInitiatedByPageApp?"FromPageApp":"FromRouter";return this._fetchJson(e,n,a).then(function(e){if(!e||!e.Id)throw t._getOdataRestApiError(e)||new _.e;return s._processCreateOrCopyResponse(o,i,e)}).catch(function(e){throw e instanceof _.e?403===e.status?i.writeExpectedFailure("FailedResponseForbidden",e,{pageCreationEntryPoint:c}):O()||e.code!==h.e.siteQuoteExceededException?i.writeUnexpectedFailure(O()?"FailedResponseStatus":"ErrorTag",e,{pageCreationEntryPoint:c}):i.writeExpectedFailure("SiteQuoteExceeded",e,{pageCreationEntryPoint:c}):(i.writeUnexpectedFailure("FailedResponseStatus",e,{pageCreationEntryPoint:c}),r._TraceLogger.logError(s._logSource,e,c)),e})},t.prototype.checkOutAndReloadPageAsync=function(e){var t=this,n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/checkoutpage"),a=new c._QosMonitor("CheckOutPageAPI");return r._TraceLogger.logVerbose(this._logSource,"checkOutAndReloadPageAsync"),this._fetchJson(n,new S.n("POST")).then(function(e){if(!e||!e.IsPageCheckedOutToCurrentUser)throw new _.e;var n=m.e.tryLoadFromSitePagesOdata(e);return r._TraceLogger.logVerbose(t._logSource,"checkOutAndReloadPageAsync success"),a.writeSuccess(),n}).catch(function(e){throw e instanceof _.e?(t._handleOdataError(e,e.status,a,"CheckOutPageAPI"),r._TraceLogger.logError(t._logSource,e,"CheckOutPageAPI")):(a.writeUnexpectedFailure("FailedToCheckoutPageError2",e),r._TraceLogger.logError(t._logSource,e)),e})},t.prototype.publishPageAsync=function(e){var t,n=this,a="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/publish"),i=new c._QosMonitor("PublishPageAPI");r._TraceLogger.logVerbose(this._logSource,"publishPageAsync");var o={alias:null===(t=v.t.fields)||void 0===t?void 0:t.PageLayoutType};return this._fetchJson(a,new S.n("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new _.e);i.writeSuccess(o)}).catch(function(e){return e.isUnknown?(i.writeUnexpectedFailure("PublishPageAPI",e,o),r._TraceLogger.logError(n._logSource,e)):n._handleOdataError(e,e.status,i,"PublishPageAPI",o),Promise.reject(e)})},t.prototype.schedulePageAsync=function(e){var t=this,n=new c._QosMonitor("SchedulePublishAPI"),a="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/schedulepublish");return r._TraceLogger.logVerbose(this._logSource,"schedulePageAsync"),this._fetchJson(a,new S.n("POST"),JSON.stringify({})).then(function(e){return n.writeSuccess(),e.value}).catch(function(e){return"-2146232832, Microsoft.SharePoint.SPFeatureDependencyNotActivatedException"===(null==e?void 0:e.code)&&(n.writeExpectedFailure("SchedulePublishAPI",e),r._TraceLogger.logError(t._logSource,e)),e.isUnknown?(n.writeUnexpectedFailure("SchedulePublishAPI",e),r._TraceLogger.logError(t._logSource,e)):t._handleOdataError(e,e.status,n,"SchedulePublishAPI"),Promise.reject(e)})},t.prototype.discardPageAsync=function(e){var t=this,n=Object(f.Ze)()?"".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/discardPage"):"".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/discardPage?$expand=VersionInfo"),a=new c._QosMonitor("DiscardPageAPI");return r._TraceLogger.logVerbose(this._logSource,"discardPageAsync"),this._fetchJson(n,new S.n("POST")).then(function(e){if(!e)throw new _.e;var n=m.e.tryLoadFromSitePagesOdata(e);return r._TraceLogger.logVerbose(t._logSource,"discardPageAsync success"),a.writeSuccess(),n}).catch(function(e){throw e instanceof _.e&&!e.isUnknown?t._handleOdataError(e,e.status,a,"DiscardPageAPI"):(a.writeUnexpectedFailure("FailedToDiscardPageError22",e),r._TraceLogger.logError(t._logSource,e)),e})},t.prototype.promotePageToNewsAsync=function(e){var t=this,n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/PromoteToNews"),a=new c._QosMonitor("PromotePageToNewsAPI");return r._TraceLogger.logVerbose(this._logSource,"promotePageToNewsAsync"),this._fetchJson(n,new S.n("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new _.e);a.writeSuccess()}).catch(function(e){return e.isUnknown?(r._TraceLogger.logError(t._logSource,e,"PromotePageToNewsAPI"),a.writeUnexpectedFailure("PromotePageToNewsAPI",e)):t._handleOdataError(e,e.status,a,"PromotePageToNewsAPI"),Promise.reject(e)})},t.prototype.checkInFileAsync=function(e,t){var n=this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('".concat(this._pageContext.list.serverRelativeUrl+"/"+t,"')/checkin(").concat(e,")"),a=new c._QosMonitor("CheckinFileAPI");return this._fetchJson(n,new S.n("POST"),JSON.stringify({})).then(function(){return a.writeSuccess()}).catch(function(e){return a.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getFileEtagAsync=function(){var e=o.StringHelper.format(this._restWebEndPointForEtag,this._pageServerRelativeUrl),t=new c._QosMonitor("GetFileEtagAPI");return this._fetchJson(e).then(function(e){if(!e.ETag)throw new _.e;return t.writeSuccess(),e.ETag}).catch(function(e){throw t.writeUnexpectedFailure("FailedGettingFileEtag",e),e})},t.prototype.getFileCheckinCommentsAsync=function(){var e=o.StringHelper.format(this._restWebEndPointForCheckInComments,this._pageServerRelativeUrl),t=new c._QosMonitor("GetFileCheckInComments");return this._fetchJson(e).then(function(e){return t.writeSuccess(),e.CheckInComment}).catch(function(e){return t.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getUserById=function(e){var t=this._webServerRelativeUrl+"/_api/web/GetUserById(".concat(e,")"),n=new c._QosMonitor("GetUserById");return this._fetchJson(t).then(function(t){return n.writeSuccess(),{id:e,email:t.Email,name:t.Title}}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getPagePublishStartDate=function(e){var t="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")?$select=PublishStartDate"),n=new c._QosMonitor("GetPublishStartDate");return this._fetchJson(t).then(function(e){return n.writeSuccess(),e.PublishStartDate}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getListMetadataAsync=function(){var e=this._webServerRelativeUrl+"/_api/lists/EnsureClientRenderedSitePagesLibrary?$select=EnableModeration,EnableMinorVersions,Id,DraftVersionVisibility",t=new c._QosMonitor("GetListMetadataAPI");return this._fetchJson(e,new S.n("POST"),JSON.stringify({})).then(function(e){return t.writeSuccess(),{DraftVersionVisibility:e.DraftVersionVisibility,EnableMinorVersions:e.EnableMinorVersions,EnableModeration:e.EnableModeration,Id:e.Id}}).catch(function(e){return t.writeUnexpectedFailure("FailedGettingModerationStatus",e),Promise.reject(e)})},t.prototype.getIsTemplate=function(e){var t="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")?$select=IsTemplate"),n=new c._QosMonitor("GetIsTemplate");return this._fetchJson(t).then(function(e){return n.writeSuccess(),e.IsTemplate}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingFileEtag",e),Promise.reject(e)})},t.prototype.setListItemModerationStatus=function(e,t,n,a){var i=this._webServerRelativeUrl+"/_api/SP.APIHubConnector.SetApprovalStatus",r=new c._QosMonitor("SetModerationStatusAPI"),o={action:n,comments:t,etag:a,itemId:e.toString(),listName:this._pageContext.list?this._pageContext.list.id.toString():"Site Pages"};return this._fetchJson(i,new S.n("POST"),JSON.stringify(o)).then(function(){return r.writeSuccess()}).catch(function(e){return r.writeUnexpectedFailure("FailedSettingModerationStatusAPI",e),Promise.reject(e)})},t.prototype.getClassicHomepageUrlAsync=function(){var e=this,t=y.get("".concat(I,"_").concat(this._webServerRelativeUrl));if(t)return r._TraceLogger.logVerbose(this._logSource,"get classic homepage url from cache"),Promise.resolve(t);var n=o.Uri.concatenate(this._webServerRelativeUrl,"_api/Web?$select=ClassicWelcomePage,IsRevertHomepageLinkHidden"),a=new c._QosMonitor("GetClassicHomepageUrl");return this._fetchJson(n).then(function(t){var n=t.ClassicWelcomePage,i=t.IsRevertHomepageLinkHidden?"":n;return r._TraceLogger.logVerbose(e._logSource,"getClassicHomepageUrlAsync success"),a.writeSuccess(),y.insert("".concat(I,"_").concat(e._webServerRelativeUrl),i),i}).catch(function(t){return 403===t.status?(a.writeExpectedFailure("GetClassicHomepageUrl",t),""):(a.writeUnexpectedFailure("GetClassicHomepageUrl",t),r._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.removeClassicHomepageUrl=function(){var e=this,t=this._webServerRelativeUrl+"/_api/Web",n=new c._QosMonitor("RemoveClassicHomepageUrl");return this._fetchJson(t,new S.n("PATCH"),JSON.stringify({__metadata:{type:"SP.Web"},IsRevertHomepageLinkHidden:!0})).then(function(){n.writeSuccess(),y.remove("".concat(I,"_").concat(e._webServerRelativeUrl))}).catch(function(e){return n.writeUnexpectedFailure("RemoveClassicHomepageUrl",e),Promise.reject(e)})},t.prototype.getHomePageUrlAsync=function(){var e=this,t=y.get("".concat(D,"_").concat(this._webServerRelativeUrl));if(t)return r._TraceLogger.logVerbose(this._logSource,"get home page url from cache"),Promise.resolve(t);var n=o.Uri.concatenate(this._webServerRelativeUrl,"_api/web/rootfolder?$select=welcomepage"),a=new c._QosMonitor("GetHomePageUrl");return this._fetchJson(n).then(function(t){var n=o.Uri.concatenate(e._webServerRelativeUrl,t.WelcomePage);return r._TraceLogger.logVerbose(e._logSource,"getHomePageUrlAsync success"),a.writeSuccess(),y.insert("".concat(D,"_").concat(e._webServerRelativeUrl),n),n}).catch(function(t){return 403===t.status?(a.writeExpectedFailure("GetHomePageUrl",t),""):(a.writeUnexpectedFailure("GetHomePageUrl",t),r._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.getPreviousPageVersionInfoAsync=function(e){var t=this,n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/VersionInfo"),a=new c._QosMonitor("VersionInfoPageAPI");return r._TraceLogger.logVerbose(this._logSource,"getPreviousPageVersionInfoAsync"),this._fetchJson(n,new S.n("POST")).then(function(e){if(!e)throw new _.e;return a.writeSuccess(),e}).catch(function(e){throw e instanceof _.e?e.isUnknown?(a.writeUnexpectedFailure("FailedResponseStatus",e),r._TraceLogger.logError(t._logSource,e,"VersionInfoPageAPI")):t._handleOdataError(e,e.status,a,"VersionInfoPageAPI"):(a.writeUnexpectedFailure("FailedToGetPageVersion",e),r._TraceLogger.logError(t._logSource,e)),e})},t.prototype.deletePageAsync=function(){var e=this,t=new c._QosMonitor("DeletePageAPI"),n=o.Uri.concatenate(this._webServerRelativeUrl,"/_api/web/lists(guid'".concat(this._pageContext.list.id,"')/Items(").concat(v.t.fields.Id||p.e.spPageContextInfo.pageItemId,")/recycle"));return this._fetchJson(n,new S.n("POST")).then(function(e){if(!(null==e?void 0:e.value))throw new _.e;t.writeSuccess()}).catch(function(n){throw n instanceof _.e?n.isUnknown?(t.writeUnexpectedFailure("FailedResponseStatus",n),r._TraceLogger.logError(e._logSource,n,"DeletePageAPI")):e._handleOdataError(n,n.status,t,"DeletePageAPI"):(t.writeUnexpectedFailure("FailedToDeletePage",n),r._TraceLogger.logError(e._logSource,n)),n})},t.prototype.addPageToQuickLaunchAsync=function(e,t){var n=this,a="".concat(this._webServerRelativeUrl,"/_api/web/navigation/QuickLaunch"),i=new c._QosMonitor("AddPageToQuickLaunchAPI"),o=new S.t({__metadata:{type:"SP.NavigationNode"},IsExternal:!0,Title:e,Url:t});return this._fetchJson(a,new S.n("POST"),o.toString()).then(function(e){return i.writeSuccess(),r._TraceLogger.logVerbose(n._logSource,"addPageToQuickLaunchAsync success"),{key:e.Id.toString(),name:e.Title,url:e.Url,target:p.e.isRelativeUrl(e.Url)?"_self":"_blank"}}).catch(function(e){return i.writeUnexpectedFailure("FailedResponseStatus",e),e instanceof _.e?r._TraceLogger.logError(n._logSource,e,"AddPageToQuickLaunchAPI"):r._TraceLogger.logError(n._logSource,e),Promise.reject(e)})},t.prototype.getClassicPubNavProviderTypeAsync=function(e){var t=new c._QosMonitor("GetClassicPublishingNavProviderAPI"),n="".concat(this._webServerRelativeUrl,"/_api/navigation/GetPublishingNavigationProviderType?mapProviderName=%27");return n+=e,n+="%27",this._fetchJson(n).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.ensureTitleResourceAsync=function(){var e=this,t="".concat(this._restSitePagesEndPointUrl,"/EnsureTitleResource");return this._fetchJson(t,new S.n("POST"),JSON.stringify({})).then(function(){}).catch(function(t){throw r._TraceLogger.logError(e._logSource,t),t})},t.prototype.getVersion=function(e,t){var n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/getversion(").concat(t,")"),a=new c._QosMonitor("GetVersionAPI");return this._fetchJson(n).then(function(e){if(!e)throw new _.e;var t=m.e.tryLoadFromSitePagesOdata(e);return a.writeSuccess(),t}).catch(function(e){throw a.writeUnexpectedFailure("FailedGetVersion",e),e})},t.prototype.getDashboardPage=function(){var e=this._restSitePagesEndPointUrl+"?$filter=PageLayoutType eq '".concat(u.e.Dashboard,"'&$top=1&$select=FileName"),t=new c._QosMonitor("GetDashboardPage");return this._fetchJson(e).then(function(e){return e&&e.value&&e.value.length>0?(t.writeSuccess({exist:!0}),e.value[0].FileName):void t.writeSuccess({exist:!1})}).catch(function(e){t.writeUnexpectedFailure(e)})},t.prototype._savePage=function(e,t,n,a){var i,o=this,s=new c._QosMonitor(n),d={alias:null===(i=v.t.fields)||void 0===i?void 0:i.PageLayoutType};return this._fetchJson(e,a,t.toString(),this._isSaveSuccessful).then(function(e){return s.writeSuccess(d),r._TraceLogger.logVerbose(o._logSource,n+"success"),e.value}).catch(function(e){return Object(f.J)()||(d.spPagesApiCorrelationId=e.correlationId),e instanceof _.e?e.isUnknown?(s.writeUnexpectedFailure("FailedResponseUnknown",e,d),r._TraceLogger.logError(o._logSource,e,n)):o._handleOdataError(e,e.status,s,n,d):(s.writeUnexpectedFailure("FailedToSavePageError2",e,d),r._TraceLogger.logError(o._logSource,e)),Promise.reject(e)})},t.prototype._processCreateOrCopyResponse=function(e,t,n){r._TraceLogger.logVerbose(this._logSource,"".concat(e," (").concat(n.Id,")"));var a=m.e.tryLoadFromSitePagesOdata(n);return p.e.updatePageContextItemId(n.Id),t.writeSuccess(),a},t.prototype._shouldCreateNewsCopy=function(){return g.e.instance.promoteOnPublish},t.prototype._savePageAsTemplateInternal=function(e,t,n){var a="".concat(x,"_").concat(this._webServerRelativeUrl);y.remove(a);var i="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/").concat(t);return this.createOrCopyPage(i,new S.n("POST"),(new S.t).toString(),n,t)},t}(S.e);function O(){return i._SPKillSwitch.isActivated("6965230b-9bdb-46c9-b696-1da797a4a860")}t.default=C},"UF/m":function(e,t,n){"use strict";n.d(t,"n",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"e",function(){return h});var a=n("UWqr"),i=n("ut3N"),r=n("vlQI"),o=n("Pk8u"),s=n("y88i"),c=n("EMa1"),d=n("XdGY"),l=n("q+wp"),u=n("bwg3"),f=n("onFi"),p=n("xs0R"),m=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},_=function(){function e(e){var t;t=p.t.isSpace?"SP.Publishing.SitePage3D":l.e.isNewTopicPage()?"SP.Publishing.TopicSitePage":"SP.Publishing.SitePage",this.__metadata={type:t},e&&Object(o.assign)(this,e)}return e.prototype.toString=function(){return JSON.stringify(this)},e}(),h=function(){function e(t,n){this._pageContext=t,this._spHttpClient=n,this._spHttpClientFetch=this._spHttpClient.fetch.bind(this._spHttpClient),this._spHttpClientGet=this._spHttpClient.get.bind(this._spHttpClient),this._spHttpClientPost=this._spHttpClient.post.bind(this._spHttpClient),this._isResponseSuccessful=l.e.isResponseSuccessful.bind(l.e),this._isSaveSuccessful=e._isSaveResponseSuccessful}return e._getOdataRestApiError=function(e,t,n){void 0===t&&(t=500);var a=e["odata.error"],i=n&&n.message||"unknown",r=Object(d.J)()||null==n?void 0:n.correlationId;return a&&a.message?new f.e("Inner-Message: ".concat(a.message.value," Exception-Message: ").concat(i),t,a.code,r):void 0},e._encodeAndSanitizeURIComponent=function(e){return(e=encodeURIComponent(e).replace(/'/g,"''")).replace(/[~!*()']/g,function(e){return"%"+e.charCodeAt(0).toString(16)})},e._isSaveResponseSuccessful=function(e){return l.e.isResponseSuccessful(e)||413===e},Object.defineProperty(e.prototype,"_webServerRelativeUrl",{get:function(){return a.UrlUtilities.removeEndSlash(this._pageContext.legacyPageContext.webServerRelativeUrl)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restSitePagesEndPointUrl",{get:function(){return this._webServerRelativeUrl+"/_api/sitepages/pages"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restSpacesEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/spaces"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForEtag",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=ETag"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForCheckInComments",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=CheckInComment"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restTopicsEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/topics"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_defaultSitePageThumbnail",{get:function(){return s.Uri.concatenate("/",this._pageContext.legacyPageContext.layoutsUrl,"/images/sitepagethumbnail.png")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_pageServerRelativeUrl",{get:function(){var t="/"+e._encodeAndSanitizeURIComponent(l.e.url(!0).replace(l.e.domainUrl(),""));return l.e.doesUrlHaveFileName?t:l.e.spPageContextInfo.serverRequestPath},enumerable:!1,configurable:!0}),e.prototype._fetch=function(e,t,n,a){var i=this._spHttpClientPost,o={body:n,headers:t};return t?"GET"===t["X-HTTP-Method"]&&(i=this._spHttpClientFetch):(o=void 0,i=this._spHttpClientGet),i(e,r.SPHttpClient.configurations.v1,o).catch(function(e){return Promise.reject({error:new f.e})}).then(function(e){if(!a(e.status)){var t=Object(d.J)()?new f.e(l.e.getStatusMessage(e),e.status):new f.e(l.e.getStatusMessage(e),e.status,void 0,e.headers.get("SPRequestGuid")||void 0);throw t.response=e,{error:t,isResponseSuccessful:!1}}return e})},e.prototype._fetchJson=function(t,n,a,i){var r;return this._fetch(t,n,a||(new _).toString(),i||this._isResponseSuccessful).catch(function(e){if(!1===e.isResponseSuccessful)return r=e.error,e.error.response;throw e.error}).then(function(e){return e.ok&&204===e.status?e:e.json()}).then(function(t){var n=e._getOdataRestApiError(t,r&&r.status,r)||r;if(n)throw n;return t})},e.prototype._handleOdataError=function(e,t,n,a,r){if(e){if(Object(d.J)()||void 0===e.correlationId||((r=r||{}).spPagesApiCorrelationId=e.correlationId),400!==t||e.message!==c.t.exceedStreamLimitationErrorMessage&&e.message!==c.t.requestMessageTooBigErrorMessage)if(409===t){var o=new f.e("File checked out by another user",409);n.writeExpectedFailure("FailedResponsePageConflict",o,r)}else if(404===t){var s=new f.e("Page is not found",404);n.writeExpectedFailure("FailedResponseNotFound",s,r)}else 406===t?n.writeExpectedFailure("FailedResponseNotAcceptable",e,r):403===t?n.writeExpectedFailure("FailedResponseForbidden",e,r):n.writeUnexpectedFailure("FailedResponseStatus",e,r);else n.writeUnexpectedFailure("FailedResponseExceedStreamLimitation",e,r);throw i._TraceLogger.logError(this._logSource,e,a),Object(d.pe)()||(e.message=Object(u.e)(t)),e}},e}()},dInN:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("0IsF"),i=n("xs0R");function r(){var e;return(null===(e=i.t.fields)||void 0===e?void 0:e.PageLayoutType)===a.e.Topic}},k6KK:function(e,t,n){"use strict";var a=function(){function e(){}return e.isDuplicateFieldValueError=function(e,t){var n,a;return(null===(n=e.code)||void 0===n?void 0:n.indexOf("Microsoft.SharePoint.SPDuplicateValuesFoundException"))>-1&&(null===(a=e.message)||void 0===a?void 0:a.indexOf(t))>-1},e.spDuplicatedEntityIdException="-2130575169, Microsoft.SharePoint.SPDuplicateValuesFoundException",e.siteQuoteExceededException="-2147023080, Microsoft.SharePoint.SPException",e}();t.e=a},pfXd:function(e,t,n){"use strict";var a=n("ut3N"),i=n("EMa1"),r=n("jyrw"),o=n("E7/L"),s=n("GDsS"),c=n("dInN");function d(){return Object(s.e)()&&Object(c.e)()?u():l()}function l(){return n.e(6).then(n.bind(null,"+Mf1")).then(function(e){return e.default})}function u(){return Promise.all([n.e(6),n.e(141)]).then(n.bind(null,"7EU/")).then(function(e){return e.default})}var f=n("xs0R"),p=n("q+wp"),m=function(){function e(){}return e.setIsTemplate=function(t){r.e._dispatchAction("FIELDS_SET_TEMPLATE_STATUS",t,e._moduleName,"set page template flag")},e.setNumMissingRequiredProps=function(t){r.e._dispatchAction("FIELDS_SET_MISSING_PROPS",t,e._moduleName,"set missing required properties")},e.setCategories=function(t){r.e._dispatchAction("FIELDS_SET_CATEGORIES",t,e._moduleName,"set categories")},e.addFieldsToUpdate=function(t){e._dispatchAction("FIELDS_UPDATE",t,"SPPageFieldStoreSetFields")},e.addFieldToUpdate=function(t,n){if(!t)throw new Error("fieldName is undefined");var a={};a[t]=n,e.addFieldsToUpdate(a)},e.setPromotedState=function(t){e._dispatchAction("FIELDS_SET_PROMOTEDSTATE",t,"SPPageFieldStoreSetFields")},e.clearPrivateAuthoringFlag=function(){var t,n,a=null===(n=null===(t=f.t.fields)||void 0===t?void 0:t.PageFlags)||void 0===n?void 0:n.filter(function(e){return e&&e!==i.t.privateAuthoringFlagKey});a&&e.addFieldToUpdate("PageFlags",a)},e.setFields=function(t){e._dispatchAction("FIELDS_SET",t,"SPPageFieldStoreSetFields")},e.createNewPage=function(t,n,i,r){return r&&(t.bannerImageUrl=f.t.fields.BannerImageUrl),(t.pageFieldData?Promise.resolve(t.pageFieldData):Object(o.e)().then(function(e){return e.createNewPageStub(t,n,i,r)})).then(function(t){e._dispatchAction("PAGE_CREATE_STUB",t,"SPPageFieldStoreCreatePageStub"),t&&p.e.logUserEngagementForPage(t,!0,"NewButton")}).catch(function(t){a._TraceLogger.logError(e._logSource,t)})},e.createNewPageDeprecated=function(t,n,i,r,s,c,d,l,u,m,_,h){return u&&(_=f.t.fields.BannerImageUrl),(i?Promise.resolve(i):Object(o.e)().then(function(e){return e.createNewPageStubDeprecated(t,n,r,s,c,d,l,u,m,_)})).then(function(t){e._dispatchAction("PAGE_CREATE_STUB",t,"SPPageFieldStoreCreatePageStub"),t&&p.e.logUserEngagementForPage(t,!0,"NewButton")}).catch(function(t){a._TraceLogger.logError(e._logSource,t)})},e.scheduleNewMajorVersionToServerAsync=function(){return d().then(function(e){return e.scheduleNewMajorVersionToServerAsync()})},e.publishNewMajorVersionToServerAsync=function(){return d().then(function(e){return e.publishNewMajorVersionToServerAsync()})},e.publishTopicPageMajorVersionToServerAsync=function(){return(Object(s.e)()?u():l()).then(function(e){return e.publishTopicPageMajorVersionToServerAsync()})},e.discardPageOnServerAsync=function(){return d().then(function(e){return e.discardPageOnServerAsync()})},e.getPreviousPageVersionInfoAsync=function(){return d().then(function(e){return e.getPreviousPageVersionInfoAsync()})},e.setListItemModerationStatusAsync=function(e,t){return d().then(function(n){return n.setListItemModerationStatusAsync(e,t)})},e.setFileCheckInCommentsAsync=function(){return d().then(function(e){return e.setFileCheckInCommentsAsync()})},e.checkOutFieldsFromServerAsync=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),d().then(function(n){return n.checkOutFieldsFromServerAsync(e,t)})},e.saveDraftToServerAsync=function(){return d().then(function(e){return e.saveDraftToServerAsync()})},e.saveFieldsToServerAsync=function(e){return void 0===e&&(e=!1),d().then(function(t){return t.saveFieldsToServerAsync(e)})},e.getPageUrlFromServerAsync=function(){return d().then(function(e){return e.getPageUrlFromServerAsync()})},e.checkInFileAsync=function(e,t,n){return d().then(function(a){return a.checkInFileAsync(e,t,n)})},e.ensureValidPageTitleAsync=function(){return d().then(function(e){return e.ensureValidPageTitle()})},e.promotePageToNewsAsync=function(){return d().then(function(e){return e.promotePageToNewsAsync()})},e.cacheClientForm=function(t,n){void 0===n&&(n=!1),e._dispatchAction("FIELDS_CACHE_CLIENTFORM",{clientForm:t,forceCanvasUpdate:n},"SPPageCacheClientForm")},e.ensurePageExistsAsync=function(){return f.t.doesPageExistOnServer?(a._TraceLogger.logVerbose(e._logSource,"Page already Exists"),Promise.resolve()):(a._TraceLogger.logVerbose(e._logSource,"Page does not Exists, calling createNewPageOnServerAsync"),d().then(function(e){return e.createNewPageOnServerAsync()}))},e.commitTitle=function(){e._dispatchAction("FIELDS_COMMIT_TITLE",void 0,"SPPageFieldStoreCommitTitle")},e.deletePageAsync=function(){return d().then(function(e){return e.deletePageAsync()})},e.setIsCanvasWizardOpen=function(t){e._dispatchAction("FIELDS_SET_IS_CANVAS_WIZARD_OPEN",t,"SPPageFieldSetIsCanvasWizardOpen")},e.turnOnIsCollaborating=function(){e._dispatchAction("FIELDS_SET_IS_COLLABORATING",!0,"SPPageFieldTurnOnIsCollaborating")},e.setFocusMode=function(t){e._dispatchAction("FIELDS_SET_FOCUS_MODE_STATUS",t,"SPPageFieldSetFocusMode")},e._dispatchAction=function(t,n,a){return r.e._dispatchAction(t,n,e._moduleName,a,void 0,e._logSource)},e._moduleName="[PageFieldStoreAction]",e._logSource=a._LogSource.create("PageFieldStoreActionCreator"),e}();t.e=m},s2tg:function(e,t,n){"use strict";n.r(t);var a=n("jyrw"),i=function(){function e(){}return e.load=function(t){a.e._dispatchAction("CHROME_CONFIG_LOAD",t,e._moduleName,"SPPageConfigChrome")},e._moduleName="[ChromeConfigurationAction]",e}(),r=n("2q6Q"),o=n("7plR"),s=n("n1SJ"),c=n("LjAQ"),d=function(){function e(){}return e.addQuickLaunchNode=function(t){var n=new r._QosMonitor("SPPageNavigationUpdateQuickLaunch");try{o.e.instance.getPageDataProviderAsync().then(function(e){return e.addPageToQuickLaunchAsync(t.name,t.url)}).then(function(t){a.e._dispatchAction("QUICKLAUNCH_ADDONE",t,e._moduleName,"SPPageNavigationUpdateQuickLaunch",void 0,void 0,n)}).catch(function(e){s.e.showError(c.e,c.t,e)})}catch(e){throw n.writeUnexpectedFailure("SPPageNavigationUpdateQuickLaunch",e),e}},e._moduleName="[NavigationAction]",e}(),l=n("17wl"),u=n("pfXd"),f=n("ut3N"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.undo=function(){a.e._dispatchAction("FIELDS_UNDO",{},t._undoableModuleName,"Undo",void 0,t.LOG_SOURCE,new f._QosMonitor("Undo"))},t.redo=function(){a.e._dispatchAction("FIELDS_REDO",{},t._undoableModuleName,"Redo",void 0,t.LOG_SOURCE,new f._QosMonitor("Redo"))},t.clearHistory=function(){a.e._dispatchAction("FIELDS_CLEAR_HISTORY",{},t._undoableModuleName,"ClearHistory",void 0,t.LOG_SOURCE,new f._QosMonitor("ClearHistory"))},t.disableUndo=function(){a.e._dispatchAction("FIELDS_DISABLE_UNDO",{},t._undoableModuleName,"DisableUndo")},t.enableUndo=function(){a.e._dispatchAction("FIELDS_ENABLE_UNDO",{},t._undoableModuleName,"EnableUndo")},t.LOG_SOURCE=f._LogSource.create("UndoablePageFieldStoreActionCreator"),t._undoableModuleName="[UndoablePageFieldStoreAction]",t}(u.e),m=p,_=function(){function e(){}return e.loadPageLayoutMapping=function(t){a.e._dispatchAction("PAGELAYOUTMAPPING_LOAD",t,e._moduleName,"SPPageLayoutMapping",{Mapping:t.toString()})},e.addPageLayoutMapping=function(t,n){a.e._dispatchAction("PAGELAYOUTMAPPING_ADD",{key:t,pageLayout:n},e._moduleName,"SPPageAddPageLayoutMapping",{key:t})},e._moduleName="[PageFieldStoreAction]",e}(),h=n("Fn15"),b=function(){function e(){}return e.load=function(t){a.e._dispatchAction("PAGE_TEMPLATE_LOAD",t,e._moduleName,"SPPageTemplatesLoad")},e._moduleName="[PageTemplateAction]",e}(),g=function(){function e(){}return e.setListSettings=function(t){a.e._dispatchAction("SET_LIST_SETTINGS",t,e._moduleName,"set list settings")},e._moduleName="[ListActionCreator]",e}(),v=n("UWqr"),y=n("I6O9"),S=n("sSDQ"),D=n("hiL/"),I=n("EMa1"),x=n("ExwJ"),C=n("XdGY"),O=n("0IsF"),w=n("9sBY"),E=n("q+wp"),A=n("lDgI"),L=n("67N2"),k=n("bwg3"),M=function(){function e(){}return e.createNewPage=function(t,n){var a=n.canvasContent1?e._extractWebPartIdsFromCanvasContent(n.canvasContent1):[];return(Object(D.isCortexEnabled)(o.e.instance.pageContext)?e._loadComponentManifests(a):Promise.resolve()).then(function(){return o.e.instance.autoSaverPromise.then(function(a){return o.e.instance.getPageDataProviderAsync().then(function(i){var r,d,l,u=Object(L.r)()?Boolean(!n.isPreview&&(null===(d=n.pageFieldData)||void 0===d?void 0:d.EntityType)):(null===(r=n.pageFieldData)||void 0===r?void 0:r.PageLayoutType)===O.e.Topic,f=n.pageLayoutType===O.e.Space||(null===(l=n.pageFieldData)||void 0===l?void 0:l.PageLayoutType)===O.e.Space;return i.getListMetadataAsync().then(function(i){g.setListSettings(i),a.resetAutoSaveAttempts();var r=i.EnableMinorVersions?"0.1":"1.0";return Object(L.e)()?e._dispatchNewPageActionsDeprecated(t,n.source,n.promotedState,n.pageTemplateId,n.pageFieldData,n.canvasContent1,n.spaceContent,n.serverWebPartsDataMap,i.EnableModeration?D.SPModerationStatusType.Draft:void 0,r,n.templateFolderName,n.pageLayoutType,n.isPreview,n.previewPageFileName,n.bannerImageUrl,n.publishStartDate):e._dispatchNewPageActions(n,t,i.EnableModeration?D.SPModerationStatusType.Draft:void 0,r)}).then(function(){return n.isPreview?Promise.resolve():s.e.setDisplayModeEditAsync().then(function(){var e,t;!Object(L.r)()&&u?document.title=w.a:document.title=null!==(e=n.previewPageFileName)&&void 0!==e?e:w.n,E.e.authorId=null===(t=E.e.preloadedData.user)||void 0===t?void 0:t.Id})}).then(function(){var e,t;if(u)if(Object(L.a)())(a=new URL(E.e.url())).searchParams.append("isNewTopicPage","true"),E.e.pushUrl(Object(L.s)()?a.toString():a.href,void 0,!0);else{var a=E.e.url(),i=E.e.appendUrlParam("isNewTopicPage","true",a);a!==i&&E.e.pushUrl(i,void 0,!0)}else if(v._SPFlight.isEnabled(943)&&f){var r=null===(e=n.pageFieldData)||void 0===e?void 0:e.Title,s=null===(t=n.pageFieldData)||void 0===t?void 0:t.Description;r&&(o.e.actions.fieldActions.addFieldToUpdate(x.e.Title,r),o.e.actions.fieldActions.commitTitle()),s&&o.e.actions.fieldActions.addFieldToUpdate(x.e.Description,s)}}).then(function(){return o.e.instance.serviceScope.whenFinished(function(){o.e.instance.serviceScope.consume(A.e.serviceKey).raiseNavigatedEvent()})}).catch(function(e){s.e.showError(Object(k.n)(e),c.D,e)})})})})},e.createNewCrossSitePage=function(e,t){return v.Validate.isNonemptyString(t.crossSiteUrl,"crossSiteUrl"),this.createNewPage(e,t)},e._dispatchNewPageActions=function(e,t,n,a){var i=!!e.templateFolderName;return o.e.instance.autoSaver&&o.e.instance.autoSaver.resetAutoSaveAttempts(),u.e.createNewPage(e,n,a,e.templateFolderName).then(function(){if(s.e.setSaveStatus(D.PageSaveStatus.Draft),u.e.setIsTemplate(i),u.e.setNumMissingRequiredProps(-1),t){var n=!Object(C.H)()&&e.templateFolderName?"SitePages/".concat(e.templateFolderName):"SitePages",a=v.UrlUtilities.removeEndSlash(o.e.instance.pageContext.legacyPageContext.webServerRelativeUrl)+"/".concat(n,"/").concat(e.isPreview?e.previewPageFileName||I.t.previewPageStubFileName:I.t.newPageStubFileName+"?Mode=Edit")+"".concat(e.source?"&source="+encodeURIComponent(e.source):"");t.push(a,{isNewPage:!0})}})},e._dispatchNewPageActionsDeprecated=function(e,t,n,a,i,r,c,d,l,f,p,m,_,h,b,g){var y=!!p;return o.e.instance.autoSaver&&o.e.instance.autoSaver.resetAutoSaveAttempts(),u.e.createNewPageDeprecated(n,a,i,r,c,d,l,f,p,m,b,g).then(function(){s.e.setSaveStatus(D.PageSaveStatus.Draft),u.e.setIsTemplate(y),u.e.setNumMissingRequiredProps(-1);var n=!Object(C.H)()&&p?"SitePages/".concat(p):"SitePages";if(e){var a=v.UrlUtilities.removeEndSlash(o.e.instance.pageContext.legacyPageContext.webServerRelativeUrl)+"/".concat(n,"/").concat(_?h||I.t.previewPageStubFileName:I.t.newPageStubFileName+"?Mode=Edit")+"".concat(t?"&source="+encodeURIComponent(t):"");e.push(a,{isNewPage:!0})}})},e._extractWebPartIdsFromCanvasContent=function(e){return("string"==typeof e?JSON.parse(e):e).reduce(function(e,t){return t.controlType===S.CanvasControlType.WebPartZone&&e.push({id:t.webPartId}),e},[])},e._loadComponentManifests=function(e){return e&&e.length?new y._ManifestProvider(o.e.instance.serviceScope,o.e.instance.pageContext.legacyPageContext.webAbsoluteUrl).tryGetManifests(e).then(function(e){y._ManifestStore.instance.registerManifests(e,!1)}).catch(function(t){var n=f._LogSource.create("PageCreationActionCreator");f._TraceLogger.logError(n,new Error("Failed to load one or more manifests [".concat(e.join(),"]")))}):Promise.resolve()},e}();t.default=function(){this.actions={coreActions:s.e,chromeActions:i,navActions:d,fieldActions:m,layoutMappingActions:_,statusActions:h.e,templateActions:b,listActions:g,pageCreationActions:M}}}}]);