define("49d290fb-a38e-4001-97d3-a2db486db2fa_0.1.0",["tslib","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@microsoft/sp-component-base","@microsoft/sp-loader","@microsoft/sp-lodash-subset","@ms/sp-dataproviders","@microsoft/sp-core-library","@ms/sp-topic-sdk","@microsoft/sp-page-context","@microsoft/sp-webpart-base","react","react-dom","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={1:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){var t={i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:"9poL"},n={i:"93dfc7f4-039c-4dc5-b10f-bf09ab171eba",v:"0.1.0",m:"n5CE"};return{2:[t,n],4:[t,n]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"vendors~topic-shared-create-new-topic-dia~bb55b989",2:"topic-shared-create-new-topic-dialog",3:"topic-shared-topic-association-callout",4:"topic-shared-topic-creation"}[e]||e)+"_"+(["fr-fr","none"])[{"0":1,"2":0,"3":0,"4":0}[e]]+"_"+{0:"df2c1519c7d6bdc6dede",2:"ae5cfd695cf0a5754d6e",3:"5e16d115ed186ba08e7c",4:"89979d4cfa0f76587fdc"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_49d290fb_a38e_4001_97d3_a2db486db2fa_0_1_0=window.webpackJsonp_49d290fb_a38e_4001_97d3_a2db486db2fa_0_1_0||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-topic-shared_fr-fr_c455dc5f6230a95a1828\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"+ORw":function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"i",function(){return r}),n.d(t,"_",function(){return o}),n.d(t,"f",function(){return s}),n.d(t,"s",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"u",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"p",function(){return f}),n.d(t,"r",function(){return p}),n.d(t,"D",function(){return m}),n.d(t,"l",function(){return _}),n.d(t,"o",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"h",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"y",function(){return y}),n.d(t,"S",function(){return S}),n.d(t,"d",function(){return D}),n.d(t,"g",function(){return I}),n.d(t,"e",function(){return x}),n.d(t,"v",function(){return C}),n.d(t,"m",function(){return O});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("5578ed5a-4e7a-45d7-a946-f024dc2e2f19")}function r(){return a._SPKillSwitch.isActivated("dc43c615-0dc0-468e-a1c8-484c15ad7937")}function o(){return a._SPKillSwitch.isActivated("ec2fb4a1-4bbc-4873-944a-4e97b7bf88e3")}function s(){return a._SPKillSwitch.isActivated("da8e1d2d-3d70-4e01-b510-0ed1a878db2c")}function c(){return a._SPKillSwitch.isActivated("b4f30075-c6ac-4012-9be0-9f5eff0435a2")}function d(){return a._SPKillSwitch.isActivated("a4163b00-d568-4704-b5cc-61f4d7a428ab")}function l(){return a._SPKillSwitch.isActivated("217319dc-7152-4d89-9e41-f8b6832a4484")}function u(){return a._SPKillSwitch.isActivated("223143f6-809d-4753-9325-4e3176b68b61")}function f(){return a._SPKillSwitch.isActivated("8e01d885-1e7f-4614-b4f9-70b14797ce0b")}function p(){return a._SPKillSwitch.isActivated("87db0354-1bb4-43ac-b9ad-9b77ef96d4ad")}function m(){return a._SPKillSwitch.isActivated("54a84d15-714a-4db3-b282-0be5a12aaa0a")}function _(){return a._SPKillSwitch.isActivated("cea9836d-fa11-4b9d-a02e-27cb1ca5e257")}function h(){return a._SPKillSwitch.isActivated("4ec6e712-b109-4e6b-8831-830e78b939f6")}function b(){return a._SPKillSwitch.isActivated("89556063-df7b-4f87-9039-9604457ea090")}function g(){return a._SPKillSwitch.isActivated("cefc45c4-a192-41b7-8187-31f48cbb201a")}function v(){return a._SPKillSwitch.isActivated("2672213c-a03a-4925-b5bf-6aa67f71f4de")}function y(){return a._SPKillSwitch.isActivated("9f31e0b5-e403-422c-8e0e-f537ac8c5b0d")}function S(){return a._SPKillSwitch.isActivated("74fdbed6-f55d-415f-9ef5-bfe7ca27bd67")}function D(){return a._SPKillSwitch.isActivated("a31ddbab-25a0-4079-ab1b-4fc19fd37593")}function I(){return a._SPKillSwitch.isActivated("ac301bea-4e6e-443a-b225-1e8fb5389fff")}function x(){return a._SPKillSwitch.isActivated("be7da963-dc9c-4854-b813-6c665c00b678")}function C(){return a._SPKillSwitch.isActivated("5d59e193-3eba-43ce-bb04-4614661bd72a")}function O(){return a._SPKillSwitch.isActivated("560f418a-61ae-4ae7-a5bf-49c85fcb6355")}},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"3rh1":function(e,t,n){"use strict";n.d(t,"h",function(){return i}),n.d(t,"b",function(){return r.e}),n.d(t,"e",function(){return o.e}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c.e}),n.d(t,"d",function(){return d}),n.d(t,"l",function(){return l}),n.d(t,"m",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"t",function(){return v}),n.d(t,"s",function(){return S}),n.d(t,"o",function(){return D}),n.d(t,"c",function(){return I}),n.d(t,"p",function(){return x}),n.d(t,"n",function(){return C.e}),n.d(t,"r",function(){return C.t}),n.d(t,"_",function(){return C.n}),n.d(t,"u",function(){return O});var a=n("rMgv");function i(e){return(null==e?void 0:e.length)>0?a.e.Curated:a.e.NotCurated}var r=n("XJVB"),o=n("aj7r");function s(e){var t;return null===(t=e.knowledgeHubSiteDetails)||void 0===t?void 0:t.Url}var c=n("OUh5");function d(e,t){var n,a,i=new Set([e.Id].concat(null!==(n=e.OriginalIds)&&void 0!==n?n:[]));return[t.Id].concat(null!==(a=t.OriginalIds)&&void 0!==a?a:[]).some(function(e){return i.has(e)})}function l(e){return"Suggested"===e||"UserSuggested"===e}var u=n("M0jl"),f=n("GKvq");function p(e,t,n){Object(u.e)("errorPage",n,{errorMessage:e});var a=Object(c.e)(t),i=t.legacyPageContext.layoutsUrl||"_layouts/15",r="".concat(a,"/").concat(i,"/error.aspx?Title=").concat(f.e,"&ErrorText=").concat(e);window.postMessage("router://".concat(r),window.location.origin)}function m(e){var t,n,a;return Boolean(e&&((null===(t=e.author)||void 0===t?void 0:t.name)||(null===(n=e.author)||void 0===n?void 0:n.email)||(null===(a=e.author)||void 0===a?void 0:a.upn))&&e.time)}var _=n("X+PM"),h=n("hiL/"),b=n("WZz6"),g=n("w4+A");function v(e){if(Object(h.isEnvSPDF)()){var t=e.legacyPageContext;if(t){var n=new _.SPPermission(t.webPermMasks);return Promise.resolve(Object(h.isCortexEnabled)(e)&&n.hasAnyPermissions(_.SPPermission.manageLists,_.SPPermission.manageWeb)&&Object(g.a)())}}return Object(b.getTopicsSdkAsync)(e.legacyPageContext).then(function(t){return t.canUserEditTopics()&&(!Object(h.isEnvMSIT)(e)||t.canUserManageTopics())})}var y=n("+ORw");function S(e,t){var n;return Boolean(null===(n=t.RelatedPeople)||void 0===n?void 0:n.some(function(t){return Object(y.p)()?I(e,t.Email)||I(e,t.Upn):D(e,t.Email,t.Upn)}))}function D(e,t,n){return!(!t&&!n)&&(Boolean(t&&(t===e.email||t===e.loginName))||Boolean(n&&(n===e.email||n===e.loginName)))}function I(e,t){return t===e.email||t===e.loginName}function x(e){return Object(b.getTopicsSdkAsync)(e).then(function(e){return Boolean(e.isPreviewUser())}).catch(function(){return!1})}var C=n("HmPY");function O(e){return"Suggested"===e||"Confirmed"===e||"UserSuggested"===e}},"5pbq":function(e,t){e.exports=i},"6DK4":function(e,t,n){"use strict";function a(e){var t=e.headers.get("sprequestguid")||"",n=e.headers.get("microsoftsharepointteamservices")||"";return"[HTTP]:".concat(e.status," - ").concat(e.statusText," [CorrelationId]:").concat(t," [Version]:").concat(n)}n.d(t,"e",function(){return a})},"7Awa":function(e,t){e.exports=r},"9G/V":function(e){e.exports=JSON.parse('{"e":"Envoyer des commentaires","t":"Envoyer un courrier à l’équipe d’expérience de la rubrique Projet Cortex"}')},GKvq:function(e){e.exports=JSON.parse('{"c":"Commentaires au sujet de : {0}","t":"Parlez-nous de votre expérience à ce sujet. Les informations étaient-elles exactes et utiles ?","a":"Notes d’ingénierie : ","i":"Source : ","o":"ID de la rubrique : ","r":"Versions de la boîte à outils : ","n":"Agent du navigateur :  ","s":"Langue de l\\u0027utilisateur","e":"Les détails de la rubrique ne sont pas disponibles pour le moment"}')},HmPY:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"n",function(){return u});var a=n("X+PM"),i=n("hiL/"),r=n("WZz6"),o=n("rMgv"),s=n("+ORw"),c=n("mAUd");function d(e){if(e){var t=new URL(e);return t.searchParams.append(o._.LinkSource,o._.Language),Object(s.g)()||t.searchParams.append("stay","true"),t.toString()}}function l(e,t){var n;if(e._isFinished){var o=e.consume(a.PageContext.serviceKey),d=e.consume(i.TopicDataService.serviceKey);return!Object(s.y)()&&t||i.Multilingual.isTopicMultilingualFlightEnabled()||i.Multilingual.isTopicMultilingualEapFlightEnabled()&&Object(r.isCortexEapUser)(o.legacyPageContext)?Object(c.u)()?d.topicPageMultilingualInfo.previewLanguage:(null===(n=d.topicPageMultilingualInfo)||void 0===n?void 0:n.isTranslation)?d.topicPageMultilingualInfo.translationLanguage:o.web.languageName:void 0}}function u(e,t,n){if(t._isFinished){var r=t.consume(a.PageContext.serviceKey),o=r.web.languageName;if(e)return o;if(n&&0!==n.length){var s=r.cultureInfo.currentUICultureName,c=Object(i.getTopicLanguageByCulture)(o),d=Object(i.getTopicLanguageByCulture)(s),u=l(t,!0),f=Object(i.getTopicLanguageByCulture)(u||"");return f&&-1!==n.indexOf(f)?u:d&&-1!==n.indexOf(d)?s:c&&-1!==n.indexOf(c)?o:i.TOPIC_CULTURES[n[0]||""]}}}},I6O9:function(e,t){e.exports=o},Kwxa:function(e){e.exports=JSON.parse('{"e":"De {0}","t":"Wikipédia","n":"Texte sous licence CC-BY-SA"}')},M0jl:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("17wl"),i=n("ut3N"),r=n("XJVB");function o(e,t,n,o,s){var c={};o&&(c.topicId=o,c.topicOrigin=Object(r.e)(o)),s&&(c.topicCurated=s),i._EngagementLogger.logEventWithLogEntry(new i._LogEntry(t,e,i._LogType.Event,Object(a.__assign)(Object(a.__assign)({},n),c),!0))}},NDxI:function(e,t,n){"use strict";var a=n("17wl"),i=function(e){function t(n,a,i,r){void 0===n&&(n="unknown"),void 0===a&&(a=200),void 0===r&&(r=!1);var o=e.call(this,n)||this;return"unknown"===n&&(o.isUnknown=!0),o.__proto__=t.prototype,o.status=a,o.code=i,o.isExpected=r,o.errorType="RestApiError",o}return Object(a.__extends)(t,e),t}(Error);t.e=i},NmML:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("rMgv");function i(e,t){if(!e)return e;var n=new URL(e);return n.searchParams.append(a._.LinkSource,t),n.href}},OUh5:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n("UWqr"),i=n("ut3N"),r="https://microsoft.sharepoint-df.com/teams/knowledgehub",o="https://microsoft.sharepoint.com/sites/knowledgecenter",s=["odspcsitest","olfilato-test-site","EdensTestSPDF","knowledgehub"];function c(e){var t,n;a.Validate.isNotNullOrUndefined(e,"pageContext");var c=i._LogSource.create("TopicUtilities");if(function(e){a.Validate.isNotNullOrUndefined(e,"pageContext");var t=e.site.absoluteUrl.toLowerCase();return-1!==t.indexOf("microsoft.sharepoint-df.com")&&s.some(function(e){return-1!==t.indexOf(e)})}(e))return r;if(null===(n=null===(t=e.legacyPageContext)||void 0===t?void 0:t.knowledgeHubSiteDetails)||void 0===n?void 0:n.Url){var d=e.legacyPageContext.knowledgeHubSiteDetails.Url;return d===r?o:d}return-1!==location.origin.toLowerCase().indexOf("microsoft")?o:void i._TraceLogger.logError(c,new Error("Error: Configure the KnowledgeCenter URL for Knowledge Mining scenarios to work correctly."))}},Pk8u:function(e,t){e.exports=s},QZHX:function(e,t){e.exports=c},UWqr:function(e,t){e.exports=d},WZz6:function(e,t){e.exports=l},"X+PM":function(e,t){e.exports=u},XJVB:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("rMgv");function i(e){return(null==e?void 0:e.split(a.d)[0])||""}},aj7r:function(e,t,n){"use strict";function a(e){return e.toLowerCase().replace(/[{}]/g,"")}n.d(t,"e",function(){return a})},br4S:function(e,t){e.exports=f},cDcd:function(e,t){e.exports=p},faye:function(e,t){e.exports=m},hN9v:function(e){e.exports=JSON.parse('{"u":"Zone de titre","f":"Description de la zone de titre","p":"Résumé","r":"Contacts","l":"Fichiers et pages","s":"Sites associés","d":"Graphique","t":"Conversations","n":"Questions et réponses","m":"Rubrique","i":"Personnes liées au sujet actuel.","a":"Documents liés au sujet actuel.","c":"Rubriques associées à la rubrique actuelle.","o":"Sites associés au sujet actuel.","e":"Conversations Yammer liées au sujet actuel."}')},"hiL/":function(e,t){e.exports=_},hrbp:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a,i=n("UWqr"),r=n("hiL/"),o=n("aj7r"),s=n("j84u"),c=n("rMgv"),d=n("jamc"),l=n("mAUd"),u=n("hN9v"),f=n("+ORw"),p=n("w4+A");!function(e){e[e.TopicGraph=486]="TopicGraph",e[e.YammerTopic=745]="YammerTopic",e[e.SupportExternalResources=60695]="SupportExternalResources"}(a||(a={}));var m=function(){function e(){}return e.getLayoutWebPartIds=function(){return[{webPartId:e.TITLE_REGION_WP_ID},{webPartId:e.DISAMBIGUATION_WP_ID,disabled:Object(f.r)()},{webPartId:e.DEFINITION_WP_ID},{webPartId:e.RELATED_PEOPLE_WP_ID},{webPartId:e.RELATED_DOCS_WP_ID},{webPartId:e.RELATED_SITES_WP_ID},{webPartId:e.GRAPH_WP_ID,disabled:!e._isFlightEnabled(a.TopicGraph)},{webPartId:e.YAMMER_WP_ID,disabled:!e._isFlightEnabled(a.YammerTopic)}].filter(function(e){return!e.disabled}).map(function(e){return e.webPartId})},e.getLayoutTemplate=function(t,n){i.Validate.isNotNullOrUndefined(t,"topic"),i.Validate.isNotNullOrUndefined(t.Id,"topicId"),i.Validate.isNotNullOrUndefined(t.Name,"topicName");var o=[];return e.getLayoutWebPartIds().forEach(function(i){switch(i){case e.TITLE_REGION_WP_ID:o.push({id:e.TITLE_REGION_WP_ID,title:u.u,dataVersion:d.e.titleRegion,instanceId:e.TITLE_REGION_WP_ID,description:u.f,serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},properties:{imageSourceType:r.ImageSourceType.none,title:t.Name,textAlignment:"Left",showPublishDate:!1,authors:void 0,showTopicHeader:!0,authorByline:void 0,layoutType:"TopicPage",topicId:t.Id,topicName:t.Name,topicHeader:u.m,preventTitleOverwrite:!0,hasTitleBeenCommitted:!!Object(f.D)()||Object(l.u)()}});break;case e.DEFINITION_WP_ID:var s=[];o.push({id:e.DEFINITION_WP_ID,instanceId:e.OVERVIEW_RTE_INSTANCE_ID,title:u.p,description:u.p,dataVersion:d.e.definition,properties:{content:t.Definition,title:u.p,topicName:t.Name,curated:s,suggested:e._getAlternateNamesInfo(t.AlternateNames),removed:s,confirmedTopicTypes:Object(p.l)(n.legacyPageContext)?e._getTopicTypesInfo(t.Types,n):void 0}});break;case e.RELATED_PEOPLE_WP_ID:o.push({id:e.RELATED_PEOPLE_WP_ID,instanceId:e.RELATED_PEOPLE_WP_ID,title:u.r,description:u.i,dataVersion:d.e.people,properties:{title:u.r,topicName:t.Name,suggested:e._getExpertInfoFromRelatedPeople(t.RelatedPeople),curated:e._defaultCurated(t,n),removed:[]}});break;case e.RELATED_DOCS_WP_ID:o.push({id:e.RELATED_DOCS_WP_ID,instanceId:e.RELATED_DOCS_WP_ID,title:u.l,description:u.a,dataVersion:e._isFlightEnabled(a.SupportExternalResources)?d.e.resource:"1.4.0",properties:{title:u.l,topicName:t.Name,suggested:e._getSuggestedResources(t.RelatedDocuments),curated:[]}});break;case e.RELATED_SITES_WP_ID:o.push({id:e.RELATED_SITES_WP_ID,instanceId:e.RELATED_SITES_WP_ID,title:u.s,description:u.o,dataVersion:d.e.sites,properties:{curated:[],removed:[]}});break;case e.GRAPH_WP_ID:o.push({id:e.GRAPH_WP_ID,instanceId:e.GRAPH_WP_ID,title:u.d,description:u.c,dataVersion:d.e.graph,properties:{isOnTopicPage:!0,title:u.d,topicName:t.Name,titleFontWeightBold:!0,suggested:[],curated:[]}});break;case e.DISAMBIGUATION_WP_ID:o.push({id:e.DISAMBIGUATION_WP_ID,instanceId:e.DISAMBIGUATION_WP_ID,title:"",description:"",dataVersion:d.e.disambiguation,properties:{isOnTopicPage:!0}});break;case e.YAMMER_WP_ID:o.push({id:e.YAMMER_WP_ID,instanceId:e._YAMMER_QUESTIONSANDANSWERS_WP_INSTANCE_ID,title:u.t,description:u.e,dataVersion:"1.0",properties:{isOnTopicPage:!0,title:u.n,type:"Topic",legacyId:t.Id,feedSubtype:"QUESTIONS",threadCount:3,showHighlights:!0,templateType:"Cortex"}},{id:e.YAMMER_WP_ID,instanceId:e._YAMMER_CONVERSATIONS_WP_INSTANCE_ID,title:u.t,description:u.e,dataVersion:"1.0",properties:{isOnTopicPage:!0,title:u.t,type:"Topic",legacyId:t.Id,feedSubtype:"ALL",threadCount:3,showHighlights:!0,templateType:"Cortex"}})}}),o},e.getAnchorIdForWebPart=function(e){var t;return(t={},t[this.RELATED_DOCS_WP_ID]=c.f,t[this.RELATED_PEOPLE_WP_ID]=c.u,t[this.GRAPH_WP_ID]=c.m,t[this.RELATED_SITES_WP_ID]=c.p,t)[e]},e.getTitleRegionData=function(t,n){return e.getLayoutTemplate(t,n).filter(function(t){return t.id===e.TITLE_REGION_WP_ID})[0]},e._getExpertInfoFromRelatedPeople=function(e){return e?e.map(function(e){return{name:e.Name,id:e.OId,email:e.Email,upn:e.Upn}}):[]},e._defaultCurated=function(e,t){if(e.Id===r.NULL_TOPIC_ENTITY.Id){var n=t.user,a=n.displayName,i=n.email,o=n.loginName;return[{id:i,name:a,email:i,upn:o,curationDetails:Object(s.t)(i,a,o)}]}return[]},e._getAlternateNamesInfo=function(e){return e?e.map(function(e){return{name:e.Name}}):[]},e._getSuggestedResources=function(e){return e&&e.length>0?e.map(function(e){var t,n;return{aiReason:e.AIReason?{reasonType:e.AIReason.ReasonType,topicMentionsCount:e.AIReason.TopicMentionsCount}:void 0,title:e.Title,url:e.WebviewUrl||e.Url,modifier:{email:(null===(t=e.Modifier)||void 0===t?void 0:t.Email)||"",name:(null===(n=e.Modifier)||void 0===n?void 0:n.Name)||"",id:""},viewCount:void 0===e.ViewCount?0:e.ViewCount,siteId:Object(o.e)(e.SiteId),webId:Object(o.e)(e.WebId),uniqueId:Object(o.e)(e.UniqueId),lastModifiedTime:e.LastModifiedTime,filePath:e.Url}}):[]},e._getTopicTypesInfo=function(e,t){var n=t.user,a=n.displayName,i=n.email,r=n.loginName;return e?e.map(function(e){return{Id:e.Id,DisplayName:e.DisplayName,Type:"TopicType",curationDetails:Object(s.t)(i,a,r)}}):[]},e._isFlightEnabled=function(e){return i._SPFlight.isEnabled(e)},e.TITLE_REGION_WP_ID="cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",e.RELATED_DOCS_WP_ID="9346e298-66c6-4122-853c-a1eef08b5827",e.RELATED_PEOPLE_WP_ID="29991a50-6f14-42e0-9536-aef85d91b05c",e.LOCKED_RTE_WP_ID="09fc0123-851e-4fd3-bdd6-6e2e31cb1ef7",e.DEFINITION_WP_ID="e9ee7242-273c-473f-bfa5-149b32873501",e.DISAMBIGUATION_WP_ID="65af22bc-cfae-4ac5-97c8-438d3ed7fd76",e.GRAPH_WP_ID="81ce1eba-74ad-4f0d-a692-2133b98bc308",e.YAMMER_WP_ID="cb3bfe97-a47f-47ca-bffb-bb9a5ff83d75",e.RELATED_SITES_WP_ID="8670c27e-8fb2-46a9-a4fe-ea4515d2d9e1",e.OVERVIEW_RTE_INSTANCE_ID="7aca70c6-02bc-4b46-a27e-093e34a7a4dc",e._YAMMER_CONVERSATIONS_WP_INSTANCE_ID="6f5b4c2a-5f50-4e2b-a7be-3e78496c0bd2",e._YAMMER_QUESTIONSANDANSWERS_WP_INSTANCE_ID="46747584-1075-4555-92d9-dc0dd04af129",e}()},j84u:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"t",function(){return d});var a=n("UWqr"),i=n("hiL/"),r=n("+ORw"),o=n("3rh1");function s(e,t,n,s){a.Validate.isNotNullOrUndefined(e,"serviceScope"),a.Validate.isNotNullOrUndefined(s,"newRelation");var c=e.consume(i.EntityRelationsService.serviceKey)[i.RelationsContainerKey].relations;c[t]||(c[t]={}),Object(r.e)()||s.forEach(function(e){Object(o.f)(e.curationDetails)||delete e.curationDetails}),c[t][n]=s}function c(e){a.Validate.isNotNullOrUndefined(e,"serviceScope"),e.consume(i.EntityRelationsService.serviceKey)[i.RelationsContainerKey].relations={}}function d(e,t,n,a){return void 0===a&&(a=!1),{author:{email:e,name:t,upn:n},time:(new Date).toISOString(),isAddedFromSearch:a}}},jOlS:function(e,t){e.exports=h},jamc:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.titleRegion="1.4",e.definition="1.3.0",e.people="1.1.0",e.resource="1.5.0",e.sites="1.1",e.graph="1.3",e.disambiguation="1.0",e}()},mAUd:function(e,t,n){"use strict";n.d(t,"t",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"u",function(){return _}),n.d(t,"s",function(){return h}),n.d(t,"l",function(){return b}),n.d(t,"d",function(){return g}),n.d(t,"c",function(){return v}),n.d(t,"n",function(){return y}),n.d(t,"e",function(){return S}),n.d(t,"o",function(){return D}),n.d(t,"r",function(){return I}),n.d(t,"i",function(){return x}),n.d(t,"a",function(){return C});var a=n("UWqr"),i=n("hiL/"),r=n("X+PM"),o=n("ut3N"),s=n("y88i"),c=n("rMgv"),d=n("NmML"),l=n("OUh5"),u=n("GKvq");function f(e,t,n,i){a.Validate.isNotNullOrUndefined(e,"name"),a.Validate.isNotNullOrUndefined(t,"id"),a.Validate.isNotNullOrUndefined(n,"pageContext"),a.Validate.isNotNullOrUndefined(i,"linkSource");var r=Object(l.e)(n),o="".concat(r,"/_layouts/15/TopicPagePreview.aspx?topicId=")+"".concat(t,"&topicName=").concat(encodeURIComponent(e));return Object(d.e)(o,i)}function p(e){a.Validate.isNotNullOrUndefined(e,"url"),window.open(e,"_blank")}function m(){var e=new URL(window.location.href).pathname.toLowerCase();return e.substring(e.lastIndexOf("/")+1)}function _(){return g()&&m().toLowerCase()===c.h.topicPagePreviewStubFileName.toLowerCase()}function h(){return g()&&m().toLowerCase()===c.h.createTopicPageStubFileName.toLowerCase()}function b(){return m().toLowerCase()===c.h.newPageStubFileName.toLowerCase()||h()}function g(){return-1!==new URL(window.location.href).pathname.toLowerCase().indexOf(c.h.layoutsPagePrefix)}function v(){return-1!==new URL(window.location.href).pathname.toLowerCase().indexOf(c.h.disambiguationPageStubFileName)}function y(e){return"".concat(Object(l.e)(e),"/").concat(c.h.layoutsPagePrefix).concat(c.h.createTopicPageStubFileName,"?Mode=Edit&isNewTopicPage=true")}var S=new Set(["doc","docx","one","ppt","pptx","xls","xlsx"]);function D(e,t,n,a){var i=((null==a?void 0:a.split(".").pop())||"").toLowerCase();if(a&&"msg"===i){var r=I(a),o=r.substring(0,r.lastIndexOf("/")),s=a.substring(0,a.lastIndexOf("/"));return"".concat(s,"?id=").concat(r,"&parent=").concat(o)}return S.has(i)&&e&&t&&n?"".concat(e,"/").concat(t,"/Doc.aspx?sourcedoc={").concat(encodeURIComponent(n),"}"):a}function I(e){return new URL(e).pathname}function x(e,t){var n=new o._QosMonitor(t),a=e.consume(i.PageService.serviceKey),s=e.consume(r.PageContext.serviceKey);return(null==s?void 0:s.list)?a.getCurrentItem().then(function(e){var t,a,i=null===(a=null===(t=null==e?void 0:e.item)||void 0===t?void 0:t.properties)||void 0===a?void 0:a.uniqueId;return i?n.writeSuccess():n.writeUnexpectedFailure("getUndefinedPageUniqueId"),i}).catch(function(e){n.writeUnexpectedFailure("getPageUniqueIdFailed",e)}):Promise.resolve(void 0)}function C(e){var t=e.topicName,n=e.topicId,a=e.source,i=e.buildNumber,r=e.feedbackEmail,o=e.pageContext,c=encodeURIComponent(s.StringHelper.format(u.c,t)),d=["".concat(u.i).concat(a),"".concat(u.o).concat(n),"".concat(u.r,"buildNumber=").concat(i),"".concat(u.n).concat(window.navigator.userAgent),"".concat(u.s).concat(o.legacyPageContext.currentLanguage)].join("\n"),l=encodeURIComponent("".concat(u.t,"\n\n\n").concat(u.a,"\n").concat(d));return"mailto:".concat(r,"?subject=").concat(c,"&body=").concat(l)}},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"_BaseSubstrateTopicDataProvider",function(){return C}),n.d(t,"SubstrateTopicsDataProviderV2",function(){return w}),n.d(t,"SubstrateManageTopicsDataProvider",function(){return E}),n.d(t,"SubstrateFeedbackDataProvider",function(){return A}),n.d(t,"SubstrateFeedbackDataProviderV2",function(){return L}),n.d(t,"SubstrateGetTopicSuggestionProvider",function(){return F}),n.d(t,"TopicDataProviderHelper",function(){return S}),n.d(t,"TopicPageLayoutDefaultTemplate",function(){return H.e}),n.d(t,"addEntityRelations",function(){return R.e}),n.d(t,"resetEntityRelations",function(){return R.n}),n.d(t,"getCurationDetails",function(){return R.t}),n.d(t,"generatePreviewUrl",function(){return N.t}),n.d(t,"openInNewTab",function(){return N.f}),n.d(t,"isPreviewPage",function(){return N.u}),n.d(t,"isCreateTopicPage",function(){return N.s}),n.d(t,"isNewPage",function(){return N.l}),n.d(t,"isLayoutsPage",function(){return N.d}),n.d(t,"isDisambiguationPage",function(){return N.c}),n.d(t,"getCreateTopicPageUrl",function(){return N.n}),n.d(t,"WEB_VIEW_EXTENSIONS",function(){return N.e}),n.d(t,"getWebviewUrl",function(){return N.o}),n.d(t,"getPathName",function(){return N.r}),n.d(t,"getPageUniqueId",function(){return N.i}),n.d(t,"getFeedbackMailLink",function(){return N.a}),n.d(t,"FeedbackDataProvider",function(){return B}),n.d(t,"_translateDoc",function(){return G}),n.d(t,"_translatePeople",function(){return K}),n.d(t,"_translatePerson",function(){return W}),n.d(t,"_translateSubstrateSuggestionSearchAPIResponse",function(){return te}),n.d(t,"_SubstrateGetTopicByIdDataProvider",function(){return ae}),n.d(t,"_SubstrateGetTopicsByIdsDataProvider",function(){return ie}),n.d(t,"_SubstrateAnnotationDataProvider",function(){return re}),n.d(t,"_SubstrateRelatedTopicsDataProvider",function(){return oe}),n.d(t,"_BaseKMWebPart",function(){return Ee}),n.d(t,"getLatestCurationAuthorProfile",function(){return Se}),n.d(t,"isSameAuthor",function(){return De}),n.d(t,"DeferredCreateNewTopicDialog",function(){return Le}),n.d(t,"DeferredTopicAssociationCallout",function(){return Pe}),n.d(t,"buildTopicEntity",function(){return Te.e}),n.d(t,"ExperienceFeedback",function(){return Fe}),n.d(t,"DeferredTopicCreation",function(){return Re}),n.d(t,"chooseIcon",function(){return Ne}),n.d(t,"TopicConstants",function(){return O.h}),n.d(t,"DEFAULT_RELATION_COUNT",function(){return O.t}),n.d(t,"MAX_RELATION_COUNT",function(){return O.r}),n.d(t,"logEngagement",function(){return Be.e}),n.d(t,"getStatusMessage",function(){return je.e}),n.d(t,"MORE_RESULTS_SIGNAL",function(){return V}),n.d(t,"translateTopicType",function(){return z}),n.d(t,"translateDoc",function(){return G}),n.d(t,"translatePeople",function(){return K}),n.d(t,"translatePerson",function(){return W}),n.d(t,"translateSite",function(){return q}),n.d(t,"translateSiteMetadata",function(){return Q}),n.d(t,"translateSubstrateTopicEntity",function(){return Y}),n.d(t,"translateAnnotationResponse",function(){return ee}),n.d(t,"translateSubstrateSuggestionSearchAPIResponse",function(){return te}),n.d(t,"MSIT_KNOWLEDGE_HUB_URL",function(){return h.t}),n.d(t,"GetTopicsByNamesDataProvider",function(){return Ve}),n.d(t,"TopicTypesDataProvider",function(){return ze}),n.d(t,"SubstrateQnANotificationsDataProvider",function(){return Ge}),n.d(t,"addLinkSource",function(){return Ke.e}),n.d(t,"TOPIC_RELATED_PEOPLE_ANCHOR_ID",function(){return O.u}),n.d(t,"TOPIC_RELATED_RESOURCES_ANCHOR_ID",function(){return O.f}),n.d(t,"TOPIC_RELATED_TOPICS_ANCHOR_ID",function(){return O.m}),n.d(t,"TOPIC_RELATED_SITES_ANCHOR_ID",function(){return O.p}),n.d(t,"TOPIC_ID_ORIGIN_BREAKER",function(){return O.d}),n.d(t,"CuratedTypes",function(){return O.e}),n.d(t,"DefinitionTypes",function(){return O.a}),n.d(t,"TopicPageParams",function(){return O._}),n.d(t,"LinkSourceTypes",function(){return O.i}),n.d(t,"isMobileView",function(){return O.b}),n.d(t,"RELATED_PEOPLE_LIMIT",function(){return O.s}),n.d(t,"RELATED_DOCUMENTS_LIMIT",function(){return O.o}),n.d(t,"SUBSTRATE_GETTOPICBYID_EMPTY_RESPONSE_ERROR",function(){return O.c}),n.d(t,"DUMMY_CURATION_DETAILS",function(){return O.n}),n.d(t,"TOPIC_PRIVACY_CLOSE_BUTTON_ID",function(){return O.l}),n.d(t,"EmptyResponseError",function(){return ne}),n.d(t,"AadTokenError",function(){return v}),n.d(t,"PagesFlightId",function(){return m.e}),n.d(t,"isAnnotatePageTitleFlightEnabled",function(){return m.n}),n.d(t,"isManageTopicsAPIMigrationEnabled",function(){return m.d}),n.d(t,"isSwitchAPIRequestMethodEnabled",function(){return m.f}),n.d(t,"isDisambiguationFlightEnabled",function(){return m.r}),n.d(t,"isEngagementLoggingWithTopicsSDKFlightEnabled",function(){return m.c}),n.d(t,"isRelatedTopicsMultiHopEnabled",function(){return m.u}),n.d(t,"isUseObjectstoreForTopicManagementEnabled",function(){return m.m}),n.d(t,"isVivaTopicsFREInSharePointFlightEnabled",function(){return m._}),n.d(t,"isCSIEnableCreateTopicCrossSitesEnabled",function(){return m.a}),n.d(t,"isTopicTypesFlightEnabled",function(){return m.p}),n.d(t,"isMultipleTopicTypesFlightEnabled",function(){return m.l}),n.d(t,"isZeroTermSuggestionsFlightEnabled",function(){return m.h}),n.d(t,"_isAnnotationsCheckUsingTopicsSDK",function(){return m.t}),n.d(t,"isEnablePreACLScoreFlightEnabled",function(){return m.s}),n.d(t,"isEnablePostACLScoreFlightEnabled",function(){return m.o}),n.d(t,"isChangeTopicPageStylesFlightEnabled",function(){return m.i}),n.d(t,"isVivaTopicsFREKSActivated",function(){return _.p}),n.d(t,"SubstrateManagedDashboardDataProvider",function(){return We}),n.d(t,"WikiSourceElement",function(){return Ye}),n.d(t,"SuggestedDefinitionSourceElement",function(){return Qe}),n.d(t,"MultilingualSourceMessage",function(){return Je}),n.d(t,"DataVersion",function(){return Xe.e}),n.d(t,"topicCurated",function(){return we.h}),n.d(t,"topicOrigin",function(){return we.b}),n.d(t,"_cleanGuid",function(){return we.e}),n.d(t,"getKnowledgeHubUrl",function(){return we.a}),n.d(t,"getKnowledgeHubUrlWithOverrides",function(){return we.i}),n.d(t,"isSameTopic",function(){return we.d}),n.d(t,"isSuggestedEntity",function(){return we.l}),n.d(t,"openTopicErrorPage",function(){return we.m}),n.d(t,"isValidCurationDetails",function(){return we.f}),n.d(t,"canUserCreateTopic",function(){return we.t}),n.d(t,"isCurrentUserInSuggested",function(){return we.s}),n.d(t,"isCurrentUser",function(){return we.o}),n.d(t,"isCurrentUserLegacy",function(){return we.c}),n.d(t,"loadIsEAPUser",function(){return we.p}),n.d(t,"getDefaultPageUrlWithSource",function(){return we.n}),n.d(t,"getTopicPageLanguage",function(){return we.r}),n.d(t,"pickContentCultureFromLanguages",function(){return we._}),n.d(t,"isTopicSuggested",function(){return we.u}),n.d(t,"useUpdateRequiredFields",function(){return Ze}),n.d(t,"useTypeName",function(){return $e}),n.d(t,"RestApiError",function(){return g.e}),n.d(t,"TopicIndexedDBHelper",function(){return U}),n.d(t,"logEngagementWithTopicsSDK",function(){return he}),n.d(t,"EngagementLogger",function(){return be}),n.d(t,"TopicPageEngagementLogger",function(){return ge}),n.d(t,"logEventWithTopicsSDK",function(){return _e});var a=n("17wl"),i=n("ut3N"),r=n("UWqr"),o=n("X+PM"),s=n("vlQI");function c(){return r._SPKillSwitch.isActivated("03fe1e3a-35a4-4d30-9d7d-eba1b4537dbb")}var d="lastCortexDisableFlagLogged";function l(){return 1===r._SPExperiment.getVariantAndLogExposure(90059)||r._SPFlight.isEnabled(60083)}function u(){return r._SPFlight.isEnabled(60574)}var f,p=n("hiL/"),m=n("w4+A"),_=n("+ORw"),h=n("oUEy"),b=function(){function e(e,t){var n=this;r.Environment.type!==r.EnvironmentType.Local&&(this._pageContext=t,e.whenFinished(function(){n._tokenProvider=e.consume(s.OAuthTokenProvider.serviceKey)}))}return e.prototype.getOAuthToken=function(e){var t=new i._QosMonitor("".concat(h.a,".STITokenFetch.getOAuthToken"));return this._tokenProvider.getOAuthToken(e,this._pageContext.web.serverRelativeUrl,"STI").then(function(e){return t.writeSuccess(),e.token}).catch(function(e){return t.writeUnexpectedFailure("FailedToGetOAuthToken",e),Promise.reject(e)})},e}(),g=n("NDxI"),v=function(e){function t(n){var a=e.call(this,n)||this;return a._isExpected=!1,a.__proto__=t.prototype,a.errorType="AadTokenError",a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isExpected",{get:function(){return this._isExpected||!1},set:function(e){this._isExpected=e},enumerable:!1,configurable:!0}),t}(Error);!function(e){e.Deserialization="DeserializationError",e.Offline="Offline",e.TokenFetch="TokenFetchError",e.CortexDisabled="CortexDisabled",e.GroupMembershipNotAvailable="GroupMembershipNotAvailable",e.GuestUserNotSupported="GuestUserNotSupported"}(f||(f={}));var y={Cancelled:["cancelled","geannuleerd","キャンセルしました","cancelado","отменено","已取消","annullato","annulé"]},S=function(){function e(){}return e.processSubstrateHttpResponse=function(e,t,n,a,o,s,l){var u=this;if(r.Validate.isNotNullOrUndefined(e,"response"),r.Validate.isNotNullOrUndefined(t,"requestId"),r.Validate.isNotNullOrUndefined(n,"qosMonitorAPI"),r.Validate.isNotNullOrUndefined(a,"qosMonitorTotal"),r.Validate.isNotNullOrUndefined(o,"useSetCortexDisabledFlag"),o&&function(e){if((r._SPKillSwitch.isActivated("fa29b3db-0910-4ee3-8f75-cd116fabcc43")||"true"!==window.sessionStorage.getItem("isRunCortexTAB"))&&403===(null==e?void 0:e.status)){var t=new Date((new Date).getTime()+36e5);if(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.setItem){sessionStorage.setItem("cortexDisableFlag",t.toISOString());var n="CSIKM.CortexEnabledFlag.Set.True";c()?i._EngagementLogger.logEvent(n):(a=n,void 0===o&&(o=!0),(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.getItem)&&(null!==(s=sessionStorage.getItem(d))&&void 0!==s?s:"")!==a&&(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.setItem)&&(o&&i._EngagementLogger.logEvent(a),sessionStorage.setItem(d,a))),!c()&&(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.removeItem)&&sessionStorage.removeItem(d)}}var a,o,s}(e),e.headers&&(t.value=e.headers.get("request-id"),s.requestId=t.value),s.status=e.status,!e.ok){var p="Substrate Cortex API server failure: $tag::".concat(e.status,"::").concat(e.statusText);return 403===e.status?this._processSubstrateHttpResponseFailure(p,e,!0,n,a,f.CortexDisabled,s,l):this._getInnerErrorFromResponse(e).then(function(t){var i=!Object(_.u)()&&u._isKServingError(t)?null==t?void 0:t.error.message:null==t?void 0:t.Message,r=!Object(_.u)()&&u._isKServingError(t)?null==t?void 0:t.error.code:null==t?void 0:t.ErrorCode;return 400===e.status&&/Guest user is not supported/i.test(i)?u._processSubstrateHttpResponseFailure(p,e,!0,n,a,f.GuestUserNotSupported,s,l):(p+=t?", ErrorCode:".concat(r,", ErrorMessage:").concat(i):", ErrorMessage: Failed to retrieve",u._processSubstrateHttpResponseFailure(p,e,!1,n,a,u._getFormattedHttpStatus(e.status),s,l))})}try{return n.writeSuccess(s),a.writeSuccess(s),e.json()}catch(i){var m=i;return this._processSubstrateHttpResponseFailure("Substrate Cortex API deserialization failure: $tag::[RequestId: ".concat(t.value,", Name:").concat(m.name,", message:").concat(m.message,", stack:").concat(m.stack),e,!1,n,a,f.Deserialization,s,l)}},e.handleSubstrateAPIException=function(e,t,n,a,i,o){if(r.Validate.isNotNullOrUndefined(e,"error"),e instanceof g.e)throw e;var s=void 0;if(t)window.navigator.onLine?(s=void 0===e.status?new Error("Substrate Cortex API failure: $tag::[Name:".concat(e.name,", message:").concat(e.name,", stack:").concat(e.stack)):e,null==a||a.writeUnexpectedFailure(e.message,s,o),null==i||i.writeUnexpectedFailure(e.message,s,o)):(s=new Error("Substrate Cortex API failure Offline: $tag::[Name:".concat(e.name,", message:").concat(e.message,", stack:").concat(e.stack)),null==a||a.writeExpectedFailure(f.Offline,s,o),null==i||i.writeExpectedFailure(f.Offline,s,o));else{var c="Substrate Cortex token failure: $tag::[Name:".concat(e.name,", message:").concat(e.message,", stack:").concat(e.stack,", aadTokenFetchSucceeded:").concat(t);s=new v(c),window.navigator.onLine?null==n||n.writeUnexpectedFailure(e.message,s):(null==n||n.writeExpectedFailure(f.Offline,s),Object(_.a)()||(s.isExpected=!0)),null==a||a.writeExpectedFailure(f.TokenFetch,s,o),null==i||i.writeExpectedFailure(f.TokenFetch,s,o)}throw s},e._processSubstrateHttpResponseFailure=function(e,t,n,a,i,r,o,s){var c=new g.e(e,t.status,r,n);return s&&(s.restApiError=c),n?(a.writeExpectedFailure(r,c,o),i.writeExpectedFailure(r,c,o)):(a.writeUnexpectedFailure(r,c,o),i.writeUnexpectedFailure(r,c,o)),Promise.reject(c)},e._getFormattedHttpStatus=function(e){return"HTTP ".concat(e.toString())},e._isKServingError=function(e){return"error"in e},e._getInnerErrorFromResponse=function(e){return e.json().then(function(e){return e}).catch(function(){return Promise.resolve(void 0)})},e}(),D=n("y88i"),I="https://substrate.office.com",x="KS",C=function(){function e(e,t,n){void 0===t&&(t=!0);var a=this;this._requestId={value:""},this._language=void 0,this._handleHttpResponse=function(e){return S.processSubstrateHttpResponse(e,a._requestId,a._qosMonitorAPI,a._qosMonitorTotal,a._useSetCortexDisabledFlag,a._extraData).catch(function(e){return S.handleSubstrateAPIException(e,a._aadTokenFetchSucceeded,a._qosMonitorAADTokenFetch,a._qosMonitorAPI,a._qosMonitorTotal,a._extraData)})},this._serviceScope=e,this._useSetCortexDisabledFlag=t,this._extraData={},e.whenFinished(function(){a._pageContext=e.consume(o.PageContext.serviceKey),a._tokenDataProvider=new b(a._serviceScope,a._pageContext)}),this._isIndexedDBEnabled=l(),this._scenario=n}return Object.defineProperty(e.prototype,"_kServingEndpoint",{get:function(){return"".concat(I,"/").concat("KnowledgeGraph/api/v1.0","/").concat(this.apiName).concat(this.apiParams)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_dweEndpoint",{get:function(){return"".concat(I,"/").concat("DWEngineV2/api/v1.0/KnowledgeManagement","/").concat(this.dweApiName||this.apiName).concat(this.apiParams)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_kservingAuthTokenEndpoint",{get:function(){return I},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_substrateEndpoint",{get:function(){return this.isUseKServiceEndPointEnabled?this._kServingEndpoint:this._dweEndpoint},enumerable:!1,configurable:!0}),e.getRoutingKMAPIKey=function(e){var t=new i._QosMonitor("".concat(h.a,".getRoutingKMAPIKey"));if(!Object(_.v)()){if(e.aadInfo&&e.aadInfo.userId&&e.aadInfo.tenantId)return t.writeSuccess(),"OID:".concat(e.aadInfo.userId,"@").concat(e.aadInfo.tenantId);t.writeUnexpectedFailure("PageContext AadInfo is missing")}return"SMTP:".concat(e.user.email)},Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUseKServiceEndPointEnabled",{get:function(){return u()&&(Object(_.i)()||this.isKServingEndPointReady)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isKServingEndPointReady",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldShadowCallKServingAPI",{get:function(){return!u()&&r._SPFlight.isEnabled(60808)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fetchRetryOptions",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPost",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiName",{get:function(){return"Topics"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dweApiName",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.getCustomRequestOptions=function(e){},Object.defineProperty(e.prototype,"xScenario",{get:function(){return this._scenario},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"qosTag",{get:function(){throw new Error("Needs to be overridden by the derived class")},enumerable:!1,configurable:!0}),e.prototype.getRequest=function(e,t,n,a,o){var s=this;void 0===e&&(e=""),void 0===n&&(n=!1),void 0===a&&(a=!1);var c="".concat(h.a,".AADTokenFetch"),d="".concat(h.a,".").concat(this.qosTag,".").concat(n?"Init":"API",".").concat(h.n),l="".concat(h.a,".").concat(this.qosTag,".").concat(h.n),u=this.shouldShadowCallKServingAPI?null!=o?o:r.Guid.newGuid().toString():void 0;this._qosMonitorAADTokenFetch=new i._QosMonitor(c),this._qosMonitorTotal=new i._QosMonitor(l),this._aadTokenFetchSucceeded=!1,this._qosMonitorKServingAADTokenFetch=new i._QosMonitor("".concat(c,".").concat(x)),this._qosMonitorKServingTotal=new i._QosMonitor("".concat(l,".").concat(x)),this._kServingAADTokenFetchSucceeded=!1,i._EngagementLogger.logEvent(l);var f=function(){s._aadTokenFetchSucceeded=!0,s._qosMonitorAADTokenFetch.writeSuccess(),s._qosMonitorAPI=new i._QosMonitor(d)},p=function(){s._kServingAADTokenFetchSucceeded=!0,s._qosMonitorKServingAADTokenFetch.writeSuccess(),s._qosMonitorKServingAPI=new i._QosMonitor("".concat(d,".").concat(x))};if(this._isIndexedDBEnabled&&t)return a?this._makeClientCachableRequest(this._kServingEndpoint,this._kservingAuthTokenEndpoint,e,p,t,u):this._makeClientCachableRequest(this._substrateEndpoint,this._getOAuthTokenEndPoint(),e,f,t,u);var m=this._makeRequest(this._substrateEndpoint,this._getOAuthTokenEndPoint(),e,f,u);return this.shouldShadowCallKServingAPI&&(m=this._requestAndLogShadowCallKServing({apiCustomParams:e,postKSTokenFetchUpdates:p,requestId:u,responsePromise:m})),m.then(this._handleHttpResponse)},Object.defineProperty(e.prototype,"correlationId",{get:function(){return this._requestId.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiParams",{get:function(){return Object(m.f)()&&this.isPost?"":"?provider=Yggdrasil"},enumerable:!1,configurable:!0}),e.prototype.getSubstrateCachableResponseProperties=function(e,t,n,a,i,r,o,s,c,d,l){return void 0===o&&(o=this._qosMonitorAPI),void 0===s&&(s=this._qosMonitorTotal),void 0===c&&(c=this._useSetCortexDisabledFlag),void 0===d&&(d=this._aadTokenFetchSucceeded),void 0===l&&(l=this._qosMonitorAADTokenFetch),{response:e,isRawData:t,isCachedDataEmpty:n,processRawData:a,dpQosMonitor:o,qosTagPrefix:i,uniquePageId:r,requestId:this._requestId,qosMonitorTotal:s,useSetCortexDisabledFlag:c,aadTokenFetchSucceeded:d,qosMonitorAADTokenFetch:l,extraQoSData:this._extraData}},e.prototype._getAPI=function(e,t,n,a,i,r){var o=this,c=function(){return o.isPost?t.post(e+n,s.AadHttpClient.configurations.v1,o._getRequestOptions(a,r)):t.get(e+n,s.AadHttpClient.configurations.v1,o._getRequestOptions(a,r))};return i?function(e,t){var n=Object(D.Retry)({callback:e,retries:t.retries,delay:t.retryDelay,canRetry:function(e){return t.logError(e),t.shouldRetryOnError(e)}});return n.then(function(e){t.logResponse(e),t.logFinal("RESOLVED")},function(e){t.logError(e),t.logFinal("CAUGHT")}),n}(c,i):c()},Object.defineProperty(e.prototype,"_shouldRetryAPIFailures",{get:function(){return!!this.fetchRetryOptions},enumerable:!1,configurable:!0}),e.prototype._requestAndLogShadowCallKServing=function(e){var t=this,n=e.apiCustomParams,r=e.requestId,o=e.responsePromise,c=e.postKSTokenFetchUpdates,d=new i._QosMonitor("".concat(h.a,".").concat(this.qosTag,".StatusCode.Consistency"));return new Promise(function(e,i){var l,u,f,p=!1,m=!1,_=t._makeRequest(t._kServingEndpoint,t._kservingAuthTokenEndpoint,n,c,r);new Promise(function(e){return setTimeout(e,6e4)}).then(function(){var e,t;if(!p||!m){var n=new Error("Failed to settle both requests in 1 minutes");d.writeUnexpectedFailure("Timeout",n,{isDWEReturned:p,isKServingReturned:m,dweResult:l,kServingResult:u,dweStatus:l instanceof s.HttpClientResponse?l.status:"",kServingStatus:u instanceof s.HttpClientResponse?u.status:"",clientRequestId:r,dweRequestId:l instanceof s.HttpClientResponse?null===(e=l.headers)||void 0===e?void 0:e.get("request-id"):"",kServingRequestId:u instanceof s.HttpClientResponse?null===(t=u.headers)||void 0===t?void 0:t.get("request-id"):""})}}),(f=[o.then(function(t){return p=!0,l=t,e(t),t},function(e){return p=!0,i(e),e}),_.then(function(e){return m=!0,u=e,S.processSubstrateHttpResponse(e,t._requestId,t._qosMonitorKServingAPI,t._qosMonitorKServingTotal,!t.shouldShadowCallKServingAPI&&t._useSetCortexDisabledFlag,t._extraData).catch(function(e){S.handleSubstrateAPIException(e,t._kServingAADTokenFetchSucceeded,t._qosMonitorKServingAADTokenFetch,t._qosMonitorKServingAPI,t._qosMonitorKServingTotal,t._extraData)}),e},function(e){return m=!0,e})],Promise.all(f.map(function(e){return Promise.resolve().then(function(){return e}).then(function(e){return{value:e,status:"fulfilled"}}).catch(function(e){return{reason:e,status:"rejected"}})}))).then(function(e){var t,n,i,o,c,f,_;t=Object(a.__read)(function(e){return e.map(function(e){return"fulfilled"===e.status?e.value:e.reason})}(e),2),l=t[0],u=t[1],l instanceof s.HttpClientResponse&&u instanceof s.HttpClientResponse?l.status!==u.status?d.writeUnexpectedFailure("InconsistentStatusCode",new Error("Different Status Code"),{isDWEReturned:p,isKServingReturned:m,dweStatus:l.status,kServingStatus:u.status,clientRequestId:r,dweRequestId:null===(o=l.headers)||void 0===o?void 0:o.get("request-id"),kServingRequestId:null===(c=l.headers)||void 0===c?void 0:c.get("request-id")}):d.writeSuccess({isDWEReturned:p,isKServingReturned:m,statusCode:u.status,clientRequestId:r,dweRequestId:null===(f=l.headers)||void 0===f?void 0:f.get("request-id"),kServingRequestId:null===(_=l.headers)||void 0===_?void 0:_.get("request-id")}):d.writeUnexpectedFailure("FailedToResolveBothRequests",new Error("At least one of requests are rejected"),{isDWEReturned:p,isKServingReturned:m,dweResult:l,kServingResult:u,clientRequestId:r,dweStatus:l instanceof s.HttpClientResponse?l.status:l.message,kServingStatus:u instanceof s.HttpClientResponse?u.status:u.message,dweRequestId:l instanceof s.HttpClientResponse?null===(n=l.headers)||void 0===n?void 0:n.get("request-id"):"",kServingRequestId:u instanceof s.HttpClientResponse?null===(i=u.headers)||void 0===i?void 0:i.get("request-id"):""})})})},e.prototype._getAPIRetryOptions=function(){var e=this,t=[],n=0,r=0,o=void 0;this._apiRetryQosMonitor=new i._QosMonitor("".concat(h.a,".").concat(this.qosTag,".Retry")),n=performance.now();var s,c,d,l,u=function(){return{sr:t.length+1,clientReqId:e._extraData.clientRequestId,duration:(a=performance.now(),i=(a-n).toFixed(1),n=a,+i)};var a,i};return Object(a.__assign)(Object(a.__assign)({},{retries:void 0===(c=(s=this.fetchRetryOptions).retries)?1:c,retryDelay:void 0===(d=s.retryDelay)?500:d,shouldRetryOnError:void 0===(l=s.shouldRetryOnError)?function(){return!0}:l}),{logResponse:function(e){var n=u();n.httpStatus=e.status,t.push(n),r=e.status},logError:function(e){var n=u();n.error=e.toString(),n.onLine=navigator.onLine,t.push(n),o=e},logFinal:function(n){e._extraData.FinalStatus=n,e._extraData.AttemptsInfo=JSON.stringify(t),e._extraData.TotalRetryAttempts=t.length-1,t.length>1&&("RESOLVED"===n?e._apiRetryQosMonitor.writeExpectedFailure("HTTP ".concat(r.toString()," ").concat(t.length-1),void 0,e._extraData):e._apiRetryQosMonitor.writeUnexpectedFailure("".concat(o.message," ").concat(t.length-1),o,e._extraData))}})},e.prototype._getRequestOptions=function(t,n){var a;a=(new Date).getTime();var i={},o=null!=n?n:r.Guid.newGuid().toString(),s=e.getRoutingKMAPIKey(this.pageContext);return i.headers={},i.headers["Content-Type"]="application/json",i.headers["X-AnchorMailbox"]=s,i.headers["X-RoutingParameter-SessionKey"]=s,i.headers["Client-Request-Id"]=o,i.headers["request-id"]=o,this._enableTestFeedback()&&(i.headers[h.r]="true"),t&&(i.headers.Authorization="Bearer ".concat(t)),this.xScenario&&(i.headers["X-Scenario"]=this.xScenario),this._language&&!p.Multilingual.isTopicMultilingualKSActivated()&&(i.headers["X-Accept-Language"]=this._language),this.getCustomRequestOptions(i),this._extraData.clientRequestId=o,this._extraData.getRequestOptionsTime="".concat((new Date).getTime()-a," ms"),Object(_.b)()||(this._extraData.culture=this._language,this._extraData.scenario=this.xScenario),i},e.prototype._makeRequest=function(e,t,n,a,i){var r=this;return this._tokenDataProvider.getOAuthToken(t).then(function(t){a();var o=r._serviceScope.consume(s.HttpClient.serviceKey);return r._getAPI(e,o,n,t,r._shouldRetryAPIFailures?r._getAPIRetryOptions():void 0,i)})},e.prototype._makeClientCachableRequest=function(e,t,n,a,i,r){var o=this;return this._tokenDataProvider.getOAuthToken(t).then(function(t){a();var c=o._serviceScope.consume(s.HttpClient.serviceKey),d=o._executeRequestWithCacheOptions(e,c,n,i,t,r);return o._shouldRetryAPIFailures?o._wrapPromiseForRetry(e,d,c,n,t,r):d})},e.prototype._getOAuthTokenEndPoint=function(){return this.isUseKServiceEndPointEnabled?this._kservingAuthTokenEndpoint:"https://outlook.office365.com/dwengine"},e.prototype._wrapPromiseForRetry=function(e,t,n,a,i,r){var o=this,s=this._getAPIRetryOptions();return s.retries--,t.then(function(t){var c;return{cachedResponse:t.cachedResponse,serverResponse:null===(c=t.serverResponse)||void 0===c?void 0:c.then(function(e){return s.logResponse(e),s.logFinal("RESOLVED"),e}).catch(function(t){if(s.logError(t),s.retries>=0&&s.shouldRetryOnError(t))return o._getAPI(e,n,a,i,s,r);throw s.logFinal("CAUGHT"),t})}})},e.prototype._executeRequestWithCacheOptions=function(e,t,n,a,i,r){if(this.isPost){var o=this._getRequestOptions(i,r);return o.method="POST",t.fetch(e+n,s.HttpClient.configurations.v1,o,a)}return t.get(e+n,s.HttpClient.configurations.v1,this._getRequestOptions(i,r),a)},e.prototype._enableTestFeedback=function(){var e,t=new URL(window.location.href).searchParams;return 0===window.location.href.toLowerCase().indexOf(h.i)||0===window.location.href.toLowerCase().indexOf(h.o)&&"true"===(null===(e=t.get(h.e))||void 0===e?void 0:e.toLocaleLowerCase().trim())},e}(),O=n("rMgv"),w=function(e){function t(t,n){var a=e.call(this,t,!1)||this;return a._requestType=n,a}return Object(a.__extends)(t,e),t.prototype.getTopics=function(e,t,n,a,i){var o=this;return r.Validate.isNotNullOrUndefined(e,"count"),this._count=e,this._skipToken=t,this._name=n,this._orderBy=a,this._orderByDesc=i,this.getRequest("").then(function(e){var t;return e.correlationId=null!==(t=o.correlationId)&&void 0!==t?t:"",e}).catch(function(e){return Promise.reject(e)})},Object.defineProperty(t.prototype,"apiName",{get:function(){return"Topics/Managed"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosTag",{get:function(){return this._requestType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldShadowCallKServingAPI",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xScenario",{get:function(){return"Confirmed"===this._requestType?"SPPages.TopicManagement.Confirmed":"Suggested"===this._requestType||"Unconfirmed"===this._requestType?"SPPages.TopicManagement.Suggested":"Removed"===this._requestType||"Excluded"===this._requestType?"SPPages.TopicManagement.Removed":"Published"===this._requestType?"SPPages.TopicManagement.Published":"UserSuggested"===this._requestType?"SPPages.TopicManagement.UserSuggested":void 0},enumerable:!1,configurable:!0}),t.prototype.getCustomRequestOptions=function(e){e.headers["X-ODataQuery"]="true",e.headers.accept="application/json",Object(m.m)()&&(e.headers["X-Debug-EnableVivaTopicsCenterV3"]="true",e.headers["X-Debug-SortedTopicsRequestCount"]=200);var t={Size:this._count,ManagedTopicState:this._requestType};this._skipToken&&(t.From=this._skipToken),this._name&&(t.TopicNameStartsWith=this._name),this._orderBy&&(t.Sort={Field:this._orderBy,Direction:this._orderByDesc?O.h.descending:O.h.ascending}),e.body=JSON.stringify(t)},t}(C),E=function(e){function t(t){return e.call(this,t,!1)||this}return Object(a.__extends)(t,e),t.prototype.getTopics=function(e){var t=e.Size;return r.Validate.isNotNullOrUndefined(t,"count"),this._queryOptions=e,this.getRequest()},Object.defineProperty(t.prototype,"dweApiName",{get:function(){return"Topics/TopicCenter"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Topics/Managed"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiParams",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"ManageTopics"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isKServingEndPointReady",{get:function(){return Object(m.d)()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xScenario",{get:function(){var e=this._queryOptions.Filters.LifeCycleStates;return e.length>0&&"Removed"===e[0]?"SPPages.TopicManagementV3.RemovedTopics":"SPPages.TopicManagementV3.ActiveTopics"},enumerable:!1,configurable:!0}),t.prototype.getCustomRequestOptions=function(e){e.headers["X-ODataQuery"]="true",e.headers["X-Debug-EnableVivaTopicsCenterV3"]="true",e.headers.accept="application/json",Object(m.o)()&&(e.headers["X-Debug-EnablePostACLScore"]="true"),Object(m.s)()&&(e.headers["X-Debug-EnablePreACLScore"]="true"),e.headers["X-Debug-ServerSidePaginationEnabledHeader"]="true",e.body=JSON.stringify(this._queryOptions)},t}(C),A=function(e){function t(t,n){var a=this;return r.Validate.isNotNullOrUndefined(t,"serviceScope"),r.Validate.isNotNullOrUndefined(n,"feedbackType"),(a=e.call(this,t,!1)||this)._topics=[],a._feedbackType=n,a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Topics/".concat(this._feedbackType)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosTag",{get:function(){return this._feedbackType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xScenario",{get:function(){return"SPPages.TopicManagement.Manage"},enumerable:!1,configurable:!0}),t.prototype.provideFeedback=function(e){return r.Validate.isNotNullOrUndefined(e,"topics"),this._topics=e.map(function(e){return{Id:e.Id,Name:e.Name}}),this.getRequest()},t.prototype.getCustomRequestOptions=function(e){e.body=JSON.stringify({Topics:this._topics})},t}(C),L=function(e){function t(t){var n=this;return r.Validate.isNotNullOrUndefined(t,"serviceScope"),(n=e.call(this,t,!1)||this)._topics=[],n}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Topics/".concat(this._feedbackType)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"ManageTopics.".concat(this._feedbackType)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xScenario",{get:function(){return"Confirm"===this._feedbackType?"SPPages.TopicManagement.Confirmed":"Exclude"===this._feedbackType?"SPPages.TopicManagement.Removed":void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldShadowCallKServingAPI",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isKServingEndPointReady",{get:function(){return!Object(_.s)()},enumerable:!1,configurable:!0}),t.prototype.provideFeedback=function(e,t){return r.Validate.isNotNullOrUndefined(e,"topics"),r.Validate.isNotNullOrUndefined(t,"feedbackType"),this._feedbackType=t,this._topics=e.map(function(e){return{Id:e.Id,Name:e.Name}}),this.getRequest()},t.prototype.getCustomRequestOptions=function(e){e.body=JSON.stringify({Topics:this._topics})},t}(C),k=n("WZz6"),M=n("Pk8u"),P=n("QZHX"),T="CortexInvalidIDBPages",U=function(){function e(){}return e.parseClientCachableResponse=function(e){var t=this;r.Validate.isNotNullOrUndefined(e,"properties");var n=e.response,a=e.isRawData,o=e.isCachedDataEmpty,s=e.processRawData,c=e.dpQosMonitor,d=e.qosTagPrefix,l=e.uniquePageId;if(this._lastError=void 0,this._lastRestApiError={restApiError:void 0},!n.cachedResponse&&!n.serverResponse){var u=new Error("InvalidClientCachableResponse");throw c.writeUnexpectedFailure(u.message),u}var f,m=l&&this._isIdInvalidForCacheUsage(l),_=function(e){if(t._lastRestApiError.restApiError)throw t._lastRestApiError.restApiError;throw t._lastError=e,e};if((!n.cachedResponse||m)&&n.serverResponse)return n.serverResponse.then(function(n){return m&&t._clearIdFromInvalidCacheUsage(l),t._processHttpResponse(n,e)}).catch(_);var h=new i._QosMonitor("".concat(d,".IndexedDB.CacheOnly.DP")),b=P.TieredCacheHelper.processResponseRawData(n.cachedResponse,a,s.bind(this)).then(function(e){return f=JSON.stringify(e),h.writeSuccess(),o(e)?Promise.reject("IndexedDB cached data exists but is empty"):e}).catch(function(e){return"IndexedDB cached data does not exist or is expired"===e.message?h.writeExpectedFailure(void 0,e):h.writeUnexpectedFailure(void 0,e),Promise.reject(e.message)});if(!n.serverResponse)return b;var g=!1,v=n.serverResponse.then(function(n){if(g=!0,f)try{t._logCacheRefreshedQos(f,n,s.bind(t),d)}catch(e){}return t._processHttpResponse(n,e)}).catch(_),y=r.Guid.parse("fdbcc3e7-1aa1-4bc5-809c-fd4b4cf3ce56"),S=r.Guid.parse("ae67b80b-7315-447c-94bc-8d51c712bfb8"),D=[{raceablePromise:b,raceId:y},{raceablePromise:v,raceId:S}];return p.SmartRace.race(D).then(function(n){return n.raceId!==y||g||v.then(function(e){return e}).catch(function(n){t._logApiException(n,e)}),g?v:b}).catch(function(e){throw t._lastRestApiError.restApiError?t._lastRestApiError.restApiError:t._lastError?t._lastError:e})},e.getUniquePageId=function(e,t,n){return(null==e?void 0:e.toString().length)&&(null==t?void 0:t.toString().length)&&(null==n?void 0:n.toString().length)?{siteId:e.toString(),webId:t.toString(),uniqueId:n.toString()}:void 0},e.setInvalidForCacheUsage=function(e){var t;r.Validate.isNotNullOrUndefined(e.uniqueId,"uniquePageId.uniqueId"),r.Validate.isNotNullOrUndefined(e.siteId,"uniquePageId.siteId"),r.Validate.isNotNullOrUndefined(e.webId,"uniquePageId.webId");var n=null!==(t=this._getInvalidIdsFromStorage())&&void 0!==t?t:[];this._getIndexOf(e,n)===this._indexNotPresent&&(n.push(e),sessionStorage.setItem(T,JSON.stringify(n)))},e._clearIdFromInvalidCacheUsage=function(e){var t=this._getInvalidIdsFromStorage();if(t){var n=this._getIndexOf(e,t);n!==this._indexNotPresent&&(1===t.length?sessionStorage.removeItem(T):(t.splice(n,1),sessionStorage.setItem(T,JSON.stringify(t))))}},e._isIdInvalidForCacheUsage=function(e){var t=this._getInvalidIdsFromStorage();return!!t&&this._getIndexOf(e,t)!==this._indexNotPresent},e._getIndexOf=function(e,t){return Object(M.findIndex)(t,function(t){return t.uniqueId===e.uniqueId&&t.siteId===e.siteId&&t.webId===e.webId})},e._getInvalidIdsFromStorage=function(){var e;if(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.getItem){var t=null!==(e=sessionStorage.getItem(T))&&void 0!==e?e:"";return t?JSON.parse(t):void 0}},e._logCacheRefreshedQos=function(e,t,n,a){var r=this;t.clone&&200===t.status&&t.clone().json().then(function(t){var o,s=n(t);o=r._compareResponseData(e,JSON.stringify(s))?"RefreshedNoChanges.DP":"Refreshed.DP",new i._QosMonitor("".concat(a,".IndexedDB.").concat(o)).writeSuccess()}).catch(function(e){return Promise.reject(e)})},e._compareResponseData=function(e,t){return!!(null==e?void 0:e.length)&&e===t},e._processHttpResponse=function(e,t){return S.processSubstrateHttpResponse(e,t.requestId,t.dpQosMonitor,t.qosMonitorTotal,t.useSetCortexDisabledFlag,t.extraQoSData,this._lastRestApiError)},e._logApiException=function(e,t){try{S.handleSubstrateAPIException(e,t.aadTokenFetchSucceeded,t.qosMonitorAADTokenFetch,t.dpQosMonitor,t.qosMonitorTotal,t.extraQoSData)}catch(e){}},e.onlyIndexedDB=P.TieredCacheHelper.onlyIndexedDB,e.cacheKeyOverride=P.TieredCacheHelper.cacheKeyOverride,e._indexNotPresent=-1,e}(),F=function(e){function t(n,a){var i=e.call(this,n,void 0,a)||this;return i._warmUpQueryRun=!1,i._zeroTermSuggestionsResult=[],i._processRawData=function(e){if(e.value)return e},(p.Multilingual.isTopicMultilingualEapFlightEnabled()&&Object(k.isCortexEapUser)(i.pageContext.legacyPageContext)||p.Multilingual.isTopicMultilingualFlightEnabled())&&(i._language=i.pageContext.cultureInfo.currentUICultureName),i._shouldWarmUpSuggestionsApi()&&(t._lastInitQueryTime=(new Date).getTime(),i._warmUpSuggestionsApi()),i}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"GetTopicSuggestion"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPost",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getTopicSuggestion=function(e,t,n){var a,i=this;if(0===e.length&&(null===(a=this._lastQuerySuggestionsResult)||void 0===a?void 0:a.length)>0)return Object(m.h)()?Promise.resolve(this._zeroTermSuggestionsResult):Promise.resolve(this._lastQuerySuggestionsResult);0===e.length&&(e=Object(m.h)()?"":"a");var o="&prefix=".concat(encodeURIComponent(e),"&topicCount=").concat(t);if(this._isIndexedDBEnabled&&n&&!this._warmUpQueryRun){var s=void 0;return this.shouldShadowCallKServingAPI&&(s=r.Guid.newGuid().toString(),this._getKServingCachableRequest(o,n,s)),this._getCachableRequest(o,n,s)}return this.getRequest(o,void 0,this._warmUpQueryRun).then(function(e){return i._lastQuerySuggestionsResult=e.value,Promise.resolve(i._lastQuerySuggestionsResult)})},t.prototype._getKServingCachableRequest=function(e,t,n){var a=this;return this.getRequest(e,t,!1,!0,n).then(function(e){var t=a.getSubstrateCachableResponseProperties(e,a._isRawData,a._isCachedDataEmpty,a._processRawData,"".concat(h.a,".").concat(a.qosTag,".API.KS"),void 0,a._qosMonitorKServingAPI,a._qosMonitorKServingTotal,!1,a._kServingAADTokenFetchSucceeded,a._qosMonitorKServingAADTokenFetch);return U.parseClientCachableResponse(t).then(function(e){return e.value})}).catch(function(e){throw S.handleSubstrateAPIException(e,a._kServingAADTokenFetchSucceeded,a._qosMonitorKServingAADTokenFetch,a._qosMonitorKServingAPI,a._qosMonitorKServingTotal,a._extraData)})},t.prototype._getCachableRequest=function(e,t,n){var a=this;return this.getRequest(e,t,!1,!1,n).then(function(e){var t=a.getSubstrateCachableResponseProperties(e,a._isRawData,a._isCachedDataEmpty,a._processRawData,"".concat(h.a,".").concat(a.qosTag,".API"));return U.parseClientCachableResponse(t).then(function(e){return e.value})}).catch(function(e){throw S.handleSubstrateAPIException(e,a._aadTokenFetchSucceeded,a._qosMonitorAADTokenFetch,a._qosMonitorAPI,a._qosMonitorTotal,a._extraData)})},t.prototype._warmUpSuggestionsApi=function(){var e=this;if(this._isPageInEditMode&&!this._warmUpQueryRun){this._warmUpQueryRun=!0;var t=Object(m.h)()?"":"a",n=r._SPFlight.isEnabled(663)?10:5;this.getTopicSuggestion(t,n).then(function(t){Object(m.h)()&&(e._zeroTermSuggestionsResult=t)}),this._warmUpQueryRun=!1}},t.prototype._shouldWarmUpSuggestionsApi=function(){var e=(new Date).getTime()-t._lastInitQueryTime;return!t._lastInitQueryTime||e>3e5},Object.defineProperty(t.prototype,"_isPageInEditMode",{get:function(){return-1!==new URLSearchParams(window.location.search).toString().indexOf("Mode=Edit")},enumerable:!1,configurable:!0}),t.prototype._isRawData=function(e){return e&&e.value},t.prototype._isCachedDataEmpty=function(e){return 0===e.value.length},t}(C),H=n("hrbp"),R=n("j84u"),N=n("mAUd"),B=function(e){function t(t,n,a){void 0===a&&(a="SPPages.TopicCard.Feedback");var i,o,s,c,d,l,u=this;return r.Validate.isNotNullOrUndefined(t,"serviceScope"),(u=e.call(this,t,void 0,a)||this)._spoId=n,u._currentPageId={SiteId:null!==(o=null===(i=u._spoId.siteId)||void 0===i?void 0:i.toString())&&void 0!==o?o:r.Guid.empty.toString(),WebId:null!==(c=null===(s=u._spoId.webId)||void 0===s?void 0:s.toString())&&void 0!==c?c:r.Guid.empty.toString(),UniqueId:null!==(l=null===(d=u._spoId.uniqueId)||void 0===d?void 0:d.toString())&&void 0!==l?l:r.Guid.empty.toString()},u}return Object(a.__extends)(t,e),t.prototype.processFeedback=function(e,t){return r.Validate.isNotNullOrUndefined(e,"topicEntity"),r.Validate.isNotNullOrUndefined(t,"feedbackQuestion"),r.Validate.isNotNullOrUndefined(t.ResponseType,"feedbackQuestion.ResponseType"),this._requestBody=this._buildProcessFeedbackAPIRequestBody(e,t),this.getRequest()},Object.defineProperty(t.prototype,"apiName",{get:function(){return"TopicCardFeedback"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"TopicCardFeedback"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldShadowCallKServingAPI",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getCustomRequestOptions=function(e){e.body=this._requestBody},t.prototype._buildProcessFeedbackAPIRequestBody=function(e,t){var n,a={EntityId:e.Id,Name:e.Name,CurrentPageId:this._currentPageId,QuestionType:t.QuestionType,ResponseType:t.ResponseType};return"Person"===(null===(n=t.RelatedEntity)||void 0===n?void 0:n.Type)&&(a.RelatedPerson=t.RelatedEntity.EntityIdentity),JSON.stringify({Request:a})},t}(C),j=n("aj7r"),V=11;function z(e){return{Id:e.Id,DisplayName:e.DisplayName,isSuggested:"Mined"===e.State}}function G(e){var t;return{DepartmentId:e.DepartmentId,GroupId:e.GroupId,LastModifiedTime:e.LastModifiedTime,Title:e.Title,Url:e.FilePath,Extension:e.Extension,DownloadUrl:e.DownloadUrl,WebviewUrl:e.Url,SiteId:Object(j.e)(e.SiteId),WebId:Object(j.e)(e.WebId),UniqueId:Object(j.e)(e.UniqueId),State:e.State,ViewCount:e.ViewCount,Modifier:e.LastModifier?{Email:e.LastModifier.EmailAddress,Name:e.LastModifier.DisplayName,Upn:e.LastModifier.UserPrincipalName}:void 0,AIReason:{ReasonType:e.AIReason&&e.AIReason.ReasonType?e.AIReason.ReasonType:"",TopicMentionsCount:null===(t=e.AIReason)||void 0===t?void 0:t.TopicMentionsCount},LifecycleState:e.LifeCycle,Languages:e.Languages}}function K(e){var t,n=e.RelatedResourcesMap,a=[];return n.forEach(function(e){"People"===e.Key&&(a=e.Value)}),null!==(t=null==a?void 0:a.map(function(e){return W(e)}))&&void 0!==t?t:[]}function W(e){var t;return{Email:e.EmailAddress,Name:e.DisplayName,Upn:e.UserPrincipalName,OId:e.ObjectId,Description:e.Description,LifecycleState:e.LifeCycle,AIReason:e.AIReason?{Count:e.AIReason.FileContributions?e.AIReason.FileContributions.length:0,DocumentContributedTo:(null===(t=e.AIReason.FileContributions)||void 0===t?void 0:t.length)>0?{Title:e.AIReason.FileContributions[0].Title+(e.AIReason.FileContributions[0].Extension?"."+e.AIReason.FileContributions[0].Extension:""),Url:e.AIReason.FileContributions[0].Url}:{}}:void 0,LastCurator:e.Curator,LastFeedbackModifier:e.LastFeedbackModifier}}function q(e){return Object(a.__assign)(Object(a.__assign)({},e),{SiteId:Object(j.e)(e.SiteId),WebId:Object(j.e)(e.WebId),LifecycleState:e.LifeCycle})}function Q(e){return{Acronym:e.Acronym,Title:e.Title,BannerColor:e.Color,BannerImageUrl:e.LogoUrl,Url:e.Url,Type:"Site",ItemReference:{SiteId:Object(j.e)(e.SiteId),WebId:Object(j.e)(e.WebId),Type:"SiteReference"},EntityState:e.State}}function Y(e){var t,n,a,i,r=e.RelatedResourcesMap,o=e.RemovedRelatedResourcesMap,s=[],c=[],d=[],l=[],u=[],f=[],p=[],m=!1,h=!1,b=!1;r&&r.length>0&&r.forEach(function(e){"People"===e.Key?(s=e.Value,m=e.MoreResultsAvailable):"File"===e.Key?(c=e.Value,h=e.MoreResultsAvailable):"Site"===e.Key?(d=e.Value,b=e.MoreResultsAvailable):"TopicType"===e.Key&&(p=e.Value||[])}),null==o||o.forEach(function(e){"People"===e.Key?l=e.Value:"File"===e.Key?u=e.Value:"Site"===e.Key&&(f=e.Value)});var g=[];return(null===(t=e.Definitions)||void 0===t?void 0:t.length)&&e.Definitions.forEach(function(e){g.push(function(e){var t,n,a=null===(n=null===(t=e.AIReason)||void 0===t?void 0:t.SourceFiles)||void 0===n?void 0:n[0];return{Definition:e.Value,SourceType:"Wikipedia"===(null==a?void 0:a.Source)?"Wikipedia":"Private",State:e.State,LifecycleState:e.LifeCycle,Url:null==a?void 0:a.Url,WacUrl:null==a?void 0:a.Url,SourceDocumentTitle:null==a?void 0:a.Title,SourceDocumentExtension:null==a?void 0:a.Extension,Languages:e.Languages,SourceFile:a}}(e))}),{CurrentLanguage:e.CurrentLanguage,Definitions:g,Definition:e.Definition,DisambiguationContext:null===(n=e.DisambiguationContext)||void 0===n?void 0:n.Value,Id:e.Id,Name:e.DisplayName,State:e.State,Score:e.RelevanceScore,Type:e.TopicType,Types:p.map(z),TopicTypes:p,PrimaryName:J(e.PrimaryName),RelatedDocuments:c.filter(function(e){return Object(_.l)()||"File"===e.Type}).map(G),RelatedPeople:s.map(W),RelatedSites:d.map(q),RemovedRelatedDocuments:u.filter(function(e){return"File"===e.Type}).map(G),RemovedRelatedPeople:l.map(W),RemovedRelatedSites:f.map(q),Url:e.Url,AlternateNames:(null===(a=e.AlternateNames)||void 0===a?void 0:a.map(Z))||[],AtTheMinimumRelatedPeopleCount:m?V:s.length,AtTheMinimumRelatedResourcesCount:h?V:c.length,AtTheMinimumRelatedTopicsCount:b?V:d.length,HasPrimaryType:e.HasPrimaryType,HiddenMinedDocuments:[],HiddenMinedPeople:[],Languages:null===(i=e.Languages)||void 0===i?void 0:i.map(X),LifecycleState:e.LifeCycle,OriginalIds:e.AncestorIds,Source:e.Source}}function J(e){if(!Object(_.S)()&&e)return{Name:e.Name,State:e.State,Languages:e.Languages}}function X(e){return{culture:p.TOPIC_CULTURES[e.Value],url:e.Url}}function Z(e){var t,n;return{Name:e.Name,State:e.State,Languages:Object(_.S)()?void 0:e.Languages||[],AIReason:{ReasonType:null===(t=e.AIReason)||void 0===t?void 0:t.ReasonType,SourceFiles:null===(n=e.AIReason)||void 0===n?void 0:n.SourceFiles.map($)}}}function $(e){return{Extension:e.Extension||"",Source:e.Source,Title:e.Title,Url:e.Url}}function ee(e){var t={EntityDetails:[],PageMatches:[]};if(e.EntityAnnotation){var n=e.EntityAnnotation.SectionMatches;if(n.length){var a=n.map(function(e){return{ComponentId:e.SectionId,Matches:e.EntityMatches.map(function(e){return{Start:e.StartPos,Length:e.Length,HighlightedName:e.HighlightedName,Entities:[{EntityId:e.Entities[0].Id,Score:0}]}})}});t.PageMatches=a;var i=e.EntityAnnotation.EntityDetails;t.EntityDetails=i}}return t}function te(e){var t={value:[]};if(e&&e.length>0){var n=e.map(function(e){var t,n;return{EntityId:e.Id,Name:e.DisplayName,Type:e.Type,Definition:e.Definition,AlternateNames:null!==(n=null===(t=e.AlternateNames)||void 0===t?void 0:t.map(Z))&&void 0!==n?n:[],RelatedPeople:K(e),DisambiguationContext:e.DisambiguationContext}});t.value=n}return t}var ne=function(e){function t(n){var a=e.call(this,n)||this;return a.__proto__=t.prototype,a}return Object(a.__extends)(t,e),t}(Error),ae=function(e){function t(t,n){var a=e.call(this,t)||this;return a._handleResponse=function(e){if(0===e.value.length)throw new ne(O.c);return e.value[0]},a._useMined=n,a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"GetTopicById"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return Object(m.f)()?"Topics/Ids":this._useMined?"Topics/Mined":"Topics"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xScenario",{get:function(){return"SPPages.TopicPage.Read"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPost",{get:function(){return Object(m.f)()},enumerable:!1,configurable:!0}),t.prototype.getTopic=function(e,t,n,a){if(void 0===t&&(t=this._useMined),r.Validate.isNonemptyString(e,"topicId"),Object(p.isRunCortexTAB)()){var i=this._getTABMockMinedData(),o={value:[]};return i&&(o=JSON.parse(i)).value.length>0&&(o.value[0].Id=e),Promise.resolve(o).then(this._handleResponse)}if(this._useMined=t,this._language=a,Object(m.f)())return this._resourceOptions=n,this._topicId=e,this.getRequest().then(this._handleResponse);var s="";return Object(M.isEmpty)(n)||Object(M.each)(n,function(e,t){return s+="&".concat(t.toLowerCase(),"=").concat(e)}),this.getRequest("&id=".concat(e).concat(s)).then(this._handleResponse)},t.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),Object(m.f)()&&(t.body=JSON.stringify({TopicIds:[this._topicId],IsMinedOnly:this._useMined,ResourceOptions:this._resourceOptions}))},t.prototype._getTABMockMinedData=function(){return window.sessionStorage.getItem("MOCK_TOPIC_MINED_RESPONSE")},t}(C),ie=function(e){function t(t,n){return void 0===n&&(n="SPPages.TopicCard.Embedded"),e.call(this,t,void 0,n)||this}return Object(a.__extends)(t,e),t.prototype.fetchTopics=function(e,t){return r.Validate.isNotNullOrUndefined(e,"topicIds"),this._topicIds=e.filter(function(e){return!Object(M.isEmpty)(e.trim())}),this._language=t,0===this._topicIds.length?Promise.resolve([]):this.getRequest().then(function(e){return e.value})},Object.defineProperty(t.prototype,"qosTag",{get:function(){return"GetTopicsByIds"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Topics/Ids"},enumerable:!1,configurable:!0}),t.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),t.body=JSON.stringify({TopicIds:this._topicIds})},t}(C),re=function(e){function t(t,n){var a=e.call(this,t)||this;return a._processRawData=function(e){if(e.EntityAnnotation)return e},a._doNotRetrieveTopicDetails=n,a}return Object(a.__extends)(t,e),t.prototype.getAnnotations=function(e,t,n,a){if(r.Validate.isNotNullOrUndefined(e,"contentArr"),r.Validate.isNotNullOrUndefined(t,"spoId"),this._contentArr=e,this._spoId=t,this._language=a,l()&&n){var i=void 0;return this.shouldShadowCallKServingAPI&&(i=r.Guid.newGuid().toString(),this._getKServingCachableRequest(n,this._spoId,i)),this._getCachableRequest(n,this._spoId,i)}return this.getRequest().then(function(e){return e})},Object.defineProperty(t.prototype,"fetchRetryOptions",{get:function(){return{shouldRetryOnError:function(e){var t;return-1===y.Cancelled.indexOf(null===(t=e.message)||void 0===t?void 0:t.toLowerCase())},retries:1}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Annotation"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosTag",{get:function(){var e="Annotation";return this._doNotRetrieveTopicDetails?"".concat(e,".DoNotRetrieveDetails"):e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xScenario",{get:function(){return"SPPages.TopicAnnotation.SPPage"},enumerable:!1,configurable:!0}),t.prototype.getCustomRequestOptions=function(e){var n,a,i,r,o,s,c=this,d={Provider:"Yggdrasil"};d.TextSections=this._contentArr.map(function(e){return{SectionId:e.id,Text:e.text,RetrieveTopicDetails:!c._doNotRetrieveTopicDetails}}),d.CurrentPageId={SiteId:null!==(a=null===(n=this._spoId.siteId)||void 0===n?void 0:n.toString())&&void 0!==a?a:t._allTopicsPageGuid,WebId:null!==(r=null===(i=this._spoId.webId)||void 0===i?void 0:i.toString())&&void 0!==r?r:t._allTopicsPageGuid,UniqueId:null!==(s=null===(o=this._spoId.uniqueId)||void 0===o?void 0:o.toString())&&void 0!==s?s:t._allTopicsPageGuid},e.body=JSON.stringify({AnnotationRequest:d});var l=new URL(window.location.href).searchParams;e&&e.headers&&("0"===l.get("threshold")&&(e.headers["X-Debug-SkipAnnotationFiltering"]="true"),"true"===l.get("yukonFlight")&&(e.headers["X-Debug-IsYukonHighlightFlightEnabled"]="true"))},t.prototype._isRawData=function(e){return e&&e.EntityAnnotation},t.prototype._isCachedDataEmpty=function(e){return 0===e.EntityAnnotation.EntityDetails.length},t.prototype._getKServingCachableRequest=function(e,t,n){var a=this,i=U.getUniquePageId(t.siteId,t.webId,t.uniqueId);return this.getRequest("",e,!1,!0,n).then(function(e){var t=a.getSubstrateCachableResponseProperties(e,a._isRawData,a._isCachedDataEmpty,a._processRawData,"".concat(h.a,".").concat(a.apiName,".API.KS"),i,a._qosMonitorKServingAPI,a._qosMonitorKServingTotal,!1,a._kServingAADTokenFetchSucceeded,a._qosMonitorKServingAADTokenFetch);return U.parseClientCachableResponse(t)}).catch(function(e){throw S.handleSubstrateAPIException(e,a._kServingAADTokenFetchSucceeded,a._qosMonitorKServingAADTokenFetch,a._qosMonitorKServingAPI,a._qosMonitorKServingTotal,a._extraData)})},t.prototype._getCachableRequest=function(e,t,n){var a=this,i=U.getUniquePageId(t.siteId,t.webId,t.uniqueId);return this.getRequest("",e,!1,!1,n).then(function(e){var t=a.getSubstrateCachableResponseProperties(e,a._isRawData,a._isCachedDataEmpty,a._processRawData,"".concat(h.a,".").concat(a.apiName,".API"),i);return U.parseClientCachableResponse(t)}).catch(function(e){throw S.handleSubstrateAPIException(e,a._aadTokenFetchSucceeded,a._qosMonitorAADTokenFetch,a._qosMonitorAPI,a._qosMonitorTotal,a._extraData)})},t._allTopicsPageGuid="9833225a-d24b-4b9e-b16d-bba52bae6e23",t}(C),oe=function(e){function t(t,n){void 0===n&&(n="SPPages.TopicPage.RelatedTopics");var a=e.call(this,t,void 0,n)||this;return a._graphDepth=2,a}return Object(a.__extends)(t,e),t.prototype.getTopicEntity=function(e,t,n){return void 0===t&&(t={}),r.Validate.isNotNullOrUndefined(e,"topicId"),this._language=n,Object(m.f)()?(this._topicId=e,this.getRequest().then(function(e){var t=e.value;return null==t?void 0:t[0]})):this.getRequest("&wholeTopicQualityModelVersion=V9&TopicsGraphDepth=1&id=".concat(e,"&").concat(this._generateQueryString(t))).then(function(e){var t=e.value;return null==t?void 0:t[0]})},t.prototype.setGraphDepth=function(e){this._graphDepth=e},Object.defineProperty(t.prototype,"qosTag",{get:function(){return"GetRelatedTopics"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return Object(m.f)()?"Topics/Ids":"Topics"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiParams",{get:function(){return Object(m.f)()?"":"?provider=Yggdrasil"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPost",{get:function(){return Object(m.f)()},enumerable:!1,configurable:!0}),t.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),t.headers["X-Debug-EnableRelatedTopics"]="true",Object(m.u)()&&(t.headers["X-Debug-EnableMultiHopRelatedTopics"]="true"),Object(m.f)()&&(t.body=JSON.stringify({TopicIds:[this._topicId],RelatedTopics:Object(a.__assign)({TopicsGraphDepth:this._graphDepth},Object(m.u)()&&{FocalTopicAdjacentTopics:6})}))},t.prototype._generateQueryString=function(e){return new URLSearchParams(e).toString()},t}(C),se=n("cDcd"),ce=n.n(se),de=n("faye"),le=n.n(de),ue=n("2q6Q"),fe=n("br4S"),pe=n("7Awa"),me=n("5pbq");function _e(e,t,n,a){void 0===a&&(a=!0);var i=Object(k.tryGetTopicsSdk)();function r(e){e.logEvent(t,n,{isIntentional:a})}i?r(i):Object(k.getTopicsSdkAsync)(e).then(r)}function he(e,t,n,a,i,r){void 0===r&&(r=!0),_e(e,"".concat("Cortex",".").concat(t,".").concat(n,".").concat(a),i,r)}var be=function(){function e(e){this.customData={},this._pageContext=e}return e.prototype.log=function(e,t,n){var a=this;void 0===t&&(t={}),void 0===n&&(n=!0);var i=Object(k.tryGetTopicsSdk)(),r=function(i){i.logEvent(e,Object(M.assign)({},a.customData,{isIntentional:n},t))};i?r(i):Object(k.getTopicsSdkAsync)(this._pageContext).then(r)},e}(),ge=function(e){function t(t,n){var a,i,r,o=this;return(o=e.call(this,t)||this).customData={topicId:n.Id,topicStatus:n.State,hasTopicDescription:Boolean(null===(i=null===(a=n.Definitions)||void 0===a?void 0:a[0])||void 0===i?void 0:i.Definition),topicLifeCycleState:null===(r=n.LifecycleState)||void 0===r?void 0:r.State,topicSource:n.Source||"",topicRelevanceScore:n.Score,pageLayout:"TopicPage"},o}return Object(a.__extends)(t,e),t}(be),ve=n("HmPY"),ye=function(e){function t(t){var n=e.call(this,t)||this;return n.state={error:void 0},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){!this.state.error&&this.props.isReadyToCompleteRender&&this.props.onRenderSuccess()},t.prototype.componentDidUpdate=function(e){!this.state.error&&this.props.isReadyToCompleteRender&&this.props.onRenderSuccess()},t.prototype.componentDidCatch=function(e,t){this.setState({error:e}),this.props.onRenderFailure(e)},t.prototype.render=function(){if(this.state.error)throw this.state.error;return this.props.children},t}(se.Component);function Se(e,t,n){var r=new i._QosMonitor("".concat(n,".getLatestCurationAuthorProfile"));return t.then(function(t){return t.getPeopleInfo(e.upn||e.email).then(function(t){return r.writeSuccess(),Object(a.__assign)(Object(a.__assign)({},e),{name:t.name||"",email:t.email||""})})}).catch(function(t){return r.writeUnexpectedFailure("GetProfileFailedUnexpected",t),e})}function De(e,t){return!(!e||!t)&&(e.upn&&e.upn===t.upn||e.email&&e.email===t.email)}function Ie(e,t){Object(M.isEmpty)(e)||Object(M.isEmpty)(t)||e.forEach(function(n,a){var i;if(null===(i=n.curationDetails)||void 0===i?void 0:i.author){var r=Object(M.find)(t,function(e){return De(e,n.curationDetails.author)});r&&(e[a].curationDetails.author=r)}})}var xe=n("I6O9"),Ce=function(){function e(){}return e.load=function(t){if(!e._peopleDataProviderPromise){var n=new i._QosMonitor("".concat(t,".PeopleDataProvider.DeferredLoad"));e._peopleDataProviderPromise=xe.SPComponentLoader.loadComponentById(e._peopleDataProviderComponentId).then(function(e){return n.writeSuccess(),e.PeopleDataProvider}).catch(function(e){throw n.writeUnexpectedFailure("LoadModuleFailure",e),e})}return e._peopleDataProviderPromise},e._peopleDataProviderComponentId="8b7ae98f-492d-4304-93df-8f8a9fbedf11",e}(),Oe=n("jOlS");Oe.loadStyles('.k_c_04103875{margin-top:20px;margin-bottom:20px}.b_c_04103875{background-color:"[theme:bodyBackground, default: #ffffff]";border-radius:8px;margin-bottom:0;padding:20px;margin-top:20px}',!0);var we=n("3rh1"),Ee=function(e){function t(){var n=e.call(this)||this;return n.isSuggestedDataLoaded=!1,n.hasGotMaximumRelations=!1,n._hasUpdatedCurationAuthorPropertiesInEditMode=!1,n._updatedCurationAuthorProfiles=[],n.requestMaximumRelations=function(){var e,t;if(!n.hasGotMaximumRelations&&n.relationCountQueryParamKey){if(Object(_.d)()){var a=new i._QosMonitor("".concat(n.qosPrefix,".requestMaximumRelations"));return n._requestTopicEntity((t={},t[n.relationCountQueryParamKey]=O.r,t)).then(function(e){n.hasGotMaximumRelations=!0,n.topicDataService.currentTopicEntity=e,n._feedSuggestedAndFeedbackDataToWebPart(e)}).then(function(){return a.writeSuccess({relationType:n.relationCountQueryParamKey}),O.r}).catch(function(e){throw a.writeUnexpectedFailure("RequestMaximumRelationsFail",e,{stack:e.stack,relationType:n.relationCountQueryParamKey}),e})}if(n.topicId&&n.topicId!==p.NULL_TOPIC_ENTITY.Id){var r=new i._QosMonitor("".concat(n.qosPrefix,".requestMaximumRelations"));return n._topicEntityDataProvider.getTopic(n.topicId,!0,(e={},e[n.relationCountQueryParamKey]=O.r,e),Object(ve.t)(n.context.serviceScope)).then(Y).then(function(e){n.hasGotMaximumRelations=!0,n.topicDataService.currentTopicEntity=e,n._feedSuggestedAndFeedbackDataToWebPart(e)}).then(function(){return r.writeSuccess({relationType:n.relationCountQueryParamKey}),O.r}).catch(function(e){throw r.writeUnexpectedFailure("RequestMaximumRelationsFail",e,{stack:e.stack,relationType:n.relationCountQueryParamKey}),e})}return Promise.resolve(void 0)}return Promise.resolve(O.r)},n._logRenderError=function(e,t){var a;null===(a=n._renderQosMonitor)||void 0===a||a.writeUnexpectedFailure(t||"FailedToRender",e,n._extraQosData(e))},n._logRenderSuccess=function(){var e;null===(e=n._renderQosMonitor)||void 0===e||e.writeSuccess(n._extraQosData())},n._handleTopicLoaded=function(e){var a=e.topic;if(!a||a.Id===n.topicId)try{n.isSuggestedDataLoaded=!0,t._currentTopicEntity=a,Object(_.f)()||n._initializeEngagementLogger(a),n._feedSuggestedAndFeedbackDataToWebPart(a)}catch(e){n.renderCompleted(e)}},n._endPerfMarkWhenAllWebPartsAreReady=function(){Object(we.p)(n.context.pageContext.legacyPageContext).then(function(e){n._isEveryTopicWebPartReadyInPerfLog(e)&&ue._PerformanceLogger.endMarkForComponent("TopicPageLayoutComponent")})},n._refreshCurationDetailsPeopleProfile=function(){var e,t,a,r;Object(M.isEmpty)(n.properties.curated)||(n._setUpdatedFlagInEditMode(),function(e,t,n){return Promise.all(e.map(function(e){return Se(e,t,n)}))}((e=n.properties.curated,r=null!==(a=null===(t=null==e?void 0:e.map(function(e){var t;return null===(t=e.curationDetails)||void 0===t?void 0:t.author}))||void 0===t?void 0:t.filter(function(e){return!Object(M.isEmpty)(e)}))&&void 0!==a?a:[],Object(M.uniqBy)(r,function(e){return e.upn||e.email})),n.getPeopleDataProvider(),n.qosPrefix).then(function(e){e.length>0&&(n._updatedCurationAuthorProfiles=e,Ie(n.properties.curated,e),n.render())}).catch(function(e){i._TraceLogger.logError(i._LogSource.create("".concat(n.qosPrefix,".UpdateCurationAuthorProfile")),e)}))},n._dispatchTopicPublishTeachingBubbleEvent=Object(M.debounce)(n._dispatchTopicPublishTeachingBubbleEvent,3e3),n}return Object(a.__extends)(t,e),t.prototype.render=function(){this.onUpdateAccessibleTitle(),this.webPartContext?le.a.render(se.createElement(this.webPartContext.Provider,{value:this.webPartContextData},this._renderContent()),this.domElement):le.a.render(this._renderContent(),this.domElement)},Object.defineProperty(t.prototype,"inheritedProperties",{get:function(){var e,t,n,a;if(p.Multilingual.isTopicMultilingualEapFlightEnabled()&&this.context&&(null===(t=null===(e=this.topicDataService)||void 0===e?void 0:e.topicPageMultilingualInfo)||void 0===t?void 0:t.isTranslation)){var i=null===(a=null===(n=this.topicDataService)||void 0===n?void 0:n.inheritedWebPartsDataMap)||void 0===a?void 0:a.get(this.context.instanceId);return(null==i?void 0:i.properties)&&pe._PropertyMetadataProcessor.reInstateServerProcessedData(this.propertiesMetadata,i.properties,i.serverProcessedContent,this.context.manifest),null==i?void 0:i.properties}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOnTranslationPage",{get:function(){var e;return null===(e=this.topicDataService.topicPageMultilingualInfo)||void 0===e?void 0:e.isTranslation},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showEditOnDefaultAction",{get:function(){return Boolean(p.Multilingual.isTopicMultilingualEapFlightEnabled()&&this.displayMode===r.DisplayMode.Edit&&this.useInheritedPropertiesForTranslationPage&&this.isOnTranslationPage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWebPartEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewModeContainerClass",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webPartContext",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"relationCountQueryParamKey",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webPartContextData",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useInheritedPropertiesForTranslationPage",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getRemovedItemsFromTopicEntity=function(e){},t.prototype.isReadyToCompleteRender=function(){return!this.isRenderAsync||this.isSuggestedDataLoaded},t.prototype.onInit=function(){var t=this;return this._renderQosMonitor=new i._QosMonitor("".concat(this.qosPrefix,".ComponentRender")),this._assignInheritedPropertiesIfNeeded(),this._registerTopicLoadedEventListener(),e.prototype.onInit.call(this).then(function(){t.onAsyncUpdateAndRender()})},t.prototype.onBeforeSerialize=function(){this.isOnTranslationPage&&this.useInheritedPropertiesForTranslationPage||this.onUpdateEntityRelations(),this._checkAddedCuratedAndDisplayFRE(),e.prototype.onBeforeSerialize.call(this)},t.prototype.onAfterDeserialize=function(e,t){return this.displayMode!==r.DisplayMode.Edit||this._hasUpdatedCurationAuthorPropertiesInEditMode||Ie(e.curated,this._updatedCurationAuthorProfiles),this._setUpdatedFlagInEditMode(),e},t.prototype.onDispose=function(){e.prototype.onDispose.call(this),t._currentTopicEntity=void 0,t._afterLoadSuggestedListeners.clear(),this._unregisterTopicLoadedSPEventListeners()},t.prototype.getCurrentTopicEntity=function(){return t._currentTopicEntity?Promise.resolve(t._currentTopicEntity):Promise.resolve(void 0)},t.prototype.onUpdateAccessibleTitle=function(){if(this.displayMode===r.DisplayMode.Edit){var e=this.accessibleTitle||this._getDefaultAccessibleTitle();if(e){var t="cswpAccessibleLabelContextual_".concat(this.context.instanceId),n=this.domElement.querySelector("#".concat(t));n&&n.textContent!==e&&(n.textContent=e)}}},t.prototype.onAsyncUpdateAndRender=function(){this._refreshCurationDetailsPeopleProfile()},t.prototype.renderCompleted=function(t,n,a){this._firstRenderCompleteTime||(this._firstRenderCompleteTime=Date.now()),t?this._logRenderError(t,a):this._logRenderSuccess(),this._endPerfMarkWhenAllWebPartsAreReady(),e.prototype.renderCompleted.call(this,t,!!n)},Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.isTopicPreviewPage=function(){return Object(N.u)()},Object.defineProperty(t.prototype,"topicDataService",{get:function(){return this._topicDataService||(this._topicDataService=this.context.serviceScope.consume(p.TopicDataService.serviceKey)),this._topicDataService},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initialRelationCount",{get:function(){return O.b?O.r:O.t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topicId",{get:function(){var e;return null===(e=this.topicDataService.currentTopicEntity)||void 0===e?void 0:e.Id},enumerable:!1,configurable:!0}),t.prototype.getPeopleDataProvider=function(){var e=this;return this._peopleDataProvider||(this._peopleDataProvider=Ce.load(this.qosPrefix).then(function(t){return new t(e.context.serviceScope,e.qosPrefix)})),this._peopleDataProvider},t.prototype._requestTopicEntity=function(e){if(this.topicId&&this.topicId.length>0&&this.topicId!==p.NULL_TOPIC_ENTITY.Id){var t=O.b?O.r:O.t,n={FileCount:t,PeopleCount:t,SiteCount:t},a=Object(M.isEmpty)(e)?n:e;return this._topicEntityDataProvider.getTopic(this.topicId,!0,a,Object(ve.t)(this.context.serviceScope)).then(Y)}return Promise.resolve(void 0)},t.prototype._dispatchTopicPublishTeachingBubbleEvent=function(){document.dispatchEvent(new CustomEvent(O.h.showTopicPublishTeachingBubbleEventName))},t.prototype._checkAddedCuratedAndDisplayFRE=function(){var e,t=this;if(!Object(_.p)()&&this._firstRenderCompleteTime){var n=Date.now();(null===(e=this.properties.curated)||void 0===e?void 0:e.some(function(e){var a;if(!(null===(a=e.curationDetails)||void 0===a?void 0:a.time))return!1;var i=new Date(e.curationDetails.time).getTime();return n-i<5e3&&t._firstRenderCompleteTime<i}))&&this._dispatchTopicPublishTeachingBubbleEvent()}},t.prototype._renderContent=function(){return this._assignInheritedPropertiesIfNeeded(),se.createElement(ye,{isReadyToCompleteRender:this.isReadyToCompleteRender(),onRenderSuccess:this.renderCompleted,onRenderFailure:this.renderCompleted},this.displayMode!==r.DisplayMode.Edit?!this.isWebPartEmpty&&se.createElement("div",{className:Object(me.css)(Object(m.i)()?"b_c_04103875":"k_c_04103875",this.viewModeContainerClass)},this.contentElement):this.contentElement)},t.prototype._feedSuggestedAndFeedbackDataToWebPart=function(e){var t=e?this.getSuggestedItemsFromTopicEntity(e):void 0,n=e?this.getRemovedItemsFromTopicEntity(e):void 0;this.onAfterLoadSuggestedAndFeedback(t,n),this.render()},Object.defineProperty(t.prototype,"_topicEntityDataProvider",{get:function(){return this._substrateDataProvider||(this._substrateDataProvider=new ae(this.context.serviceScope)),this._substrateDataProvider},enumerable:!1,configurable:!0}),t.prototype._extraQosData=function(e){return Object(a.__assign)({isSuggestedDataLoaded:this.isSuggestedDataLoaded},!Object(_.n)()&&e&&{errorCode:e.name,errorMessage:e.message,errorStack:e.stack})},t.prototype._unregisterTopicLoadedSPEventListeners=function(){r._SPEventManager.instance.unregisterEvent(O.h.currentTopicLoadedEvent,this,this._handleTopicLoaded)},t.prototype._registerTopicLoadedEventListener=function(){r._SPEventManager.instance.registerEvent(O.h.currentTopicLoadedEvent,this,this._handleTopicLoaded)},t.prototype._initializeEngagementLogger=function(e){e&&(this.engagementLogger=new ge(this.context.pageContext.legacyPageContext,e))},t.prototype._isEveryTopicWebPartReadyInPerfLog=function(e){var t=[];return ue._PerformanceLogger.getExpectedControls().forEach(function(e){return t.push(e)}),[H.e.TITLE_REGION_WP_ID,Object(m.r)(e)&&H.e.DISAMBIGUATION_WP_ID,H.e.OVERVIEW_RTE_INSTANCE_ID,H.e.RELATED_PEOPLE_WP_ID,H.e.GRAPH_WP_ID,H.e.RELATED_DOCS_WP_ID,H.e.RELATED_SITES_WP_ID].filter(function(e){return!!e}).every(function(e){return t.some(function(t){return t.indexOf(e)>-1})})},t.prototype._setUpdatedFlagInEditMode=function(){this.displayMode===r.DisplayMode.Edit&&(this._hasUpdatedCurationAuthorPropertiesInEditMode=!0)},t.prototype._assignInheritedPropertiesIfNeeded=function(){var e,t;p.Multilingual.isTopicMultilingualEapFlightEnabled()&&this.isOnTranslationPage&&this.useInheritedPropertiesForTranslationPage&&(this.properties.curated=(null===(e=this.inheritedProperties)||void 0===e?void 0:e.curated)||[],this.properties.removed=(null===(t=this.inheritedProperties)||void 0===t?void 0:t.removed)||[])},t._afterLoadSuggestedListeners=new Map,t}(fe.BaseClientSideWebPart),Ae=se.lazy(function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,"/G8a"))});function Le(e){return se.createElement(se.Suspense,{fallback:se.createElement(se.Fragment,null)},se.createElement(Ae,Object(a.__assign)({},e)))}var ke=i._LogSource.create("TopicAssociationCallout"),Me=se.lazy(function(){return n.e(3).then(n.bind(null,"YgK8")).catch(function(e){throw i._TraceLogger.logError(ke,e,"FailedToLoadJS"),e})});function Pe(e){return se.createElement(se.Suspense,{fallback:se.createElement(se.Fragment,null)},se.createElement(Me,Object(a.__assign)({},e)))}var Te=n("pUyu");Oe.loadStyles('.l_e_04103875{border:0;padding:0}.l_e_04103875:hover{background-color:"[theme:neutralLighter, default: #f3f2f1]"}.l_e_04103875 .m_e_04103875{color:"[theme:themePrimary, default: #0078d4]"}',!0);var Ue=n("9G/V");function Fe(e){var t=e.topicId,n=e.topicName,a=e.pageContext,r=e.source,o=e.className,s=se.useCallback(function(){i._EngagementLogger.logEventWithLogEntry(new i._LogEntry("TopicCard","CSIKM.TopicCard.GiveFeedbackEmail",i._LogType.Event,{topicId:t},!0))},[t]);return se.createElement(me.DefaultButton,{iconProps:{iconName:"Emoji2",className:"m_e_04103875"},onClick:s,href:Object(N.a)({feedbackEmail:"projecthedleyfeedback@service.microsoft.com",topicId:t,topicName:n,buildNumber:ue._Telemetry.buildNumber,source:r,pageContext:a}),className:Object(me.css)("l_e_04103875",o),title:Ue.t,styles:{label:{fontWeight:"normal"}}},Ue.e)}var He=se.lazy(function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,"D6a0"))}),Re=se.forwardRef(function(e,t){return se.createElement(se.Suspense,{fallback:se.createElement(se.Fragment,null)},se.createElement(He,Object(a.__assign)({},e,{ref:t})))});function Ne(e){return p.Icons.getIconUrl(e.split(".").pop()||"")}var Be=n("M0jl"),je=n("6DK4"),Ve=function(e){function t(t,n,a){return void 0===a&&(a=!1),e.call(this,t,a,n)||this}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"GetTopicByNames"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Topics/Names"},enumerable:!1,configurable:!0}),t.prototype.fetchTopics=function(e,t){return Object(p.isRunCortexTAB)()?Promise.resolve([]):(Object(_.h)()||(this._language=t),this._topicNames=Object(M.uniq)(null==e?void 0:e.filter(function(e){return e}).map(function(e){return e.trim()})),Object(M.isEmpty)(this._topicNames)?Promise.resolve([]):this.getRequest().then(function(e){return e.value}))},t.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),t.body=JSON.stringify({TopicNames:this._topicNames})},t}(C),ze=function(e){function t(t,n){var a=e.call(this,t,!1,n)||this;return a._typeIds=[],a}return Object(a.__extends)(t,e),t.prototype.getTypes=function(e,t){return void 0===e&&(e=[]),this._typeIds=e,this._language=t,this.getRequest().then(function(e){return e.value})},t.prototype.getCustomRequestOptions=function(t){e.prototype.getCustomRequestOptions.call(this,t),t.body=JSON.stringify({Ids:this._typeIds})},Object.defineProperty(t.prototype,"qosTag",{get:function(){return"GetTopicTypes"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Types"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isKServingEndPointReady",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(C),Ge=function(e){function t(t,n){void 0===n&&(n="SPPages.TopicPage.QnASetting");var a=this;return r.Validate.isNotNullOrUndefined(t,"serviceScope"),(a=e.call(this,t,void 0,n)||this)._payload=[],a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"dweApiName",{get:function(){return"Settings/QnANotificationsByTopicIds"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return"Settings/QnANotifications/Ids"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"QnANotificationsByTopicIds"},enumerable:!1,configurable:!0}),t.prototype.optOutByTopicId=function(e){return r.Validate.isNotNullOrUndefined(e,"topicId"),this._payload=[{TopicId:e,Enabled:!1}],this.getRequest()},t.prototype.getCustomRequestOptions=function(e){e.body=JSON.stringify(this._payload)},t}(C),Ke=n("NmML"),We=function(e){function t(t){var n=e.call(this,t,!!Object(_._)()&&void 0)||this;return n._pastDays=30,n}return Object(a.__extends)(t,e),t.prototype.getDashboardDataByLifecycleState=function(e){return this._managedTopicState=e,this.getRequest()},Object.defineProperty(t.prototype,"apiName",{get:function(){return"Topics/ManagedDashboard"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"ManagedDashboard"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xScenario",{get:function(){return r._SPFlight.isEnabled(60476)?"SPPages.TopicManagementV3.Dashboard":"SPPages.TopicManagement.Dashboard"},enumerable:!1,configurable:!0}),t.prototype.getCustomRequestOptions=function(e){e.headers["X-ODataQuery"]="true";var t={ManagedTopicState:this._managedTopicState,PastDays:this._pastDays};e.body=JSON.stringify(t)},t}(C),qe=n("Kwxa");function Qe(e){return se.createElement(me.Stack,{className:e.className},se.createElement(me.Stack,null,(Object(_.t)()||e.source.title)&&(e.source.url?se.createElement(p.RichTextFormatter,{template:qe.e,values:[se.createElement(me.Link,{key:e.source.url,href:e.source.url,target:"_blank","data-interception":"off",title:e.source.title,onClick:e.onSourceClick},e.source.title)],className:"j_b_04103875"}):se.createElement("span",null,e.source.title))),e.languageSourceMessage&&se.createElement(Je,{languageSourceMessage:e.languageSourceMessage}))}function Ye(e){var t=e.stacked;return se.createElement(p.RichTextFormatter,{template:qe.e,className:Object(me.css)("b_b_04103875",e.className,t&&"c_b_04103875"),values:[se.createElement(me.Link,{key:e.source.url,href:e.source.url,target:"_blank",title:e.source.url,className:"g_b_04103875",onClick:e.onWikiLinkClick},qe.t),se.createElement(me.Link,{key:"1",href:"https://creativecommons.org/licenses/by-sa/3.0/",target:"_blank",className:Object(me.css)(t?"i_b_04103875":"e_b_04103875","h_b_04103875"),onClick:e.onWikiLinkClick},qe.n)]})}function Je(e){return se.createElement(me.Stack,null,se.createElement("span",null,e.languageSourceMessage))}Oe.loadStyles(".b_b_04103875{display:flex}.b_b_04103875.c_b_04103875{display:block}[dir=ltr] .b_b_04103875 .e_b_04103875{margin-left:12px}[dir=rtl] .b_b_04103875 .e_b_04103875{margin-right:12px}[dir=ltr] .b_b_04103875 .f_b_04103875{margin-right:4px}[dir=rtl] .b_b_04103875 .f_b_04103875{margin-left:4px}[dir=ltr] .b_b_04103875 .g_b_04103875{margin-left:4px}[dir=rtl] .b_b_04103875 .g_b_04103875{margin-right:4px}.b_b_04103875 .h_b_04103875{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.b_b_04103875 .i_b_04103875{display:block}.j_b_04103875{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}",!0);var Xe=n("jamc");function Ze(e){var t=e.serviceScope,n=e.shouldShowError,a=e.requiredField;se.useEffect(function(){t.whenFinished(function(){t.consume(p.TopicDataService.serviceKey).missingRequiredFields[a]=n})},[t,n,a])}function $e(e,t){var n=Object(a.__read)(ce.a.useState(""),2),i=n[0],r=n[1];return ce.a.useEffect(function(){var n;if(e.curatedTypeId){var a=t.consume(o.PageContext.serviceKey);(function(e,t,n){return Object(k.getTopicsSdk)(t.legacyPageContext,Object(ve.t)(n,!0)).then(function(t){return t.searchTopicsTypes(void 0,[e]).then(function(e){return(null==e?void 0:e.length)?e[0].DisplayName:""})})})(e.curatedTypeId,a,t).then(function(e){r(e)}).catch(M.noop)}else!Object(_.m)()&&Object(N.u)()&&e.currentTopicEntity.HasPrimaryType&&r((null===(n=Object(M.find)(e.currentTopicEntity.TopicTypes,"IsPrimary"))||void 0===n?void 0:n.DisplayName)||"")},[e.curatedTypeId,t,e.currentTopicEntity,e.topicPageMultilingualInfo]),i}},oUEy:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"r",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"o",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"e",function(){return d});var a="CSIKM.Substrate",i="DP",r="X-SPDF-TestFeedback",o="https://microsoft.sharepoint-df.com/teams/knowledgehub",s="https://microsoft.sharepoint-df.com",c="https://microsoft.sharepoint.com/sites/knowledgecenter",d="feedbackDebugMode"},pUyu:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n("17wl"),i=n("hrbp");function r(e){var t,n,r,o,s,c=JSON.parse(e);try{for(var d=Object(a.__values)(c),l=d.next();!l.done;l=d.next()){var u=l.value;if(u.id===i.e.DEFINITION_WP_ID)return(null===(o=null===(r=u.serverProcessedContent)||void 0===r?void 0:r.searchablePlainTexts)||void 0===o?void 0:o.content)||(null===(s=u.properties)||void 0===s?void 0:s.content)||""}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return""}function o(e,t,n,a,i,r,o,s){return{Id:n,CurrentLanguage:s,DisplayName:e,State:"Mined, Curated",Url:a,LifeCycle:{State:"Published"},RelatedResourcesMap:[{Key:"People",Value:[{Id:i,Type:"People",State:"Curated",LifeCycle:{State:"Published"},MyFeedbackStatus:"Undetermined",EmailAddress:i,UserPrincipalName:o,DisplayName:r,Curator:{DisplayName:r,EmailAddress:i,UserPrincipalName:o}}]}],RelatedEntitiesMap:[],AlternateNames:[],Definition:t,Definitions:[{Value:t,State:"Curated",LifeCycle:{State:"Published"}}]}}},rMgv:function(e,t,n){"use strict";n.d(t,"u",function(){return i}),n.d(t,"f",function(){return r}),n.d(t,"m",function(){return o}),n.d(t,"p",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"_",function(){return u}),n.d(t,"i",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"s",function(){return m}),n.d(t,"o",function(){return _}),n.d(t,"c",function(){return h}),n.d(t,"n",function(){return b}),n.d(t,"l",function(){return g}),n.d(t,"t",function(){return v}),n.d(t,"r",function(){return y});var a=function(){function e(){}return e.topicViewerConfirmedTopicsLogPrefix="CSKIM.TopicViewer.ConfirmedTopics.DP",e.topicViewerUnconfirmedTopicsLogPrefix="CSKIM.TopicViewer.UnconfirmedTopics.DP",e.topicViewerExcludedTopicsLogPrefix="CSKIM.TopicViewer.ExcludedTopics.DP",e.topicPagePreviewStubFileName="TopicPagePreview.aspx",e.createTopicPageStubFileName="CreateTopicPage.aspx",e.newPageStubFileName="newpage.aspx",e.layoutsPagePrefix="_layouts/15/",e.disambiguationPageStubFileName="TopicDisambiguation.aspx",e.topicCacheDuration=864e5,e.kmTopicIdAttribute="data-sp-topic-id",e.kmHashtaggedTopicIdAttribute="data-sp-hashtagged-topic-id",e.kmTopicCardAttribute="data-sp-topic-card",e.kmAnnotateLogPrefix="CSIKM.Annotate",e.kmTopicPickerLogPrefix="CSIKM.TopicPicker",e.kmTopicCenterLogPrefix="CSIKM.TopicCenter",e.kmFeedbackLogPrefix="CSIKM.Feedback",e.kmTopicCardLogPrefix="CSIKM.TopicCard",e.kmTopicPageLogPrefix="CSIKM.TopicPage",e.kmTopicCacheLogPrefix="CSIKM.TopicCache",e.timeZoneStartIndexInDatetime=19,e.pageVersionParam="version",e.pageVersionCompareFromParam="versionCompareFrom",e.pageVersionCompareToParam="versionCompareTo",e.currentTopicLoadedEvent="CurrentTopicLoadedEvent",e.ascending=1,e.descending=2,e.onAnnotateTitleEventName="onAnnotateTitle_Cortex",e.topicNameChangeEventName="TopicNameChangedEvent_Cortex",e.showTopicPublishTeachingBubbleEventName="ShowTopicPublishTeachingBubble_Cortex",e}();t.h=a;var i="topic_related_people",r="topic_related_resources",o="topic_related_topics",s="topic_related_sites",c="_",d={Curated:"Curated",NotCurated:"NotCurated"},l={MinedDefinition:"MinedDefinition",Definition:"Definition",NoDefinition:"NoDefinition"},u={TopicId:"topicId",TopicName:"topicName",LinkSource:"ls",TopicsCount:"top",SkipCount:"skip",Language:"lang",QnAOptOut:"QnAOptOut"},f={HashtaggedAnnotation:"HASHTAGGEDANNOTATION",Annotation:"ANNOTATION",TopicCard:"CARD",TopicManagement:"MGMT",GraphWebPart:"GRAPH",MyTopics:"MYTOPICS",DisambiguationContext:"DISAMBIGUATION",AmbiguousTopic:"AMBIGUOUS_TOPIC"},p=window.innerWidth<640,m=2,_=2,h="Empty response from substrate getTopicById api",b={author:{email:"",name:"",upn:""},time:"",isAddedFromSearch:!1},g="topic-page-privacy-banner-close-button",v=10,y=50},ut3N:function(e,t){e.exports=b},vlQI:function(e,t){e.exports=g},"w4+A":function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"n",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"f",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"u",function(){return f}),n.d(t,"m",function(){return p}),n.d(t,"_",function(){return m}),n.d(t,"a",function(){return _}),n.d(t,"p",function(){return h}),n.d(t,"l",function(){return b}),n.d(t,"h",function(){return g}),n.d(t,"t",function(){return v}),n.d(t,"s",function(){return y}),n.d(t,"o",function(){return S}),n.d(t,"i",function(){return D});var a,i=n("UWqr"),r=n("WZz6"),o=n("+ORw");function s(){return i._SPFlight.isEnabled(1442)}function c(){return i._SPFlight.isEnabled(a.ManageTopicsAPIMigration)}function d(){return i._SPFlight.isEnabled(a.SwitchAPIRequestMethod)}function l(e){return void 0===e&&(e=!1),i._SPFlight.isEnabled(a.Disambiguation)||e&&i._SPFlight.isEnabled(a.DisambiguationEAP)}function u(){return i._SPFlight.isEnabled(60376)}function f(){return i._SPFlight.isEnabled(a.GraphMultipleLayers)}function p(){return i._SPFlight.isEnabled(60589)}function m(e){return Object(o.p)()?Promise.resolve(!1):i._SPFlight.isEnabled(60576)?Promise.resolve(!0):i._SPFlight.isEnabled(60709)?Object(r.getTopicsSdkAsync)(e).then(function(e){return Boolean(e.isPreviewUser())}).catch(function(){return!1}):Promise.resolve(!1)}function _(){return i._SPFlight.isEnabled(60621)}function h(e){return b(e)||i._SPFlight.isEnabled(60014)||i._SPFlight.isEnabled(60819)&&Object(r.hasCortexPermission)(e,"Manage")}function b(e){return i._SPFlight.isEnabled(1174)||i._SPFlight.isEnabled(1315)&&Object(r.isCortexEapUser)(e)}function g(){return i._SPFlight.isEnabled(60672)}function v(){return i._SPFlight.isEnabled(60671)}function y(){return i._SPFlight.isEnabled(a.EnablePreACLScore)}function S(){return i._SPFlight.isEnabled(a.EnablePostACLScore)}function D(){return i._SPFlight.isEnabled(1437)}!function(e){e[e.TopicCardEditButton=1288]="TopicCardEditButton",e[e.TopicExperienceFeedback=1057]="TopicExperienceFeedback",e[e.Disambiguation=1734]="Disambiguation",e[e.DisambiguationEAP=60717]="DisambiguationEAP",e[e.SwitchAPIRequestMethod=60866]="SwitchAPIRequestMethod",e[e.EnablePreACLScore=1290]="EnablePreACLScore",e[e.EnablePostACLScore=1435]="EnablePostACLScore",e[e.GraphMultipleLayers=60550]="GraphMultipleLayers",e[e.ManageTopicsAPIMigration=1532]="ManageTopicsAPIMigration"}(a||(a={}))},y88i:function(e,t){e.exports=v}})});