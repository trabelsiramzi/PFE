(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[121],{"2G27":function(e,t,n){"use strict";var a=n("DGFG");t.e=function(e){this.name="LikeLimitExceeded",this.message=a.n,e&&(this.message=e)}},"4xmq":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("17wl"),i=n("cDcd"),r=i.lazy(function(){return Promise.all([n.e(7),n.e(10),n.e(168),n.e(2),n.e(122)]).then(n.bind(null,"1yMh")).then(function(e){return{default:e.default}})});function o(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(r,Object(a.__assign)({},e)))}},"5Zgq":function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("5pbq"),o=n("y88i"),s=n("UWqr"),c=n("Pk8u"),d=n("QdXD");n("jOlS").loadStyles('.ju_af_ada2ac09{max-width:230px;max-height:450px}.ju_af_ada2ac09 .jv_af_ada2ac09{font-size:12px;font-weight:400;border:0;color:"[theme:neutralPrimary, default: #323130]";list-style:none;margin:0;padding:16px 25px;white-space:nowrap}.ju_af_ada2ac09 .jv_af_ada2ac09 .jw_af_ada2ac09{display:block;overflow:hidden;margin:0 0 20px;text-overflow:ellipsis}.ju_af_ada2ac09 .jv_af_ada2ac09 .jx_af_ada2ac09{margin:0}.ju_af_ada2ac09 .jv_af_ada2ac09 .jy_af_ada2ac09{margin:20px 0 0}',!0);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props.item.likedBy.slice(0,10),t=this.props.item.likeCount-e.length;return i.createElement("ul",{className:"jv_af_ada2ac09"},e.map(function(t,n){return n<e.length-1?i.createElement("li",{key:t.email,className:"jw_af_ada2ac09"},t.name):i.createElement("li",{key:t.email,className:"jx_af_ada2ac09"},t.name)}),Boolean(t)&&i.createElement("li",{key:"others",className:"jy_af_ada2ac09"},s.Text.format(d.i,t)))},t}(i.Component),u=l,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"finalProps",{get:function(){var e=this,t=this._likedByMessage(this.props.item),n={ariaLabel:this.props.item.likeCount?s.Text.format(d.e,t):t,"data-automation-id":"sp-likedbymessage",item:this.props.item,text:t,tooltipProps:{onRenderContent:function(){return i.createElement(u,{item:e.props.item})}}};return Object(c.merge)({},n,this.props)},enumerable:!1,configurable:!0}),t.prototype.render=function(){return this._includeTooltip(this.props.item)?i.createElement(r.TooltipHost,{className:"ju_af_ada2ac09",tooltipProps:this.finalProps.tooltipProps},i.createElement(r.ActionButton,Object(a.__assign)({},this.finalProps))):i.createElement(r.ActionButton,Object(a.__assign)({},this.finalProps))},t.prototype._likedByMessage=function(e){var t=e.likeCount-Number(e.userLiked);return e.likeCount?s.Text.format(o.StringHelper.getLocalizedCountValue(e.userLiked?d.r:d.o,d.a,t),t):d.t},t.prototype._includeTooltip=function(e){return e.likedBy&&(e.likedBy.length>1||!e.userLiked&&1===e.likedBy.length)},t}(i.Component);t.e=f},"8byn":function(e){e.exports=JSON.parse('{"e":"Page avec une mention J’aime","t":"Page dont la mention J’aime a été supprimée","i":"Aucune autre mention J’aime à afficher||Affichage de {0} autre mention J’aime||Affichage de {0} autres mentions J’aime","r":"0||1||2-","a":" Nous n’avons pas pu ajouter de mention J’aime à la page, car cette dernière a atteint le nombre maximal de mentions J’aime. ","n":"Nous n’avons pas pu ajouter de mention J’aime à la page. Veuillez réessayer.","o":"Nous n’avons pas pu supprimer la mention J’aime sur la page. Veuillez réessayer."}')},E6a3:function(e,t,n){"use strict";n("jOlS").loadStyles('.ba_p_ada2ac09 i{color:"[theme:bodyText, default: #323130]"}.bb_p_ada2ac09{padding:0;width:24px}.bc_p_ada2ac09>.ms-AnalyticsChart{margin-top:0}.n_p_ada2ac09{font-size:14px;font-weight:400;display:flex;align-items:center;flex-direction:row;flex-wrap:wrap}.n_p_ada2ac09 .be_p_ada2ac09{width:16px}.n_p_ada2ac09 .be_p_ada2ac09+.be_p_ada2ac09{width:0}.bf_p_ada2ac09{width:288px}.bg_p_ada2ac09{top:50px}.bg_p_ada2ac09 .ms-Panel-contentInner{overflow-y:visible;height:100%}.bh_p_ada2ac09{padding:0 25px;overflow-x:hidden;overflow-y:auto}.bi_p_ada2ac09{cursor:default;font-size:16px;height:32px;line-height:28px;text-align:center;width:32px;-webkit-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle}[dir=ltr] .bi_p_ada2ac09{margin-right:8px}[dir=rtl] .bi_p_ada2ac09{margin-left:8px}button.z_p_ada2ac09,label.z_p_ada2ac09{display:inline;line-height:32px;-webkit-user-select:none;-ms-user-select:none;user-select:none;font-weight:400}[dir=ltr] button.z_p_ada2ac09,[dir=ltr] label.z_p_ada2ac09{margin-left:-7px}[dir=rtl] button.z_p_ada2ac09,[dir=rtl] label.z_p_ada2ac09{margin-right:-7px}[dir=ltr] button.z_p_ada2ac09,[dir=ltr] label.z_p_ada2ac09{margin-right:15px}[dir=rtl] button.z_p_ada2ac09,[dir=rtl] label.z_p_ada2ac09{margin-left:15px}button.bj_p_ada2ac09,label.bj_p_ada2ac09{height:32px}.bk_p_ada2ac09{height:64px;background-color:#eff5fc}.bl_p_ada2ac09{padding:23px;display:flex}.bm_p_ada2ac09{color:#33332d;font-size:14px;font-weight:600}.bn_p_ada2ac09{color:#484644;font-size:16px;padding-left:13px;height:22px}',!0),t.e={commandLink:"ba_p_ada2ac09",socialIconButton:"bb_p_ada2ac09",pageUsageChartContainer:"bc_p_ada2ac09",root:"n_p_ada2ac09",socialBarSpacer:"be_p_ada2ac09",socialBarList:"bf_p_ada2ac09",socialBarPanel:"bg_p_ada2ac09",socialBarPanelContent:"bh_p_ada2ac09",viewsIcon:"bi_p_ada2ac09",link:"z_p_ada2ac09",linkHeight:"bj_p_ada2ac09",socialBarPanelFeedbackFooter:"bk_p_ada2ac09",socialBarPanelFeedbackFooterContent:"bl_p_ada2ac09",socialBarPanelFeedbackFooterText:"bm_p_ada2ac09",socialBarPanelFeedbackFooterIcon:"bn_p_ada2ac09"}},IekB:function(e,t,n){"use strict";n.r(t),n.d(t,"BOOKMARKS_TO_RENDER",function(){return f});var a=n("17wl"),i=n("UWqr"),r=n("ut3N"),o=n("vlQI"),s=n("I6O9"),c=n("Y5JV"),d=n("2q6Q"),l=n("M+LP");function u(){return Object(l.e)(1063)||1===d._SPPerfExperiment.getVariantAndTrackExperiment(d._PerformanceExperiment.WEXPageSaveForLaterVroomApiExperiment)}var f=5,p="AddBookmark",m="RemoveBookmark",_="IsBookmarked",h=f+1,b=function(){function e(e){this._serviceScope=e,u()&&(this._spHttpClient=this._serviceScope.consume(o.SPHttpClient.serviceKey))}return e._getMonitorExtraData=function(){if(!Object(c.n)())return{alias:u()?"Vroom":"SPHome"}},Object.defineProperty(e,"_baseVRoomAPIPath",{get:function(){var e=window.location.hostname;return"https://".concat(e,"/_api/v2.1/favorites/followedListItems")},enumerable:!1,configurable:!0}),e.prototype.addBookmark=function(t){var n,a=new r._QosMonitor(p),i=u(),o=i?this._convertServerVroomBookmarkRequest(t):t.url;return n=i?"".concat(e._baseVRoomAPIPath,"/oneDrive.add"):"documents/saveForLater/add",this._updateBookmarkStatus(n,o,a,p)},e.prototype.removeBookmark=function(t){var n,a=new r._QosMonitor(m),i=u(),o=i?this._convertServerVroomBookmarkRequest(t):decodeURI(t.url);return n=i?"".concat(e._baseVRoomAPIPath,"/oneDrive.remove"):"documents/saveForLater/remove",this._updateBookmarkStatus(n,o,a,m)},e.prototype.isBookmarked=function(t){var n=new r._QosMonitor(_);return this._isBookmarkedRequest(t).then(function(e){return e.json()}).then(function(t){var a,i;return u()&&(t.ViewCount=null===(a=t.analytics)||void 0===a?void 0:a.allTime.access.actionCount,t.SavedForLater=Boolean(null===(i=t.followed)||void 0===i?void 0:i.followedDateTime)),n.writeSuccess(e._getMonitorExtraData()),t}).catch(function(t){throw n.writeUnexpectedFailure(_,t,e._getMonitorExtraData()),t})},e.prototype.fetchBookmarked=function(){var t,n=this,a=new r._QosMonitor("FetchBookmarked"),i=u();if(i){var s="".concat(e._baseVRoomAPIPath,"?$top=").concat(h,"&$filter=listItemType eq pages");t=this._spHttpClient.get(s,o.SPHttpClient.configurations.v1,e._vRoomRequestOptions)}else t=this._loadSPHomeHttpClient().then(function(e){return e.get("/documents/saveForLater?count=100")});return t.then(function(e){return e.json()}).then(function(t){var r,o,s;return s=i?(null===(r=t.value)||void 0===r?void 0:r.map(function(e){return n._convertServerVroomBookmarkResponse(e)}))||[]:(null===(o=t.Activities)||void 0===o?void 0:o.filter(function(e){return!!e.ActivityItem}).map(function(e){return n._convertServerLegacySpHomeBookmarksResponse(e)}))||[],a.writeSuccess(e._getMonitorExtraData()),s}).catch(function(t){throw a.writeUnexpectedFailure("Unexpected",t,e._getMonitorExtraData()),t})},e.prototype._isBookmarkedRequest=function(t){if(u()){var n=window.location.hostname,a="https://".concat(n,"/_api/v2.1/sites/").concat(n,",").concat(t.siteId,",").concat(t.webId,"/")+"lists/".concat(t.listId,"/items/").concat(t.uniqueId)+"/driveItem?$select=followed,id,analytics&$expand=analytics($expand=allTime)";return this._spHttpClient.get(a,o.SPHttpClient.configurations.v1,e._vRoomRequestOptions)}var i="document/metadata?siteId=".concat(t.siteId,"&webId=").concat(t.webId)+"&listId=".concat(t.listId,"&uniqueId=").concat(t.uniqueId,"&url=").concat(t.url)+(t.groupId?"&groupId=".concat(t.groupId):"");return this._loadSPHomeHttpClient().then(function(e){return e.get(i)})},e.prototype._updateBookmarkStatus=function(t,n,r,s){var c,d,l=JSON.stringify(n);c=u()?this._spHttpClient.post(t,o.SPHttpClient.configurations.v1,Object(a.__assign)(Object(a.__assign)({},e._vRoomRequestOptions),{body:l})):this._loadSPHomeHttpClient().then(function(e){return e.post(t,l)});var f=e._getMonitorExtraData();return c.then(function(e){var t;i._SPKillSwitch.isActivated("df2cd841-189c-462f-a5b0-fdf21755a1e7")||(d=null===(t=e.correlationId)||void 0===t?void 0:t.toString())&&f&&(f.correlationId=d);var n=e.ok;if(!n)throw new Error("UpdateBookmarkNotOk");return r.writeSuccess(f),n}).catch(function(e){throw r.writeUnexpectedFailure(s,e,f),e})},e.prototype._convertServerLegacySpHomeBookmarksResponse=function(e){var t=e.ActivityItem,n=t.ImageUrl,a=t.Library,i=t.Site,r=t.Title,o=t.UniqueId,s=t.Url,c=a.ListId,d=i.ItemReference,l=d.GroupId;return{imageUrl:n,title:r,url:s,siteId:d.SiteId,webId:d.WebId,listId:c,groupId:l,uniqueId:o}},e.prototype._convertServerVroomBookmarkResponse=function(e){var t=e.listId,n=e.listItemUniqueId,a=e.name,i=e.resourceVisualization,r=e.siteId,o=e.webId,s=e.webUrl;return{imageUrl:null==i?void 0:i.previewImageUrl,title:a,url:s,siteId:r,webId:o,listId:t,uniqueId:n}},e.prototype._convertServerVroomBookmarkRequest=function(e){var t=e.siteId;return{value:[{listId:e.listId,listItemUniqueId:e.uniqueId,webId:e.webId,siteId:t}]}},e.prototype._loadSPHomeHttpClient=function(){var e=this;return this._spHomeHttpClient?Promise.resolve(this._spHomeHttpClient):s.SPComponentLoader.loadComponentById("1cea229f-b208-4202-8014-22503d92a019").then(function(t){return e._spHomeHttpClient=e._serviceScope.consume(t.SPHomeHttpClient.serviceKey),e._spHomeHttpClient})},e.serviceKey=i.ServiceKey.create("sp-dataproviders:BookmarksDataProvider",e),e._vRoomRequestOptions={headers:new Headers({Caller:"PagesWeb"})},e}();t.default=b},LuFS:function(e,t,n){"use strict";n.r(t);var a=n("2q6Q"),i=n("vlQI"),r=n("y88i"),o=n("2G27"),s=n("xs0R"),c=n("onFi"),d=n("q+wp"),l=function(){function e(e,t){this._pageContext=e,this._spHttpClient=t}return e.prototype.getPageLikes=function(){var e=this,t=new a._QosMonitor("GetPageLikesAPI");return this._getPageLikesRequest().then(function(n){return e._checkForErrors(t,n),n.json()}).then(function(n){return t.writeSuccess(),e._convertServerLikesResponse(n)}).catch(function(e){return t.writeUnexpectedFailure("GetPageLikesAPI",e),Promise.reject(e)})},e.prototype.getNextPageLikes=function(e){var t=this,n=new a._QosMonitor("GetPageLikesAPI");return this._nextPageLikesRequest(e).then(function(e){return t._checkForErrors(n,e),e.json()}).then(function(e){return n.writeSuccess(),t._convertServerLikesNextResponse(e)}).catch(function(e){return n.writeUnexpectedFailure("GetPageLikesAPI",e),Promise.reject(e)})},e.prototype.likePage=function(){var e=this,t=new a._QosMonitor("LikePageAPI");return this._likePageRequest().then(function(n){e._checkLikeResponse("LikePageAPI",t,n),t.writeSuccess()}).catch(function(e){return t.writeUnexpectedFailure("LikePageAPI",e),Promise.reject(e)})},e.prototype.unlikePage=function(){var e=this,t=new a._QosMonitor("UnlikePageAPI");return this._unlikePageRequest().then(function(n){e._checkForErrors(t,n),t.writeSuccess()}).catch(function(e){return t.writeUnexpectedFailure("UnlikePageAPI",e),Promise.reject(e)})},e.prototype._checkForErrors=function(e,t){t||this._throwEmptyResponseError(e),d.e.isResponseSuccessful(t.status)||this._throwHttpError(e,t)},e.prototype._checkLikeResponse=function(e,t,n){n||this._throwEmptyResponseError(t),d.e.isResponseSuccessful(n.status)||this._throwLikeError(t,n)},e.prototype._convertServerLikesResponse=function(e){return e&&e.likedBy?{count:e.likeCount||0,likes:e.likedBy,isLikedByUser:e.isLikedByUser,nextLink:e["likedBy@odata.nextLink"],pageId:this._itemId()}:void 0},e.prototype._convertServerLikesNextResponse=function(e){return{count:void 0,nextLink:e["@odata.nextLink"],likes:e.value}},e.prototype._failedResponseFromStatus=function(e){var t,n=((t={})[403]="FailedResponseForbidden",t[404]="FailedResponseNotFound",t[406]="FailedResponseNotAcceptable",t);return n[e]?n[e]:"FailedResponseStatus"},e.prototype._fields=function(){return s.t.fields},e.prototype._getPageLikesRequest=function(){return this._spHttpClient.get(r.Uri.concatenate(this._getPageUrl(),"/likedByInformation?$expand=likedby&$top=10"),i.SPHttpClient.configurations.v1)},e.prototype._getPageUrl=function(){return r.Uri.concatenate(this._pageContext.legacyPageContext.webServerRelativeUrl||"","/_api/web/lists('".concat(d.e.listId(),"')"),"/GetItemById(".concat(this._itemId(),")"))},e.prototype._itemId=function(){return this._fields().Id||d.e.spPageContextInfo.pageItemId},e.prototype._likePageRequest=function(){return this._toggleLikePageRequest(!0)},e.prototype._nextPageLikesRequest=function(e){return this._spHttpClient.get(e,i.SPHttpClient.configurations.v1)},e.prototype._throwEmptyResponseError=function(e){var t=new Error("Response is null, undefined or empty");throw e.writeUnexpectedFailure("FailedResponseStatus",t),t},e.prototype._throwHttpError=function(e,t){var n=new c.e(d.e.getStatusMessage(t),t.status);throw e.writeUnexpectedFailure(this._failedResponseFromStatus(t.status),n),n},e.prototype._throwLikeError=function(e,t){507===t.status?this._throwLikeLimitExceededError(e):this._throwHttpError(e,t)},e.prototype._throwLikeLimitExceededError=function(t){throw t.writeExpectedFailure("LikePageAPI",e.likeLimitExceededError),e.likeLimitExceededError},e.prototype._toggleLikePageRequest=function(e){return this._spHttpClient.fetch(r.Uri.concatenate(this._getPageUrl(),e?"/like":"/unlike"),i.SPHttpClient.configurations.v1,{method:"post",body:JSON.stringify({})})},e.prototype._unlikePageRequest=function(){return this._toggleLikePageRequest(!1)},e.likeLimitExceededError=new o.e,e}();t.default=l},QdXD:function(e){e.exports=JSON.parse('{"e":"{0}, entrez pour afficher les détails.","t":"J’aime","n":"Je n’aime plus","i":"et {0} autres personnes...","r":"Vous aimez ça||Vous et {0} personne aimez cela||Vous et {0} personnes aimez cela","o":"||{0} personne a ajouté une mention J’aime à cet élément||{0} personnes ont ajouté une mention J’aime à cet élément","a":"0||1||2-"}')},Y5JV:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("dc468a00-ab7a-4a23-bfce-e52306e617b3")}function r(){return a._SPKillSwitch.isActivated("c8fa5c1f-3d7d-4dda-93bc-e4ee3b16f8b6")}function o(){return a._SPKillSwitch.isActivated("c2d7676d-5c8d-46c2-ba40-0484f511a25e")}},aKJO:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n("5pbq"),i=n("17wl"),r=n("cDcd"),o=Object(a.classNamesFunction)(),s=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=r.createRef(),n._onKeyDown=function(e){n.props.onDismiss&&e.which===a.KeyCodes.escape&&n.props.onDismiss()},Object(a.initializeComponentRef)(n),n.state={},n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.onDismiss&&document.addEventListener("keydown",this._onKeyDown,!1)},t.prototype.componentWillUnmount=function(){this.props.onDismiss&&document.removeEventListener("keydown",this._onKeyDown)},t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e,t,n,s,c,d=this.props,l=d.children,u=d.illustrationImage,f=d.primaryButtonProps,p=d.secondaryButtonProps,m=d.headline,_=d.hasCondensedHeadline,h=d.hasCloseButton,b=void 0===h?this.props.hasCloseIcon:h,g=d.onDismiss,v=d.closeButtonAriaLabel,y=d.hasSmallHeadline,S=d.isWide,D=d.styles,I=d.theme,x=d.ariaDescribedBy,C=d.ariaLabelledBy,O=d.footerContent,w=d.focusTrapZoneProps,E=o(D,{theme:I,hasCondensedHeadline:_,hasSmallHeadline:y,hasCloseButton:b,hasHeadline:!!m,isWide:S,primaryButtonClassName:f?f.className:void 0,secondaryButtonClassName:p?p.className:void 0});if(u&&u.src&&(e=r.createElement("div",{className:E.imageContent},r.createElement(a.Image,Object(i.__assign)({},u)))),m){var A="string"==typeof m?"p":"div";t=r.createElement("div",{className:E.header},r.createElement(A,{role:"heading","aria-level":3,className:E.headline,id:C},m))}if(l){var L="string"==typeof l?"p":"div";n=r.createElement("div",{className:E.body},r.createElement(L,{className:E.subText,id:x},l))}return(f||p||O)&&(s=r.createElement(a.Stack,{className:E.footer,horizontal:!0,horizontalAlign:O?"space-between":"end"},r.createElement(a.Stack.Item,{align:"center"},r.createElement("span",null,O)),r.createElement(a.Stack.Item,null,p&&r.createElement(a.DefaultButton,Object(i.__assign)({},p,{className:E.secondaryButton})),f&&r.createElement(a.PrimaryButton,Object(i.__assign)({},f,{className:E.primaryButton}))))),b&&(c=r.createElement(a.IconButton,{className:E.closeButton,iconProps:{iconName:"Cancel"},title:v,ariaLabel:v,onClick:g})),r.createElement("div",{className:E.content,ref:this.rootElement,role:"dialog",tabIndex:-1,"aria-labelledby":C,"aria-describedby":x,"data-is-focusable":!0},e,r.createElement(a.FocusTrapZone,Object(i.__assign)({isClickableOutsideFocusTrap:!0},w),r.createElement("div",{className:E.bodyContent},t,n,s,c)))},t}(r.Component),c={root:"ms-TeachingBubble",body:"ms-TeachingBubble-body",bodyContent:"ms-TeachingBubble-bodycontent",closeButton:"ms-TeachingBubble-closebutton",content:"ms-TeachingBubble-content",footer:"ms-TeachingBubble-footer",header:"ms-TeachingBubble-header",headerIsCondensed:"ms-TeachingBubble-header--condensed",headerIsSmall:"ms-TeachingBubble-header--small",headerIsLarge:"ms-TeachingBubble-header--large",headline:"ms-TeachingBubble-headline",image:"ms-TeachingBubble-image",primaryButton:"ms-TeachingBubble-primaryButton",secondaryButton:"ms-TeachingBubble-secondaryButton",subText:"ms-TeachingBubble-subText",button:"ms-Button",buttonLabel:"ms-Button-label"},d=Object(a.memoizeFunction)(function(){return Object(a.keyframes)({"0%":{opacity:0,animationTimingFunction:a.AnimationVariables.easeFunction1,transform:"scale3d(.90,.90,.90)"},"100%":{opacity:1,transform:"scale3d(1,1,1)"}})}),l=function(e,t){var n=t||{},a=n.calloutWidth,i=n.calloutMaxWidth;return[{display:"block",maxWidth:364,border:0,outline:"transparent",width:a||"calc(100% + 1px)",animationName:""+d(),animationDuration:"300ms",animationTimingFunction:"linear",animationFillMode:"both"},e&&{maxWidth:i||456}]},u=function(e,t,n){return t?[e.headerIsCondensed,{marginBottom:14}]:[n&&e.headerIsSmall,!n&&e.headerIsLarge,{selectors:{":not(:last-child)":{marginBottom:14}}}]},f=function(e){var t,n,r,o=e.hasCondensedHeadline,s=e.hasSmallHeadline,d=e.hasCloseButton,f=e.hasHeadline,p=e.isWide,m=e.primaryButtonClassName,_=e.secondaryButtonClassName,h=e.theme,b=e.calloutProps,g=void 0===b?{className:void 0,theme:h}:b,v=!o&&!s,y=h.palette,S=h.semanticColors,D=h.fonts,I=Object(a.getGlobalClassNames)(c,h),x=Object(a.getFocusStyle)(h,{outlineColor:"transparent",borderColor:"transparent"});return{root:[I.root,D.medium,g.className],body:[I.body,d&&!f&&{marginRight:24},{selectors:{":not(:last-child)":{marginBottom:20}}}],bodyContent:[I.bodyContent,{padding:"20px 24px 20px 24px"}],closeButton:[I.closeButton,{position:"absolute",right:0,top:0,margin:"15px 15px 0 0",borderRadius:0,color:y.white,fontSize:D.small.fontSize,selectors:{":hover":{background:y.themeDarkAlt,color:y.white},":active":{background:y.themeDark,color:y.white},":focus":{border:"1px solid "+S.variantBorder}}}],content:Object(i.__spreadArrays)([I.content],l(p),[p&&{display:"flex"}]),footer:[I.footer,{display:"flex",flex:"auto",alignItems:"center",color:y.white,selectors:(t={},t["."+I.button+":not(:first-child)"]={marginLeft:10},t)}],header:Object(i.__spreadArrays)([I.header],u(I,o,s),[d&&{marginRight:24},(o||s)&&[D.medium,{fontWeight:a.FontWeights.semibold}]]),headline:[I.headline,{margin:0,color:y.white,fontWeight:a.FontWeights.semibold},v&&[{fontSize:D.xLarge.fontSize}]],imageContent:[I.header,I.image,p&&{display:"flex",alignItems:"center",maxWidth:154}],primaryButton:[I.primaryButton,m,x,{backgroundColor:y.white,borderColor:y.white,color:y.themePrimary,whiteSpace:"nowrap",selectors:(n={},n["."+I.buttonLabel]=D.medium,n[":hover"]={backgroundColor:y.themeLighter,borderColor:y.themeLighter,color:y.themePrimary},n[":focus"]={backgroundColor:y.themeLighter,border:"1px solid "+y.black,outline:"1px solid "+y.white,outlineOffset:"-2px"},n[":active"]={backgroundColor:y.white,borderColor:y.white,color:y.themePrimary},n)}],secondaryButton:[I.secondaryButton,_,{backgroundColor:y.themePrimary,borderColor:y.white,whiteSpace:"nowrap",selectors:(r={},r["."+I.buttonLabel]=[D.medium,{color:y.white}],r[":hover"]={backgroundColor:y.themeDarkAlt,borderColor:y.white},r[":focus"]={backgroundColor:y.themeDark,border:"1px solid "+y.black,outline:"1px solid "+y.white,outlineOffset:"-2px"},r[":active"]={backgroundColor:y.themePrimary,borderColor:y.white},r)}],subText:[I.subText,{margin:0,fontSize:D.medium.fontSize,color:y.white,fontWeight:a.FontWeights.regular}],subComponentStyles:{callout:{root:Object(i.__spreadArrays)(l(p,g),[D.medium]),beak:[{background:y.themePrimary}],calloutMain:[{background:y.themePrimary}]}}}},p=Object(a.styled)(s,f,void 0,{scope:"TeachingBubbleContent"}),m=Object(a.classNamesFunction)(),_=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=r.createRef(),Object(a.initializeComponentRef)(n),n.state={},n._defaultCalloutProps={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:a.DirectionalHint.rightCenter},n}return Object(i.__extends)(t,e),t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.targetElement,o=e.onDismiss,s=e.hasCloseButton,c=void 0===s?this.props.hasCloseIcon:s,d=e.isWide,l=e.styles,u=e.theme,f=e.target,_=Object(i.__assign)(Object(i.__assign)({},this._defaultCalloutProps),t),h={theme:u,isWide:d,calloutProps:Object(i.__assign)(Object(i.__assign)({},_),{theme:_.theme}),hasCloseButton:c},b=m(l,h),g=b.subComponentStyles?b.subComponentStyles.callout:void 0;return r.createElement(a.Callout,Object(i.__assign)({target:f||n,onDismiss:o},_,{className:b.root,styles:g,hideOverflow:!0}),r.createElement("div",{ref:this.rootElement},r.createElement(p,Object(i.__assign)({},this.props))))},t.defaultProps={calloutProps:{beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:a.DirectionalHint.rightCenter}},t}(r.Component),h=Object(a.styled)(_,f,void 0,{scope:"TeachingBubble"})},"i+3J":function(e,t,n){"use strict";var a=n("ut3N"),i=n("Cgdb"),r=n("n1SJ"),o=n("jyrw"),s=n("7plR"),c=n("Y5JV"),d=n("s5jy"),l=function(){function e(){}return e.addBookmark=function(t){var n=this;e._dispatch("ADD_BOOKMARK",{pageData:t}),s.e.instance.bookmarksDataProvider.then(function(e){return e.addBookmark(t)}).catch(function(a){e._dispatch("REMOVE_BOOKMARK",{url:t.url}),n._processBookmarkError(a)})},e.removeBookmark=function(t){e._dispatch("REMOVE_BOOKMARK",{url:t.url}),s.e.instance.bookmarksDataProvider.then(function(e){return e.removeBookmark(t)}).catch(function(t){r.e.showError(d.bookmarkRemoveFailed,void 0,t),e._logError(t)})},e.isBookmarked=function(t){return s.e.instance.bookmarksDataProvider.then(function(e){return e.isBookmarked(t)}).then(function(n){e._dispatch("UPDATE_BOOKMARKED",{pageData:{title:t.title,imageUrl:t.imageUrl,url:t.url},isBookmarked:n.SavedForLater,viewCount:n.ViewCount})}).catch(e._logError)},e.getBookmarks=function(){return s.e.instance.bookmarksDataProvider.then(function(e){return e.fetchBookmarked()}).then(function(t){e._dispatch("BOOKMARK_BATCH",{moreBookmarks:t})}).catch(function(t){Object(c.n)()||r.e.showError(d.bookmarksFetchFailed,void 0,t),e._logError(t)})},e._dispatch=function(t,n){o.e.dispatch(new i.e(t,e._logEntryFor(t),n))},e._logEntryFor=function(t){return new a._LogEntry(e._moduleName,e._logFeatureMap.get(t),a._LogType.Event)},e._logError=function(t){a._TraceLogger.logError(e._logSource,t)},e._processBookmarkError=function(t){r.e.showError(d.bookmarkFailed,void 0,t),e._logError(t)},e._logSource=a._LogSource.create("BookmarkActionCreator"),e._moduleName="[BookmarkActionCreator]",e._logFeatureMap=new Map([["ADD_BOOKMARK","SPPageBookmarkAdded"],["REMOVE_BOOKMARK","SPPageBookmarkRemoved"],["UPDATE_BOOKMARKED","SPPageIsBookmarked"],["BOOKMARK_BATCH","SPPageBookmarksLoaded"]]),e}();t.e=l},liQQ:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("5pbq"),o=n("2q6Q"),s=n("y88i"),c=n("UWqr"),d=n("aKJO"),l=n("ut3N"),u=n("Pk8u"),f=n("i+3J"),p=n("0IsF"),m=n("XdGY"),_=n("PJr9"),h=n("q+wp"),b=n("7plR"),g=n("xs0R"),v=n("Y5JV"),y=n("lsr+"),S=n("s5jy"),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"finalProps",{get:function(){var e={ariaLabel:this.props.isBookmarked?c.Text.format(S.actionSeeBookmarkedItemsAriaLabel,S.isBookmarked):c.Text.format(S.actionSeeBookmarkedItemsAriaLabel,S.actionBookmark),"data-automation-id":"sp-bookmarkmessage",text:this._bookmarkMessage(),tooltipProps:{onRenderContent:function(){return i.createElement("p",{className:y.e.bookmarkTooltipContent}," ",S.seeRecentlySavedItems," ")}},isBookmarked:!1,tooltipEnabled:!0};return Object(u.merge)({},e,this.props)},enumerable:!1,configurable:!0}),t.prototype.render=function(){return this._includeTooltip()?i.createElement(r.TooltipHost,{className:y.e.bookmarkTooltip,tooltipProps:this.finalProps.tooltipProps},i.createElement(r.ActionButton,Object(a.__assign)({},this.finalProps))):i.createElement(r.ActionButton,Object(a.__assign)({},this.finalProps))},t.prototype._bookmarkMessage=function(){return this.props.isBookmarked?S.isBookmarked:S.actionBookmark},t.prototype._includeTooltip=function(){return this.props.isBookmarked&&this.props.tooltipEnabled},t}(i.Component),I=D;function x(e,t){void 0===e&&(e={bookmarks:[],bookmarksLoaded:!1,viewCount:0});var n=t.actionData;switch(t.type){case"ADD_BOOKMARK":return b.e.instance.a11yManager.alert(S.ariaIsBookmarked),function(e,t){return C(e,t.url)||e.bookmarks.unshift(t),e}(e,n.pageData);case"REMOVE_BOOKMARK":return b.e.instance.a11yManager.alert(S.ariaBookmarkRemoved),function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{bookmarks:e.bookmarks.filter(function(e){return e.url!==t&&encodeURI(e.url)!==t})})}(e,n.url);case"BOOKMARK_BATCH":return Object(a.__assign)(Object(a.__assign)({},e),{bookmarks:n.moreBookmarks,bookmarksLoaded:!0});case"UPDATE_BOOKMARKED":return function(e,t,n,a){return n&&!C(e,t.url)&&e.bookmarks.push(t),e.viewCount=a,e}(e,n.pageData,n.isBookmarked,n.viewCount);default:return e}}function C(e,t){return e.bookmarks.some(function(e){return e.url===t||encodeURI(e.url)===t})}var O=i.lazy(function(){return Promise.all([n.e(7),n.e(10),n.e(168),n.e(2),n.e(122)]).then(n.bind(null,"M8Hu")).then(function(e){return{default:e.default}})});function w(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(O,Object(a.__assign)({},e)))}var E=function(e){function t(n){var a=e.call(this,n)||this;return a._firstRunChecked=!1,a._onClickHandler=function(){a._toggleBookmark()},a._onClosePanel=function(){a.setState({panelOpen:!1})},a._onBookmarkTextClicked=function(){l._EngagementLogger.logEvent("SocialBar.OpenSaveForLaterPanel.Click"),a.state.moreBookmarksLoaded||f.e.getBookmarks(),a.setState({panelOpen:!0})},a._onDismissTeachingBubble=function(){a.setState({isTeachingBubbleDismissed:!0}),a._setFirstRunSeen()},a._onStoresUpdated=function(){if(t.navigatedToArticlePage(t._pageKey)&&(Object(m.M)()||(t._pageKey=h.e.getPageKey()),a._lastTimeout&&clearTimeout(a._lastTimeout),a._lastTimeout=window.setTimeout(function(){a.setState({isBookmarked:!1}),h.e.isNewPage()||a._checkPageIsBookmarked()},0)),g.t.sliceUpdated.indexOf(_.e.FirstRunStore)>-1&&a.setState({showTeachingBubble:a._firstRunSlice.Bookmark.isFirstRun}),g.t.sliceUpdated.indexOf(_.e.BookmarkStore)>-1){var e=g.t.pageReduxStore.getState().bookmark;e&&a.setState({isBookmarked:C(e,a._bookmarkData.url),moreBookmarks:e.bookmarks.length?e.bookmarks:a.state.moreBookmarks,moreBookmarksLoaded:e.bookmarksLoaded})}},a.state={isBookmarked:!1,isTeachingBubbleDismissed:!1,panelOpen:!1,moreBookmarks:[],moreBookmarksLoaded:!1,showTeachingBubble:!1},g.t.addReducer("bookmark",x),h.e.isNewPage()||a._checkPageIsBookmarked(),Object(m.M)()||(t._pageKey=h.e.getPageKey()),a._unsubscribe=g.t.addListener(a._onStoresUpdated),a}return Object(a.__extends)(t,e),t.navigatedToArticlePage=function(e){var t,n;return g.t.sliceUpdated.indexOf(_.e.RouteStore)>-1&&(Object(m.M)()?!g.t.isTransitioning:g.t.didTransition&&h.e.navigatedToNewPage(e))&&(null===(t=g.t.fields)||void 0===t?void 0:t.PageLayoutType)===p.e.Article&&!(null===(n=g.t.fields)||void 0===n?void 0:n.IsWebWelcomePage)},t.prototype.shouldComponentUpdate=function(e,t){return!Object(u.isEqual)(e,this.props)||!Object(u.isEqual)(t,this.state)},t.prototype.componentDidUpdate=function(e,t){this._firstRunChecked||t.isBookmarked||!this.state.isBookmarked||(this._checkFirstRun(),this._firstRunChecked=!0)},t.prototype.componentWillUnmount=function(){this._lastTimeout&&clearTimeout(this._lastTimeout),this._unsubscribe&&this._unsubscribe()},t.prototype.render=function(){if(!Object(v.n)()&&!this._isPageContextDataAvailable())return i.createElement(i.Fragment,null);var e=this.state.isBookmarked?S.removeBookmark:S.actionBookmarkTooltip,t=this.state.isBookmarked?S.removeBookmark:S.actionBookmarkAriaLabel;return i.createElement(i.Fragment,null,i.createElement(r.IconButton,{iconProps:{iconName:this.state.isBookmarked?"SingleBookmarkSolid":"SingleBookmark"},title:e,ariaLabel:t,onClick:this._onClickHandler,className:this.props.socialIconButtonClass,"data-automation-id":"sp-socialbar-bookmarkbutton"}),i.createElement("span",{ref:this._resolveRef("_bookmarkedMessageElement")},i.createElement(I,{className:y.e.link,"data-automation-id":"sp-socialbar-bookmarkmessage",onClick:this._onBookmarkTextClicked,isBookmarked:this.state.isBookmarked,tooltipEnabled:this._enableTooltip})),this.state.panelOpen&&i.createElement(w,{bookmarks:this.state.moreBookmarks,bookmarksLoaded:this.state.moreBookmarksLoaded,elementToFocusOnDismiss:this._bookmarkedMessageElement,isOpen:this.state.panelOpen,onDismiss:this._onClosePanel,closeButtonAriaLabel:S.panelCloseAriaLabel}),this._renderTeachingBubble())},t.prototype._toggleBookmark=function(){this.state.isBookmarked?(l._EngagementLogger.logEvent("SocialBar.RemoveSaveForLater.Click"),f.e.removeBookmark(this._bookmarkData)):(l._EngagementLogger.logEvent("SocialBar.SaveForLater.Click"),f.e.addBookmark(this._bookmarkData),this.state.showTeachingBubble&&this.setState({isTeachingBubbleDismissed:!1}))},t.prototype._checkPageIsBookmarked=function(){var e,t=(null===(e=g.t.fields)||void 0===e?void 0:e.BannerImageUrl)||"",n=(null==t?void 0:t.Url)||t,i=this._isPageContextDataAvailable()?{siteId:b.e.instance.pageContext.site.id.toString(),webId:b.e.instance.pageContext.web.id.toString(),listId:h.e.listId(),groupId:b.e.instance.pageContext.legacyPageContext.groupId,uniqueId:g.t.fields.UniqueId.toString()}:void 0,r=Object(v.n)()?void 0:i;this._bookmarkData=Object(a.__assign)(Object(a.__assign)({},r),{title:g.t.fields.Title,imageUrl:n,url:Object(m.a)()?h.e.url(!0):h.e.removeQueryStringAndAnchor(window.location.href)}),r?f.e.isBookmarked(this._bookmarkData):i&&f.e.isBookmarked(Object(a.__assign)(Object(a.__assign)({},i),this._bookmarkData))},Object.defineProperty(t.prototype,"_showTeachingBubble",{get:function(){return this.state.isBookmarked&&this.state.showTeachingBubble},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_enableTooltip",{get:function(){return this.state.isBookmarked&&!this._showTeachingBubble},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_firstRunSlice",{get:function(){return g.t.pageReduxStore.getState().firstRun},enumerable:!1,configurable:!0}),t.prototype._isPageContextDataAvailable=function(){var e;return Boolean((null===(e=g.t.fields)||void 0===e?void 0:e.UniqueId)&&(b.e.instance.pageContext.list&&b.e.instance.pageContext.list.id||g.t.listSettings.Id)&&b.e.instance.pageContext.web&&b.e.instance.pageContext.web.id&&b.e.instance.pageContext.site&&b.e.instance.pageContext.site.id)},t.prototype._renderTeachingBubble=function(){return this._showTeachingBubble&&!this.state.isTeachingBubbleDismissed?i.createElement(d.e,{targetElement:this._bookmarkedMessageElement,onDismiss:this._onDismissTeachingBubble,hasCloseIcon:!0,hasCondensedHeadline:!0,headline:S.firstRunTooltip,calloutProps:{doNotLayer:!1,gapSpace:0,isBeakVisible:!0,directionalHint:r.DirectionalHint.bottomCenter},closeButtonAriaLabel:S.closeTeachingBubbleAriaLabel}):void 0},t.prototype._checkFirstRun=function(){"true"===window.localStorage.getItem("bookmarkTeachingBubbleSeen")?(this._setFirstRunSeen(),window.localStorage.removeItem("bookmarkTeachingBubbleSeen")):this._firstRunModule().then(function(e){return e.checkFirstRunState(e.firstRunKeys.Bookmark)})},t.prototype._setFirstRunSeen=function(){var e=this;this._firstRunModule().then(function(t){return t.raiseFirstRunAction(!1,e._forceUpdate(),t.firstRunKeys.Bookmark)})},t.prototype._firstRunModule=function(){return Promise.all([n.e(0),n.e(86)]).then(n.bind(null,"lxZ0"))},t.prototype._forceUpdate=function(){return Boolean(this._firstRunSlice.Bookmark.forceUpdate)},t}(r.BaseComponent),A=E,L=n("/spA"),k=n("5Zgq"),M=n("lpyS"),P=i.lazy(function(){return Promise.all([n.e(7),n.e(10),n.e(168),n.e(2),n.e(122)]).then(n.bind(null,"0UwO")).then(function(e){return{default:e.default}})});function T(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(P,Object(a.__assign)({},e)))}var U=n("bXd7"),F=n("mwqp"),H=n("4xmq"),R=n("qgIT"),N=n("E6a3"),B=function(e){function t(t){var n=e.call(this,t)||this;return n._viewsElement=i.createRef(),n._firstRunChecked=!1,n._onStoresUpdated=function(){(F.PageStore.sliceUpdated.indexOf(F.StoreName.FirstRunStore)>-1||void 0===n.state.hasBubbleBeenSeenBefore)&&n.setState({hasBubbleBeenSeenBefore:!n._firstRunSlice.AnalyticsPanel.isFirstRun},n._renderCoachMark)},n._showTeachingBubble=function(){var e=n.state,t=e.hasBubbleBeenSeenBefore,a=e.isTeachingBubbleDismissed;return!1===t&&!a},n._onDismissTeachingBubble=function(){n.setState({isTeachingBubbleDismissed:!0}),n._setFirstRunSeen()},n._openAnalyticsPanel=function(){l._EngagementLogger.logEvent("SocialBarViewCount.Click"),n.setState({analyticsPanelOpen:!0})},n._onCloseAnalyticsPanel=function(){l._EngagementLogger.logEvent("SocialBarViewsPaneClose.Click"),n.setState({analyticsPanelOpen:!1})},n.state={analyticsPanelOpen:!1,hasBubbleBeenSeenBefore:void 0,isTeachingBubbleDismissed:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._unsubscribe=F.PageStore.addListener(this._onStoresUpdated)},t.prototype.componentDidUpdate=function(e,t){this._firstRunChecked||t.analyticsPanelOpen||!this.state.analyticsPanelOpen||(this._checkFirstRun(),this._firstRunChecked=!0)},t.prototype.componentWillUnmount=function(){this._unsubscribe&&this._unsubscribe();var e=this.state.coachMarkKey;e&&F.PageManager.instance.serviceScope.consume(U.CoachmarkUtility.serviceKey).dismiss(e)},t.prototype.render=function(){var e=c.Text.format(s.StringHelper.getLocalizedCountValue(R.p,R.m,this.props.viewCount),this.props.viewCount);return i.createElement(i.Fragment,null,i.createElement("div",{ref:this._viewsElement},i.createElement(r.ActionButton,{ariaLabel:e,className:N.e.commandLink,iconProps:{iconName:"View",styles:{root:{color:"#000"}}},onClick:this._openAnalyticsPanel,"data-automation-id":"sp-socialbar-viewcount"},e)),this.state.analyticsPanelOpen&&i.createElement(H.e,{elementToFocusOnDismiss:this._viewsElement.current,isOpen:this.state.analyticsPanelOpen,onDismiss:this._onCloseAnalyticsPanel}))},Object.defineProperty(t.prototype,"_firstRunSlice",{get:function(){return F.PageStore.pageReduxStore.getState().firstRun},enumerable:!1,configurable:!0}),t.prototype._checkFirstRun=function(){this._firstRunModule().then(function(e){return e.checkFirstRunState(e.firstRunKeys.AnalyticsPanel)})},t.prototype._renderCoachMark=function(){var e=this;if(this._showTeachingBubble()&&!this.state.coachMarkKey){var t=this._viewsElement.current;F.PageManager.instance.serviceScope.consume(U.CoachmarkUtility.serviceKey).attachCoachmark({content:"",displayEvaluator:this._showTeachingBubble,layerElement:t,onBeforeDismiss:this._onDismissTeachingBubble,positioningContainerProps:{directionalHint:r.DirectionalHint.topCenter,doNotLayer:!0,setInitialFocus:!1},preventFocusOnMount:!0,target:this._viewsElement.current,teachingBubbleProps:{calloutProps:{gapSpace:0},hasCondensedHeadline:!0,headline:R.e}}).then(function(t){e.setState({coachMarkKey:t})})}},t.prototype._setFirstRunSeen=function(){this._firstRunModule().then(function(e){return e.raiseFirstRunAction(!1,!0,e.firstRunKeys.AnalyticsPanel)})},t.prototype._firstRunModule=function(){return Promise.all([n.e(0),n.e(86)]).then(n.bind(null,"lxZ0"))},t}(r.BaseComponent),j=B,V=function(){function e(e,t,n,a){this._likeCount=e||0,this._likedBy=t||[],this._nextLikesLink=n||void 0,this._userLiked=a||!1}return Object.defineProperty(e.prototype,"likeCount",{get:function(){return this._likeCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"likedBy",{get:function(){return this.userLiked?[this._user()].concat(this._likedBy||[]):this._likedBy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextLikesLink",{get:function(){return this._nextLikesLink},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLiked",{get:function(){return this._userLiked},enumerable:!1,configurable:!0}),e.prototype.hasMoreLikes=function(){return Boolean(this._nextLikesLink)},e.prototype.like=function(){return this.userLiked?this:new e(this.likeCount+1,this._likedBy,this.nextLikesLink,!0)},e.prototype.processLikeChunk=function(t){var n=this._markUserLiked(t.isLikedByUser),a=this._addLikes(t.likes||[]);return new e(t.count||this.likeCount,a,this._processNextLink(t.nextLink),n)},e.prototype.unlike=function(){return this.userLiked?new e(this.likeCount-1,this._likedBy,this.nextLikesLink,!1):this},e.prototype._alreadyLiked=function(e){return this._likedBy.some(function(t){return t.email===e.email})},e.prototype._addLikes=function(e){var t=this;return e=e.filter(function(e){return!t._isCurrentUser(e)&&!t._alreadyLiked(e)}),this._likedBy.concat(e)},e.prototype._isCurrentUser=function(e){return this._user().id===e.id},e.prototype._markUserLiked=function(e){return void 0!==e?e:this.userLiked},e.prototype._noMoreLikes=function(e){return this._nextLikesLink&&-1===this._nextLikesLink.indexOf("skiptoken")},e.prototype._processNextLink=function(e){return this._noMoreLikes(e)?void 0:e},e.prototype._user=function(){return{email:b.e.instance.pageContext.user.email,name:b.e.instance.pageContext.user.displayName,id:b.e.instance.pageContext.legacyPageContext.userId}},e}(),z=n("8byn");function G(e,t){switch(void 0===e&&(e={pageLikeContainer:new V}),t.type){case"PAGE_LIKE":return b.e.instance.a11yManager.alert(z.e),function(e){return{pageLikeContainer:e.pageLikeContainer.like()}}(e);case"PAGE_UNLIKE":return b.e.instance.a11yManager.alert(z.t),function(e){return{pageLikeContainer:e.pageLikeContainer.unlike()}}(e);case"PAGE_LIKE_CHUNK":return K(e,t.actionData);case"PAGE_LIKE_CHUNK_RESET":return K(W(),t.actionData);case"START_TRANSITION":case"PAGE_CREATE_STUB":return W();default:return e}}function K(e,t){return{pageLikeContainer:e.pageLikeContainer.processLikeChunk(t)}}function W(){return{pageLikeContainer:new V}}var q="SocialBarLoad",Q=function(e){function t(n){var a=e.call(this,n)||this;a._getStateFromStores=function(){var e={};a._commentSlice&&(e.commentsEnabled=!a._commentSlice.disabled,e.commentCount=a._commentSlice.commentCount),a._pageLikesContainer&&(e.likeCount=a._pageLikesContainer.likeCount,e.userLiked=a._pageLikesContainer.userLiked),a.setState(e)},a._focusCommentsSection=function(){var e=document.getElementById("sp-comment-input");o._EngagementLogger.logEvent("SocialBarComment.Click"),e&&(e.scrollIntoView(),e.focus())},a._onCloseLikesPanel=function(){o._EngagementLogger.logEvent("SocialBarPaneClose.Click"),a.setState({likesPanelOpen:!1}),a._getLikes()},a._onLikeTextClicked=function(){if(0===a._pageLikesContainer.likeCount)return a._toggleLike();o._EngagementLogger.logEvent("SocialBarLikeList.Click"),a.setState({likesPanelOpen:!0})},a._onLoadMoreLikes=function(){o._EngagementLogger.logEvent("SocialBarLikeListLoadMore.Click"),a._pageLikesContainer.hasMoreLikes()&&M.e.getNextPageLikes(a._pageLikesContainer)},a._onStoresUpdated=function(){var e;A.navigatedToArticlePage(t._pageKey)&&(Object(m.M)()||(t._pageKey=h.e.getPageKey()),a._lastTimeout&&clearTimeout(a._lastTimeout),a._lastTimeout=window.setTimeout(function(){a.setState({likeCount:0,userLiked:!1,viewCount:0}),h.e.isNewPage()||a._getLikes(!0)},0));var n=g.t.pageReduxStore.getState().slicesUpdated;-1===n.indexOf(_.e.CommentStore)&&-1===n.indexOf(_.e.SocialStore)||a._getStateFromStores();var i=null===(e=g.t.pageReduxStore.getState().bookmark)||void 0===e?void 0:e.viewCount;void 0!==i&&i!==a.state.viewCount&&a.setState({viewCount:i})},a._toggleLike=function(){a.state.userLiked?(o._EngagementLogger.logEvent("SocialBarUnlike.Click"),M.e.unlikePage()):(o._EngagementLogger.logEvent("SocialBarLike.Click"),M.e.likePage())},g.t.addReducer("social",G),a.state={analyticsPanelOpen:!1,commentsEnabled:!1,commentCount:0,likeCount:0,likesPanelOpen:!1,userLiked:!1,viewCount:0};var i=new o._QosMonitor(q);return Object(m.M)()||(t._pageKey=h.e.getPageKey()),Promise.all([a._getComments(),a._getLikes()]).then(function(){i.writeSuccess()}).catch(function(e){i.writeUnexpectedFailure(q,e)}),a._unsubscribe=g.t.addListener(a._onStoresUpdated),a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._mounted=!0},t.prototype.componentWillUnmount=function(){this._mounted=!1,this._lastTimeout&&clearTimeout(this._lastTimeout),this._unsubscribe&&this._unsubscribe()},t.prototype.render=function(){var e=c.Text.format(s.StringHelper.getLocalizedCountValue(R.o,R.c,this.state.commentCount),this.state.commentCount);return i.createElement("aside",{role:"complementary","aria-label":R.t,"data-automation-id":"sp-socialbar","data-sp-feature-tag":"Social bar","data-sp-feature-instance-id":"_Social bar",className:N.e.root},this._pageLikesContainer&&i.createElement(i.Fragment,null,i.createElement(r.IconButton,{iconProps:{iconName:this._pageLikesContainer.userLiked?"LikeSolid":"Like"},title:this._likeButtonLabel(this._pageLikesContainer.userLiked),ariaLabel:this._likeButtonAriaLabel(this._pageLikesContainer.userLiked),onClick:this._toggleLike,className:N.e.socialIconButton,"data-automation-id":"sp-socialbar-likebutton"}),i.createElement(k.e,{"data-automation-id":"sp-socialbar-likedbymessage",item:this._pageLikesContainer,onClick:this._onLikeTextClicked,componentRef:this._resolveRef("_likedByMessageElement")}),this.state.likesPanelOpen&&i.createElement(T,{elementToFocusOnDismiss:this._likedByMessageElement,pageLikes:this._pageLikesContainer,isOpen:this.state.likesPanelOpen,onDismiss:this._onCloseLikesPanel,onLoadMoreLikes:this._onLoadMoreLikes})),i.createElement("div",{className:N.e.socialBarSpacer}),this.state.commentsEnabled&&i.createElement(r.ActionButton,{ariaLabel:c.Text.format(R.s,e),className:N.e.commandLink,iconProps:{iconName:"Comment",styles:{root:{color:"#000"}}},onClick:this._focusCommentsSection,"data-automation-id":"sp-socialbar-commentsbutton"},e),i.createElement("div",{className:N.e.socialBarSpacer}),this._showViews()&&i.createElement(j,{viewCount:this.state.viewCount}),i.createElement("div",{className:N.e.socialBarSpacer}),this._isUserSupportedBySubstrate&&i.createElement(A,{socialIconButtonClass:N.e.socialIconButton})," ")},Object.defineProperty(t.prototype,"_pageLikesContainer",{get:function(){return g.t.pageReduxStore.getState().social.pageLikeContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_commentSlice",{get:function(){return g.t.pageReduxStore.getState().comments},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isUserSupportedBySubstrate",{get:function(){var e=h.e.spPageContextInfo;return!e.isAnonymousGuestUser&&!e.isExternalGuestUser},enumerable:!1,configurable:!0}),t.prototype._getComments=function(){var e=this;return L.e.instance.waitForLoad().then(function(){Promise.all([n.e(10),n.e(163),n.e(73)]).then(n.bind(null,"DrmC")).then(function(){e._mounted&&e._getStateFromStores()})})},t.prototype._getLikes=function(e){return M.e.getPageLikes(e)},t.prototype._likeButtonAriaLabel=function(e){return e?R.u:R.d},t.prototype._likeButtonLabel=function(e){return e?R.f:R.l},t.prototype._showViews=function(){return this._isUserSupportedBySubstrate&&this.state.viewCount>0},t}(r.BaseComponent);t.default=Q},lpyS:function(e,t,n){"use strict";var a=n("ut3N"),i=n("Cgdb"),r=n("jyrw"),o=n("7plR"),s=n("n1SJ"),c=n("LuFS"),d=n("q+wp"),l=n("8byn"),u=function(){function e(){}return e.getNextPageLikes=function(t){o.e.instance.socialDataProvider.then(function(e){return e.getNextPageLikes(t.nextLikesLink)}).then(function(t){e._dispatch("PAGE_LIKE_CHUNK",t),d.e.alertScreenreader(l.i,l.r,t.likes.length)}).catch(e._logError)},e.getPageLikes=function(t){return o.e.instance.socialDataProvider.then(function(e){return e.getPageLikes()}).then(function(n){t?e._dispatch("PAGE_LIKE_CHUNK_RESET",n):e._dispatch("PAGE_LIKE_CHUNK",n)}).catch(e._logError)},e.likePage=function(){var e=this;this._dispatch("PAGE_LIKE"),o.e.instance.socialDataProvider.then(function(e){return e.likePage()}).catch(function(t){e._dispatch("PAGE_UNLIKE"),e._processLikeError(t)})},e.unlikePage=function(){var t=this;this._dispatch("PAGE_UNLIKE"),o.e.instance.socialDataProvider.then(function(e){return e.unlikePage()}).catch(function(n){t._dispatch("PAGE_LIKE"),s.e.showError(l.o,void 0,n),e._logError(n)})},e._dispatch=function(t,n){r.e.dispatch(new i.e(t,e._logEntryFor(t),n))},e._logEntryFor=function(t){if("PAGE_LIKE_CHUNK"!==t)return new a._LogEntry(e._moduleName,e._logFeatureMap.get(t),a._LogType.Event)},e._logError=function(t){a._TraceLogger.logError(e._logSource,t)},e._processLikeError=function(t){var n=t.name===c.default.likeLimitExceededError.name?l.a:l.n;s.e.showError(n,void 0,t),e._logError(t)},e._logSource=a._LogSource.create("SocialActionCreator"),e._moduleName="[SocialActionCreator]",e._logFeatureMap=new Map([["PAGE_LIKE","SPPageSocialPageLiked"],["PAGE_LIKE_CHUNK","SPPageSocialMorePageLikesLoaded"],["PAGE_UNLIKE","SPPageSocialPageUnliked"]]),e}();t.e=u},"lsr+":function(e,t,n){"use strict";n("jOlS").loadStyles(".t_j_ada2ac09{top:50px}.u_j_ada2ac09{margin:0 25px}.v_j_ada2ac09{display:block;margin:auto;text-align:center}.w_j_ada2ac09{margin:150px auto}.x_j_ada2ac09{max-width:230px}.y_j_ada2ac09{padding:10x}.z_j_ada2ac09{display:inline;height:32px;line-height:32px;-webkit-user-select:none;-ms-user-select:none;user-select:none}[dir=ltr] .z_j_ada2ac09{margin-left:-7px}[dir=rtl] .z_j_ada2ac09{margin-right:-7px}[dir=ltr] .z_j_ada2ac09{margin-right:15px}[dir=rtl] .z_j_ada2ac09{margin-left:15px}",!0),t.e={bookmarkPanel:"t_j_ada2ac09",bookmarkPanelContent:"u_j_ada2ac09",seeAllBookmarks:"v_j_ada2ac09",bookmarkPanelSpinner:"w_j_ada2ac09",bookmarkTooltip:"x_j_ada2ac09",bookmarkTooltipContent:"y_j_ada2ac09",link:"z_j_ada2ac09"}},qgIT:function(e){e.exports=JSON.parse('{"e":"Cliquez pour afficher l’évolution du nombre de vues de cette page.","t":"Barre Réseaux sociaux","s":"{0}, entrez pour taper un commentaire sur cette page","o":"Commentaire||{0} commentaire||{0} commentaires","c":"0||1||2-","d":"J’aime","u":"Je n’aime plus","l":"Ajouter une mention J’aime à cette page","f":"Supprimer la mention J’aime de cette page","p":"{0} vue||{0} vue||{0} vues","m":"0||1||2-","h":"{0} mentions J’aime||{0} mention J’aime||{0} mentions J’aime","b":"0||1||2-","_":"Fermer","g":"Afficher plus de mentions J’aime.","v":"Afficher plus","n":"Analyse des pages","a":"Appréciez-vous l’utilisation de l’analyse de page ?","i":"J’aime cette analyse de page","r":"Je n’aime plus cette analyse de page"}')},s5jy:function(e){var t=e.exports=JSON.parse('{"actionBookmark":"Enregistrer pour plus tard","actionBookmarkTooltip":"Enregistrer cet élément pour une utilisation ultérieure","actionBookmarkAriaLabel":"Enregistrer cet élément pour une utilisation ultérieure","ariaBookmarkRemoved":"La page a été supprimée des pages enregistrées pour plus tard","ariaIsBookmarked":"Enregistrée pour plus tard","bookmarkFailed":"Nous n’avons pas pu ajouter cet élément à vos éléments enregistrés. Veuillez réessayer plus tard.","bookmarkRemoveFailed":"Nous n’avons pas pu supprimer cet élément de vos éléments enregistrés. Veuillez réessayer plus tard.","bookmarksFetchFailed":"Nous n’avons pas pu récupérer vos éléments enregistrés. Veuillez réessayer plus tard.","closeTeachingBubbleAriaLabel":"Fermer la bulle de formation","panelCloseAriaLabel":"Fermer","isBookmarked":"Enregistrée pour plus tard","loadingRecentlySavedItems":"Chargement des éléments récemment enregistrés","removeBookmark":"Supprimer de vos éléments enregistrés","savedForLaterPanelTitle":"Éléments récemment enregistrés","seeAllSavedItems":"Afficher tous les éléments enregistrés","seeRecentlySavedItems":"Afficher les éléments récemment enregistrés","actionSeeBookmarkedItemsAriaLabel":"{0}, entrez pour afficher les éléments enregistrés récemment.","firstRunTooltip":"Cliquez sur Enregistré pour plus tard pour afficher les éléments enregistrés récemment"}');t.default=t},yLVF:function(e,t,n){"use strict";n.r(t),n("LuFS"),n("lpyS")}}]);