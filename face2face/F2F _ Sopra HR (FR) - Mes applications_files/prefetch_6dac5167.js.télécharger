(window.webpackJsonp_74586a1f_1f7a_4ff2_9a8b_e8e3c00056e7=window.webpackJsonp_74586a1f_1f7a_4ff2_9a8b_e8e3c00056e7||[]).push([["prefetch"],{"+XOu":function(e,t,r){"use strict";r.r(t),r.d(t,"spRequestDurationHeader",(function(){return n})),r.d(t,"spClientServiceRequestDurationHeader",(function(){return c})),r.d(t,"sharePointCorrelationHeader",(function(){return o})),r.d(t,"getNamedHeadersFromXhr",(function(){return i})),r.d(t,"getRequestDurationFromXhr",(function(){return a})),r.d(t,"getRequestDurationFromHeaders",(function(){return u}));var n="sprequestduration",c="spclientservicerequestduration",o="sprequestguid";function i(e,t){var r={};if(e.getAllResponseHeaders){var n=e.getAllResponseHeaders();t.forEach((function(t){e.getResponseHeader&&-1!==n.indexOf(t)&&(r[t]=e.getResponseHeader(t)||"")}))}return r}function a(e){var t=i(e,[n,c]);return t[n]||t[c]||void 0}function u(e){return e[n]||e[c]||""}},"/hiP":function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("k6ph"),c=r("x2tm");function o(e){return function(t){var r=t.prefetchTimeSinceOrigin||performance.now.bind(performance),n=r();return a(0,n,t,e,r).catch((function(c){return i(c)?a(1,n,t,e,r).catch((function(e){return function(e,t,r){if(i(e)){var n=e;throw n.tokenAttemptCount=t,n.tokenFetchDuration=r,n}throw e}(e,2,r()-n)})):Promise.reject(c)}))}}function i(e){return!!e&&(401===e.status||0===e.status)}function a(e,t,r,n,c){if(!("token"in r)&&!("tokenProvider"in r))return Promise.reject(new Error("Token or token provider must be specified."));var o=-1;return"token"in r&&function(e){return!!e.token}(r)?n(r.token)(r).then((function(e){return{tokenAttemptCount:0,tokenFetchDuration:0,xhr:e}})):r.tokenProvider({attempt:e}).then((function(e){return o=c()-t,n(e)(r)})).then((function(t){return{tokenAttemptCount:e+1,tokenFetchDuration:o,xhr:t}}))}function u(e,t){return Object(c.a)(t,Object(n.a)(o(e))(t))}},"0tYw":function(e,t,r){"use strict";function n(e){var t=null;return function(r){return t?t(r):e.then((function(e){return t=e,e(r)}))}}r.r(t),r.d(t,"createAsyncTokenProvider",(function(){return n})),r.d(t,"fetch",(function(){return c.a})),r.d(t,"fetchAcquireToken",(function(){return o.default})),r.d(t,"fetchAndParseSearchConfiguration",(function(){return h})),r.d(t,"fetchCustomVerticals",(function(){return l.a})),r.d(t,"fetcher",(function(){return p.a})),r.d(t,"fetchBingConsumer",(function(){return m.default})),r.d(t,"fetchFileShareConnectorSettings",(function(){return g})),r.d(t,"fetchHubSites",(function(){return O.default})),r.d(t,"fetchPersonalData",(function(){return y})),r.d(t,"fetchPersonalRankingContext",(function(){return I.default})),r.d(t,"fetchSearchCenterUrl",(function(){return C})),r.d(t,"fetchRawSearchCenterUrl",(function(){return x})),r.d(t,"fetchSearchConfiguration",(function(){return f.a})),r.d(t,"fetchTellMeSearchResults",(function(){return T.default})),r.d(t,"fetchParsedCustomVerticals",(function(){return s.default})),r.d(t,"fetchSearchConfigurationFromEcs",(function(){return E})),r.d(t,"fetchConfigFromEcsWithCacheAndMonitor",(function(){return A})),r.d(t,"fetchSpHomeNews",(function(){return L.fetchSpHomeNews})),r.d(t,"fetchSpHomePrefetch",(function(){return L.fetchSpHomePrefetch})),r.d(t,"fetchSiteNewsSuggestions",(function(){return V})),r.d(t,"fetchSiteActivities",(function(){return U.default})),r.d(t,"siteActivitiesCacheKeyExtractor",(function(){return U.cacheKeyExtractor})),r.d(t,"fetchSharePointDigest",(function(){return F.default})),r.d(t,"fetchSharePointDigestV2",(function(){return q})),r.d(t,"fetchSitesFromSubstrate",(function(){return K})),r.d(t,"cache",(function(){return z.cache})),r.d(t,"init",(function(){return z.init})),r.d(t,"puid",(function(){return z.puid})),r.d(t,"statusOk",(function(){return B.default})),r.d(t,"substrateIframeProxy",(function(){return J.substrateIframeProxy})),r.d(t,"toTokenDetail",(function(){return W.toTokenDetail})),r.d(t,"warmupMsb",(function(){return Q})),r.d(t,"resolveBingUrl",(function(){return Y})),r.d(t,"resolveLokiEnvironment",(function(){return ee.resolveLokiEnvironment})),r.d(t,"resolveSubstrateUrl",(function(){return te.resolveSubstrateUrl})),r.d(t,"warmupSubstrateSearch",(function(){return re.default})),r.d(t,"withBasicMonitor",(function(){return D.a})),r.d(t,"withMonitor",(function(){return ne.a})),r.d(t,"withImportMonitor",(function(){return ce.default})),r.d(t,"withPeriodicRefresh",(function(){return ae})),r.d(t,"withRefresh",(function(){return ie})),r.d(t,"getEcsIds",(function(){return ue.a})),r.d(t,"withCache",(function(){return R.a}));var c=r("DHVw"),o=r("MkXD"),i=r("sUnP"),a=r("vskH"),u=r("CZty"),s=r("ZHTy"),f=r("zLON"),d=r("msSD");function h(e){var t,r;Object(i.getQueryStringValue)("sid")&&(e.siteId=Object(i.getQueryStringValue)("sid")),e.siteId&&(e.siteId=e.siteId.toUpperCase());var n=null===(r=null===(t=e.additionalHeaders)||void 0===t?void 0:t[d.a.SearchComponent])||void 0===r?void 0:r.toLowerCase();return"serp"===n&&Object(s.createSearchConfigPromiseEntity)(e),Object(f.a)(e).then((function(e){var t=e.xhr,r=JSON.parse(t.responseText),c=null==r?void 0:r.ecsSettings;r.ecsSettings=Object(a.a)(Object(u.a)("ecsOverrides","wipeEcsConfig",c));var o=Object(s.getSearchConfigPromiseEntity)();return"serp"===n&&(r.verticalConfig?(null==o?void 0:o.promiseResolver)&&o.promiseResolver(r.verticalConfig):(null==o?void 0:o.promiseRejector)&&o.promiseRejector()),r})).catch((function(){var e,t=null===(e=Object(s.getSearchConfigPromiseEntity)())||void 0===e?void 0:e.promiseRejector;t&&t()}))}var l=r("e+qm"),p=r("/hiP"),m=r("n8Nd"),v=r("wuwP"),b=["AllVerticalContent","FilesVerticalContent"],g=Object(p.a)((function(e){return function(t){var r=t.endpoint;return Object(c.a)({url:"".concat(r,"/_api/web/AllProperties?$select=").concat(b.join(",")),method:"GET",headers:Object(v.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3})}}),{monitorName:"prefetchFileShareConnectorsInfo",cacheId:"fileshareconnectorsettings",cacheVersion:"0",cacheItemLifetime:216e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}}),O=r("TG2i");function j(e){return function(t){return(t.prefetchFetch||c.a)(e(t))}}var S,y=Object(p.a)((function(e){return j((function(t){return{url:t.url,method:"GET",headers:Object(v.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3}}))}),{monitorName:"fetchPersonalAccountName",cacheId:"personalaccountname",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}}}),I=r("OMji");function x(e){var t=e.siteRoot,r=e.tokenProvider;return w({siteRoot:t,tokenProvider:r}).then((function(e){if(e.cacheItemResolved&&S)return S;var t=JSON.parse(e.xhr.responseText),r=t&&t.d&&t.d.searchcenterurl||"";return S=r,r}))}var w=Object(p.a)((function(){return function(e){var t=e.siteRoot;return(0,e.tokenProvider)({attempt:0}).then((function(e){return Object(c.a)({url:"".concat(t,"/_api/search/searchcenterurl"),method:"GET",headers:Object(v.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3})}))}}),{monitorName:"fetchSearchCenterUrl",cacheId:"searchcenterurl",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}}}),C=function(e){return x({siteRoot:e.siteRoot,tokenProvider:e.tokenProvider}).then((function(e){return function(e){var t=e.lastIndexOf("/search/");if(t<0)return"";return e.substring(0,t+"/search/".length).replace(/\/$/,"")}(e)}))};var P,T=r("PWcX"),k=r("3UHF"),E=j((function(e){return e?{url:Object(u.b)(e),method:"GET"}:Object(k.a)("missing options for ECS call")})),D=r("uKfc"),R=r("k6ph"),A=Object(D.a)({monitorName:"searchConfigurationFromEcs",monitorType:"prefetch_request",successPropExtractor:function(e){return Object(u.c)(Object(u.d)(null==e?void 0:e.xhr.responseText,{disableUrlOverrides:!0}))},failurePropExtractor:function(e){return{errorCode:(null==e?void 0:e.status)||-1}}},Object(R.a)((P=E,function(e){return P(e).then((function(e){return{xhr:e}}))}))({cacheId:"searchConfigurationFromEcs",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return Object(v.d)(e,[])}}));var L=r("ZRn5");function H(e,t,r){return"".concat(r.sitePath,"/_api/search/query?QueryText='*'").concat(function(e){var t=e.departmentId,r=e.isHubSite;return"&QueryTemplate='({searchterms}) ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118*"+" AND PromotedState:2 AND ".concat((r&&t?M:N)(e),"'")}(r))+"&HitHighlightedProperties='Title'&StartRow=0&RowLimit=100"+"&Properties='ClientFunction:News,EnableMultiGeoSearch:".concat(e?"true":"false","'")+"&sortlist='LastModifiedTime:descending'&SelectProperties='ContentClass,ContentTypeId,DefaultEncodingURL,DocId,EditorOWSUSER,FileExtension,GeoLocationSource,LastModifiedTime,ModifiedBy,Path,SPWebUrl,SPSiteURL,SecondaryFileExtension,ServerRedirectedUrl,SiteId,Title,UniqueId,WebId'"+"&ClientType='".concat(t,"'&EnableQueryRules=false")}function N(e){var t=e.sitePath;return'Path:"'.concat(t,'"')}function M(e){var t=e.departmentId;return"(DepartmentId:".concat(t," OR DepartmentId:").concat(t.replace(/[{}]/g,""),")")}var V=Object(p.a)((function(e){return function(t){var r=t.clientId,n=t.site;return Object(c.a)({url:H(!0,r,n),method:"GET",headers:Object(v.a)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{})})}}),{monitorName:"sitenews-rawPrefetch",cacheId:"sitenews-rawPrefetch",cacheVersion:"0",cacheItemLifetime:9e5,cacheKeyExtractor:function(e){return{sitePath:e.site.sitePath}}}),U=r("zghH"),F=r("Y3nR"),G=!1,q=Object(p.a)((function(e){return function(t){var r=t.endpoint,n=t.overrideDigest;return n&&!G?(G=!0,new Promise((function(e){e({responseText:JSON.stringify({d:{GetContextWebInformation:{FormDigestValue:n}}})})}))):Object(c.a)({url:"".concat(r,"/_api/contextinfo"),method:"POST",headers:Object(v.a)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3})}}),{monitorName:"fetchSharepointDigest",cacheId:"fetchSharepointDigest",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:e.endpoint}}}),_=r("CVAo"),B=r("3WoE"),J=r("JCJM"),K=Object(p.a)((function(e){return function(t){var r=t.prefix,n=t.substrateUrl;return Object(J.substrateIframeProxy)(n).then((function(t){return t({action:"queryv2",token:e,prefix:r,cvid:Object(_.a)()}).then((function(e){if(!Object(B.default)(e.statusCode))throw{status:e.statusCode};return{status:e.statusCode,responseText:e.qfResponse}}))}))}}),{monitorName:"fetchSitesFromSubstrate",cacheId:"fetchSitesFromSubstrate",cacheVersion:"0",cacheItemLifetime:108e5,cacheKeyExtractor:function(e){e.token;var t=Object(v.d)(e,["token"]);return Object(v.a)({},t)}}),z=r("DeF7"),W=r("g1R2"),X="warmupMsb",Q=Object(p.a)((function(e){return function(t){var r=t.msbUrl,n=t.clientType;"https://business.bing.com"===r&&(r+="/work/api");var o="".concat(r,"/v3/user/init"),i={Authentication:e,clientContext:{clientType:n}};return Object(c.a)({url:o,method:"POST",body:JSON.stringify(i)})}}),{monitorName:X,cacheId:X,cacheVersion:"0",cacheItemLifetime:5e3,cacheKeyExtractor:function(e){e.token;var t=Object(v.d)(e,["token"]);return Object(v.a)({},t)}}),Z=r("KUM7");function $(e,t){switch(e){case"dev":return"https://localhost:18101/api";case"test":return"https://bingatwork.asgfalcon-test.io/api";case"prod":return t||"https://business.bing.com/api";case"prod_generic":return t||"https://business.bing.com/work/api";case"prod_gcc":return t||"https://usgov.business.bing.com/api";case"prod_gcch":return t||"https://usgovhigh.business.bing.com/api";case"dev_bing":return"https://localhost/work/api";case"staging_bing":return"https://www.staging-bing-int.com/work/api";default:return Object(Z.a)(e)}}function Y(e){switch(e){case"test":return $(e);case"gcc":return $("prod_gcc");case"trailblazer":return $("prod_gcch");default:return $("prod_generic")}}var ee=r("SGCm"),te=r("TCme"),re=r("KzqD"),ne=r("x2tm"),ce=r("9Q1t"),oe=r("DEsW");function ie(e,t){var r,n=null,c=!1,o=function(){return c||(c=!0,r=t({attempt:1}).then((function(e){return n=Object(W.toTokenDetail)(e),c=!1,n.token})).catch((function(e){throw c=!1,e}))),r};return function(r,c,i){void 0===i&&(i=!0);var a,u,s,f=i?(a="".concat(e,"_withRefresh"),u=performance.now(),(s=Object(oe.getDispatcher)()).dispatch({name:"generic_qos",nameDetail:a,timestamp:u,eventType:"QOSSTART"}),function(e,t,r){var n=performance.now();s.dispatch({name:"generic_qos",nameDetail:a,startTimestamp:u,totalTime:n-u,eventType:"QOSSTOP",result:e,properties:{customLogProps:JSON.stringify(t)},error:r})}):function(){};if(!t)return f("FAILURE",Object(v.a)({cacheItemResolved:!1,tokenProviderNull:!0},c)),Promise.reject("token provider is null");if(!n||!Object(W.isValid)(n)||r.attempt>0)return o().then((function(e){return f("SUCCESS",Object(v.a)({cacheItemResolved:!1,expires:n&&new Date(n.expEpoch),didRefresh:!0},c)),e})).catch((function(e){throw f("FAILURE",Object(v.a)({cacheItemResolved:!1,tokenProviderNull:!1},c)),e.reason||e}));var d=Object(W.isApproachingExpiration)(n);return d&&o(),f("SUCCESS",Object(v.a)({cacheItemResolved:!0,expires:n&&new Date(n.expEpoch),backgroundRefresh:d},c)),Promise.resolve(n.token)}}function ae(e,t,r){var n,c,o=0,i=0,a=ie(e,t);return function(e){return o++,c||(c=window.setInterval((function(){var e={invokedByPeriodicRefresh:!0,invocationCounter:++o};Date.now()-n>864e5||i>=5?(window.clearInterval(c),c=void 0,i=0):a({attempt:0},e,!1).then((function(e){return i=0})).catch((function(e){console.error(e),i++}))}),r||3e5)),n=Date.now(),a(e,{invokedByPeriodicRefresh:!1,invocationCounter:o},!0)}}var ue=r("cLGF")},"3UHF":function(e,t,r){"use strict";function n(e){throw new Error(e)}r.d(t,"a",(function(){return n}))},"3WoE":function(e,t,r){"use strict";function n(e){return e>=200&&e<=300||0===e}r.r(t),r.d(t,"default",(function(){return n}))},CVAo:function(e,t,r){"use strict";t.a=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},CZty:function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return h})),r.d(t,"a",(function(){return m}));var n=r("wuwP"),c=r("KUM7"),o=r("DEsW"),i=r("sUnP"),a=r("vskH"),u=r("LLyz"),s=r("cLGF"),f=function(e){var t=e.complianceEnvironment,r=e.clientWorkload,n=e.component,o=e.userId,i=e.tenantId,a=e.ring,u=e.isGuestUser,s=function(e){switch(e){case"GccHigh":return"config.ecs.gov.teams.microsoft.us";case"DoD":return"config.ecs.dod.teams.microsoft.us";case"AG08":return"config.ecs.teams.eaglex.ic.gov";case"AG09":return"config.ecs.teams.microsoft.scloud";case"Blackforest":case"Df":case"Gallatin":case"GccModerate":case"Msit":case"Unknown":case"Prod":return"ecs.office.com";default:return Object(c.b)(e,"ecs.office.com")}}(t),f=function(e){switch(e){case"Blackforest":return"BlackForest";case"GccModerate":return"Gcc";default:return e&&"Unknown"!==e?e:"Prod"}}(t);return"https://".concat(s,"/config/v1/LokiService/1.0.0.0?")+"agents=MicrosoftSearch&ecsserviceinformation=true"+"&ClientWorkload=".concat(r)+"&id=".concat(o)+"&TenantID=".concat(i)+"&ring=".concat(a)+"&ApEnvironment=".concat(f)+"&IsGuestUser=".concat(String(u))+(n?"&MsSearch_Component=".concat(n):"")};function d(e){var t={};if(e){var r=JSON.parse(e);if(r.ecsConfigIds&&r.ecsEtag){t.ecsConfigIds=Object(s.a)(r.ecsConfigIds)||"",t.ecsEtag=r.ecsEtag.replace(/"/g,"");var n={},c="searchux.".length;r.ecsSettings&&Object.keys(r.ecsSettings).filter((function(e){return"boolean"==typeof r.ecsSettings[e]&&"searchux."===e.substr(0,c)})).forEach((function(e){return n[e.substr(c)]=r.ecsSettings[e]})),t.ecsSettings=JSON.stringify(n)}}return t}function h(e,t){return e?JSON.stringify(function(e,t){var r,c;try{var o=Object(n.a)({disableUrlOverrides:!1},t).disableUrlOverrides,i=JSON.parse(e),s=null==i?void 0:i.MicrosoftSearch;!o&&(s=m("ecsSbOverrides","wipeSbEcsConfig",s)),s=function(e){var t=(c=e,l(c,"searchBoxPluginConfiguration.",(function(e,t){return{id:"searchux.searchBoxPlugin."+e.split(".")[1],position:v(t)}}))),r=function(e){return l(e,"suggestionProviderGroups.",(function(e,t){return{id:e.split(".")[1],optimalCount:t.optimalCount,maxCount:t.maxCount,component:t.component,ariaLabel:t.ariaLabel,heading:t.heading,providers:p(t)}}))}(e);var c;return Object(n.a)(Object(n.a)(Object(n.a)({},Object(a.a)(e)),{searchBoxPluginConfiguration:{plugins:t}}),{searchBoxSuggestionProviderConfiguration:{groups:r,streamPolicy:e["searchux.suggestionGroupStreamPolicy"]}})}(s);var f=null===(r=null==i?void 0:i.Headers)||void 0===r?void 0:r.ETag,d=[null===(c=null==i?void 0:i.ConfigIDs)||void 0===c?void 0:c.MicrosoftSearch];return{ecsSettings:s,ecsConfigIds:d,ecsEtag:f}}catch(e){Object(u.throwSafeToLogError)("Failed to parse ECS config")}}(e,t)):""}function l(e,t,r){return Object.keys(e).filter((function(r){return r.indexOf(t)>-1&&e[r]})).sort((function(t,r){return v(e[t])-v(e[r])})).map((function(t){try{return r(t,e[t])}catch(e){Object(o.getDispatcher)().dispatch({name:"generic_error",nameDetail:"ecsUtils.convertSettingsWithKeyToArray",eventType:"ERROR",detail:"Mapper failed on key: "+t})}})).filter((function(e){return e}))}function p(e){return l(e,"providers.",(function(e){return"searchux.suggestionProvider.provider."+e.split(".")[1]}))}function m(e,t,r){var c=Object(i.getQueryStringValue)(t);c&&"true"===c.toLowerCase()&&(r={});var o=decodeURIComponent(Object(i.getQueryStringValue)(e));return o?function e(t,r){if(!b(t))return t;var c=Object(n.a)({},t);b(r)&&Object.keys(r).forEach((function(n){b(r[n])?c[n]=n in t?e(t[n],r[n]):r[n]:c[n]=r[n]}));return c}(r,JSON.parse(o)):r}function v(e){var t;return null!==(t=e.position)&&void 0!==t?t:Number.MAX_VALUE}function b(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}},DHVw:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("wuwP"),c=r("3WoE");function o(e){return new Promise((function(t,r){var o=new(e.XMLHttpRequest||XMLHttpRequest);o.requestLogData=Object(n.a)({},e.requestLogData),o.open(e.method,e.url,!0),e.timeoutMs&&(o.timeout=e.timeoutMs),e.withCredentials&&(o.withCredentials=e.withCredentials);var i=e.headers||{};Object.keys(i).map((function(e){o.setRequestHeader(e,i[e])})),o.onload=function(){4===o.readyState&&(Object(c.default)(o.status)?t(o):r(o))},o.onerror=function(){r(o)},o.ontimeout=function(){r(o)};var a=e.body||null;o.send(a)}))}},DeF7:function(e,t,r){"use strict";r.r(t),r.d(t,"init",(function(){return i})),r.d(t,"puid",(function(){return a})),r.d(t,"cache",(function(){return u}));var n,c=r("3UHF"),o=r("xn41");function i(e){n&&Object(c.a)("Can not set initial state more than once.")||(e.cache.participants.push(o.a),n=e)}r.d(t,"BUILD_VERSION",(function(){return o.a}));var a=s("puid"),u=s("cache");function s(e){return function(){return n&&n[e]||Object(c.a)("Trying to get ".concat(e," before it is set."))}}},JCJM:function(e,t,r){"use strict";r.r(t),r.d(t,"substrateIframeProxy",(function(){return m})),r.d(t,"getIframeProxy",(function(){return b})),r.d(t,"sendSubstrateRequest",(function(){return O})),r.d(t,"parseDiagnostics",(function(){return S})),r.d(t,"parser",(function(){return y}));var n=r("wuwP"),c=r("CVAo");function o(e,t){var r=i();return{iframe:r,initialize:function(){return document.body.contains(r)||(r.src=e,r.style.display="none",document.body.appendChild(r)),r},postMessage:function(n,c,o){var i=function(e,n){return a(r.contentWindow,t,e,n)}(c,o);return r.contentWindow&&r.contentWindow.postMessage(n,e),i}}}var i=function(){return document.createElement("iframe")},a=function(e,t,r,n){return new Promise((function(c,o){return u((function i(a){if(a.source===e&&a.origin===t){var u=void 0,f=!1;try{u=r(a)}catch(e){return s(i),void o(e)}try{f=n(u,a)}catch(e){return s(i),void o(e)}f&&(s(i),c(u))}}))}))},u=function(e){return addEventListener("message",e,!1)},s=function(e){return removeEventListener("message",e,!1)},f=r("LLyz");var d=r("qBZW"),h={},l={},p={};function m(e){return void 0===e&&(e="https://substrate.office.com"),e=Object(d.a)(e),void 0===l[e]&&(l[e]=v(e).ready),l[e].then((function(){return p[e]=!0,function(t){return j(t,e)}}))}function v(e){return h[e]?h[e]:b((t=window).mssearchux&&t.mssearchux.reuseIframe||!1,e+"/search/api/v2/resources",e);var t}function b(e,t,r){if(e){var n=document.getElementById("ms-searchux-3s-proxy"),c=function(e,t){if(e&&e.src===t&&e.ready&&e.postMessage)return{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}};return null}(n,t);h[r]=c||g(!n,t,r)}else h[r]=g(!1,t,r);return h[r]}function g(e,t,r){var c=o(t,r),i=c.initialize(),u=a(i.contentWindow,r,(function(e){return e.data}),(function(e){return"loaded"===e}));return e&&(i.id="ms-searchux-3s-proxy",i.postMessage=c.postMessage,i.ready=u),Object(n.a)(Object(n.a)({},c),{ready:u})}var O=function(e,t){return void 0===t&&(t="https://substrate.office.com"),t=Object(d.a)(t),p[t]?j(e,t):m(t).then((function(t){return t(e)}))};function j(e,t){var r=Object(c.a)(),n=e.action,o=e.token,i=e.prefix,a=e.cvid,u=e.additionalInfo,s=e.headers;return v(t).postMessage(JSON.stringify({requestId:r,action:n,token:o,prefix:i,cvid:a,additionalInfo:u,headers:s}),y,(function(e){return e.requestId===r}))}function S(e){var t=JSON.parse(e)[0];t.name;return Object(n.d)(t,["name"])}function y(e){try{return JSON.parse(e.data)}catch(e){return Object(f.throwSafeToLogError)("Failed to parse substrate API JSON response.")}}},KUM7:function(e,t,r){"use strict";function n(e){return e}function c(e,t){return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return c}))},KzqD:function(e,t,r){"use strict";r.r(t);var n=r("wuwP"),c=r("CVAo"),o=r("/hiP"),i=r("3WoE"),a=r("JCJM");function u(e){return e.getResponseHeader?{correlationID:e.getResponseHeader("request-id")||"",properties:JSON.stringify({serverLatency:e.getResponseHeader("x-end2endlatencyms")||"",diagnosticsDuration:e.getResponseHeader("Substrate-DiagnosticsDuration")||""})}:{}}t.default=Object(o.a)((function(e){return function(t){var r=t.queryStringParameters,o=t.headers,u=t.postAction,s=void 0===u?"init":u,f=t.cvid,d=t.makeSubstrateRequest,h=t.substrateUrl,l=t.useNoBearerAuth,p=r?Object(n.a)({},r):{},m={action:s,token:e,prefix:void 0,cvid:f||Object(c.a)(),additionalInfo:Object(n.a)(Object(n.a)({},p),{diagnostics:"1"}),headers:o};return(d?d(Object(n.a)(Object(n.a)({},m),{useNoBearerAuth:l})):Object(a.sendSubstrateRequest)(m,h)).then((function(e){var t={};try{t=JSON.parse(e.responseHeaders)}catch(e){}if(e.diagnostics)try{var r=Object(a.parseDiagnostics)(e.diagnostics);r&&r.duration&&(t["Substrate-DiagnosticsDuration"]=""+r.duration)}catch(e){}var n={status:e.statusCode,responseText:e.qfResponse,getResponseHeader:function(e){return t[e]}};if(!Object(i.default)(e.statusCode))throw n;return n}))}}),{monitorName:"warmupSubstrateSearch",cacheId:"warmupSubstrateSearch",cacheVersion:"0",cacheItemLifetime:5e3,additionalSuccessPropsExtractor:u,additionalFailurePropsExtractor:u,cacheKeyExtractor:function(e){e.token,e.makeSubstrateRequest,e.cvid;var t=Object(n.d)(e,["token","makeSubstrateRequest","cvid"]);return Object(n.a)({},t)}})},LLyz:function(e,t,r){"use strict";function n(e,t,r){var n;return t&&t.safeToLog?(n=new Error("".concat(e," ").concat(t.message))).innerError=t:n=new Error(e),n.safeToLog=!0,n.logProperties=r,Object.freeze(n),n}function c(e,t,r){throw n(e,t,r)}r.r(t),r.d(t,"default",(function(){return n})),r.d(t,"throwSafeToLogError",(function(){return c}))},MkXD:function(e,t,r){"use strict";r.r(t);var n=r("wuwP"),c=r("DHVw"),o=r("k6ph"),i=r("x2tm"),a=["https://substrate.office.com","https://loki.delve.office.com","https://www.bing.com","https://partner.outlook.cn/search","https://outlook.office365.com/search"];t.default=Object(i.a)({monitorName:"prefetchAcquireToken",additionalSuccessPropsExtractor:function(e){var t=e&&e.responseText&&JSON.parse(e.responseText);return Object(n.a)({},t&&{resource:u(t.resource)?t.resource:"",expires_on:t.expires_on})},additionalFailurePropsExtractor:function(e){var t,r,n;try{n=e&&e.responseText&&JSON.parse(e.responseText)}catch(e){}var c=null===(t=null==n?void 0:n.error)||void 0===t?void 0:t.code;return{resource:null===(r=null==e?void 0:e.requestLogData)||void 0===r?void 0:r.resource,properties:JSON.stringify({responseErrorCode:isNaN(c)?"0":c})}}},Object(o.a)((function(e){var t=e.digest,r=e.portalUrl,o=e.resourceUrl,i={resource:o};return e.useSTI&&(i.tokenType="STI"),Object(c.a)(Object(n.a)({url:"".concat(r,"/_api/SP.OAuth.Token/Acquire"),method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","Odata-Version":"4.0",Accept:"application/json;odata.metadata=minimal","X-RequestDigest":t},body:JSON.stringify(i),timeoutMs:7e3},u(o)&&{requestLogData:{resource:o}})).then((function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1,cacheItemType:null}}))}))({cacheId:"psst",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{resource:e.resourceUrl}}}));var u=function(e){return-1!==a.indexOf(e)}},NShO:function(e,t,r){"use strict";r.d(t,"f",(function(){return h})),r.d(t,"e",(function(){return l})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return m})),r.d(t,"d",(function(){return v})),r.d(t,"c",(function(){return b}));var n,c=r("wuwP"),o=r("KUM7");function i(e){switch(e){case"Df":return n.Dogfood;case"Msit":return n.MSIT;case"Blackforest":return n.Blackforest;case"GccModerate":return n.GccModerate;case"GccHigh":return n.GccHigh;case"DoD":return n.DOD;case"Gallatin":return n.Gallatin;case"Prod":return n.TopLevel;case"AG08":return n.AG08;case"AG09":return n.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(o.a)(e)}}!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(n||(n={}));var a=r("sUnP"),u=r("msSD"),s=r("xn41");function f(e){return"string"==typeof e?e.replace(/\/+$/,""):e}var d=function(e){return"".concat(f(e),"/api/v1/search/configuration")};function h(e,t,r){void 0===t&&(t="");var n=function(e,t){var r=i(e);return r===e&&(r=i("Prod")),t(r)}(e,r);return"".concat(n).concat(t?"/".concat(t):"")}function l(e,t){return void 0===t&&(t=""),h(e,t,d)}function p(e,t,r){var n;return Object(c.a)(Object(c.a)(Object(c.a)({},t),((n={"X-MSSearchVersion":s.a,"X-ClientFeature":"Search"})["X-ClientType"]=e,n)),r?{Authorization:"Bearer ".concat(r)}:{})}function m(e){return"".concat(f(e)||"","/api/v1/search/configuration/verticals")}function v(e,t){void 0===t&&(t=!1);var r={};return e&&(r.siteCollectionId=e.toUpperCase()),t&&(r.verticalState="all"),Object(a.getQueryStringValue)("ecsOverrides")&&(r.ecsOverrides=Object(a.getQueryStringValue)("ecsOverrides")),r}function b(){var e;return"true"===Object(a.getQueryStringValue)("cacheClear")?((e={})[u.a.VerticalsCacheClear]="uncached",e):{}}},OMji:function(e,t,r){"use strict";r.r(t);var n=r("wuwP"),c=r("DHVw"),o=r("/hiP");t.default=Object(o.a)((function(e){return function(t){var r=t.endpoint,o=t.clientId;return Object(c.a)({url:"".concat(r,"?querytext='*'&ClientType='").concat(o,"'")+"&Properties='ClientFunction:PersonalRelevanceContext,FetchPersonalRelevanceContext:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=ms-oil-datasource-spopersonalcontext",method:"GET",headers:Object(n.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:7e3})}}),{monitorName:"prefetchPersonalRelevance",cacheId:"prctx",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}}})},PWcX:function(e,t,r){"use strict";r.r(t);var n=r("DHVw"),c=r("k6ph"),o=r("x2tm");t.default=function(e){return Object(o.a)({monitorName:"tell-me-search-service-prefetch"},Object(c.a)((function(t){var r=t.url;return Object(n.a)({url:r,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Office-Application":e.application,"X-Office-Platform":"Web","X-TellMe-SuggestionTypes":e.searchTypes.join(),"X-TellMe-Culture":e.marketValue},body:JSON.stringify({Query:e.searchText,TemplateInfo:{Application:e.templateTypes.join(),MaxTemplate:e.numberOfResultsToFetch}})}).then((function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}}))}))({cacheId:"tell-me-search-service-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)}},SGCm:function(e,t,r){"use strict";r.r(t),r.d(t,"resolveLokiEnvironment",(function(){return c}));var n=r("KUM7");function c(e){switch(e){case"o365test":case"onebox":case"edog":case"spdf":case"test":return"Df";case"prodbubble":return"Msit";case"":case"prod":return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09";default:return Object(n.b)(e,"Prod")}}},TCme:function(e,t,r){"use strict";r.r(t),r.d(t,"resolveSubstrateUrl",(function(){return c}));var n=r("KUM7");function c(e){switch(e){case"Blackforest":return"https://substrate.office.de";case"GccHigh":return"https://substrate.office365.us";case"DoD":return"https://substrate-dod.office365.us";case"Gallatin":return"https://partner.outlook.cn";case"AG08":return"https://substrate.exo.eaglex.ic.gov";case"AG09":return"https://substrate.exo.microsoft.scloud";case"Df":case"Msit":case"Prod":case"GccModerate":case"Unknown":return"https://substrate.office.com";default:return Object(n.b)(e,"https://substrate.office.com")}}},TG2i:function(e,t,r){"use strict";r.r(t),r.d(t,"cacheId",(function(){return i}));var n=r("wuwP"),c=r("DHVw"),o=r("/hiP"),i="spohubsitesinfo";t.default=Object(o.a)((function(e){return function(t){var r=t.clientId,o=t.endpoint;return Object(c.a)({url:"".concat(o,"/_api/search/query?querytext='IsHubSite=1%20contentclass:STS_Site'")+"&selectproperties='DepartmentId,Title'&rowlimit=1000&ClientType='".concat(r,"'")+"&Properties='ClientFunction:SpoHubSitesInfo,FetchSpoHubSitesInfo:true,EnableDynamicGroups:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=spohubsitesinfo",method:"GET",headers:Object(n.a)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3})}}),{monitorName:"prefetchSpoHubSitesInfo",cacheId:i,cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}})},Y3nR:function(e,t,r){"use strict";r.r(t);var n=r("DHVw"),c=r("k6ph"),o=r("x2tm");t.default=function(e){var t=e.endpoint,r=e.forceDigestRefresh;return Object(o.a)({monitorName:"prefetchSharepointDigest"},Object(c.a)((function(e){var t=e.endpoint;return Object(n.a)({url:"".concat(t,"/_api/contextinfo"),method:"POST",headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},timeoutMs:5e3}).then((function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}}))}))({cacheId:"pspd",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:"".concat(e.endpoint,"/_api/contextinfo")}},forceRefresh:r}))({endpoint:t,forceDigestRefresh:r})}},ZHTy:function(e,t,r){"use strict";r.r(t),r.d(t,"getSearchConfigScope",(function(){return s})),r.d(t,"getSearchConfigPromise",(function(){return f})),r.d(t,"getSearchConfigPromiseEntity",(function(){return d})),r.d(t,"createSearchConfigPromiseEntity",(function(){return h})),r.d(t,"default",(function(){return l}));var n,c=r("wuwP"),o=r("LLyz"),i=r("e+qm"),a=r("zLON"),u=r("NShO");function s(){return n&&n.option&&n.option.siteId||""}function f(){return n||h(),n?n.promiseObj:Promise.resolve([])}function d(){return n||h(),n}function h(e){if(!n||!n.isPending||n.isRejected){n={};var t=new Promise((function(e,t){n.promiseResolver=function(t){n.isPending=!1,e(t)},n.promiseRejector=function(){n.isRejected=!0,n.isPending=!1,t()}}));n.promiseObj=t,n.isRejected=!1,t.catch((function(){}))}n.isPending=!0,e&&(n.option=e)}function l(e){var t,r,f,d=s();if(n&&(!e.scope&&!d||(null===(r=null===(t=e.scope)||void 0===t?void 0:t.siteId)||void 0===r?void 0:r.toUpperCase())===d.toUpperCase())&&!n.isRejected){var l=n.option;return h(l),Object(a.a)(l).then((function(e){var t,r,c=e.xhr;if(c.responseText){var o=JSON.parse(c.responseText).verticalConfig;null===(t=n.promiseResolver)||void 0===t||t.call(n,o)}else null===(r=n.promiseRejector)||void 0===r||r.call(n)})).catch((function(e){var t;console.error(e),null===(t=n.promiseRejector)||void 0===t||t.call(n,e),Object(o.throwSafeToLogError)("CUSTOM_VERTICAL_FETCH_FAILED")})),n.promiseObj}var p=e.lokiUrl,m=null===(f=null==n?void 0:n.option)||void 0===f?void 0:f.environment;return("Df"===m||"Msit"===m&&-1!==(null==p?void 0:p.toLowerCase().indexOf("df")))&&(p=Object(u.f)(m,n.option.culture,(function(e){return e}))),Object(i.a)(Object(c.a)(Object(c.a)({},e),{lokiUrl:p})).then((function(e){var t=e.xhr;return t.responseText?JSON.parse(t.responseText):[]})).catch((function(e){console.error(e),Object(o.throwSafeToLogError)("CUSTOM_VERTICAL_FETCH_FAILED")}))}},ZRn5:function(e,t,r){"use strict";r.r(t),r.d(t,"fetchSpHomePrefetch",(function(){return u})),r.d(t,"fetchSpHomeNews",(function(){return s}));var n=r("wuwP"),c=r("DHVw"),o=r("/hiP");var i,a=(i=function(e){return function(t){var r=t.clientId,o=t.fetcher,i=(0,t.requestDataProvider)(),a=i.endpoint,u=i.context,s=i.microserviceFlights,f={url:a,method:"GET",headers:Object(n.a)(Object(n.a)({Accept:"application/json;odata=verbose","SPHome-ClientType":r,"SPHome-ApiContext":JSON.stringify(u)},e?{Authorization:"Bearer ".concat(e)}:{}),s&&{"SPHome-MicroserviceFlights":s.join(";")})};return o?o(a,f).then((function(e){return e.json()})).then((function(e){return{responseText:JSON.stringify(e)}})):Object(c.a)(f)}},function(e){return Object(o.a)(i,{monitorName:e,cacheId:e,cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(){return{}}})}),u=a("sphome-rawsprefetch"),s=a("sphome-rawnews")},cLGF:function(e,t,r){"use strict";function n(e){return e?e.filter((function(e){return e.indexOf("31828")>-1})).join()||e.join():void 0}r.d(t,"a",(function(){return n}))},"e+qm":function(e,t,r){"use strict";var n=r("wuwP"),c=r("sUnP"),o=r("DHVw"),i=r("/hiP"),a=r("NShO");t.a=Object(i.a)((function(e){return function(t){var r=t.lokiUrl,i=t.clientType,u=t.scope,s=t.previewDisabledVerticals,f=t.useSimpleRequest,d=void 0!==f&&f,h=Object(a.a)(i,Object(a.c)(),e),l=u&&u.siteId?u.siteId:"";return d?Object(o.a)({url:Object(c.constructUrl)(Object(a.b)(r),Object(n.a)(Object(n.a)({},Object(a.d)(l,s)),{ConvertGetPost:"true"})),method:"POST",body:JSON.stringify(h)}):Object(o.a)({url:Object(c.constructUrl)(Object(a.b)(r),Object(a.d)(l,s)),method:"GET",headers:h})}}),{monitorName:"customVerticals",cacheId:"customVerticals",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{url:e.lokiUrl,showDisabled:e.previewDisabledVerticals,clientType:e.clientType,scope:e.scope&&e.scope.siteId&&e.scope.siteId.toUpperCase()||null}},additionalSuccessPropsExtractor:function(){return{cacheClear:Object(c.getQueryStringValue)("cacheClear")}},forceRefresh:function(){return"true"===Object(c.getQueryStringValue)("cacheClear")}})},g1R2:function(e,t,r){"use strict";r.r(t),r.d(t,"toTokenDetail",(function(){return c})),r.d(t,"isApproachingExpiration",(function(){return o})),r.d(t,"isValid",(function(){return i}));function n(e){var t=(e=e.trim()).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^\-_a-zA-Z0-9]/.test(e))&&function(e){throw new Error(e).name="InvalidCharacterError",new Error(e)}("Invalid character: the string to be decoded is not correctly encoded.");for(var r,n=0,c=0,o="",i=-1;++i<t;)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(e.charAt(i)),c=n%4?64*c+r:r,n++%4&&(o+=String.fromCharCode(255&c>>(-2*n&6)));return o}function c(e){if("object"==typeof e)return{token:e.token,expEpoch:1e3*e.expiry};var t=Number.MAX_VALUE,r=e&&e.split(".");if(r&&3===r.length){var c=JSON.parse(n(r[1]));c&&c.exp&&(t=1e3*c.exp)}return{token:e,expEpoch:t}}function o(e){if(!i(e))return!1;return Date.now()>e.expEpoch-24e4}function i(e){return!!e&&!(e.expEpoch-Date.now()<12e4)}},k6ph:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,c=r("wuwP"),o=r("DEsW"),i=r("3UHF"),a=!1,u=!1;function s(e,t,r){var n;h(r);var c=f();try{var i=c.getItem(e);if(!i)return null;n=JSON.parse(i)}catch(e){return!a&&Object(o.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",detail:"Failed to read from storage."}),a=!0,null}return n?n.cacheVersion!==t?(c.removeItem(e),null):n.puid&&n.puid===r?n:(c.removeItem(e),!!0&&Object(o.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",detail:"Invalid puid detected."}),null):null}var f=function(){return n||(n={getItem:function(e){return sessionStorage.getItem(d(e))},removeItem:function(e){return sessionStorage.removeItem(d(e))},setItem:function(e,t){return sessionStorage.setItem(d(e),t)}})};function d(e){return"mssearchux-cache-".concat(e)}function h(e){!e&&Object(i.a)("Puid not set.")}function l(e,t,r){var n=s(e,t,r);if(!n)return null;var c=n.cacheItems;return Object.keys(c).reduce((function(e,t){return e[t]={value:Promise.resolve({xhr:{responseText:c[t].value,status:c[t].status||0}}),expiryTime:c[t].expiryTime,cacheItemType:"storage",cacheItemResolved:!0},e}),{})}function p(e,t){return e.cacheItems[t]=null}function m(e,t,r,n,i){var a=t.cacheId,d=t.cacheVersion,l=t.cacheItemLifetime;h(r);var m=e.cacheItems,b=v(m,i,{value:n,expiryTime:Date.now()+l,cacheItemType:"memory",cacheItemResolved:!1});return n.then((function(e){return v(m,i,Object(c.a)(Object(c.a)({},b),{cacheItemResolved:!0})),function(e,t,r,n,c,i,a){h(r);var d=s(e,t,r)||{cacheCreationTime:Date.now(),cacheVersion:t,puid:r,cacheItems:{}};d.cacheItems[n]={value:c,expiryTime:i,status:a};try{f().setItem(e,JSON.stringify(d))}catch(t){!u&&Object(o.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",nameDetail:e,detail:"Failed to write to session storage."}),u=!0}}(a,d,r,i,e.xhr.responseText,b.expiryTime,e.xhr.status),Object(c.a)(Object(c.a)({},e),{cacheItemResolved:!1,cacheItemType:null,expiryTime:b.expiryTime})}),(function(t){throw p(e,i),t}))}var v=function(e,t,r){return e[t]=r};function b(e,t){var r=t.cacheId,n=t.cacheVersion,o=t.cacheItemLifetime,i=t.userInfoPuid;return{operation:function(t,a,u){var s=function(e,t,r,n){h(n);var c=e[t];return c&&c.puid!==n&&(c=null),c||(e[t]={puid:n,cacheItems:l(t,r,n)||{}})}(e,r,n,i);return"setItem"!==t&&function(e,t){var r=e.cacheItems[t];if(r){if(Date.now()<r.expiryTime)return r.value.then((function(e){return Object(c.a)(Object(c.a)({},e),{cacheItemType:r.cacheItemType,cacheItemResolved:r.cacheItemResolved,expiryTime:r.expiryTime})}));p(e,t)}return null}(s,a)||m(s,{cacheId:r,cacheVersion:n,cacheItemLifetime:o},i,u(),a)}}}function g(e){return"object"==typeof e&&null!==e}var O=r("DeF7"),j=r("xn41");function S(e){return function(t){var r=t.cacheId,n=t.cacheVersion,c=t.cacheItemLifetime,o=t.cacheKeyExtractor,i=t.forceRefresh;return function(t){var a=t.prefetchCacheCollection||I,u=function(e){if(!g(e))throw new Error("Key argument must be an object.");for(var t=Object.keys(e).sort(),r=t.length,n=[],c=0;c<r;c++){var o=t[c],i=e[o];void 0===i||g(i)||"function"==typeof i||n.push(o+":"+i)}return n.join(",")}(o(function(e){return Object.keys(e).reduce((function(t,r){return r.length>"prefetch".length&&0===r.indexOf("prefetch")||(t[r]=e[r]),t}),{})}(t))||{}),s=(null==i?void 0:i())?"setItem":"getItem";return a.bind({cacheConsumer:y,cacheId:r,cacheVersion:n,cacheItemLifetime:c,userInfoPuid:t.prefetchUserInfoPuid||Object(O.puid)()}).operation(s,u,(function(){return e(t)}))}}}var y={packageName:"@1js/search-prefetch",packageVersion:j.a},I={bind:function(e){return b(Object(O.cache)().caches,e)}}},msSD:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.SearchComponent="X-MSSearchComponent",e.SearchScenario="X-MSSearchScenario",e.VerticalsCacheClear="X-Cache-Mode"}(n||(n={}))},n8Nd:function(e,t,r){"use strict";r.r(t);var n=r("DHVw"),c=r("k6ph"),o=r("x2tm");t.default=function(e){return Object(o.a)({monitorName:"bing-consumer-prefetch"},Object(c.a)((function(e){var t=e.url;return Object(n.a)({url:t,method:"GET",withCredentials:!0}).then((function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}}))}))({cacheId:"bing-consumer-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)}},qBZW:function(e,t,r){"use strict";function n(e){return function(e){return!!e&&(0===e.toLocaleLowerCase().indexOf("http://")||0===e.toLocaleLowerCase().indexOf("https://"))}(e)?e:"https://".concat(e)}r.d(t,"a",(function(){return n}))},sUnP:function(e,t,r){"use strict";function n(e){var t=self&&self.location&&(self.location.search||self.location.hash)||"";return decodeURIComponent(t.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}function c(e,t){var r=e,n=Object.keys(t);return n.length&&(r+="?",r+=n.map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&")),r}r.r(t),r.d(t,"getQueryStringValue",(function(){return n})),r.d(t,"constructUrl",(function(){return c}))},vskH:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));function n(e){var t={},r={};for(var n in e)if(e.hasOwnProperty(n))if(0===n.indexOf("searchux.killSwitches.")){var c=n.slice("searchux.killSwitches.".length),o=Boolean(e[n]);r[c]=o}else t[n]=e[n];return t["searchux.killSwitches"]=r,t}},x2tm:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("wuwP"),c=r("+XOu"),o=r("uKfc");function i(e,t){var r=e.monitorName,c=e.monitorType,i=void 0===c?"prefetch_request":c,u=e.additionalSuccessPropsExtractor,s=e.additionalFailurePropsExtractor;return Object(o.a)({monitorName:r,monitorType:i,successPropExtractor:function(e){var t=e.xhr,r=e.tokenAttemptCount,c=e.tokenFetchDuration,o=e.cacheItemResolved,i=e.cacheItemType;return Object(n.a)(Object(n.a)(Object(n.a)(Object(n.a)({},a(t)),r?{tokenAttemptCount:r,tokenFetchDuration:Math.round(c)}:{}),{cacheItemResolved:o,cacheItemType:i}),null==u?void 0:u(t))},failurePropExtractor:function(e){var t;return Object(n.a)(Object(n.a)(Object(n.a)({},null==s?void 0:s(e)),a(e)),{errorCode:null===(t=e.status)||void 0===t?void 0:t.toString()})}},(function(e){return void 0===e?Promise.reject("undefined options"):t(e)}))}function a(e){if(!e||!e.getAllResponseHeaders)return{};var t=Object(c.getNamedHeadersFromXhr)(e,[c.spRequestDurationHeader,c.spClientServiceRequestDurationHeader,c.sharePointCorrelationHeader]),r={};return r[c.sharePointCorrelationHeader]=t[c.sharePointCorrelationHeader],r[c.spRequestDurationHeader]=t[c.spRequestDurationHeader]||t[c.spClientServiceRequestDurationHeader]||void 0,r}},xn41:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="1.20220926.2.0"},zLON:function(e,t,r){"use strict";var n=r("wuwP"),c=r("sUnP"),o=r("CZty"),i=r("DHVw"),a=r("/hiP"),u=r("NShO");t.a=Object(a.a)((function(e){return function(t){var r=t.clientType,o=t.environment,a=t.culture,s=t.additionalHeaders,f=t.siteId,d=void 0===f?"":f,h=t.useSimpleRequest,l=void 0!==h&&h,p=Object(u.a)(r,Object(n.a)(Object(n.a)({},s),Object(u.c)()),e);return l?Object(i.a)({url:Object(c.constructUrl)(Object(u.e)(o,a),Object(n.a)(Object(n.a)({},Object(u.d)(d,!1)),{ConvertGetPost:"true"})),method:"POST",body:JSON.stringify(p)}):Object(i.a)({url:Object(c.constructUrl)(Object(u.e)(o,a),Object(u.d)(d,!1)),method:"GET",headers:p})}}),{monitorName:"searchConfiguration",cacheId:"searchConfiguration",cacheVersion:"0",cacheItemLifetime:6e5,cacheKeyExtractor:function(e){e.token;var t=Object(n.d)(e,["token"]),r=t.additionalHeaders&&t.additionalHeaders["X-MSSearchScenario"]||"";return Object(n.a)(Object(n.a)({},t),{msSearchScenario:r})},additionalSuccessPropsExtractor:function(e){return Object(n.a)(Object(n.a)({},Object(o.c)(e.responseText)),{cacheClear:Object(c.getQueryStringValue)("cacheClear")})},forceRefresh:function(){return"true"===Object(c.getQueryStringValue)("cacheClear")}})},zghH:function(e,t,r){"use strict";r.r(t),r.d(t,"cacheKeyExtractor",(function(){return i}));var n=r("wuwP"),c=r("DHVw"),o=r("/hiP");function i(e){return{scope:e&&e.map((function(e){return e&&e.siteId&&e.siteId.toLowerCase()})).join(",")||""}}t.default=Object(o.a)((function(e){return function(t){var r=t.clientId,o=t.requestDataProvider,i=t.sites,a=o(),u=a.endpoint,s=a.microserviceFlights,f={url:u,method:"POST",headers:Object(n.a)(Object(n.a)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","SPHome-ClientType":r},e?{Authorization:"Bearer ".concat(e)}:{}),s&&{"SPHome-MicroserviceFlights":s.join(";")}),body:JSON.stringify(i.slice(0,30).map((function(e){return{IndexId:e.id,SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"}})))};return Object(c.a)(f)}}),{monitorName:"site-activities-rawsprefetch",cacheId:"site-activities-rawsprefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return i(e.sites.slice(0,30))}})}}]);