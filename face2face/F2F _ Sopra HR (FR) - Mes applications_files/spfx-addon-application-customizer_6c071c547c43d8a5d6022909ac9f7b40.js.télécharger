define("cfd56f9f-781f-4fe3-8cc9-216e78b01234_0.0.1",["@microsoft/sp-application-base","@microsoft/decorators","jquery"],function(e,t,r){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="y2hV")}({"08ZC":function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return i});const i=void 0===e?window:e}).call(this,r("yLpj"))},GPet:function(t,r){t.exports=e},wxtz:function(e,r){e.exports=t},xeH2:function(e,t){e.exports=r},y2hV:function(e,t,r){"use strict";r.r(t);var i=r("wxtz"),n=r("GPet");function o(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function s(e,t,r,i){return new(r||(r=Promise))(function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})}Object.create;Object.create;function a(e,t,...r){return function(){t.apply(e,r)}}function l(e,t,r){let i=new Date(e.toString());switch(t.toLowerCase()){case"year":i.setFullYear(i.getFullYear()+r);break;case"quarter":i.setMonth(i.getMonth()+3*r);break;case"month":i.setMonth(i.getMonth()+r);break;case"week":i.setDate(i.getDate()+7*r);break;case"day":i.setDate(i.getDate()+r);break;case"hour":i.setTime(i.getTime()+36e5*r);break;case"minute":i.setTime(i.getTime()+6e4*r);break;case"second":i.setTime(i.getTime()+1e3*r);break;default:i=void 0}return i}function u(...e){return e.filter(e=>!f(e)).map(e=>e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")).join("/").replace(/\\/g,"/")}function c(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)})}function d(e){return"function"==typeof e}function h(e){return null!=e}function p(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function g(e,t,r=!1,i=(()=>!0)){if(!h(t))return e;const n=r?(e,t)=>!(t in e):()=>!0;return Object.getOwnPropertyNames(t).filter(t=>n(e,t)&&i(t)).reduce((e,r)=>(e[r]=t[r],e),e)}function y(e){return/^https?:\/\/|^\/\//i.test(e)}function f(e){return null==e||e.length<1}function m(e){return JSON.stringify(e)}function v(e,t){return Object.hasOwnProperty.call(e,t)}const S=d(Object.entries)?Object.entries:e=>Object.keys(e).map(t=>[t,e[t]]);const b=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext","ie11"],P=[];class I{constructor(e=new Map){this._v=e;const t=(e,t)=>{this._v.has(e)||this._v.set(e,t)};t(b[0],"session"),t(b[1],60),t(b[2],!1),t(b[3],!1),t(b[4],750),t(b[5],null),t(b[6],!1),P.forEach(e=>e(this))}assign(e){var t;this._v=function(e,...t){for(let r=0;r<t.length;r++)t[r].forEach((t,r)=>{"string"==typeof r&&"spfxContext"!==r&&"[object Object]"===Object.prototype.toString.call(t)?e.set(r,Object.assign({},e.get(r)||{},t)):e.set(r,t)});return e}(this._v,h(t=e)?new Map(S(t)):new Map)}get(e){return this._v.get(e)}export(){const e=new Map;for(const[t,r]of this._v)"__isDefault__"!==t&&e.set(t,r);return e}}const w=new I(new Map([["__isDefault__",!0]]));function T(e,t,r,i){return new(r||(r=Promise))(function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})}Object.create;Object.create;var C=r("08ZC");function x(e,t){if(h(t)){new Request("",{headers:t}).headers.forEach((t,r)=>{e.append(r,t)})}}function U(e,t){if(h(t)){const r=g(e.headers||{},t.headers);(e=g(e,t)).headers=r}}class R{fetch(e,t){return C.a.fetch(e,t)}}class D{constructor(e,t=-1){this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),w.get("enableCacheExpiration")&&this.cacheExpirationHandler()}static bind(e){return new D(void 0===e?new L:e)}get(e){if(!this.enabled)return null;const t=this.store.getItem(e);if(!h(t))return null;const r=JSON.parse(t);return new Date(r.expiration)<=new Date?(this.delete(e),null):r.value}put(e,t,r){this.enabled&&this.store.setItem(e,this.createPersistable(t,r))}delete(e){this.enabled&&this.store.removeItem(e)}getOrPut(e,t,r){return T(this,void 0,void 0,function*(){if(!this.enabled)return t();let i=this.get(e);return null===i&&(i=yield t(),this.put(e,i,r)),i})}deleteExpired(){return T(this,void 0,void 0,function*(){if(this.enabled)for(let e=0;e<this.store.length;e++){const t=this.store.key(e);null!==t&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))&&(yield this.get(t))}})}test(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}}createPersistable(e,t){if(void 0===t){let e=w.get("defaultCachingTimeoutSeconds");this.defaultTimeoutMinutes>0&&(e=60*this.defaultTimeoutMinutes),t=l(new Date,"second",e)}return m({pnp:1,expiration:t,value:e})}cacheExpirationHandler(){this.enabled&&this.deleteExpired().then(()=>{setTimeout(a(this,this.cacheExpirationHandler),w.get("cacheExpirationIntervalMilliseconds"))}).catch(console.error)}}class L{constructor(e=new Map){this._store=e}get length(){return this._store.size}clear(){this._store.clear()}getItem(e){return this._store.get(e)}key(e){return Array.from(this._store)[e][0]}removeItem(e){this._store.delete(e)}setItem(e,t){this._store.set(e,t)}}const F="00000000-0000-0000-0000-000000000000";var B;function _(e,t=w){t.assign(e)}B=(e=>{const t=e.get("sp"),r=Object.assign({},{fetchClientFactory:()=>new R},t);e.assign({sp:r})}),P.indexOf(B)<0&&(B(w),P.push(B));class ${constructor(e={},t="",r=w){this._options=e,this._baseUrl=t,this._runtime=r}configure(e,t=""){return new $(e,t)}setup(e){e.pageContext?_({spfxContext:e},this._runtime):_(e,this._runtime)}createIsolated(e){return s(this,void 0,void 0,function*(){e=Object.assign({baseUrl:"",cloneGlobal:!0,config:{},options:{}},e||{});const{baseUrl:t,cloneGlobal:r,options:i,config:n}=e,o=r?new I(w.export()):new I;return o.assign(n),new $(i,t,o)})}childConfigHook(e){return e({options:this._options,baseUrl:this._baseUrl,runtime:this._runtime})}}new $;class A{constructor(e=c()){this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[],this._index=-1}get batchId(){return this._batchId}get requests(){return this._reqs.sort((e,t)=>e.index-t.index)}track(e){e.data.batch=this,(void 0===e.data.batchIndex||e.data.batchIndex<0)&&(e.data.batchIndex=++this._index)}add(e){const t={id:e.requestId,index:e.batchIndex,method:e.method.toUpperCase(),options:e.options,parser:e.parser,reject:null,resolve:null,url:e.url},r=new Promise((e,r)=>{t.resolve=e,t.reject=r});return this._reqs.push(t),r}addDependency(){let e=()=>void 0;return this._deps.push(new Promise(t=>{e=t})),e}addResolveBatchDependency(e){this._rDeps.push(e)}execute(){return Promise.all(this._deps).then(()=>Promise.all(this._deps)).then(()=>this.executeImpl()).then(()=>Promise.all(this._rDeps)).then(()=>void 0)}}const k=new class{constructor(e=null,t=null){this._local=e,this._session=t}get local(){return null===this._local&&(this._local=new D("undefined"==typeof localStorage?new L:localStorage)),this._local}get session(){return null===this._session&&(this._session=new D("undefined"==typeof sessionStorage?new L:sessionStorage)),this._session}};class E{constructor(e,t,r){this.key=e,this.storeName=t,this.expiration=r}get store(){return"local"===this.storeName?k.local:k.session}}class O{constructor(e,t){this.parser=e,this.cacheOptions=t}parse(e){return this.parser.parse(e).then(e=>this.cacheData(e))}cacheData(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e}}function N(e,t,r,i){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return r(this,i)}})}let M=!1;const j=[],W=new Map,q=Symbol.for("43f7a601");function H(e,t){Array.isArray(t)?e.push(...t):e.push(t)}const V=(e,t)=>{let r=e(t);const i=Reflect.getPrototypeOf(e);if(Reflect.has(i,q)){r=((e,t)=>(M=!0,Reflect.has(e,q)||Reflect.set(e,q,[]),H(Reflect.get(e,q),t),e))(r,W.get(Reflect.get(i,q)))}return r};function G(e,t,r,...i){if(M){const t=[];Reflect.has(r,q)&&t.push(...Reflect.get(r,q)),t.push(...j);for(let n=0;n<t.length;n++){const o=t[n];let s=void 0;if(d(o)?s=o(e,r,...i):"get"===e&&Reflect.has(o,i[0])?s=Reflect.get(o,i[0],r):Reflect.has(o,e)&&(s=Reflect.get(o,e)(r,...i)),void 0!==s)return s}}return t(r,...i)}const z=(e=>t=>(...r)=>{const i=r=>{const i=Object.assign(function(...t){return e.call(i,...t)},new t(...r));return Reflect.setPrototypeOf(i,t.prototype),i};return w.get("ie11")?i(r):new Proxy(V(i,r),{apply:(e,t,r)=>G("apply",(...e)=>Reflect.apply(e[0],e[1],e[2]),e,t,r),get:(e,t,r)=>G("get",(...e)=>Reflect.get(e[0],e[1],e[2]),e,t,r),has:(e,t)=>G("has",(...e)=>Reflect.has(e[0],e[1]),e,t),set:(e,t,r,i)=>G("set",(...e)=>Reflect.set(e[0],e[1],e[2],e[3]),e,t,r,i)})})(function(e){return this.defaultAction(e)});function X(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function K(e,t,r,i){return new(r||(r=Promise))(function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})}Object.create;var J;Object.create;class Q{parse(e){return new Promise((t,r)=>{this.handleError(e,r)&&this.parseImpl(e,t,r)})}parseImpl(e,t,r){e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(e=>e.replace(/\s/gi,"").length>0?JSON.parse(e):{}).then(e=>t(this.parseODataJSON(e))).catch(e=>r(e))}handleError(e,t){return e.ok||re.init(e).then(t),e.ok}parseODataJSON(e){let t=e;return v(e,"d")?t=v(e.d,"results")?e.d.results:e.d:v(e,"value")&&(t=e.value),t}}class Y extends Q{parseImpl(e,t){e.text().then(t)}}class Z extends Q{parseImpl(e,t){e.blob().then(t)}}class ee extends Q{parseImpl(e,t){e.json().then(t)}}class te extends Q{parseImpl(e,t){d(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)}}class re extends Error{constructor(e,t,r=t.status,i=t.statusText){super(e),this.response=t,this.status=r,this.statusText=i,this.isHttpRequestError=!0}static init(e){return K(this,void 0,void 0,function*(){const t=yield e.clone().text();return new re(`Error making HttpClient request in queryable [${e.status}] ${e.statusText} ::> ${t}`,e.clone())})}}function ie(e){let t;e.options&&e.options.body&&(t=e.options.body,e.options.body="-");const r=JSON.stringify(e,(e,t)=>{switch(e){case"query":return JSON.stringify([...t]);case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return"-";default:return t}},0),i=JSON.parse(r,(t,r)=>{switch(t){case"query":return new Map(JSON.parse(r));case"batch":case"batchDependency":case"cachingOptions":case"clientFactory":case"parser":return e[t];default:return r}});return t&&(i.options.body=t,e.options.body=t),i}class ne{constructor(e={}){this._data=Object.assign({},{cloneParentWasCaching:!1,options:{},parentUrl:"",parser:new Q,query:new Map,url:"",useCaching:!1},ie(e)),this._runtime=null}get data(){return this._data}set data(e){this._data=Object.assign({},this.data,ie(e))}getRuntime(){return null===this._runtime?w:this._runtime}setRuntime(...e){return e[0]instanceof I?this._runtime=e[0]:(this._runtime=e[0]?new I(w.export()):new I,e.length>1&&h(e[1])&&this._runtime.assign(e[1])),this}toUrl(){return this.data.url}concat(e){return this.data.url+=e,this}get query(){return this.data.query}configure(e){return U(this.data.options,e),this}configureFrom(e){U(this.data.options,e.data.options);const t=e.getRuntime();return t.get("__isDefault__")||this.setRuntime(t),this}usingCaching(e){const t=this.getRuntime();if(!t.get("globalCacheDisable")){if(this.data.useCaching=!0,"string"==typeof e){if(f(e))throw Error("Cache key cannot be empty.");e={key:e}}const r={expiration:l(new Date,"second",t.get("defaultCachingTimeoutSeconds")),storeName:t.get("defaultCachingStore")};this.data.cachingOptions=g(r,e)}return this}usingParser(e){return this.data.parser=e,this}withPipeline(e){return this.data.pipes=e.slice(0),this}append(e){this.data.url=u(this.data.url,e)}inBatch(e){if(this.hasBatch)throw Error("This query is already part of a batch.");return h(e)&&e.track(this),this}addBatchDependency(){return h(this.data.batch)?this.data.batch.addDependency():()=>null}get hasBatch(){return h(this.data.batch)}get batch(){return this.hasBatch?this.data.batch:null}get parentUrl(){return this.data.parentUrl}cloneTo(e,t={}){return t=g({includeBatch:!0,includeQuery:!1},t),e.data=Object.assign({},ie(this.data),{batch:null,cloneParentCacheOptions:null,cloneParentWasCaching:!1},ie(e.data)),e.configureFrom(this),t.includeBatch&&e.inBatch(this.batch),t.includeQuery&&this.query.size>0&&this.query.forEach((t,r)=>e.query.set(r,t)),this.data.useCaching&&(e.data.cloneParentWasCaching=!0,e.data.cloneParentCacheOptions=this.data.cachingOptions),e}}class oe{static get activeLogLevel(){return oe.instance.activeLogLevel}static set activeLogLevel(e){oe.instance.activeLogLevel=e}static get instance(){return void 0!==oe._instance&&null!==oe._instance||(oe._instance=new se),oe._instance}static subscribe(...e){e.forEach(e=>oe.instance.subscribe(e))}static clearSubscribers(){return oe.instance.clearSubscribers()}static get count(){return oe.instance.count}static write(e,t=1){oe.instance.log({level:t,message:e})}static writeJSON(e,t=1){this.write(JSON.stringify(e),t)}static log(e){oe.instance.log(e)}static error(e){oe.instance.log({data:e,level:3,message:e.message})}}class se{constructor(e=2,t=[]){this.activeLogLevel=e,this.subscribers=t}subscribe(e){this.subscribers.push(e)}clearSubscribers(){const e=this.subscribers.slice(0);return this.subscribers.length=0,e}get count(){return this.subscribers.length}write(e,t=1){this.log({level:t,message:e})}log(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map(t=>t.log(e))}}!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(J||(J={}));function ae(e,t){return new Promise(r=>{e.result=t,e.hasResult=!0,r(e)})}function le(e){return e.pipes.length>0?e.pipes.shift()(e):Promise.resolve(e)}function ue(e){if(e.pipes.length<1)throw oe.write(`[${e.requestId}] (${(new Date).getTime()}) Request pipeline contains no methods!`,3),Error("Request pipeline contains no methods!");const t=le(e).then(e=>(function(e){return oe.log({data:0===oe.activeLogLevel?e.result:{},level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Returning result from pipeline. Set logging to verbose to see data.`}),Promise.resolve(e.result)})(e)).catch(e=>{throw oe.error(e),e});return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function ce(e=!1){return(t,r,i)=>{const n=i.value;i.value=function(...i){return!e&&i.length>0&&v(i[0],"hasResult")&&i[0].hasResult?(oe.write(`[${i[0].requestId}] (${(new Date).getTime()}) Skipping request pipeline method ${r}, existing result in pipeline.`,0),Promise.resolve(i[0])):(oe.write(`[${i[0].requestId}] (${(new Date).getTime()}) Calling request pipeline method ${r}.`,0),n.apply(t,i).then(e=>le(e)))}}}class de{static logStart(e){return new Promise(t=>{oe.log({data:1===oe.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Beginning ${e.method} request (${e.url})`}),t(e)})}static caching(e){return new Promise(t=>{if(e.useCaching){oe.write(`[${e.requestId}] (${(new Date).getTime()}) Caching is enabled for request, checking cache...`,1);let r=new E(e.url.toLowerCase());if(void 0!==e.cachingOptions&&(r=g(r,e.cachingOptions)),null!==r.store){let i=r.store.get(r.key);if(null!==i)return oe.log({data:1===oe.activeLogLevel?{}:i,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Value returned from cache.`}),d(e.batchDependency)&&e.batchDependency(),v(e.parser,"hydrate")&&(i=e.parser.hydrate(i)),ae(e,i).then(e=>t(e))}oe.write(`[${e.requestId}] (${(new Date).getTime()}) Value not found in cache.`,1),e.parser=new O(e.parser,r)}return t(e)})}static send(e){return new Promise((t,r)=>{if(e.isBatched){const r=e.batch.add(e);d(e.batchDependency)&&e.batchDependency(),oe.write(`[${e.requestId}] (${(new Date).getTime()}) Batching request in batch ${e.batch.batchId}.`,1),t(ae(e,r))}else{oe.write(`[${e.requestId}] (${(new Date).getTime()}) Sending request.`,1);const i=e.clientFactory(),n=g(e.options||{},{method:e.method});i.fetch(e.url,n).then(t=>e.parser.parse(t)).then(t=>ae(e,t)).then(e=>t(e)).catch(e=>r(e))}})}static logEnd(e){return new Promise(t=>{e.isBatched?oe.log({data:1===oe.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) ${e.method} request will complete in batch ${e.batch.batchId}.`}):oe.log({data:1===oe.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Completing ${e.method} request.`}),t(e)})}}X([ce(!0)],de,"logStart",null),X([ce()],de,"caching",null),X([ce()],de,"send",null),X([ce(!0)],de,"logEnd",null);const he=(pe=[de.logStart,de.caching,de.send,de.logEnd].slice(0),function(e){return function(t){return function(r){return ue(Object.assign({},{batch:null,batchDependency:null,batchIndex:-1,cachingOptions:null,clientFactory:e,cloneParentCacheOptions:null,cloneParentWasCaching:!1,hasResult:!1,isBatched:h(r.batch),method:t,options:null,parentUrl:"",parser:new Q,pipes:pe.slice(0),query:new Map,requestId:c(),url:"",useCaching:/^get$/i.test(r.method)&&r.useCaching},ie(r)))}}});var pe;function ge(e,t){return Object.assign({body:m(e)},t)}function ye(e,t){return Object.assign({headers:e},t)}function fe(e){return{__metadata:{type:e}}}function me(e){if(f(e))return"";let t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substr(0,t):e}function ve(e){return function(t,r,i){void 0===i&&(i=Object.getOwnPropertyDescriptor(t,r));const n=i.value;return i.value=function(...t){return s(this,void 0,void 0,function*(){return this.configure(ye({"X-PnPjs-Tracking":e})),n.apply(this,t)})},i}}ve.getClientTag=((e,t=!0)=>{if(e.has("X-PnPjs-Tracking")){const r=e.get("X-PnPjs-Tracking");if(t&&e.delete("X-PnPjs-Tracking"),!f(r))return r}return""}),ve.configure=((e,t)=>e.configure(ye({"X-PnPjs-Tracking":t}))),ve.isTagged=(e=>e.data.options.headers&&e.data.options.headers["X-PnPjs-Tracking"]);class Se{constructor(...e){var t;if(e[0]instanceof I?this._runtime=e[0]:(this._runtime=e.length>1&&e[1]instanceof I?e[1]:w,this._impl=e[0]),this._impl=(null===(t=this._runtime.get("sp"))||void 0===t?void 0:t.fetchClientFactory())||null,null===this._impl)throw Error("Could not generate fetchClientFactory in SPHttpClient.");this._digestCache=function(e){return t=>s(this,void 0,void 0,function*(){var r,i;const n=be.get(t);if(void 0!==n){const e=new Date;if(e<n.expiration)return n.value}const o=u(t,"/_api/contextinfo"),s=yield e.fetchRaw(o,{cache:"no-cache",credentials:"same-origin",headers:g({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},null===(i=null===(r=e._runtime.get("sp"))||void 0===r?void 0:r.sp)||void 0===i?void 0:i.headers,!0),method:"POST"}),a=yield(new Q).parse(s).then(e=>e.GetContextWebInformation),c={expiration:l(new Date,"second",a.FormDigestTimeoutSeconds),value:a.FormDigestValue};return be.set(t,c),c.value})}(this)}fetch(e,t={}){var r;return s(this,void 0,void 0,function*(){let i=g(t,{cache:"no-cache",credentials:"same-origin"},!0);const n=new Headers;if(x(n,null===(r=this._runtime.get("sp"))||void 0===r?void 0:r.headers),x(n,t.headers),n.has("Accept")||n.append("Accept","application/json"),n.has("Content-Type")||n.append("Content-Type","application/json;odata=verbose;charset=utf-8"),!n.has("X-ClientService-ClientTag")){let e=`PnPCoreJS:2.1.1:${ve.getClientTag(n)}`;e.length>32&&(e=e.substr(0,32)),n.append("X-ClientService-ClientTag",e)}if((i=g(i,{headers:n})).method&&"GET"!==i.method.toUpperCase()&&!n.has("X-RequestDigest")&&!n.has("Authorization")){const t=yield this._digestCache(me(e));n.append("X-RequestDigest",t)}return this.fetchRaw(e,i)})}fetchRaw(e,t={}){const r=new Headers;x(r,t.headers),t=g(t,{headers:r});const i=r=>{const n=e=>{let t;e.headers.has("Retry-After")?t=1e3*parseInt(e.headers.get("Retry-After"),10):(t=r.delay,r.delay*=2),r.attempts++,r.retryCount<=r.attempts?r.reject(Error(`Retry count exceeded (${r.retryCount}) for request. Response status: [${e.status}] ${e.statusText}`)):setTimeout(a(this,i,r),t)};this._impl.fetch(e,t).then(e=>{429===e.status?n(e):r.resolve(e)}).catch(e=>{503===e.status||504===e.status?n(e):r.reject(e)})};return new Promise((e,t)=>{i.call(this,{attempts:0,delay:100,reject:t,resolve:e,retryCount:7})})}get(e,t={}){const r=g(t,{method:"GET"});return this.fetch(e,r)}post(e,t={}){const r=g(t,{method:"POST"});return this.fetch(e,r)}patch(e,t={}){const r=g(t,{method:"PATCH"});return this.fetch(e,r)}delete(e,t={}){const r=g(t,{method:"DELETE"});return this.fetch(e,r)}}const be=new Map;function Pe(e,t=w){var r,i;return s(this,void 0,void 0,function*(){if(y(e))return e;const n=null===(r=t.get("sp"))||void 0===r?void 0:r.baseUrl,o=null===(i=t.get("sp"))||void 0===i?void 0:i.fetchClientFactory;if(!f(n))return u(n,e);const s=t.get("spfxContext");if(s)return u(s.pageContext.web.absoluteUrl,e);if(o){const t=o();if(v(t,"siteUrl"))return u(t.siteUrl,e)}if(void 0!==C.a._spPageContextInfo){if(v(C.a._spPageContextInfo,"webAbsoluteUrl"))return u(C.a._spPageContextInfo.webAbsoluteUrl,e);if(v(C.a._spPageContextInfo,"webServerRelativeUrl"))return u(C.a._spPageContextInfo.webServerRelativeUrl,e)}if(void 0!==C.a.location){const t=C.a.location.toString().toLowerCase();["/_layouts/","/siteassets/","/sitepages/"].forEach(r=>{const i=t.indexOf(r);if(i>0)return u(t.substr(0,i),e)})}return e})}const Ie=e=>()=>new Se(e);let we=Ie;const Te=e=>(function(t,r){return s(this,void 0,void 0,function*(){const i=t.getRuntime(),n=he(we(i))(e),o=ie(t.data),s=h(o.batch)?o.batch.addDependency():()=>{},a=yield Pe(t.toUrlAndQuery(),i);return U(o.options,r),n(Object.assign({},o,{batchDependency:s,url:a}))})}),Ce=(e,t)=>(e.data.cloneParentWasCaching&&e.usingCaching(e.data.cloneParentCacheOptions),e._forceCaching&&(e.data.useCaching=!0),Te("GET")(e,t)),xe=(e,t)=>Te("POST")(e,t),Ue=(e,t)=>Te("DELETE")(e,t),Re=(e,t)=>Te("PATCH")(e,t),De=(e,t)=>{const r=Object.assign(ye({"X-HTTP-Method":"DELETE"}),t);return xe(e,r)},Le=(e,t,r="*")=>{const i=Object.assign(ye({"X-HTTP-Method":"DELETE","IF-Match":r}),t);return xe(e,i)},Fe=e=>z(e);class Be extends ne{constructor(e,t){let r="",i="";const n=new Map;if("string"==typeof e)if(y(e)||e.lastIndexOf("/")<0)i=e,r=u(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){const n=e.lastIndexOf("/");i=e.slice(0,n),t=u(e.slice(n),t),r=u(i,t)}else{const n=e.lastIndexOf("(");i=e.slice(0,n),r=u(e,t)}else{r=u(i=e.toUrl(),t||"");const o=e.query.get("@target");void 0!==o&&n.set("@target",o)}super({parentUrl:i,query:n,url:r}),"string"!=typeof e&&this.configureFrom(e),this._forceCaching=!1}toUrlAndQuery(){const e=new Map(this.query);let t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,(t,r,i)=>(oe.write(`Rewriting aliased parameter from match ${t} to label: ${r} value: ${i}`,0),e.set(r,`'${i}'`),r));if(e.size>0){const r=t.indexOf("?")>-1?"&":"?";t+=`${r}${Array.from(e).map(e=>e[0]+"="+e[1]).join("&")}`}return t}select(...e){return e.length>0&&this.query.set("$select",e.map(encodeURIComponent).join(",")),this}get(e){return Ce(this,e)}expand(...e){return e.length>0&&this.query.set("$expand",e.map(encodeURIComponent).join(",")),this}clone(e,t,r=!0,i=!1){const n=super.cloneTo(e(this,t),{includeBatch:r,includeQuery:i});if(!i){const e="@target";this.query.has(e)&&n.query.set(e,this.query.get(e))}return n}defaultAction(e){return Ce(this,e)}getParent(e,t=this.parentUrl,r,i){let n=e(t,r).configureFrom(this);const o="@target";return this.query.has(o)&&n.query.set(o,this.query.get(o)),void 0!==i&&(n=n.inBatch(i)),n}}const _e=Fe(Be);class $e extends Be{filter(e){return this.query.set("$filter",encodeURIComponent(e)),this}orderBy(e,t=!0){const r="$orderby",i=this.query.has(r)?this.query.get(r).split(","):[];return i.push(`${encodeURIComponent(e)} ${t?"asc":"desc"}`),this.query.set(r,i.join(",")),this}skip(e){return this.query.set("$skip",e.toString()),this}top(e){return this.query.set("$top",e.toString()),this}}const Ae=Fe($e);class ke extends Be{_update(e,t){return r=>xe(ve.configure(this,`${e}.Update`),{body:m(g(fe(e),r)),headers:{"X-HTTP-Method":"MERGE"}}).then(e=>t(e,r))}}const Ee=Fe(ke);function Oe(e){return function(){return De(ve.configure(this,`${e}.delete`))}}function Ne(e){return function(t="*"){return Le(ve.configure(this,`${e}.delete`),{},t)}}function Me(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}function je(e){const t=[],r=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(v(e,r[0])&&"SP.Web"===e[r[0]])v(e,r[4])?t.push(e[r[4]]):v(e,r[2])&&t.push(e.__metadata.uri);else if(v(e,r[3])&&v(e,r[1])){const i=y(e[r[1]])?e[r[1]].split("_api")[1]:e[r[1]];t.push(me(e[r[3]]),"_api",i)}else v(e,r[1])?t.push("_api",e[r[1]]):v(e,r[2])&&t.push(e.__metadata.uri);return t.length<1?(oe.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):u(...t)}class We extends Q{constructor(e){super(),this.factory=e,this.hydrate=(e=>{return g(this.factory(je(e),null),e)})}parse(e){return super.parse(e).then(e=>{return g(this.factory(je(e),null),e)})}}class qe extends A{constructor(e,t=w){super(),this.url=e,this.runtime=t}static ParseResponse(e){const t=[],r=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),i=e.split("\n");let n,o,s="batch";for(let e=0;e<i.length;++e){const a=i[e];switch(s){case"batch":if("--batchresponse_"===a.substr(0,"--batchresponse_".length))s="batchHeaders";else if(""!==a.trim())throw Error(`Invalid response, line ${e}`);break;case"batchHeaders":""===a.trim()&&(s="status");break;case"status":{const t=r.exec(a);if(3!==t.length)throw Error(`Invalid status, line ${e}`);n=parseInt(t[1],10),o=t[2],s="statusHeaders";break}case"statusHeaders":""===a.trim()&&(s="body");break;case"body":t.push(204===n?new Response:new Response(a,{status:n,statusText:o})),s="batch"}}if("status"!==s)throw Error("Unexpected end of input");return t}executeImpl(){var e;return s(this,void 0,void 0,function*(){if(oe.write(`[${this.batchId}] (${(new Date).getTime()}) Executing batch with ${this.requests.length} requests.`,1),this.requests.length<1)return void oe.write("Resolving empty batch.",1);const t=new Se(this.runtime),r=yield Pe(this.url,this.runtime),i=[];let n="";for(let t=0;t<this.requests.length;t++){const o=this.requests[t];"GET"===o.method?(n.length>0&&(i.push(`--changeset_${n}--\n\n`),n=""),i.push(`--batch_${this.batchId}\n`)):(n.length<1&&(n=c(),i.push(`--batch_${this.batchId}\n`),i.push(`Content-Type: multipart/mixed; boundary="changeset_${n}"\n\n`)),i.push(`--changeset_${n}\n`)),i.push("Content-Type: application/http\n"),i.push("Content-Transfer-Encoding: binary\n\n");const s=new Headers,a=y(o.url)?o.url:u(r,o.url);if(oe.write(`[${this.batchId}] (${(new Date).getTime()}) Adding request ${o.method} ${a} to batch.`,0),"GET"!==o.method){let e=o.method;const t=o.options.headers;v(o,"options")&&v(o.options,"headers")&&void 0!==t["X-HTTP-Method"]&&(e=t["X-HTTP-Method"],delete t["X-HTTP-Method"]),i.push(`${e} ${a} HTTP/1.1\n`),s.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else i.push(`${o.method} ${a} HTTP/1.1\n`);x(s,null===(e=this.runtime.get("sp"))||void 0===e?void 0:e.headers),o.options&&x(s,o.options.headers),s.has("Accept")||s.append("Accept","application/json"),s.has("Content-Type")||s.append("Content-Type","application/json;odata=verbose;charset=utf-8"),s.has("X-ClientService-ClientTag")||s.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-2.1.1:batch"),s.forEach((e,t)=>{i.push(`${t}: ${e}\n`)}),i.push("\n"),o.options.body&&i.push(`${o.options.body}\n\n`)}n.length>0&&(i.push(`--changeset_${n}--\n\n`),n=""),i.push(`--batch_${this.batchId}--\n`);const o={body:i.join(""),headers:{"Content-Type":`multipart/mixed; boundary=batch_${this.batchId}`},method:"POST"};oe.write(`[${this.batchId}] (${(new Date).getTime()}) Sending batch request.`,1);const a=yield t.fetch(u(r,"/_api/$batch"),o);if(!a.ok)throw yield re.init(a);const l=yield a.clone().text(),d=qe.ParseResponse(l);if(d.length!==this.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return oe.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched requests.`,1),d.reduce((e,t,r)=>e.then(()=>s(this,void 0,void 0,function*(){const e=this.requests[r];oe.write(`[${e.id}] (${(new Date).getTime()}) Resolving request in batch ${this.batchId}.`,1);try{e.resolve(yield e.parser.parse(t))}catch(t){e.reject(t)}})),Promise.resolve(void 0))})}}function He(e){return f(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,(e,t,r)=>(oe.write(`Rewriting aliased parameter from match ${e} to label: ${t} value: ${r}`,0),`!${t}::${encodeURIComponent(r.replace(/'/gi,"''"))}`)):encodeURIComponent(e.replace(/'/gi,"''"))}let Ve=class extends ke{get rootWeb(){return ve.configure(Je(this,"rootweb"),"si.rootWeb")}getChanges(e){const t=ge({query:g(fe("SP.ChangeQuery"),e)});return xe(this.clone(Je,"getchanges"),t)}openWebById(e){return s(this,void 0,void 0,function*(){const t=yield xe(this.clone(Ge,`openWebById('${e}')`));return{data:t,web:Je(me(je(t)))}})}getRootWeb(){return s(this,void 0,void 0,function*(){const e=yield this.rootWeb.select("Url")();return ve.configure(Je(e.Url),"si.getRootWeb")})}getContextInfo(){return s(this,void 0,void 0,function*(){const e=ve.configure(Ge(this.parentUrl,"_api/contextinfo"),"si.getContextInfo"),t=yield xe(e);if(v(t,"GetContextWebInformation")){const e=t.GetContextWebInformation;return e.SupportedSchemaVersions=e.SupportedSchemaVersions.results,e}return t})}createBatch(){return new qe(this.parentUrl,this.getRuntime())}delete(){return s(this,void 0,void 0,function*(){const e=yield this.clone(Ge,"").select("Id")(),t=ve.configure(Ge(this.parentUrl,"_api/SPSiteManager/Delete"),"si.delete");yield xe(t,ge({siteId:e.Id}))})}getDocumentLibraries(e){return s(this,void 0,void 0,function*(){const t=ve.configure(_e("","_api/sp.web.getdocumentlibraries(@v)"),"si.getDocumentLibraries");t.query.set("@v",`'${He(e)}'`);const r=yield t();return v(r,"GetDocumentLibraries")?r.GetDocumentLibraries:r})}getWebUrlFromPageUrl(e){return s(this,void 0,void 0,function*(){const t=ve.configure(_e("","_api/sp.web.getweburlfrompageurl(@v)"),"si.getWebUrlFromPageUrl");t.query.set("@v",`'${He(e)}'`);const r=yield t();return v(r,"GetWebUrlFromPageUrl")?r.GetWebUrlFromPageUrl:r})}createCommunicationSite(e,t=1033,r=!1,i,n,o,a,l,u){return s(this,void 0,void 0,function*(){return this.createCommunicationSiteFromProps({Classification:o,Description:n,HubSiteId:l,Lcid:t,Owner:u,ShareByEmailEnabled:r,SiteDesignId:a,Title:e,Url:i})})}createCommunicationSiteFromProps(e){return s(this,void 0,void 0,function*(){const t=Object.assign({},{Classification:"",Description:"",HubSiteId:F,Lcid:1033,ShareByEmailEnabled:!1,SiteDesignId:F,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:F},e),r=ge({request:g(fe("Microsoft.SharePoint.Portal.SPSiteCreationRequest"),t)});return xe(Ge(me(this.toUrl()),"/_api/SPSiteManager/Create"),r)})}exists(e){return s(this,void 0,void 0,function*(){const t=ge({url:e});return yield xe(Ge(me(this.toUrl()),"/_api/SP.Site.Exists"),t)})}createModernTeamSite(e,t,r,i,n,o,a,l,u){return s(this,void 0,void 0,function*(){return this.createModernTeamSiteFromProps({alias:t,classification:o,description:n,displayName:e,hubSiteId:l,isPublic:r,lcid:i,owners:a,siteDesignId:u})})}createModernTeamSiteFromProps(e){return s(this,void 0,void 0,function*(){const t=Object.assign({},{classification:"",description:"",hubSiteId:F,isPublic:!0,lcid:1033,owners:[]},e),r={alias:t.alias,displayName:t.displayName,isPublic:t.isPublic,optionalParams:{Classification:t.classification,CreationOptions:{results:[`SPSiteLanguage:${t.lcid}`,`HubSiteId:${t.hubSiteId}`]},Description:t.description,Owners:{results:t.owners}}};return t.siteDesignId&&r.optionalParams.CreationOptions.results.push(`implicit_formula_292aa8a00786498a87a5ca52d9f4214a_${t.siteDesignId}`),xe(Ge(me(this.toUrl()),"/_api/GroupSiteManager/CreateGroupEx"),ge(r))})}};o([ve("si.getChanges")],Ve.prototype,"getChanges",null),o([ve("si.openWebById")],Ve.prototype,"openWebById",null);const Ge=Fe(Ve=o([Me("_api/site")],Ve));Reflect.defineProperty($.prototype,"site",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>Ge(t).configure(e).setRuntime(r))}});let ze=class extends $e{add(e,t,r="",i="STS",n=1033,o=!0){return s(this,void 0,void 0,function*(){const s=ge({parameters:g(fe("SP.WebCreationInformation"),{Description:r,Language:n,Title:e,Url:t,UseSamePermissionsAsParentSite:o,WebTemplate:i})}),a=yield xe(this.clone(Xe,"add"),s);return{data:a,web:Je(je(a).replace(/_api\/web\/?/i,""))}})}};o([ve("ws.add")],ze.prototype,"add",null);const Xe=Fe(ze=o([Me("webs")],ze));let Ke=class extends ke{constructor(){super(...arguments),this.delete=Oe("w")}get webs(){return Xe(this)}get allProperties(){return ve.configure(this.clone(Ee,"allproperties"),"w.allprops")}get webinfos(){return ve.configure(Ae(this,"webinfos"),"w.webinfos")}getParentWeb(){return s(this,void 0,void 0,function*(){const{ParentWeb:e}=yield Ce(this.select("ParentWeb/Id").expand("ParentWeb"));return(null==e?void 0:e.Id)?Ge(this.parentUrl).openWebById(e.Id):null})}update(e){return s(this,void 0,void 0,function*(){const t=ge(g(fe("SP.Web"),e),ye({"X-HTTP-Method":"MERGE"}));return{data:yield xe(this,t),web:this}})}applyTheme(e,t,r,i){const n=ge({backgroundImageUrl:r,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:i});return xe(this.clone(Je,"applytheme"),n)}applyWebTemplate(e){const t=this.clone(Je,"applywebtemplate");return t.concat(`(webTemplate='${He(e)}')`),xe(t)}getChanges(e){const t=ge({query:g(fe("SP.ChangeQuery"),e)});return xe(this.clone(Je,"getchanges"),t)}mapToIcon(e,t=0,r=""){return Ce(this.clone(Je,`maptoicon(filename='${He(e)}', progid='${He(r)}', size=${t})`))}getStorageEntity(e){return Ce(this.clone(Je,`getStorageEntity('${He(e)}')`))}setStorageEntity(e,t,r="",i=""){return xe(this.clone(Je,"setStorageEntity"),ge({comments:i,description:r,key:e,value:t}))}removeStorageEntity(e){return xe(this.clone(Je,`removeStorageEntity('${He(e)}')`))}getSubwebsFilteredForCurrentUser(e=-1,t=-1){const r=this.clone(Ae,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${e},nConfigurationFilter=${t})`);return ve.configure(r,"w.getSubwebsFilteredForCurrentUser")}createBatch(){return new qe(this.parentUrl,this.getRuntime())}availableWebTemplates(e=1033,t=!0){const r=`getavailablewebtemplates(lcid=${e}, doincludecrosslanguage=${t})`;return ve.configure(Ae(this,r),"w.availableWebTemplates")}};o([ve("w.getParentWeb")],Ke.prototype,"getParentWeb",null),o([ve("w.update")],Ke.prototype,"update",null),o([ve("w.applyTheme")],Ke.prototype,"applyTheme",null),o([ve("w.applyWebTemplate")],Ke.prototype,"applyWebTemplate",null),o([ve("w.getChanges")],Ke.prototype,"getChanges",null),o([ve("w.mapToIcon")],Ke.prototype,"mapToIcon",null),o([ve("w.getStorageEntity")],Ke.prototype,"getStorageEntity",null),o([ve("w.setStorageEntity")],Ke.prototype,"setStorageEntity",null),o([ve("w.removeStorageEntity")],Ke.prototype,"removeStorageEntity",null);const Je=Fe(Ke=o([Me("_api/web")],Ke));function Qe(e){return{DecodedUrl:e,__metadata:{type:"SP.ResourcePath"}}}let Ye=class extends $e{getById(e){return ve.configure(tt(this).concat(`('${e}')`),"ls.getById")}getByTitle(e){return ve.configure(tt(this,`getByTitle('${He(e)}')`),"ls.getByTitle")}add(e,t="",r=100,i=!1,n={}){return s(this,void 0,void 0,function*(){const o=Object.assign({AllowContentTypes:i,BaseTemplate:r,ContentTypesEnabled:i,Description:t,Title:e},fe("SP.List"),n);return{data:yield xe(this,ge(o)),list:this.getByTitle(o.Title)}})}ensure(e,t="",r=100,i=!1,n={}){return s(this,void 0,void 0,function*(){if(this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");const o=g(n,{Title:e,Description:t,ContentTypesEnabled:i},!0),s=this.getByTitle(o.Title);try{return yield s.select("Title")(),{created:!1,data:yield s.update(o).then(e=>e.data),list:this.getByTitle(o.Title)}}catch(n){return{created:!0,data:yield this.add(e,t,r,i,o).then(e=>e.data),list:this.getByTitle(o.Title)}}})}ensureSiteAssetsLibrary(){return s(this,void 0,void 0,function*(){const e=yield xe(this.clone(Ze,"ensuresiteassetslibrary"));return tt(je(e))})}ensureSitePagesLibrary(){return s(this,void 0,void 0,function*(){const e=yield xe(this.clone(Ze,"ensuresitepageslibrary"));return tt(je(e))})}};o([ve("ls.add")],Ye.prototype,"add",null),o([ve("ls.ensure")],Ye.prototype,"ensure",null),o([ve("ls.ensureSiteAssetsLibrary")],Ye.prototype,"ensureSiteAssetsLibrary",null),o([ve("ls.ensureSitePagesLibrary")],Ye.prototype,"ensureSitePagesLibrary",null);const Ze=Fe(Ye=o([Me("lists")],Ye));class et extends ke{constructor(){super(...arguments),this.delete=Ne("l")}get effectiveBasePermissions(){return ve.configure(_e(this,"EffectiveBasePermissions"),"l.effectiveBasePermissions")}get eventReceivers(){return ve.configure(Ae(this,"EventReceivers"),"l.eventReceivers")}get relatedFields(){return ve.configure(_e(this,"getRelatedFields"),"l.relatedFields")}get informationRightsManagementSettings(){return ve.configure(_e(this,"InformationRightsManagementSettings"),"l.informationRightsManagementSettings")}update(e,t="*"){return s(this,void 0,void 0,function*(){const r=ge(g(fe("SP.List"),e),ye({"IF-Match":t,"X-HTTP-Method":"MERGE"}));return{data:yield xe(this,r),list:v(e,"Title")?this.getParent(tt,this.parentUrl,`getByTitle('${e.Title}')`):tt(this)}})}getChanges(e){return xe(this.clone(tt,"getchanges"),ge({query:g(fe("SP.ChangeQuery"),e)}))}getItemsByCAMLQuery(e,...t){const r=this.clone(tt,"getitems");return xe(r.expand(...t),ge({query:g(fe("SP.CamlQuery"),e)}))}getListItemChangesSinceToken(e){const t=this.clone(tt,"getlistitemchangessincetoken").usingParser({parse:e=>e.text()});return xe(t,ge({query:g(fe("SP.ChangeLogItemQuery"),e)}))}recycle(){return s(this,void 0,void 0,function*(){const e=yield xe(this.clone(tt,"recycle"));return v(e,"Recycle")?e.Recycle:e})}renderListData(e){return s(this,void 0,void 0,function*(){const t=this.clone(tt,"renderlistdata(@viewXml)");t.query.set("@viewXml",`'${e}'`);const r=yield xe(t);return JSON.parse(v(r,"RenderListData")?r.RenderListData:r)})}renderListDataAsStream(e,t=null,r=new Map){v(e,"RenderOptions")&&p(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce((e,t)=>e+t));let i={parameters:g(fe("SP.RenderListDataParameters"),e)};h(t)&&(i=g(i,{overrideParameters:g(fe("SP.RenderListDataOverrideParameters"),t)}));const n=this.clone(tt,"RenderListDataAsStream",!0,!0);return r&&r.size>0&&r.forEach((e,t)=>n.query.set(t,e)),xe(n,ge(i))}renderListFormData(e,t,r){return s(this,void 0,void 0,function*(){const i=yield xe(this.clone(tt,`renderlistformdata(itemid=${e}, formid='${t}', mode='${r}')`));return JSON.parse(v(i,"RenderListFormData")?i.RenderListFormData:i)})}reserveListItemId(){return s(this,void 0,void 0,function*(){const e=yield xe(this.clone(tt,"reservelistitemid"));return v(e,"ReserveListItemId")?e.ReserveListItemId:e})}getListItemEntityTypeFullName(){return this.clone(tt,null,!1).select("ListItemEntityTypeFullName").usingCaching({expiration:l(new Date,"day",5),key:`PnPjs-ListEntityName:${this.toUrl()}`,storeName:"local"})().then(e=>e.ListItemEntityTypeFullName)}addValidateUpdateItemUsingPath(e,t,r=!1,i,n){return s(this,void 0,void 0,function*(){const o={FolderPath:Qe(t)};h(n)&&(n.leafName&&(o.LeafName=Qe(n.leafName)),n.objectType&&(o.UnderlyingObjectType=n.objectType));const s=yield xe(this.clone(tt,"AddValidateUpdateItemUsingPath()"),ge({bNewDocumentUpdate:r,checkInComment:i,formValues:e,listItemCreateInfo:g(fe("SP.ListItemCreationInformationUsingPath"),o)}));return v(s,"AddValidateUpdateItemUsingPath")?s.AddValidateUpdateItemUsingPath:s})}getParentInfos(){return s(this,void 0,void 0,function*(){const e=yield this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")();return{List:{Id:e.Id,RootFolderServerRelativePath:e.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.RootFolder.UniqueId},ParentWeb:{Id:e.ParentWeb.Id,ServerRelativePath:e.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentWeb.ServerRelativeUrl,Url:e.ParentWeb.Url}}})}}o([ve("l.update")],et.prototype,"update",null),o([ve("l.getChanges")],et.prototype,"getChanges",null),o([ve("l.CAMLQuery")],et.prototype,"getItemsByCAMLQuery",null),o([ve("l.ChangesSinceToken")],et.prototype,"getListItemChangesSinceToken",null),o([ve("l.recycle")],et.prototype,"recycle",null),o([ve("l.renderListData")],et.prototype,"renderListData",null),o([ve("l.AsStream")],et.prototype,"renderListDataAsStream",null),o([ve("l.renderListFormData")],et.prototype,"renderListFormData",null),o([ve("l.reserveListItemId")],et.prototype,"reserveListItemId",null),o([ve("l.getListItemEntityTypeFullName")],et.prototype,"getListItemEntityTypeFullName",null),o([ve("l.addValidateUpdateItemUsingPath")],et.prototype,"addValidateUpdateItemUsingPath",null);const tt=Fe(et);var rt,it;!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(rt||(rt={})),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(it||(it={}));let nt=class extends $e{getById(e){return ve.configure(at(this).concat(`(${e})`),"is.getById")}getItemByStringId(e){return ve.configure(at(this.parentUrl,`getItemByStringId('${e}')`),"is.getItemByStringId")}skip(e,t=!1){return t?this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&PagedPrev=TRUE&p_ID=${e}`)):this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&p_ID=${e}`)),this}getPaged(){return this.usingParser(new ht(this))()}getAll(e=2e3,t="application/json;odata=nometadata"){oe.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);const r=ot(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach((e,t)=>{/^\$select|filter|top|expand$/i.test(t)&&r.query.set(t,e)}),new Promise((e,t)=>{const i=[],n=r=>{[].push.apply(i,r.results),r.hasNext?r.getNext().then(n).catch(t):e(i)};r.getPaged().then(n).catch(t)})}add(e={},t=null){return s(this,void 0,void 0,function*(){const r=this.addBatchDependency(),i=ge(g(fe(yield this.ensureListItemEntityTypeName(t)),e)),n=xe(this.clone(ot,""),i).then(e=>({data:e,item:this.getById(e.Id)}));return r(),n})}ensureListItemEntityTypeName(e){return s(this,void 0,void 0,function*(){return e||this.getParent(tt).getListItemEntityTypeFullName()})}};o([ve("is.getPaged")],nt.prototype,"getPaged",null),o([ve("is.getAll")],nt.prototype,"getAll",null),o([ve("is.add")],nt.prototype,"add",null);const ot=Fe(nt=o([Me("items")],nt));class st extends ke{constructor(){super(...arguments),this.delete=Ne("i")}get effectiveBasePermissions(){return ve.configure(_e(this,"EffectiveBasePermissions"),"i.effectiveBasePermissions")}get effectiveBasePermissionsForUI(){return ve.configure(_e(this,"EffectiveBasePermissionsForUI"),"i.effectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return ve.configure(Ee(this,"FieldValuesAsHTML"),"i.fvHTML")}get fieldValuesAsText(){return ve.configure(Ee(this,"FieldValuesAsText"),"i.fvText")}get fieldValuesForEdit(){return ve.configure(Ee(this,"FieldValuesForEdit"),"i.fvEdit")}get versions(){return ve.configure(ut(this),"i.versions")}get list(){return this.getParent(tt,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))}update(e,t="*",r=null){return s(this,void 0,void 0,function*(){const i=this.addBatchDependency(),n=ge(g(fe(yield this.ensureListItemEntityTypeName(r)),e),ye({"IF-Match":t,"X-HTTP-Method":"MERGE"}));i();const o=ve.configure(this.clone(at).usingParser(new pt),"i.update");return{data:yield xe(o,n),item:this}})}recycle(){return xe(this.clone(at,"recycle"))}deleteWithParams(e){return s(this,void 0,void 0,function*(){return xe(this.clone(at,"DeleteWithParameters"),ge({parameters:e}))})}getWopiFrameUrl(e=0){return s(this,void 0,void 0,function*(){const t=this.clone(at,"getWOPIFrameUrl(@action)");t.query.set("@action",e);const r=yield xe(t);return v(r,"GetWOPIFrameUrl")?r.GetWOPIFrameUrl:r})}validateUpdateListItem(e,t=!1){return xe(this.clone(at,"validateupdatelistitem"),ge({formValues:e,bNewDocumentUpdate:t}))}getParentInfos(){return s(this,void 0,void 0,function*(){const e=yield this.select("Id","ParentList/Id","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")();return{Item:{Id:e.Id},ParentList:{Id:e.ParentList.Id,RootFolderServerRelativePath:e.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ParentList.ParentWeb.Id,ServerRelativePath:e.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ParentList.ParentWeb.Url}}})}ensureListItemEntityTypeName(e){return s(this,void 0,void 0,function*(){return e||this.list.getListItemEntityTypeFullName()})}}o([ve("i.recycle")],st.prototype,"recycle",null),o([ve("i.del-params")],st.prototype,"deleteWithParams",null),o([ve("i.getWopiFrameUrl")],st.prototype,"getWopiFrameUrl",null),o([ve("i.validateUpdateListItem")],st.prototype,"validateUpdateListItem",null);const at=Fe(st);let lt=class extends $e{getById(e){return ve.configure(ct(this).concat(`(${e})`),"iv.getById")}};const ut=Fe(lt=o([Me("versions")],lt));const ct=Fe(class extends ke{constructor(){super(...arguments),this.delete=Ne("iv")}});class dt{constructor(e,t,r){this.parent=e,this.nextUrl=t,this.results=r}get hasNext(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0}getNext(){if(this.hasNext){return ve.configure(ot(this.nextUrl,null).configureFrom(this.parent),"ip.getNext").getPaged()}return new Promise(e=>e(null))}}class ht extends Q{constructor(e){super(),this._parent=e}parse(e){return new Promise((t,r)=>{this.handleError(e,r)&&e.json().then(e=>{const r=v(e,"d")&&v(e.d,"__next")?e.d.__next:e["odata.nextLink"];t(new dt(this._parent,r,this.parseODataJSON(e)))})})}}class pt extends Q{parse(e){return new Promise((t,r)=>{this.handleError(e,r)&&t({"odata.etag":e.headers.get("etag")})})}}N(et,"items",ot);let gt=class extends $e{getByName(e){if(/%#/.test(e))throw Error("For file names containing % or # please use web.getFileByServerRelativePath");return ve.configure(mt(this).concat(`('${He(e)}')`),"fis.getByName")}add(e,t,r=!0){return s(this,void 0,void 0,function*(){return{data:yield xe(yt(this,`add(overwrite=${r},url='${He(e)}')`),{body:t}),file:this.getByName(e)}})}addUsingPath(e,t,r={Overwrite:!1}){return s(this,void 0,void 0,function*(){const i=[`AddUsingPath(decodedurl='${He(e)}'`];r&&(r.Overwrite&&i.push(",Overwrite=true"),r.AutoCheckoutOnInvalidData&&i.push(",AutoCheckoutOnInvalidData=true"),f(r.XorHash)||i.push(`,XorHash=${He(r.XorHash)}`)),i.push(")");const n=yield xe(yt(this,i.join("")),{body:t});return{data:n,file:mt(je(n))}})}addChunked(e,t,r,i=!0,n=10485760){return s(this,void 0,void 0,function*(){const o=yield xe(this.clone(yt,`add(overwrite=${i},url='${He(e)}')`,!1)),s=mt(je(o));return yield s.setContentChunked(t,r,n)})}addTemplateFile(e,t){return s(this,void 0,void 0,function*(){const r=yield xe(this.clone(yt,`addTemplateFile(urloffile='${He(e)}',templatefiletype=${t})`,!1));return{data:r,file:mt(je(r))}})}};o([ve("fis.add")],gt.prototype,"add",null),o([ve("fis.addUsingPath")],gt.prototype,"addUsingPath",null),o([ve("fis.addChunked")],gt.prototype,"addChunked",null),o([ve("fis.addTemplateFile")],gt.prototype,"addTemplateFile",null);const yt=Fe(gt=o([Me("files")],gt));class ft extends ke{constructor(){super(...arguments),this.delete=Ne("fi")}get listItemAllFields(){return ve.configure(Ee(this,"listItemAllFields"),"fi.listItemAllFields")}get versions(){return ve.configure(St(this),"fi.versions")}approve(e=""){return xe(this.clone(mt,`approve(comment='${He(e)}')`))}cancelUpload(e){return xe(this.clone(mt,`cancelUpload(uploadId=guid'${e}')`,!1))}checkin(e="",t=Pt.Major){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return xe(this.clone(mt,`checkin(comment='${He(e)}',checkintype=${t})`))}checkout(){return xe(this.clone(mt,"checkout"))}copyTo(e,t=!0){return xe(this.clone(mt,`copyTo(strnewurl='${He(e)}',boverwrite=${t})`))}copyByPath(e,t,r=!1){return s(this,void 0,void 0,function*(){const{ServerRelativeUrl:i,"odata.id":n}=yield this.select("ServerRelativeUrl")(),o=me(n),s=o.replace("://","___").split("/")[0].replace("___","://");yield xe(mt(o,`/_api/SP.MoveCopyUtil.CopyFileByPath(overwrite=@a1)?@a1=${t}`),ge({destPath:Qe(y(e)?e:`${s}${e}`),options:{KeepBoth:r,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Qe(y(i)?i:`${s}${i}`)}))})}deny(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return xe(this.clone(mt,`deny(comment='${He(e)}')`))}moveTo(e,t=It.Overwrite){return xe(this.clone(mt,`moveTo(newurl='${He(e)}',flags=${t})`))}moveByPath(e,t,r=!1){return s(this,void 0,void 0,function*(){const{ServerRelativeUrl:i,"odata.id":n}=yield this.select("ServerRelativeUrl")(),o=me(n),s=o.replace("://","___").split("/")[0].replace("___","://");yield xe(mt(o,`/_api/SP.MoveCopyUtil.MoveFileByPath(overwrite=@a1)?@a1=${t}`),ge({destPath:Qe(y(e)?e:`${s}${e}`),options:{KeepBoth:r,ResetAuthorAndCreatedOnCopy:!1,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Qe(y(i)?i:`${s}${i}`)}))})}publish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return xe(this.clone(mt,`publish(comment='${He(e)}')`))}recycle(){return xe(this.clone(mt,"recycle"))}deleteWithParams(e){return s(this,void 0,void 0,function*(){return xe(this.clone(mt,"DeleteWithParameters"),ge({parameters:e}))})}undoCheckout(){return xe(this.clone(mt,"undoCheckout"))}unpublish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return xe(this.clone(mt,`unpublish(comment='${He(e)}')`))}exists(){return s(this,void 0,void 0,function*(){try{return(yield this.clone(mt).select("Exists")()).Exists}catch(e){return!1}})}getText(){return this.clone(mt,"$value",!1).usingParser(new Y)(ye({binaryStringResponseBody:"true"}))}getBlob(){return this.clone(mt,"$value",!1).usingParser(new Z)(ye({binaryStringResponseBody:"true"}))}getBuffer(){return this.clone(mt,"$value",!1).usingParser(new te)(ye({binaryStringResponseBody:"true"}))}getJSON(){return this.clone(mt,"$value",!1).usingParser(new ee)(ye({binaryStringResponseBody:"true"}))}setContent(e){return s(this,void 0,void 0,function*(){return yield xe(this.clone(mt,"$value",!1),{body:e,headers:{"X-HTTP-Method":"PUT"}}),mt(this)})}getItem(...e){return s(this,void 0,void 0,function*(){const t=this.listItemAllFields,r=yield t.select(...e)();return g(at(je(r)),r)})}setContentChunked(e,t,r=10485760){return s(this,void 0,void 0,function*(){d(t)||(t=(()=>null));const i=e.size,n=parseInt((i/r).toString(),10)+(i%r==0?1:0),o=c();t({uploadId:o,blockNumber:1,chunkSize:r,currentPointer:0,fileSize:i,stage:"starting",totalBlocks:n});let s=yield this.startUpload(o,e.slice(0,r));for(let a=2;a<n;a++)t({uploadId:o,blockNumber:a,chunkSize:r,currentPointer:s,fileSize:i,stage:"continue",totalBlocks:n}),s=yield this.continueUpload(o,s,e.slice(s,s+r));return t({uploadId:o,blockNumber:n,chunkSize:r,currentPointer:s,fileSize:i,stage:"finishing",totalBlocks:n}),this.finishUpload(o,s,e.slice(s))})}startUpload(e,t){return s(this,void 0,void 0,function*(){let r=yield xe(this.clone(mt,`startUpload(uploadId=guid'${e}')`,!1),{body:t});return"object"==typeof r&&(r=r.StartUpload),parseFloat(r)})}continueUpload(e,t,r){return s(this,void 0,void 0,function*(){let i=yield xe(this.clone(mt,`continueUpload(uploadId=guid'${e}',fileOffset=${t})`,!1),{body:r});return"object"==typeof i&&(i=i.ContinueUpload),parseFloat(i)})}finishUpload(e,t,r){return s(this,void 0,void 0,function*(){const i=yield xe(this.clone(mt,`finishUpload(uploadId=guid'${e}',fileOffset=${t})`,!1),{body:r});return{data:i,file:mt(je(i))}})}}o([ve("fi.approve")],ft.prototype,"approve",null),o([ve("fi.cancelUpload")],ft.prototype,"cancelUpload",null),o([ve("fi.checkin")],ft.prototype,"checkin",null),o([ve("fi.checkout")],ft.prototype,"checkout",null),o([ve("fi.copyTo")],ft.prototype,"copyTo",null),o([ve("fi.copyByPath")],ft.prototype,"copyByPath",null),o([ve("fi.deny")],ft.prototype,"deny",null),o([ve("fi.moveTo")],ft.prototype,"moveTo",null),o([ve("fi.moveByPath")],ft.prototype,"moveByPath",null),o([ve("fi.publish")],ft.prototype,"publish",null),o([ve("fi.recycle")],ft.prototype,"recycle",null),o([ve("fi.del-params")],ft.prototype,"deleteWithParams",null),o([ve("fi.undoCheckout")],ft.prototype,"undoCheckout",null),o([ve("fi.unpublish")],ft.prototype,"unpublish",null),o([ve("fi.exists")],ft.prototype,"exists",null),o([ve("fi.getText")],ft.prototype,"getText",null),o([ve("fi.getBlob")],ft.prototype,"getBlob",null),o([ve("fi.getBuffer")],ft.prototype,"getBuffer",null),o([ve("fi.getJSON")],ft.prototype,"getJSON",null),o([ve("fi.setContent")],ft.prototype,"setContent",null),o([ve("fi.getItem")],ft.prototype,"getItem",null),o([ve("fi.startUpload")],ft.prototype,"startUpload",null),o([ve("fi.continueUpload")],ft.prototype,"continueUpload",null),o([ve("fi.finishUpload")],ft.prototype,"finishUpload",null);const mt=Fe(ft);let vt=class extends $e{getById(e){return ve.configure(bt(this).concat(`(${e})`),"vers.getById")}deleteAll(){return xe(St(this,"deleteAll"))}deleteById(e){return xe(this.clone(St,`deleteById(vid=${e})`))}recycleByID(e){return xe(this.clone(St,`recycleByID(vid=${e})`))}deleteByLabel(e){return xe(this.clone(St,`deleteByLabel(versionlabel='${He(e)}')`))}recycleByLabel(e){return xe(this.clone(St,`recycleByLabel(versionlabel='${He(e)}')`))}restoreByLabel(e){return xe(this.clone(St,`restoreByLabel(versionlabel='${He(e)}')`))}};o([ve("vers.deleteAll")],vt.prototype,"deleteAll",null),o([ve("vers.deleteById")],vt.prototype,"deleteById",null),o([ve("vers.recycleByID")],vt.prototype,"recycleByID",null),o([ve("vers.deleteByLabel")],vt.prototype,"deleteByLabel",null),o([ve("vers.recycleByLabel")],vt.prototype,"recycleByLabel",null),o([ve("vers.restoreByLabel")],vt.prototype,"restoreByLabel",null);const St=Fe(vt=o([Me("versions")],vt));const bt=Fe(class extends ke{constructor(){super(...arguments),this.delete=Ne("ver")}});var Pt,It,wt;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(Pt||(Pt={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(It||(It={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(wt||(wt={})),Reflect.defineProperty($.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>Je(t).configure(e).setRuntime(r))}}),$.prototype.createBatch=function(){return this.web.createBatch()};const Tt=Fe(class extends $e{constructor(e,t="_api/web/tenantappcatalog/AvailableApps"){super(me("string"==typeof e?e:e.toUrl()),t)}getAppById(e){return ve.configure(xt(this,`getById('${e}')`),"ac.getAppById")}syncSolutionToTeams(e,t=!1){return s(this,void 0,void 0,function*(){let r=null;const i=me(this.toUrl());if(t)r=e;else{const t=Je(i),n=(yield t.lists.select("Id").filter("EntityTypeName eq 'AppCatalog'")())[0].Id,o=yield t.lists.getById(n).items.filter(`AppProductID eq '${e}'`).top(1)();if(!(o&&o.length>0))throw Error(`Did not find the app with id ${e} in the appcatalog.`);r=o[0].Id}const n=ve.configure(Tt(i,`_api/web/tenantappcatalog/SyncSolutionToTeams(id=${r})`),"ac.syncSolutionToTeams");return yield xe(n,{})})}add(e,t,r=!0){return s(this,void 0,void 0,function*(){const i=ve.configure(Tt(me(this.toUrl()),`_api/web/tenantappcatalog/add(overwrite=${r},url='${e}')`),"ac.add"),n=yield xe(i,{body:t,headers:{binaryStringRequestBody:"true"}});return{data:n,file:mt(je(n))}})}});class Ct extends ke{deploy(e=!1){return this.do(`Deploy(${e})`)}retract(){return this.do("Retract")}install(){return this.do("Install")}uninstall(){return this.do("Uninstall")}upgrade(){return this.do("Upgrade")}remove(){return this.do("Remove")}do(e){return xe(this.clone(xt,e))}}o([ve("app.deploy")],Ct.prototype,"deploy",null),o([ve("app.retract")],Ct.prototype,"retract",null),o([ve("app.install")],Ct.prototype,"install",null),o([ve("app.uninstall")],Ct.prototype,"uninstall",null),o([ve("app.upgrade")],Ct.prototype,"upgrade",null),o([ve("app.remove")],Ct.prototype,"remove",null);const xt=Fe(Ct);Ke.prototype.getAppCatalog=function(e){return Tt(e||this)},$.prototype.getTenantAppCatalogWeb=function(){return s(this,void 0,void 0,function*(){return this.childConfigHook(({options:e,runtime:t})=>s(this,void 0,void 0,function*(){const r=yield _e("/","_api/SP_TenantSettings_Current").configure(e).setRuntime(t)();return Je(r.CorporateCatalogUrl).configure(e).setRuntime(t)}))})};let Ut=class extends $e{getByName(e){const t=ve.configure(Lt(this),"ats.getByName");return t.concat(`('${e}')`),t}add(e,t){return s(this,void 0,void 0,function*(){return{data:yield xe(this.clone(Rt,`add(FileName='${e}')`,!1),{body:t}),file:this.getByName(e)}})}addMultiple(e){return s(this,void 0,void 0,function*(){for(let t=0;t<e.length;t++)yield this.add(e[t].name,e[t].content)})}deleteMultiple(...e){return s(this,void 0,void 0,function*(){for(let t=0;t<e.length;t++)yield this.getByName(e[t]).delete()})}recycleMultiple(...e){return s(this,void 0,void 0,function*(){for(let t=0;t<e.length;t++)yield this.getByName(e[t]).recycle()})}};o([ve("ats.add")],Ut.prototype,"add",null),o([ve("ats.addMultiple")],Ut.prototype,"addMultiple",null),o([ve("ats.deleteMultiple")],Ut.prototype,"deleteMultiple",null),o([ve("ats.recycleMultiple")],Ut.prototype,"recycleMultiple",null);const Rt=Fe(Ut=o([Me("AttachmentFiles")],Ut));class Dt extends ke{constructor(){super(...arguments),this.delete=Ne("at")}getText(){return this.getParsed(new Y)}getBlob(){return this.getParsed(new Z)}getBuffer(){return this.getParsed(new te)}getJSON(){return this.getParsed(new ee)}setContent(e){return s(this,void 0,void 0,function*(){return yield xe(this.clone(Lt,"$value",!1),ye({"X-HTTP-Method":"PUT"},{body:e})),Lt(this)})}recycle(e="*"){return xe(this.clone(Lt,"recycleObject"),ye({"IF-Match":e,"X-HTTP-Method":"DELETE"}))}getParsed(e){return this.clone(Lt,"$value",!1).usingParser(e)()}}o([ve("at.getText")],Dt.prototype,"getText",null),o([ve("at.getBlob")],Dt.prototype,"getBlob",null),o([ve("at.getBuffer")],Dt.prototype,"getBuffer",null),o([ve("at.getJSON")],Dt.prototype,"getJSON",null),o([ve("at.setContent")],Dt.prototype,"setContent",null),o([ve("at.recycle")],Dt.prototype,"recycle",null);const Lt=Fe(Dt);function Ft(e){return e.length<1?1:Math.max.apply(null,e.map(e=>e.order))+1}function Bt(e){for(let t=0;t<e.length;t++)e[t].order=t+1,v(e[t],"columns")?Bt(e[t].columns):v(e[t],"controls")&&Bt(e[t].controls)}N(st,"attachmentFiles",Rt),Ke.prototype.getFileByServerRelativeUrl=function(e){return mt(this,`getFileByServerRelativeUrl('${He(e)}')`)},Ke.prototype.getFileByServerRelativePath=function(e){return mt(this,`getFileByServerRelativePath(decodedUrl='${He(e)}')`)},Ke.prototype.getFileById=function(e){return mt(this,`getFileById('${e}')`)},Ke.prototype.getFileByUrl=function(e){return mt(this,`getFileByUrl('!@p1::${He(e)}')`)};let _t=class extends $e{add(e){return s(this,void 0,void 0,function*(){"string"==typeof e&&(e={text:e});const t=ge(g(fe("Microsoft.SharePoint.Comments.comment"),e)),r=yield xe(this.clone($t,null),t);return g(this.getById(r.id),r)})}getById(e){return ve.configure(kt(this).concat(`(${e})`),"coms.getById")}clear(){return xe(ve.configure(this.clone($t,"DeleteAll"),"coms.clear"))}};o([ve("coms.add")],_t.prototype,"add",null);const $t=Fe(_t=o([Me("comments")],_t));class At extends ke{get replies(){return ve.configure(Ot(this),"com.replies")}like(){return xe(this.clone(kt,"Like"))}unlike(){return xe(this.clone(kt,"Unlike"))}delete(){return xe(this.clone(kt,"DeleteComment"))}}o([ve("com.like")],At.prototype,"like",null),o([ve("com.unlike")],At.prototype,"unlike",null),o([ve("com.delete")],At.prototype,"delete",null);const kt=Fe(At);let Et=class extends $e{add(e){return s(this,void 0,void 0,function*(){"string"==typeof e&&(e={text:e});const t=ge(g(fe("Microsoft.SharePoint.Comments.comment"),e)),r=yield xe(this.clone(Ot,null),t);return g(kt(je(r)),r)})}};o([ve("reps.add")],Et.prototype,"add",null);const Ot=Fe(Et=o([Me("replies")],Et));var Nt;function Mt(e,t){return Wt(me(e.toUrl()),t).configureFrom(e)}N(st,"comments",$t),st.prototype.getLikedBy=function(){return xe(this.clone(at,"likedBy"))},st.prototype.like=function(){return s(this,void 0,void 0,function*(){const e=yield this.getParentInfos(),t=u(me(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+`?@a1='{${e.ParentList.Id}}'&@a2='${e.Item.Id}'&@a3=true`;return xe(_e(t))})},st.prototype.unlike=function(){return s(this,void 0,void 0,function*(){const e=yield this.getParentInfos(),t=u(me(this.toUrl()),"_api/Microsoft.Office.Server.ReputationModel.Reputation.SetLike(listID=@a1,itemID=@a2,like=@a3)")+`?@a1='{${e.ParentList.Id}}'&@a2='${e.Item.Id}'&@a3=false`;return xe(_e(t))})},st.prototype.getLikedByInformation=function(){return this.clone(at,"likedByInformation").expand("likedby")()},function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(Nt||(Nt={}));class jt extends Be{constructor(e,t,r,i=!1,n=[],o=!1){super(e,t),this.json=r,this.sections=n,this.commentsDisabled=o,this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,"string"==typeof e?(this.data.parentUrl="",this.data.url=u(me(e),t)):this.assign(Mt(e,null),t),this._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},this._layoutPart=jt.getDefaultLayoutPart(),void 0===r||i||this.fromJSON(r)}static getDefaultLayoutPart(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authorByline:[],authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:""},reservedHeight:280,serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}}get pageLayout(){return this.json.PageLayoutType}set pageLayout(e){this.json.PageLayoutType=e}get bannerImageUrl(){return this.json.BannerImageUrl}set bannerImageUrl(e){this.setBannerImage(e)}get thumbnailUrl(){return this._pageSettings.pageSettingsSlice.isDefaultThumbnail?this.json.BannerImageUrl:this.json.BannerThumbnailUrl}set thumbnailUrl(e){this.json.BannerThumbnailUrl=e,this._bannerImageThumbnailUrlDirty=!0,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!1}get topicHeader(){return h(this.json.TopicHeader)?this.json.TopicHeader:""}set topicHeader(e){this.json.TopicHeader=e,this._layoutPart.properties.topicHeader=e,f(e)&&(this.showTopicHeader=!1)}get title(){return this._layoutPart.properties.title}set title(e){this.json.Title=e,this._layoutPart.properties.title=e}get reservedHeight(){return this._layoutPart.reservedHeight}set reservedHeight(e){this._layoutPart.reservedHeight=e}get description(){return this.json.Description}set description(e){if(!f(e)&&e.length>255)throw Error("Modern Page description is limited to 255 chars.");this.json.Description=e,v(this._pageSettings,"htmlAttributes")||(this._pageSettings.htmlAttributes=[]),this._pageSettings.htmlAttributes.indexOf("modifiedDescription")<0&&this._pageSettings.htmlAttributes.push("modifiedDescription"),this._pageSettings.pageSettingsSlice.isDefaultDescription=!1}get layoutType(){return this._layoutPart.properties.layoutType}set layoutType(e){this._layoutPart.properties.layoutType=e}get headerTextAlignment(){return this._layoutPart.properties.textAlignment}set headerTextAlignment(e){this._layoutPart.properties.textAlignment=e}get showTopicHeader(){return this._layoutPart.properties.showTopicHeader}set showTopicHeader(e){this._layoutPart.properties.showTopicHeader=e}get showPublishDate(){return this._layoutPart.properties.showPublishDate}set showPublishDate(e){this._layoutPart.properties.showPublishDate=e}get hasVerticalSection(){return this.sections.findIndex(e=>2===e.layoutIndex)>-1}get authorByLine(){return p(this.json.AuthorByline)&&this.json.AuthorByline.length>0?this.json.AuthorByline[0]:null}get verticalSection(){return this.hasVerticalSection?this.addVerticalSection():null}addSection(){const e=new Ht(this,Ft(this.sections),1);return this.sections.push(e),e}addVerticalSection(){const e=this.sections.findIndex(e=>2===e.layoutIndex);if(e>-1)return this.sections[e];const t=new Ht(this,Ft(this.sections),2);return this.sections.push(t),t}fromJSON(e){this.json=e;const t=JSON.parse(e.CanvasContent1),r=JSON.parse(e.LayoutWebpartsContent);return r&&r.length>0&&(this._layoutPart=r[0]),this.setControls(t),this}load(){return s(this,void 0,void 0,function*(){const e=yield this.getItem("Id","CommentsDisabled"),t=yield _e(this,`_api/sitepages/pages(${e.Id})`)();return this.commentsDisabled=e.CommentsDisabled,this.fromJSON(t)})}save(e=!0){return s(this,void 0,void 0,function*(){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");if(this._bannerImageDirty){const e=this.bannerImageUrl;let t,r;const i=Je(me(this.toUrl())),n=i.createBatch();i.getFileByServerRelativePath(e.replace(/%20/gi," ")).select("ListId","WebId","UniqueId","Name","SiteId").inBatch(n)().then(e=>t=e),i.select("Url").inBatch(n)().then(e=>r=e.Url),yield n.execute();const o=_e(r,"_layouts/15/getpreview.ashx");o.query.set("guidSite",`${t.SiteId}`),o.query.set("guidWeb",`${t.WebId}`),o.query.set("guidFile",`${t.UniqueId}`),this.bannerImageUrl=o.toUrlAndQuery(),h(this._layoutPart.serverProcessedContent)||(this._layoutPart.serverProcessedContent={}),this._layoutPart.serverProcessedContent.imageSources={imageSource:e},h(this._layoutPart.serverProcessedContent.customMetadata)||(this._layoutPart.serverProcessedContent.customMetadata={}),this._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:t.ListId,siteId:t.SiteId,uniqueId:t.UniqueId,webId:t.WebId},this._layoutPart.properties.webId=t.WebId,this._layoutPart.properties.siteId=t.SiteId,this._layoutPart.properties.listId=t.ListId,this._layoutPart.properties.uniqueId=t.UniqueId}this.json.IsPageCheckedOutToCurrentUser||(yield xe(Mt(this,`_api/sitepages/pages(${this.json.Id})/checkoutpage`)));let t=Object.assign(fe("SP.Publishing.SitePage"),{AuthorByline:this.json.AuthorByline||[],CanvasContent1:this.getCanvasContent1(),Description:this.description,LayoutWebpartsContent:this.getLayoutWebpartsContent(),Title:this.title,TopicHeader:this.topicHeader});if(this._bannerImageDirty||this._bannerImageThumbnailUrlDirty){t=g(t,{BannerImageUrl:this._bannerImageThumbnailUrlDirty?this.thumbnailUrl:this.bannerImageUrl})}const r=Mt(this,`_api/sitepages/pages(${this.json.Id})/savepage`);yield xe(r,ye({"if-match":"*"},ge(t)));let i=!0;return e&&(i=yield xe(Mt(this,`_api/sitepages/pages(${this.json.Id})/publish`)))&&(this.json.IsPageCheckedOutToCurrentUser=!1),this._bannerImageDirty=!1,this._bannerImageThumbnailUrlDirty=!1,i})}discardPageCheckout(){return s(this,void 0,void 0,function*(){if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");const e=yield xe(Mt(this,`_api/sitepages/pages(${this.json.Id})/discardPage`),ge(fe("SP.Publishing.SitePage")));this.fromJSON(e)})}promoteToNews(){return s(this,void 0,void 0,function*(){return this.promoteNewsImpl("promoteToNews")})}findControlById(e){return this.findControl(t=>t.id===e)}findControl(e){for(let t=0;t<this.sections.length;t++)for(let r=0;r<this.sections[t].columns.length;r++)for(let i=0;i<this.sections[t].columns[r].controls.length;i++)if(e(this.sections[t].columns[r].controls[i]))return this.sections[t].columns[r].controls[i];return null}copy(e,t,r,i=!0,n){return s(this,void 0,void 0,function*(){const o=yield qt(e,t,r,this.pageLayout,n);if(o.setControls(this.getControls()),!f(this.json.BannerImageUrl)){const e=new URL(this.json.BannerImageUrl),t=e=>e.replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/g,"$1-$2-$3-$4-$5");if(e.searchParams.has("guidSite")&&e.searchParams.has("guidWeb")&&e.searchParams.has("guidFile")){const r=t(e.searchParams.get("guidSite")),i=t(e.searchParams.get("guidWeb")),n=t(e.searchParams.get("guidFile")),s=Ge(me(this.toUrl()));if((yield s.select("Id")()).Id===r){const e=yield s.openWebById(i),t=yield e.web.getFileById(n).select("ServerRelativeUrl")(),r={};this._layoutPart.properties&&(v(this._layoutPart.properties,"translateX")&&(r.translateX=this._layoutPart.properties.translateX),v(this._layoutPart.properties,"translateY")&&(r.translateY=this._layoutPart.properties.translateY),v(this._layoutPart.properties,"imageSourceType")&&(r.imageSourceType=this._layoutPart.properties.imageSourceType),v(this._layoutPart.properties,"altText")&&(r.altText=this._layoutPart.properties.altText)),o.setBannerImage(t.ServerRelativeUrl,r)}}}return yield o.save(i),o})}setBannerImage(e,t){y(e)&&(e=e.replace(/^https?:\/\/[a-z0-9.]*?\.[a-z]{2,3}\//i,"/")),this.json.BannerImageUrl=e,this._bannerImageDirty=!0,this._bannerImageThumbnailUrlDirty||(this.thumbnailUrl=e,this._pageSettings.pageSettingsSlice.isDefaultThumbnail=!0),this._layoutPart.properties.imageSourceType=2,h(t)&&(v(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),v(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),v(t,"imageSourceType")&&(this._layoutPart.properties.imageSourceType=t.imageSourceType),v(t,"altText")&&(this._layoutPart.properties.altText=t.altText))}setBannerImageFromExternalUrl(e,t){return s(this,void 0,void 0,function*(){const r=new URL(e),i=this.json.FileName.replace(/\.[^\/.]+$/,""),n=r.pathname.split(/[\\\/]/i).pop(),o=Mt(this,"_api/sitepages/AddImageFromExternalUrl");o.query.set("imageFileName",`'${encodeURIComponent(n)}'`),o.query.set("pageName",`'${encodeURIComponent(i)}'`),o.query.set("externalUrl",`'${encodeURIComponent(e)}'`),o.select("ServerRelativeUrl");const s=yield xe(o);this.setBannerImage(s.ServerRelativeUrl,t)})}setAuthorById(e){return s(this,void 0,void 0,function*(){const t=yield Ae(me(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter(`Id eq ${e}`).select("LoginName")();if(t.length<1)throw Error(`Could not find user with id ${e}.`);return this.setAuthorByLoginName(t[0].LoginName)})}setAuthorByLoginName(e){return s(this,void 0,void 0,function*(){const t=yield Ae(me(this.toUrl()),"/_api/web/siteusers").configureFrom(this).filter(`LoginName eq '${encodeURIComponent(e)}'`).select("UserPrincipalName","Title")();if(t.length<1)throw Error(`Could not find user with login name '${e}'.`);this.json.AuthorByline=[e],this._layoutPart.properties.authorByline=[e],this._layoutPart.properties.authors=[{id:e,name:t[0].Title,role:"",upn:t[0].UserPrincipalName}]})}getItem(...e){return s(this,void 0,void 0,function*(){const t=Mt(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id"),r=yield xe(t),i=tt(r["odata.id"]).configureFrom(this).items.getById(this.json.Id),n=yield i.select(...e)();return g(at(je(n)).configureFrom(this),n)})}assign(e,t){this.data.parentUrl=e.data.url,this.data.url=u(this.data.parentUrl,t||""),this.configureFrom(e)}getCanvasContent1(){return JSON.stringify(this.getControls())}getLayoutWebpartsContent(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)}setControls(e){if(this.sections=[],e&&e.length){for(let t=0;t<e.length;t++){switch(v(e[t],"controlType")?e[t].controlType:0){case 0:v(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new Vt(e[t]));break;case 3:{const r=new Xt(e[t]);this.mergePartToTree(r,r.data.position);break}case 4:{const r=e[t],i=new zt(r.innerHTML,r);this.mergePartToTree(i,i.data.position);break}}}Bt(this.sections)}}getControls(){Bt(this.sections);const e=[];return this.sections.forEach(t=>{t.columns.forEach(r=>{r.controls.length<1?e.push({displayMode:r.data.displayMode,emphasis:this.getEmphasisObj(t.emphasis),position:r.data.position}):r.controls.forEach(r=>{r.data.emphasis=this.getEmphasisObj(t.emphasis),e.push(r.data)})})}),e.push(this._pageSettings),e}getEmphasisObj(e){return e<1||e>3?{}:{zoneEmphasis:e}}promoteNewsImpl(e){return s(this,void 0,void 0,function*(){if(null===this.json.Id)throw Error("The id for this page is null.");if(f(this.json.VersionInfo.LastVersionCreatedBy)){new Date(this.json.VersionInfo.LastVersionCreated).getFullYear()<2e3&&(yield this.save(!0))}return yield xe(Mt(this,`_api/sitepages/pages(${this.json.Id})/${e}`),ge(fe("SP.Publishing.SitePage")))})}mergePartToTree(e,t){var r,i,n;let o=null,s=12,a=0,l=0,u=1;t&&(v(t,"zoneIndex")&&(l=t.zoneIndex),v(t,"sectionIndex")&&(a=t.sectionIndex),v(t,"sectionFactor")&&(s=t.sectionFactor),v(t,"layoutIndex")&&(u=t.layoutIndex));const c=null!==(n=null===(i=null===(r=e.data)||void 0===r?void 0:r.emphasis)||void 0===i?void 0:i.zoneEmphasis)&&void 0!==n?n:0,d=this.getOrCreateSection(l,u,c),h=d.columns.filter(e=>e.order===a);o=h.length<1?d.addColumn(s,u):h[0],e.column=o,o.addControl(e)}mergeColumnToTree(e){var t,r;const i=v(e.data,"position")&&v(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,n=v(e.data,"position")&&v(e.data.position,"layoutIndex")?e.data.position.layoutIndex:1,o=this.getOrCreateSection(i,n,(null===(r=null===(t=e.data)||void 0===t?void 0:t.emphasis)||void 0===r?void 0:r.zoneEmphasis)||0);e.section=o,o.columns.push(e)}getOrCreateSection(e,t,r){let i=null;const n=this.sections.filter(r=>r.order===e&&r.layoutIndex===t);return n.length<1?((i=2===t?this.addVerticalSection():this.addSection()).order=e,i.emphasis=r):i=n[0],i}}o([ve("csp.load")],jt.prototype,"load",null),o([ve("csp.save")],jt.prototype,"save",null),o([ve("csp.discardPageCheckout")],jt.prototype,"discardPageCheckout",null),o([ve("csp.promoteToNews")],jt.prototype,"promoteToNews",null),o([ve("csp.copy")],jt.prototype,"copy",null),o([ve("csp.getItem")],jt.prototype,"getItem",null);const Wt=(e,t,r,i=!1,n=[],o=!1)=>z(jt)(e,t,r,i,n,o),qt=(e,t,r,i="Article",n=0)=>s(void 0,void 0,void 0,function*(){t=t.replace(/\.aspx$/i,"");const o=yield xe(Mt(e,"_api/sitepages/pages"),ge(Object.assign(fe("SP.Publishing.SitePage"),{PageLayoutType:i,PromotedState:n}))),s=Wt(e,"",o);return s.title=t,yield s.save(!1),s.title=r,s});class Ht{constructor(e,t,r,i=[],n=0){this.page=e,this.columns=i,this._emphasis=n,this._memId=c(),this._order=t,this._layoutIndex=r}get order(){return this._order}set order(e){this._order=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e}get layoutIndex(){return this._layoutIndex}set layoutIndex(e){this._layoutIndex=e;for(let t=0;t<this.columns.length;t++)this.columns[t].data.position.layoutIndex=e}get defaultColumn(){return this.columns.length<1&&this.addColumn(12),this.columns[0]}addColumn(e,t=this.layoutIndex){const r=new Vt;return r.section=this,r.data.position.zoneIndex=this.order,r.data.position.layoutIndex=t,r.data.position.sectionFactor=e,r.order=Ft(this.columns),this.columns.push(r),r}addControl(e){return this.defaultColumn.addControl(e),this}get emphasis(){return this._emphasis}set emphasis(e){this._emphasis=e}remove(){this.page.sections=this.page.sections.filter(e=>e._memId!==this._memId),Bt(this.page.sections)}}class Vt{constructor(e=JSON.parse(JSON.stringify(Vt.Default)),t=[]){this.json=e,this.controls=t,this._section=null,this._memId=c()}get data(){return this.json}get section(){return this._section}set section(e){this._section=e}get order(){return this.data.position.sectionIndex}set order(e){this.data.position.sectionIndex=e;for(let t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.layoutIndex=this.data.position.layoutIndex,this.controls[t].data.position.sectionIndex=e}get factor(){return this.data.position.sectionFactor}set factor(e){this.data.position.sectionFactor=e}addControl(e){return e.column=this,this.controls.push(e),this}getControl(e){return this.controls[e]}remove(){this.section.columns=this.section.columns.filter(e=>e._memId!==this._memId),Bt(this.section.columns)}}Vt.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class Gt{constructor(e){this.json=e}get id(){return this.json.id}get data(){return this.json}get column(){return this._column}set column(e){this._column=e,this.onColumnChange(this._column)}remove(){this.column.controls=this.column.controls.filter(e=>e.id!==this.id),Bt(this.column.controls)}setData(e){this.json=e}}class zt extends Gt{constructor(e,t=JSON.parse(JSON.stringify(zt.Default))){f(t.id)&&(t.id=c(),t.anchorComponentId=t.id),super(t),this.text=e}get text(){return this.data.innerHTML}set text(e){this.data.innerHTML=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=Ft(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order,this.data.position.layoutIndex=e.data.position.layoutIndex}}zt.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}};class Xt extends Gt{constructor(e=JSON.parse(JSON.stringify(Xt.Default))){super(e)}static fromComponentDef(e){const t=new Xt;return t.import(e),t}get title(){return this.data.webPartData.title}set title(e){this.data.webPartData.title=e}get description(){return this.data.webPartData.description}set description(e){this.data.webPartData.description=e}get order(){return this.data.position.controlIndex}set order(e){this.data.position.controlIndex=e}get height(){return this.data.reservedHeight}set height(e){this.data.reservedHeight=e}get width(){return this.data.reservedWidth}set width(e){this.data.reservedWidth=e}get dataVersion(){return this.data.webPartData.dataVersion}set dataVersion(e){this.data.webPartData.dataVersion=e}setProperties(e){return this.data.webPartData.properties=g(this.data.webPartData.properties,e),this}getProperties(){return this.data.webPartData.properties}onColumnChange(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=Ft(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.data.position.sectionIndex,this.data.position.layoutIndex=e.data.position.layoutIndex}import(e){const t=c(),r=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),i=JSON.parse(e.Manifest).preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:i.description.default,id:r,instanceId:t,properties:i.properties,title:i.title.default},webPartId:r}))}}Xt.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},Ke.prototype.getClientsideWebParts=function(){return this.clone(Ae,"GetClientSideWebParts")()},Ke.prototype.addClientsidePage=function(e,t=e.replace(/\.[^\/.]+$/,""),r,i){return qt(this,e,t,r,i)},Ke.prototype.loadClientsidePage=function(e){return(e=>s(void 0,void 0,void 0,function*(){const t=yield e.getItem();return Wt(me(e.toUrl()),"",{Id:t.Id},!0).configureFrom(e).load()}))(this.getFileByServerRelativePath(e))};let Kt=class extends $e{getByName(e){return ve.configure(Yt(this).concat(`('${He(e)}')`),"fs.getByName")}add(e){return s(this,void 0,void 0,function*(){return{data:yield xe(this.clone(Jt,`add('${He(e)}')`)),folder:this.getByName(e)}})}addUsingPath(e,t=!1){return s(this,void 0,void 0,function*(){return{data:yield xe(this.clone(Jt,`addUsingPath(DecodedUrl='${He(e)}',overwrite=${t})`)),folder:Yt(me(this.toUrl()),`_api/web/getFolderByServerRelativePath(decodedUrl='${He(e)}')`)}})}};o([ve("fs.add")],Kt.prototype,"add",null),o([ve("fs.addUsingPath")],Kt.prototype,"addUsingPath",null);const Jt=Fe(Kt=o([Me("folders")],Kt));class Qt extends ke{constructor(){super(...arguments),this.delete=Ne("f"),this.update=this._update("SP.Folder",e=>({data:e,folder:this}))}get contentTypeOrder(){return ve.configure(Ae(this,"contentTypeOrder"),"f.contentTypeOrder")}get folders(){return Jt(this)}get listItemAllFields(){return ve.configure(Ee(this,"listItemAllFields"),"f.listItemAllFields")}get parentFolder(){return ve.configure(Yt(this,"parentFolder"),"f.parentFolder")}get properties(){return ve.configure(Ee(this,"properties"),"f.properties")}get serverRelativeUrl(){return ve.configure(_e(this,"serverRelativeUrl"),"f.serverRelativeUrl")}get uniqueContentTypeOrder(){return ve.configure(Ae(this,"uniqueContentTypeOrder"),"f.uniqueContentTypeOrder")}recycle(){return xe(this.clone(Yt,"recycle"))}getItem(...e){return s(this,void 0,void 0,function*(){const t=yield this.listItemAllFields.select(...e)();return g(at(je(t)),t)})}moveTo(e){return s(this,void 0,void 0,function*(){const t=yield this.getParentInfos(),r=new URL(t.ParentWeb.Url);yield xe(Yt(r.origin,"/_api/SP.MoveCopyUtil.MoveFolder()"),ge({destUrl:y(e)?e:u(r.origin,e),srcUrl:u(r.origin,t.Folder.ServerRelativeUrl)}))})}moveByPath(e,t=!1){return s(this,void 0,void 0,function*(){const r=yield this.getParentInfos(),i=new URL(r.ParentWeb.Url);yield xe(Yt(i.origin,"/_api/SP.MoveCopyUtil.MoveFolderByPath()"),ge({destPath:Qe(y(e)?e:u(i.origin,e)),options:{KeepBoth:t,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Qe(u(i.origin,r.Folder.ServerRelativeUrl))}))})}copyTo(e){return s(this,void 0,void 0,function*(){const t=yield this.getParentInfos(),r=new URL(t.ParentWeb.Url);yield xe(Yt(r.origin,"/_api/SP.MoveCopyUtil.CopyFolder()"),ge({destUrl:y(e)?e:u(r.origin,e),srcUrl:u(r.origin,t.Folder.ServerRelativeUrl)}))})}copyByPath(e,t=!1){return s(this,void 0,void 0,function*(){const r=yield this.getParentInfos(),i=new URL(r.ParentWeb.Url);yield xe(Yt(i.origin,"/_api/SP.MoveCopyUtil.CopyFolderByPath()"),ge({destPath:Qe(y(e)?e:u(i.origin,e)),options:{KeepBoth:t,ResetAuthorAndCreatedOnCopy:!0,ShouldBypassSharedLocks:!0,__metadata:{type:"SP.MoveCopyOptions"}},srcPath:Qe(u(i.origin,r.Folder.ServerRelativeUrl))}))})}deleteWithParams(e){return s(this,void 0,void 0,function*(){return xe(this.clone(Yt,"DeleteWithParameters"),ge({parameters:e}))})}addSubFolderUsingPath(e){return s(this,void 0,void 0,function*(){return yield xe(this.clone(Yt,"AddSubFolderUsingPath"),ge({leafPath:Qe(e)})),this.folders.getByName(e)})}getParentInfos(){return s(this,void 0,void 0,function*(){const e=yield this.select("ServerRelativeUrl","ListItemAllFields/ParentList/Id","ListItemAllFields/ParentList/RootFolder/UniqueId","ListItemAllFields/ParentList/RootFolder/ServerRelativeUrl","ListItemAllFields/ParentList/RootFolder/ServerRelativePath","ListItemAllFields/ParentList/ParentWeb/Id","ListItemAllFields/ParentList/ParentWeb/Url","ListItemAllFields/ParentList/ParentWeb/ServerRelativeUrl","ListItemAllFields/ParentList/ParentWeb/ServerRelativePath").expand("ListItemAllFields/ParentList","ListItemAllFields/ParentList/RootFolder","ListItemAllFields/ParentList/ParentWeb")();return{Folder:{ServerRelativeUrl:e.ServerRelativeUrl},ParentList:{Id:e.ListItemAllFields.ParentList.Id,RootFolderServerRelativePath:e.ListItemAllFields.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ListItemAllFields.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ListItemAllFields.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ListItemAllFields.ParentList.ParentWeb.Id,ServerRelativePath:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ListItemAllFields.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ListItemAllFields.ParentList.ParentWeb.Url}}})}getShareable(){return s(this,void 0,void 0,function*(){const e=yield this.clone(Ee,"listItemAllFields",!1).select("odata.id")();let t=at(je(e));return this.hasBatch&&(t=t.inBatch(this.batch)),t})}}o([ve("f.recycle")],Qt.prototype,"recycle",null),o([ve("f.getItem")],Qt.prototype,"getItem",null),o([ve("f.moveTo")],Qt.prototype,"moveTo",null),o([ve("f.moveByPath")],Qt.prototype,"moveByPath",null),o([ve("f.copyTo")],Qt.prototype,"copyTo",null),o([ve("f.copyByPath")],Qt.prototype,"copyByPath",null),o([ve("f.del-params")],Qt.prototype,"deleteWithParams",null),o([ve("f.getShareable")],Qt.prototype,"getShareable",null);const Yt=Fe(Qt);N(et,"rootFolder",Yt,"rootFolder"),et.prototype.getDefaultColumnValues=function(){return s(this,void 0,void 0,function*(){const e=yield this.rootFolder.select("ServerRelativePath")(),t=yield this.select("ParentWeb/Url").expand("ParentWeb")(),r=u("/",e.ServerRelativePath.DecodedUrl,"Forms/client_LocationBasedDefaults.html"),i=u(t.ParentWeb.Url,"_api/web",`getFileByServerRelativePath(decodedUrl='${He(r)}')`);let n="";try{n=yield Yt(i,"$value").usingParser(new Y)(ye({binaryStringResponseBody:"true"}))}catch(e){if(e&&e.status&&404===e.status)return[];throw e}const o=n.match(/<a.*?<\/a>/gi);return(null===o?[]:o.map(e=>e.trim())).reduce((e,t)=>{const r=/<a href="(.*?)">/gi.exec(t);if(r.length<1)return oe.write(`Could not parse default column value from '${t}'`,2),null;const i=t.match(/<DefaultValue.*?<\/DefaultValue>/gi);return(null===i?[]:i.map(e=>e.trim())).map(t=>{const i=/<DefaultValue FieldName="(.*?)">(.*?)<\/DefaultValue>/gi.exec(t);i.length<1?oe.write(`Could not parse default column value from '${t}'`,2):e.push({name:i[1],path:decodeURIComponent(r[1]),value:i[2]})}),e},[]).filter(e=>null!==e)})},et.prototype.setDefaultColumnValues=function(e){return s(this,void 0,void 0,function*(){const t=yield Ae(this,"fields").select("InternalName","TypeAsString").filter("Hidden ne true")(),r=`<MetadataDefaults>${e.map(e=>{const r=t.findIndex(t=>t.InternalName===e.name);if(r<0)throw Error(`Field '${e.name}' does not exist in the list. Please check the internal field name. Failed to set defaults.`);const i=t[r];let n="";switch(i.TypeAsString){case"Boolean":case"Currency":case"Text":case"DateTime":case"Number":case"Choice":case"User":if(p(e.value))throw Error(`The type '${i.TypeAsString}' does not support multiple values.`);n=`${e.value}`;break;case"MultiChoice":n=p(e.value)?e.value.map(e=>`${e}`).join(";"):`${e.value}`;break;case"UserMulti":n=p(e.value)?e.value.map(e=>`${e}`).join(";#"):`${e.value}`;break;case"Taxonomy":case"TaxonomyFieldType":if(p(e.value))throw Error(`The type '${i.TypeAsString}' does not support multiple values.`);n=`${e.value.wssId};#${e.value.termName}|${e.value.termId}`;break;case"TaxonomyMulti":case"TaxonomyFieldTypeMulti":p(e.value)&&(n=e.value.map(e=>`${e.wssId};#${e.termName}|${e.termId}`).join(";#")),n=`${e.value.wssId};#${e.value.termName}|${e.value.termId}`}return`<a href="${e.path.replace(/ /gi,"%20")}"><DefaultValue FieldName="${e.name}">${n}</DefaultValue></a>`}).join("")}</MetadataDefaults>`,i=yield this.rootFolder.select("ServerRelativePath")(),n=yield this.select("ParentWeb/Url").expand("ParentWeb")(),o=u("/",i.ServerRelativePath.DecodedUrl,"Forms"),s=u(n.ParentWeb.Url,"_api/web",`getFolderByServerRelativePath(decodedUrl='${He(o)}')`,"files");yield xe(Yt(s,"add(overwrite=true,url='client_LocationBasedDefaults.html')"),{body:r}),(yield this.eventReceivers.filter("ReceiverName eq 'LocationBasedMetadataDefaultsReceiver ItemAdded'").select("ReceiverId")()).length<1&&(yield xe(tt(this.eventReceivers,"add"),ge({eventReceiverCreationInformation:{EventType:10001,ReceiverAssembly:"Microsoft.Office.DocumentManagement, Version=16.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c",ReceiverClass:"Microsoft.Office.DocumentManagement.LocationBasedMetadataDefaultsReceiver",ReceiverName:"LocationBasedMetadataDefaultsReceiver ItemAdded",SequenceNumber:1e3,Synchronization:1}})))})},N(Ke,"lists",Ze),N(Ke,"siteUserInfoList",tt,"siteuserinfolist"),N(Ke,"defaultDocumentLibrary",tt,"DefaultDocumentLibrary"),N(Ke,"customListTemplates",Ae,"getcustomlisttemplates"),Ke.prototype.getList=function(e){return tt(this,`getList('${He(e)}')`)},Ke.prototype.getCatalog=function(e){return s(this,void 0,void 0,function*(){const t=yield this.clone(Je,`getcatalog(${e})`).select("Id").get();return tt(je(t))})},Qt.prototype.getDefaultColumnValues=function(){return s(this,void 0,void 0,function*(){const e=yield Yt(this,"Properties").select("vti_x005f_listname")(),{ServerRelativePath:t}=yield this.select("ServerRelativePath")(),r=Je(me(je(e))).lists.getById(e.vti_x005f_listname);return(yield r.getDefaultColumnValues()).filter(e=>e.path.toLowerCase()===t.DecodedUrl.toLowerCase())})},Qt.prototype.setDefaultColumnValues=function(e,t=!0){return s(this,void 0,void 0,function*(){const r=yield Yt(this,"Properties").select("vti_x005f_listname")(),i=Je(me(je(r))).lists.getById(r.vti_x005f_listname),n=(yield this.select("ServerRelativePath")()).ServerRelativePath.DecodedUrl,o=yield i.getDefaultColumnValues(),s=t?o:o.filter(e=>e.path!==n);e.forEach(e=>{const t=s.find(t=>t.name===e.name&&t.path===n);t?t.value=e.value:s.push({name:e.name,path:n,value:e.value})}),yield i.setDefaultColumnValues(s)})},Qt.prototype.clearDefaultColumnValues=function(){return s(this,void 0,void 0,function*(){yield this.setDefaultColumnValues([],!1)})};let Zt=class extends $e{addAvailableContentType(e){return s(this,void 0,void 0,function*(){const t=yield xe(this.clone(er,"addAvailableContentType"),ge({contentTypeId:e}));return{contentType:this.getById(t.id),data:t}})}getById(e){return ve.configure(rr(this).concat(`('${e}')`),"cts.getById")}add(e,t,r="",i="Custom Content Types",n={}){return s(this,void 0,void 0,function*(){const o=ge(Object.assign(fe("SP.ContentType"),{Description:r,Group:i,Id:{StringValue:e},Name:t},n)),s=yield xe(this,o);return{contentType:this.getById(s.id),data:s}})}};o([ve("cts.addAvailableContentType")],Zt.prototype,"addAvailableContentType",null),o([ve("cts.add")],Zt.prototype,"add",null);const er=Fe(Zt=o([Me("contenttypes")],Zt));class tr extends ke{constructor(){super(...arguments),this.delete=Oe("ct")}get fieldLinks(){return ve.configure(nr(this),"ct.fieldLinks")}get fields(){return ve.configure(Ae(this,"fields"),"ct.fields")}get parent(){return ve.configure(rr(this,"parent"),"ct.parent")}get workflowAssociations(){return ve.configure(Ae(this,"workflowAssociations"),"ct.workflowAssociations")}}const rr=Fe(tr);let ir=class extends $e{getById(e){return ve.configure(or(this).concat(`(guid'${e}')`),"fls.getById")}};const nr=Fe(ir=o([Me("fieldlinks")],ir));const or=Fe(class extends ke{});N(Ke,"contentTypes",er),N(st,"contentType",rr,"ContentType"),N(et,"contentTypes",er);let sr=class extends $e{add(e,t=!1){return s(this,void 0,void 0,function*(){return{data:yield xe(this.clone(ar,"add"),ge({featdefScope:0,featureId:e,force:t})),feature:this.getById(e)}})}getById(e){const t=ur(this);return t.concat(`('${e}')`),ve.configure(t,"fes.getById")}remove(e,t=!1){return xe(this.clone(ar,"remove"),ge({featureId:e,force:t}))}};o([ve("fes.add")],sr.prototype,"add",null),o([ve("fes.remove")],sr.prototype,"remove",null);const ar=Fe(sr=o([Me("features")],sr));class lr extends ke{deactivate(e=!1){return s(this,void 0,void 0,function*(){const t=this.addBatchDependency(),r=yield ur(this).select("DefinitionId")(),i=this.getParent(ar,this.parentUrl,"",this.batch).remove(r.DefinitionId,e);return t(),i})}}o([ve("fe.deactivate")],lr.prototype,"deactivate",null);const ur=Fe(lr);N(Ve,"features",ar),N(Ke,"features",ar);let cr=class extends $e{createFieldAsXml(e){return s(this,void 0,void 0,function*(){"string"==typeof e&&(e={SchemaXml:e});const t=ge({parameters:g(fe("SP.XmlSchemaFieldCreationInformation"),e)}),r=yield xe(this.clone(dr,"createfieldasxml"),t);return{data:r,field:this.getById(r.Id)}})}getById(e){return ve.configure(pr(this).concat(`('${e}')`),"fs.getById")}getByTitle(e){return ve.configure(pr(this,`getByTitle('${e}')`),"fs.getByTitle")}getByInternalNameOrTitle(e){return ve.configure(pr(this,`getByInternalNameOrTitle('${e}')`),"fs.getByInternalNameOrTitle")}add(e,t,r){return s(this,void 0,void 0,function*(){const i=ge(Object.assign(fe(t),{Title:e},r));ve.isTagged(this)||ve.configure(this,"fs.add");const n=yield xe(this.clone(dr,null),i);return{data:n,field:this.getById(n.Id)}})}addText(e,t=255,r){const i={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",g(i,r))}addCalculated(e,t,r,i=gr.Text,n){const o={DateFormat:r,FieldTypeKind:17,Formula:t,OutputType:i};return this.add(e,"SP.FieldCalculated",g(o,n))}addDateTime(e,t=yr.DateOnly,r=vr.Gregorian,i=fr.Unspecified,n){const o={DateTimeCalendarType:r,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:i};return this.add(e,"SP.FieldDateTime",g(o,n))}addNumber(e,t,r,i){let n={FieldTypeKind:9};return void 0!==t&&(n=g({MinimumValue:t},n)),void 0!==r&&(n=g({MaximumValue:r},n)),this.add(e,"SP.FieldNumber",g(n,i))}addCurrency(e,t,r,i=1033,n){let o={CurrencyLocaleId:i,FieldTypeKind:10};return void 0!==t&&(o=g({MinimumValue:t},o)),void 0!==r&&(o=g({MaximumValue:r},o)),this.add(e,"SP.FieldCurrency",g(o,n))}addMultilineText(e,t=6,r=!0,i=!1,n=!1,o=!0,s){const a={AllowHyperlink:o,AppendOnly:n,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:i,RichText:r};return this.add(e,"SP.FieldMultiLineText",g(a,s))}addUrl(e,t=Sr.Hyperlink,r){const i={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",g(i,r))}addUser(e,t,r){const i={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",g(i,r))}addLookup(e,t,r,i){return s(this,void 0,void 0,function*(){const n=g({FieldTypeKind:7,LookupFieldName:r,LookupListId:t,Title:e},i),o=ge({parameters:g(fe("SP.FieldCreationInformation"),n)}),s=yield xe(this.clone(dr,"addfield"),o);return{data:s,field:this.getById(s.Id)}})}addChoice(e,t,r=Pr.Dropdown,i,n){const o={Choices:{results:t},EditFormat:r,FieldTypeKind:6,FillInChoice:i};return this.add(e,"SP.FieldChoice",g(o,n))}addMultiChoice(e,t,r,i){const n={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",g(n,i))}addBoolean(e,t){return this.add(e,"SP.Field",g({FieldTypeKind:8},t))}addDependentLookupField(e,t,r){return s(this,void 0,void 0,function*(){const i=`adddependentlookupfield(displayName='${e}', primarylookupfieldid='${t}', showfield='${r}')`,n=yield xe(this.clone(dr,i));return{data:n,field:this.getById(n.Id)}})}addLocation(e,t){return this.add(e,"SP.FieldLocation",g({FieldTypeKind:33},t))}};o([ve("fs.createFieldAsXml")],cr.prototype,"createFieldAsXml",null),o([ve("fs.addText")],cr.prototype,"addText",null),o([ve("fs.addCalculated")],cr.prototype,"addCalculated",null),o([ve("fs.addDateTime")],cr.prototype,"addDateTime",null),o([ve("fs.addNumber")],cr.prototype,"addNumber",null),o([ve("fs.addCurrency")],cr.prototype,"addCurrency",null),o([ve("fs.addMultilineText")],cr.prototype,"addMultilineText",null),o([ve("fs.addUrl")],cr.prototype,"addUrl",null),o([ve("fs.addUser")],cr.prototype,"addUser",null),o([ve("fs.addLookup")],cr.prototype,"addLookup",null),o([ve("fs.addChoice")],cr.prototype,"addChoice",null),o([ve("fs.addMultiChoice")],cr.prototype,"addMultiChoice",null),o([ve("fs.addBoolean")],cr.prototype,"addBoolean",null),o([ve("fs.addDependentLookupField")],cr.prototype,"addDependentLookupField",null),o([ve("fs.addLocation")],cr.prototype,"addLocation",null);const dr=Fe(cr=o([Me("fields")],cr));class hr extends ke{constructor(){super(...arguments),this.delete=Oe("f")}update(e,t){return s(this,void 0,void 0,function*(){if(null==t){const e=yield pr(this).select("FieldTypeKind").configure({headers:{Accept:"application/json"}})();t=e["odata.type"]}const r=ge(g(fe(t),e),ye({"X-HTTP-Method":"MERGE"}));return{data:yield xe(this,r),field:this}})}setShowInDisplayForm(e){return xe(this.clone(pr,`setshowindisplayform(${e})`))}setShowInEditForm(e){return xe(this.clone(pr,`setshowineditform(${e})`))}setShowInNewForm(e){return xe(this.clone(pr,`setshowinnewform(${e})`))}}o([ve("f.update")],hr.prototype,"update",null),o([ve("f.setShowInDisplayForm")],hr.prototype,"setShowInDisplayForm",null),o([ve("f.setShowInEditForm")],hr.prototype,"setShowInEditForm",null),o([ve("f.setShowInNewForm")],hr.prototype,"setShowInNewForm",null);const pr=Fe(hr);var gr,yr,fr,mr,vr,Sr,br,Pr;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(gr||(gr={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(yr||(yr={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(fr||(fr={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(mr||(mr={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(vr||(vr={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(Sr||(Sr={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(br||(br={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(Pr||(Pr={})),N(Ke,"fields",dr),N(Ke,"availablefields",dr,"availablefields"),N(et,"fields",dr),N(Qt,"files",yt),N(st,"file",mt,"file"),N(st,"folder",Yt,"folder"),N(et,"rootFolder",Yt,"rootFolder"),N(Ke,"folders",Jt),N(Ke,"rootFolder",Yt,"rootFolder"),Ke.prototype.getFolderByServerRelativeUrl=function(e){return Yt(this,`getFolderByServerRelativeUrl('${He(e)}')`)},Ke.prototype.getFolderByServerRelativePath=function(e){return Yt(this,`getFolderByServerRelativePath(decodedUrl='${He(e)}')`)},Ke.prototype.getFolderById=function(e){return Yt(this,`getFolderById('${e}')`)};let Ir=class extends $e{getById(e){return ve.configure(Tr(this).concat(`('${e}')`),"fos.getById")}};const wr=Fe(Ir=o([Me("forms")],Ir));const Tr=Fe(class extends ke{});N(et,"forms",wr,"forms");let Cr=class extends $e{getById(e){return ve.configure(Rr(this,`GetById?hubSiteId='${e}'`),"hss.getById")}};const xr=Fe(Cr=o([Me("_api/hubsites")],Cr));class Ur extends ke{getSite(){return s(this,void 0,void 0,function*(){const e=yield this.select("SiteUrl")();return Ge(e.SiteUrl)})}}o([ve("hs.getSite")],Ur.prototype,"getSite",null);const Rr=Fe(Ur);Ve.prototype.joinHubSite=function(e){return s(this,void 0,void 0,function*(){yield xe(this.clone(Ge,`joinHubSite('${e}')`))})},Ve.prototype.registerHubSite=function(){return s(this,void 0,void 0,function*(){yield xe(this.clone(Ge,"registerHubSite"))})},Ve.prototype.unRegisterHubSite=function(){return s(this,void 0,void 0,function*(){yield xe(this.clone(Ge,"unRegisterHubSite"))})},Ke.prototype.hubSiteData=function(e=!1){return s(this,void 0,void 0,function*(){const t=yield this.clone(Je,`hubSiteData(${e})`)();return"string"==typeof t?JSON.parse(t):t})},Ke.prototype.syncHubSiteTheme=function(){return xe(this.clone(Je,"syncHubSiteTheme"))},Reflect.defineProperty($.prototype,"hubSites",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>xr(t).configure(e).setRuntime(r))}});class Dr extends $e{getById(e){return ve.configure(Br(this).concat(`(${e})`),"nns.getById")}add(e,t,r=!0){return s(this,void 0,void 0,function*(){const i=ge(g(fe("SP.NavigationNode"),{IsVisible:r,Title:e,Url:t})),n=yield xe(this.clone(Lr,null),i);return{data:n,node:this.getById(n.Id)}})}moveAfter(e,t){const r=ge({nodeId:e,previousNodeId:t});return xe(this.clone(Lr,"MoveAfter"),r)}}o([ve("nns.add")],Dr.prototype,"add",null),o([ve("nns.moveAfter")],Dr.prototype,"moveAfter",null);const Lr=Fe(Dr);class Fr extends ke{constructor(){super(...arguments),this.delete=Oe("nn")}get children(){return ve.configure(Lr(this,"children"),"nn.children")}update(e){return s(this,void 0,void 0,function*(){const t=ge(g(fe("SP.NavigationNode"),e),ye({"X-HTTP-Method":"MERGE"}));return{data:yield xe(this,t),node:this}})}}o([ve("nn.update")],Fr.prototype,"update",null);const Br=Fe(Fr);let _r=class extends Be{get quicklaunch(){return ve.configure(Lr(this,"quicklaunch"),"n.quicklaunch")}get topNavigationBar(){return ve.configure(Lr(this,"topnavigationbar"),"n.topnavigationbar")}};const $r=Fe(_r=o([Me("navigation")],_r));class Ar extends Be{constructor(e=null){super("_api/navigation",e)}getMenuState(e=null,t=10,r=null,i=null){return xe(kr("MenuState"),ge({customProperties:i,depth:t,mapProviderName:r,menuNodeKey:e}))}getMenuNodeKey(e,t=null){return xe(kr("MenuNodeKey"),ge({currentUrl:e,mapProviderName:t}))}}o([ve("ns.getMenuState")],Ar.prototype,"getMenuState",null),o([ve("ns.getMenuNodeKey")],Ar.prototype,"getMenuNodeKey",null);const kr=e=>new Ar(e);N(Ke,"navigation",$r),Reflect.defineProperty($.prototype,"navigation",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>kr(t).configure(e).setRuntime(r))}});class Er extends ke{constructor(e,t="_api/sp.userprofiles.peoplemanager"){super(e,t),this.clientPeoplePickerQuery=new jr(e).configureFrom(this),this.profileLoader=new Nr(e).configureFrom(this)}get editProfileLink(){return this.clone(Or,"EditProfileLink").get()}get isMyPeopleListPublic(){return this.clone(Or,"IsMyPeopleListPublic").get()}amIFollowedBy(e){const t=this.clone(Or,"amifollowedby(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}amIFollowing(e){const t=this.clone(Or,"amifollowing(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}getFollowedTags(e=20){return this.clone(Or,`getfollowedtags(${e})`).get()}getFollowersFor(e){const t=this.clone(Or,"getfollowersfor(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}get myFollowers(){return Ae(this,"getmyfollowers")}get myProperties(){return new Er(this,"getmyproperties")}getPeopleFollowedBy(e){const t=this.clone(Or,"getpeoplefollowedby(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}getPropertiesFor(e){const t=this.clone(Or,"getpropertiesfor(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}get trendingTags(){const e=this.clone(Or,null);return e.concat(".gettrendingtags"),e.get()}getUserProfilePropertyFor(e,t){const r=this.clone(Or,`getuserprofilepropertyfor(accountname=@v, propertyname='${t}')`);return r.query.set("@v",`'${encodeURIComponent(e)}'`),r.get()}hideSuggestion(e){const t=this.clone(Or,"hidesuggestion(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),xe(t)}isFollowing(e,t){const r=this.clone(Or,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.set("@v",`'${encodeURIComponent(e)}'`),r.query.set("@y",`'${encodeURIComponent(t)}'`),r.get()}setMyProfilePic(e){return new Promise((t,r)=>{const i=new FileReader;i.onload=(e=>s(this,void 0,void 0,function*(){const i=e.target.result;try{yield xe(Or(this,"setmyprofilepicture"),{body:i}),t()}catch(e){r(e)}})),i.readAsArrayBuffer(e)})}setSingleValueProfileProperty(e,t,r){return xe(this.clone(Or,"SetSingleValueProfileProperty"),ge({accountName:e,propertyName:t,propertyValue:r}))}setMultiValuedProfileProperty(e,t,r){return xe(this.clone(Or,"SetMultiValuedProfileProperty"),ge({accountName:e,propertyName:t,propertyValues:r}))}createPersonalSiteEnqueueBulk(...e){return this.profileLoader.createPersonalSiteEnqueueBulk(e)}get ownerUserProfile(){return this.profileLoader.ownerUserProfile}get userProfile(){return this.profileLoader.userProfile}createPersonalSite(e=!1){return this.profileLoader.createPersonalSite(e)}shareAllSocialData(e){return this.profileLoader.shareAllSocialData(e)}clientPeoplePickerResolveUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)}clientPeoplePickerSearchUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)}}const Or=Fe(Er);let Nr=class extends Be{createPersonalSiteEnqueueBulk(e){return xe(this.clone(Mr,"createpersonalsiteenqueuebulk",!1),ge({emailIDs:e}))}get ownerUserProfile(){let e=this.getParent(Mr,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),xe(e)}get userProfile(){return xe(this.clone(Mr,"getuserprofile"))}createPersonalSite(e=!1){return xe(this.clone(Mr,`getuserprofile/createpersonalsiteenque(${e})`))}shareAllSocialData(e){return xe(this.clone(Mr,`getuserprofile/shareallsocialdata(${e})`))}};Nr=o([Me("_api/sp.userprofiles.profileloader.getprofileloader")],Nr);const Mr=(e,t)=>new Nr(e,t);let jr=class extends Be{clientPeoplePickerResolveUser(e){return s(this,void 0,void 0,function*(){const t=this.clone(Wr,null);t.concat(".clientpeoplepickerresolveuser");const r=yield xe(t,this.getBodyFrom(e));return JSON.parse("object"==typeof r?r.ClientPeoplePickerResolveUser:r)})}clientPeoplePickerSearchUser(e){return s(this,void 0,void 0,function*(){const t=this.clone(Wr,null);t.concat(".clientpeoplepickersearchuser");const r=yield xe(t,this.getBodyFrom(e));return JSON.parse("object"==typeof r?r.ClientPeoplePickerSearchUser:r)})}getBodyFrom(e){return ge({queryParams:g(fe("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})}};jr=o([Me("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],jr);const Wr=(e,t)=>new jr(e,t);var qr;!function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(qr||(qr={})),Reflect.defineProperty($.prototype,"profiles",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>Or(t).configure(e).setRuntime(r))}});let Hr=class extends ke{get installedLanguages(){return console.warn("Deprecated: RegionalSettings.installedLanguages is deprecated, please use RegionalSettings.getInstalledLanguages"),ve.configure(Ae(this,"installedlanguages"),"rs.installedLanguages")}get timeZone(){return ve.configure(zr(this),"rs.tz")}get timeZones(){return ve.configure(Kr(this),"rs.tzs")}getInstalledLanguages(){return s(this,void 0,void 0,function*(){return(yield ve.configure(Ae(this,"installedlanguages"),"rs.getInstalledLanguages")()).Items})}};const Vr=Fe(Hr=o([Me("regionalsettings")],Hr));let Gr=class extends ke{utcToLocalTime(e){return s(this,void 0,void 0,function*(){let t;t="string"==typeof e?e:e.toISOString();const r=yield xe(this.clone(zr,`utctolocaltime('${t}')`));return v(r,"UTCToLocalTime")?r.UTCToLocalTime:r})}localTimeToUTC(e){return s(this,void 0,void 0,function*(){let t;t="string"==typeof e?e:l(e,"minute",-1*e.getTimezoneOffset()).toISOString();const r=yield xe(this.clone(zr,`localtimetoutc('${t}')`));return v(r,"LocalTimeToUTC")?r.LocalTimeToUTC:r})}};o([ve("tz.utcToLocalTime")],Gr.prototype,"utcToLocalTime",null),o([ve("tz.localTimeToUTC")],Gr.prototype,"localTimeToUTC",null);const zr=Fe(Gr=o([Me("timezone")],Gr));let Xr=class extends $e{getById(e){return xe(this.clone(Kr,`GetById(${e})`).usingParser(new We(zr)))}};o([ve("tzs.getById")],Xr.prototype,"getById",null);const Kr=Fe(Xr=o([Me("timezones")],Xr));function Jr(e){return function(t){return xe(this.clone(_e,`${e}/getValueForUICulture`),ge({cultureName:t}))}}N(Ke,"regionalSettings",Vr),Ke.prototype.titleResource=Jr("titleResource"),Ke.prototype.descriptionResource=Jr("descriptionResource");let Qr=class extends $e{getById(e){return ve.configure(ei(this).concat(`('${e}')`),"ucas.getById")}add(e){return s(this,void 0,void 0,function*(){const t=yield xe(this,ge(g(fe("SP.UserCustomAction"),e)));return{action:this.getById(t.Id),data:t}})}clear(){return xe(this.clone(Yr,"clear"))}};o([ve("ucas.add")],Qr.prototype,"add",null),o([ve("ucas.clear")],Qr.prototype,"clear",null);const Yr=Fe(Qr=o([Me("usercustomactions")],Qr));class Zr extends ke{constructor(){super(...arguments),this.delete=Oe("uca"),this.update=this._update("SP.UserCustomAction",e=>({data:e,action:this}))}}const ei=Fe(Zr);var ti,ri;!function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(ti||(ti={})),function(e){e[e.Unknown=0]="Unknown",e[e.Site=2]="Site",e[e.Web=3]="Web",e[e.List=4]="List"}(ri||(ri={})),Zr.prototype.titleResource=Jr("titleResource"),Zr.prototype.descriptionResource=Jr("descriptionResource"),et.prototype.titleResource=Jr("titleResource"),et.prototype.descriptionResource=Jr("descriptionResource"),hr.prototype.titleResource=Jr("titleResource"),hr.prototype.descriptionResource=Jr("descriptionResource"),tr.prototype.titleResource=Jr("titleResource"),tr.prototype.descriptionResource=Jr("descriptionResource");let ii=class extends Be{getRelatedItems(e,t){const r=this.clone(ni,null);return r.concat(".GetRelatedItems"),xe(r,ge({SourceItemID:t,SourceListName:e}))}getPageOneRelatedItems(e,t){const r=this.clone(ni,null);return r.concat(".GetPageOneRelatedItems"),xe(r,ge({SourceItemID:t,SourceListName:e}))}addSingleLink(e,t,r,i,n,o,s=!1){const a=this.clone(ni,null);return a.concat(".AddSingleLink"),xe(a,ge({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:n,TargetListName:i,TargetWebUrl:o,TryAddReverseLink:s}))}addSingleLinkToUrl(e,t,r,i=!1){const n=this.clone(ni,null);return n.concat(".AddSingleLinkToUrl"),xe(n,ge({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:i}))}addSingleLinkFromUrl(e,t,r,i=!1){const n=this.clone(ni,null);return n.concat(".AddSingleLinkFromUrl"),xe(n,ge({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:i}))}deleteSingleLink(e,t,r,i,n,o,s=!1){const a=this.clone(ni,null);return a.concat(".DeleteSingleLink"),xe(a,ge({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:n,TargetListName:i,TargetWebUrl:o,TryDeleteReverseLink:s}))}};o([ve("rim.getRelatedItems")],ii.prototype,"getRelatedItems",null),o([ve("rim.getPageOneRelatedItems")],ii.prototype,"getPageOneRelatedItems",null),o([ve("rim.addSingleLink")],ii.prototype,"addSingleLink",null),o([ve("rim.ToUrl")],ii.prototype,"addSingleLinkToUrl",null),o([ve("rim.FromUrl")],ii.prototype,"addSingleLinkFromUrl",null),o([ve("rim.deleteSingleLink")],ii.prototype,"deleteSingleLink",null),ii=o([Me("_api/SP.RelatedItemManager")],ii);const ni=e=>new ii(me("string"==typeof e?e:e.toUrl()));new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),new Map([]);const oi=/_api\/search\/postquery$/i;let si=class extends ke{execute(e){return s(this,void 0,void 0,function*(){const t=this.parseQuery(e),r=ge({request:g(fe("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},t,{HitHighlightedProperties:this.fixArrProp(t.HitHighlightedProperties),Properties:this.fixArrProp(t.Properties),RefinementFilters:this.fixArrProp(t.RefinementFilters),ReorderingRules:this.fixArrProp(t.ReorderingRules),SelectProperties:this.fixArrProp(t.SelectProperties),SortList:this.fixArrProp(t.SortList)}))});if(this.data.useCaching){this._forceCaching=!0;const e=`PnPjs.SearchWithCaching(${function(e){let t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}(r.body)})`;h(this.data.cachingOptions)?oi.test(this.data.cachingOptions.key)&&(this.data.cachingOptions.key=e):this.data.cachingOptions=new E(e)}const i=yield xe(this,r);return new li(i,this.toUrl(),t)})}fixArrProp(e){return void 0===e?{results:[]}:{results:p(e)?e:[e]}}parseQuery(e){let t;return t="string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e}};o([ve("se.execute")],si.prototype,"execute",null),si=o([Me("_api/search/postquery")],si);const ai=(e,t={},r=w)=>i=>new si(e).configure(t).setRuntime(r).execute(i);class li{constructor(e,t,r,i=null,n=null){this._url=t,this._query=r,this._raw=i,this._primary=n,this._url=this._url.replace(oi,""),this._raw=e.postquery?e.postquery:e}get ElapsedTime(){var e;return(null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.ElapsedTime)||0}get RowCount(){var e,t,r;return(null===(r=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.RowCount)||0}get TotalRows(){var e,t,r;return(null===(r=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.TotalRows)||0}get TotalRowsIncludingDuplicates(){var e,t,r;return(null===(r=null===(t=null===(e=null==this?void 0:this.RawSearchResults)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.TotalRowsIncludingDuplicates)||0}get RawSearchResults(){return this._raw}get PrimarySearchResults(){var e,t,r,i;return null===this._primary&&(this._primary=this.formatSearchResults((null===(i=null===(r=null===(t=null===(e=this._raw)||void 0===e?void 0:e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===r?void 0:r.Table)||void 0===i?void 0:i.Rows)||null)),this._primary}getPage(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);const r=void 0!==t?t:v(this._query,"RowLimit")?this._query.RowLimit:10,i=g(this._query,{RowLimit:r,StartRow:r*(e-1)});return i.StartRow>this.TotalRows?Promise.resolve(null):ai(this._url)(i)}formatSearchResults(e){const t=new Array;if(void 0===e||null==e)return[];const r=e.results?e.results:e;for(const e of r){const r=e.Cells.results?e.Cells.results:e.Cells;t.push(r.reduce((e,t)=>(Reflect.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e),{}))}return t}}let ui=class extends ke{execute(e){return s(this,void 0,void 0,function*(){this.mapQueryToQueryString(e);const t=yield this.get(),r=v(t,"suggest")?e=>t.suggest[e].results:e=>t[e];return{PeopleNames:r("PeopleNames"),PersonalResults:r("PersonalResults"),Queries:r("Queries")}})}mapQueryToQueryString(e){this.query.set("querytext",`'${e.querytext}'`);const t=(e=>t=>r=>{v(e,t)&&this.query.set(r,e[t].toString())})(e);t("count")("inumberofquerysuggestions"),t("personalCount")("inumberofresultsuggestions"),t("preQuery")("fprequerysuggestions"),t("hitHighlighting")("fhithighlighting"),t("capitalize")("fcapitalizefirstletters"),t("culture")("culture"),t("stemming")("enablestemming"),t("includePeople")("showpeoplenamesuggestions"),t("queryRules")("enablequeryrules"),t("prefixMatch")("fprefixmatchallterms")}};o([ve("su.execute")],ui.prototype,"execute",null),ui=o([Me("_api/search/suggest")],ui);var ci,di,hi;!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(ci||(ci={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(di||(di={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(hi||(hi={}));class pi{}pi.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",pi.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",pi.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",pi.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",pi.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",pi.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",pi.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",pi.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",pi.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",pi.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",pi.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",pi.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",pi.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",pi.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",pi.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",$.prototype.search=function(e){return this.childConfigHook(({options:t,baseUrl:r,runtime:i})=>ai(r,t,i)(e))},$.prototype.searchWithCaching=function(e,t){return this.childConfigHook(({options:r,baseUrl:i,runtime:n})=>new si(i).configure(r).setRuntime(n).usingCaching(t).execute(e))},$.prototype.searchSuggest=function(e){return this.childConfigHook(({options:t,baseUrl:r,runtime:i})=>((e,t={},r=w)=>i=>new ui(e).configure(t).setRuntime(r).execute(i))(r,t,i)("string"==typeof e?{querytext:e}:e))};let gi=class extends $e{getById(e){return ve.configure(fi(this,`getById(${e})`),"sus.getById")}getByEmail(e){return ve.configure(fi(this,`getByEmail('${e}')`),"sus.getByEmail")}getByLoginName(e){return ve.configure(fi(this).concat(`('!@v::${encodeURIComponent(e)}')`),"sus.getByLoginName")}removeById(e){return xe(this.clone(yi,`removeById(${e})`))}removeByLoginName(e){const t=this.clone(yi,"removeByLoginName(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),xe(t)}add(e){return s(this,void 0,void 0,function*(){return yield xe(this,ge(g(fe("SP.User"),{LoginName:e}))),this.getByLoginName(e)})}};o([ve("sus.remId")],gi.prototype,"removeById",null),o([ve("sus.remLoginName")],gi.prototype,"removeByLoginName",null),o([ve("sus.add")],gi.prototype,"add",null);const yi=Fe(gi=o([Me("siteusers")],gi));const fi=Fe(class extends ke{constructor(){super(...arguments),this.delete=Oe("su"),this.update=this._update("SP.User",e=>({data:e,user:this}))}get groups(){return ve.configure(vi(this,"groups"),"su.groups")}});let mi=class extends $e{getById(e){return ve.configure(bi(this).concat(`(${e})`),"sgs.getById")}add(e){return s(this,void 0,void 0,function*(){const t=ge(g(fe("SP.Group"),e)),r=yield xe(ve.configure(this,"sgs.add"),t);return{data:r,group:this.getById(r.Id)}})}getByName(e){return ve.configure(bi(this,`getByName('${e}')`),"sgs.getByName")}removeById(e){return xe(this.clone(vi,`removeById('${e}')`))}removeByLoginName(e){return xe(this.clone(vi,`removeByLoginName('${e}')`))}};o([ve("sgs.removeById")],mi.prototype,"removeById",null),o([ve("sgs.removeByLoginName")],mi.prototype,"removeByLoginName",null);const vi=Fe(mi=o([Me("sitegroups")],mi));class Si extends ke{constructor(){super(...arguments),this.update=this._update("SP.Group",(e,t)=>{return{data:e,group:v(t,"Title")?this.getParent(bi,this.parentUrl,`getByName('${t.Title}')`):bi(this)}})}get users(){return ve.configure(yi(this,"users"),"sg.users")}setUserAsOwner(e){return xe(this.clone(bi,`SetUserAsOwner(${e})`))}}o([ve("sg.setUserAsOwner")],Si.prototype,"setUserAsOwner",null);const bi=Fe(Si);let Pi=class extends $e{getById(e){return wi(this).concat(`(${e})`)}add(e,t){return s(this,void 0,void 0,function*(){yield xe(this.clone(Ii,`addroleassignment(principalid=${e}, roledefid=${t})`))})}remove(e,t){return s(this,void 0,void 0,function*(){yield xe(this.clone(Ii,`removeroleassignment(principalid=${e}, roledefid=${t})`))})}};const Ii=Fe(Pi=o([Me("roleassignments")],Pi));const wi=Fe(class extends ke{constructor(){super(...arguments),this.delete=Oe("ra")}get groups(){return ve.configure(vi(this,"groups"),"ra.groups")}get bindings(){return Ae(this,"roledefinitionbindings")}});let Ti=class extends $e{getById(e){return xi(this,`getById(${e})`)}getByName(e){return xi(this,`getbyname('${e}')`)}getByType(e){return xi(this,`getbytype(${e})`)}add(e,t,r,i){return s(this,void 0,void 0,function*(){const n=ge({BasePermissions:{High:i.High.toString(),Low:i.Low.toString()},Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}}),o=yield xe(this,n);return{data:o,definition:this.getById(o.Id)}})}};const Ci=Fe(Ti=o([Me("roledefinitions")],Ti));const xi=Fe(class extends ke{constructor(){super(...arguments),this.delete=Oe("rd")}update(e){return s(this,void 0,void 0,function*(){const t=["BasePermissions"];if(void 0!==v(e,t[0])){e[t[0]]=g(fe(`SP.${t[0]}`),e[t[0]]);const r=e[t[0]];r.High=r.High.toString(),r.Low=r.Low.toString()}const r=ge(g(fe("SP.RoleDefinition"),e),ye({"X-HTTP-Method":"MERGE"})),i=yield xe(this,r);let n=this;return v(e,"Name")&&(n=this.getParent(Ci,this.parentUrl,"").getByName(e.Name)),{data:i,definition:n}})}});var Ui,Ri,Di,Li,Fi,Bi,_i;function $i(e){return s(this,void 0,void 0,function*(){const t=this.clone(Ee,"getUserEffectivePermissions(@user)");t.query.set("@user",`'${encodeURIComponent(e)}'`);const r=yield t.get();return v(r,"GetUserEffectivePermissions")?r.GetUserEffectivePermissions:r})}function Ai(){return s(this,void 0,void 0,function*(){return this.clone(_e,"EffectiveBasePermissions").get().then(e=>v(e,"EffectiveBasePermissions")?e.EffectiveBasePermissions:e)})}function ki(e=!1,t=!1){return s(this,void 0,void 0,function*(){yield xe(this.clone(_e,`breakroleinheritance(copyroleassignments=${e}, clearsubscopes=${t})`))})}function Ei(){return s(this,void 0,void 0,function*(){yield xe(this.clone(_e,"resetroleinheritance"))})}function Oi(e,t){return s(this,void 0,void 0,function*(){const r=yield $i.call(this,e);return this.hasPermissions(r,t)})}function Ni(e){return s(this,void 0,void 0,function*(){const t=yield Ai.call(this);return this.hasPermissions(t,e)})}function Mi(e,t){if(!t)return!0;if(t===Ui.FullMask)return 32767==(32767&e.High)&&65535===e.Low;let r=1;return(t-=1)>=0&&t<32?(r<<=t,0!=(e.Low&r)):t>=32&&t<64&&(r<<=t-32,0!=(e.High&r))}function ji(e,t,r=!1){return s(this,void 0,void 0,function*(){if(r)return Ji(e,t);t=g(t,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0);const i=yield function(e,t){return s(this,void 0,void 0,function*(){if(null==t){const t=e===Ri.Edit?_i.Contributor:_i.Reader,r=yield Ci("_api/web").select("Id").top(1).filter(`RoleTypeKind eq ${t}`)();if(r.length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return`role: ${r[0].Id}`}switch(t){case _i.Contributor:{const e=yield Je("_api/web","associatedmembergroup").select("Id")();return`group: ${e.Id}`}case _i.Reader:case _i.Guest:{const e=yield Je("_api/web","associatedvisitorgroup").select("Id")();return`group: ${e.Id}`}default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}})}(t.role,t.group);Array.isArray(t.loginNames)||(t.loginNames=[t.loginNames]);let n={peoplePickerInput:m(t.loginNames.map(e=>({Key:e}))),roleValue:i,url:t.url};return void 0!==t.emailData&&null!==t.emailData&&(n=g(n,{emailBody:t.emailData.body,emailSubject:void 0!==t.emailData.subject?t.emailData.subject:"Shared with you.",sendEmail:!0})),Ji(e,n)})}function Wi(e,t=null){const r=null!==t?t.toISOString():null,i=ve.configure(this.clone(Ee,"shareLink"),"sh.getShareLink");return xe(i,ge({request:{createLink:!0,emailData:null,settings:{expiration:r,linkKind:e}}}))}function qi(e){const t=ve.configure(this.clone(Ee,"checkPermissions"),"sh.checkPermissions");return xe(t,ge({recipients:e}))}function Hi(e=null,t=[]){const r=ve.configure(this.clone(Ee,"getSharingInformation"),"sh.getSharingInformation");return xe(r.expand(...t),ge({request:e}))}function Vi(e=!0){const t=ve.configure(this.clone(Ee,"getObjectSharingSettings"),"sh.getObjectSharingSettings");return xe(t,ge({useSimplifiedRoles:e}))}function Gi(){return xe(ve.configure(this.clone(Ee,"unshareObject"),"sh.unshareObject"))}function zi(e){return xe(ve.configure(this.clone(Ee,"deleteLinkByKind"),"sh.deleteLinkByKind"),ge({linkKind:e}))}function Xi(e,t=F){return xe(ve.configure(this.clone(Ee,"unshareLink"),"sh.unshareLink"),ge({linkKind:e,shareId:t}))}function Ki(e,t,r,i=!1,n=!1,o){return s(this,void 0,void 0,function*(){Array.isArray(t)||(t=[t]);const s=m(t.map(e=>({Key:e}))),a=r===Ri.Edit?_i.Contributor:_i.Reader,l=Ae("_api/web","roledefinitions"),u=yield l.select("Id").filter(`RoleTypeKind eq ${a}`).get();if(!Array.isArray(u)||u.length<1)throw Error(`Could not locate a role defintion with RoleTypeKind ${a}`);let c={includeAnonymousLinkInEmail:i,peoplePickerInput:s,propagateAcl:n,roleValue:`role:${u[0].Id}`,useSimplifiedRoles:!0};return void 0!==o&&(c=g(c,{emailBody:o.body,emailSubject:void 0!==o.subject?o.subject:"",sendEmail:!0})),xe(ve.configure(e.clone(Ee,"shareObject"),"sh.shareWith"),ge(c))})}function Ji(e,t){const r=ve.configure(Je(me(e.toUrl()),"/_api/SP.Web.ShareObject"),"sh.sendShareObjectRequest");return xe(r.expand("UsersWithAccessRequests","GroupsSharedWith"),ge(t))}!function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(Ui||(Ui={})),N(st,"roleAssignments",Ii),N(st,"firstUniqueAncestorSecurableObject",Ee),st.prototype.getUserEffectivePermissions=$i,st.prototype.getCurrentUserEffectivePermissions=Ai,st.prototype.breakRoleInheritance=ki,st.prototype.resetRoleInheritance=Ei,st.prototype.userHasPermissions=Oi,st.prototype.currentUserHasPermissions=Ni,st.prototype.hasPermissions=Mi,N(et,"roleAssignments",Ii),N(et,"firstUniqueAncestorSecurableObject",Ee),et.prototype.getUserEffectivePermissions=$i,et.prototype.getCurrentUserEffectivePermissions=Ai,et.prototype.breakRoleInheritance=ki,et.prototype.resetRoleInheritance=Ei,et.prototype.userHasPermissions=Oi,et.prototype.currentUserHasPermissions=Ni,et.prototype.hasPermissions=Mi,N(Ke,"roleDefinitions",Ci),N(Ke,"roleAssignments",Ii),N(Ke,"firstUniqueAncestorSecurableObject",Ee),Ke.prototype.getUserEffectivePermissions=$i,Ke.prototype.getCurrentUserEffectivePermissions=Ai,Ke.prototype.breakRoleInheritance=ki,Ke.prototype.resetRoleInheritance=Ei,Ke.prototype.userHasPermissions=Oi,Ke.prototype.currentUserHasPermissions=Ni,Ke.prototype.hasPermissions=Mi,function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(Ri||(Ri={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(Di||(Di={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(Li||(Li={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(Fi||(Fi={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(Bi||(Bi={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(_i||(_i={})),ft.prototype.shareWith=function(e,t=Ri.View,r=!1,i){return Ki(this,e,t,r,!1,i)},ft.prototype.getShareLink=Wi,ft.prototype.checkSharingPermissions=qi,ft.prototype.getSharingInformation=Hi,ft.prototype.getObjectSharingSettings=Vi,ft.prototype.unshare=Gi,ft.prototype.deleteSharingLinkByKind=zi,ft.prototype.unshareLink=Xi,Qt.prototype.shareWith=function(e,t=Ri.View,r=!1,i=!1,n){return s(this,void 0,void 0,function*(){const o=this.addBatchDependency(),s=yield this.getShareable();return o(),s.shareWith(e,t,r,i,n)})},Qt.prototype.getShareLink=function(e,t=null){return s(this,void 0,void 0,function*(){const r=this.addBatchDependency(),i=yield this.getShareable();return r(),i.getShareLink(e,t)})},Qt.prototype.checkSharingPermissions=function(e){return s(this,void 0,void 0,function*(){const t=this.addBatchDependency(),r=yield this.getShareable();return t(),r.checkSharingPermissions(e)})},Qt.prototype.getSharingInformation=function(e,t){return s(this,void 0,void 0,function*(){const r=this.addBatchDependency(),i=yield this.getShareable();return r(),i.getSharingInformation(e,t)})},Qt.prototype.getObjectSharingSettings=function(e=!0){return s(this,void 0,void 0,function*(){const t=this.addBatchDependency(),r=yield this.getShareable();return t(),r.getObjectSharingSettings(e)})},Qt.prototype.unshare=function(){return s(this,void 0,void 0,function*(){const e=this.addBatchDependency(),t=yield this.getShareable();return e(),t.unshare()})},Qt.prototype.deleteSharingLinkByKind=function(e){return s(this,void 0,void 0,function*(){const t=this.addBatchDependency(),r=yield this.getShareable();return t(),r.deleteSharingLinkByKind(e)})},Qt.prototype.unshareLink=function(e,t){return s(this,void 0,void 0,function*(){const r=this.addBatchDependency(),i=yield this.getShareable();return r(),i.unshareLink(e,t)})},st.prototype.shareWith=function(e,t=Ri.View,r=!1,i){return Ki(this,e,t,r,!1,i)},st.prototype.getShareLink=Wi,st.prototype.checkSharingPermissions=qi,st.prototype.getSharingInformation=Hi,st.prototype.getObjectSharingSettings=Vi,st.prototype.unshare=Gi,st.prototype.deleteSharingLinkByKind=zi,st.prototype.unshareLink=Xi,Ke.prototype.shareWith=function(e,t=Ri.View,r){return s(this,void 0,void 0,function*(){const i=this.addBatchDependency(),n=new ke(me(this.toUrl()),"/_api/web/url"),o=yield n.get();return i(),this.shareObject(u(o,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,r)})},Ke.prototype.shareObject=function(e,t,r,i,n,o=!1,s=!1,a=!0){return ji(this,{emailData:i,group:n,includeAnonymousLinkInEmail:s,loginNames:t,propagateAcl:o,role:r,url:e,useSimplifiedRoles:a})},Ke.prototype.shareObjectRaw=function(e){return ji(this,e,!0)},Ke.prototype.unshareObject=function(e){return xe(Je(this,"unshareObject"),ge({url:e}))};class Qi extends Be{constructor(e,t=""){super(me("string"==typeof e?e:e.toUrl()),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}execute(e){return xe(this,ge(e,ye({"Content-Type":"application/json;charset=utf-8"})))}createSiteDesign(e){return this.clone(Zi,"CreateSiteDesign").execute({info:e})}applySiteDesign(e,t){return this.clone(Zi,"ApplySiteDesign").execute({siteDesignId:e,webUrl:t})}getSiteDesigns(){return this.clone(Zi,"GetSiteDesigns").execute({})}getSiteDesignMetadata(e){return this.clone(Zi,"GetSiteDesignMetadata").execute({id:e})}updateSiteDesign(e){return this.clone(Zi,"UpdateSiteDesign").execute({updateInfo:e})}deleteSiteDesign(e){return this.clone(Zi,"DeleteSiteDesign").execute({id:e})}getSiteDesignRights(e){return this.clone(Zi,"GetSiteDesignRights").execute({id:e})}grantSiteDesignRights(e,t,r=1){return this.clone(Zi,"GrantSiteDesignRights").execute({grantedRights:r.toString(),id:e,principalNames:t})}revokeSiteDesignRights(e,t){return this.clone(Zi,"RevokeSiteDesignRights").execute({id:e,principalNames:t})}addSiteDesignTask(e,t){return this.clone(Zi,"AddSiteDesignTask").execute({webUrl:e,siteDesignId:t})}addSiteDesignTaskToCurrentWeb(e){return this.clone(Zi,"AddSiteDesignTaskToCurrentWeb").execute({siteDesignId:e})}getSiteDesignTask(e){return s(this,void 0,void 0,function*(){const t=yield this.clone(Zi,"GetSiteDesignTask").execute({taskId:e});return v(t,"ID")?t:null})}getSiteDesignRun(e,t){return this.clone(Zi,"GetSiteDesignRun").execute({webUrl:e,siteDesignId:t})}getSiteDesignRunStatus(e,t){return this.clone(Zi,"GetSiteDesignRunStatus").execute({webUrl:e,runId:t})}}o([ve("sd.createSiteDesign")],Qi.prototype,"createSiteDesign",null),o([ve("sd.applySiteDesign")],Qi.prototype,"applySiteDesign",null),o([ve("sd.getSiteDesigns")],Qi.prototype,"getSiteDesigns",null),o([ve("sd.getSiteDesignMetadata")],Qi.prototype,"getSiteDesignMetadata",null),o([ve("sd.updateSiteDesign")],Qi.prototype,"updateSiteDesign",null),o([ve("sd.deleteSiteDesign")],Qi.prototype,"deleteSiteDesign",null),o([ve("sd.getSiteDesignRights")],Qi.prototype,"getSiteDesignRights",null),o([ve("sd.grantSiteDesignRights")],Qi.prototype,"grantSiteDesignRights",null),o([ve("sd.revokeSiteDesignRights")],Qi.prototype,"revokeSiteDesignRights",null),o([ve("sd.addSiteDesignTask")],Qi.prototype,"addSiteDesignTask",null),o([ve("sd.addSiteDesignTaskToCurrentWeb")],Qi.prototype,"addSiteDesignTaskToCurrentWeb",null),o([ve("sd.getSiteDesignTask")],Qi.prototype,"getSiteDesignTask",null),o([ve("sd.getSiteDesignRun")],Qi.prototype,"getSiteDesignRun",null),o([ve("sd.getSiteDesignRunStatus")],Qi.prototype,"getSiteDesignRunStatus",null);const Yi=(e,t)=>new Qi(e,t),Zi=(e,t="")=>Yi(e,t);Ke.prototype.getSiteDesignRuns=function(e){return Yi(this,"").getSiteDesignRun(void 0,e)},Ke.prototype.addSiteDesignTask=function(e){return Yi(this,"").addSiteDesignTaskToCurrentWeb(e)},Ke.prototype.getSiteDesignRunStatus=function(e){return Yi(this,"").getSiteDesignRunStatus(void 0,e)},Reflect.defineProperty($.prototype,"siteDesigns",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>Yi(t).configure(e).setRuntime(r))}}),N(Ke,"siteGroups",vi),N(Ke,"associatedOwnerGroup",vi,"associatedownergroup"),N(Ke,"associatedMemberGroup",vi,"associatedmembergroup"),N(Ke,"associatedVisitorGroup",vi,"associatedvisitorgroup"),Ke.prototype.createDefaultAssociatedGroups=function(e,t,r=!1,i=!0,n){return s(this,void 0,void 0,function*(){yield this.breakRoleInheritance(r,i);const o=this.clone(Je,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)");return o.query.set("@u",`'${He(t||"")}'`),o.query.set("@v",`'${He(n||"")}'`),o.query.set("@s",`'${He(e||"")}'`),xe(o)})};class en extends Be{constructor(e,t=""){super(me("string"==typeof e?e:e.toUrl()),`_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility.${t}`)}execute(e){return xe(this,ge(e))}getSiteScripts(){return this.clone(rn,"GetSiteScripts",!0).execute({})}createSiteScript(e,t,r){return this.clone(rn,`CreateSiteScript(Title=@title,Description=@desc)?@title='${He(e)}'&@desc='${He(t)}'`).execute(r)}getSiteScriptMetadata(e){return this.clone(rn,"GetSiteScriptMetadata").execute({id:e})}deleteSiteScript(e){return this.clone(rn,"DeleteSiteScript").execute({id:e})}updateSiteScript(e,t){return t&&(e.Content=JSON.stringify(t)),this.clone(rn,"UpdateSiteScript").execute({updateInfo:e})}getSiteScriptFromList(e){return this.clone(rn,"GetSiteScriptFromList").execute({listUrl:e})}getSiteScriptFromWeb(e,t){return this.clone(rn,"getSiteScriptFromWeb").execute({webUrl:e,info:t})}executeSiteScriptAction(e){return this.clone(rn,"executeSiteScriptAction").execute({actionDefinition:e})}}o([ve("ss.getSiteScripts")],en.prototype,"getSiteScripts",null),o([ve("ss.createSiteScript")],en.prototype,"createSiteScript",null),o([ve("ss.getSiteScriptMetadata")],en.prototype,"getSiteScriptMetadata",null),o([ve("ss.deleteSiteScript")],en.prototype,"deleteSiteScript",null),o([ve("ss.updateSiteScript")],en.prototype,"updateSiteScript",null),o([ve("ss.getSiteScriptFromList")],en.prototype,"getSiteScriptFromList",null),o([ve("ss.getSiteScriptFromWeb")],en.prototype,"getSiteScriptFromWeb",null),o([ve("ss.executeSiteScriptAction")],en.prototype,"executeSiteScriptAction",null);const tn=(e,t)=>new en(e,t),rn=(e,t="")=>tn(e,t);var nn;!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.NoOp=2]="NoOp",e[e.SucceededWithException=3]="SucceededWithException"}(nn||(nn={})),Ke.prototype.getSiteScript=function(e){return tn(this.toUrl(),"").getSiteScriptFromWeb(void 0,e)},et.prototype.getSiteScript=function(){return s(this,void 0,void 0,function*(){const e=yield this.clone(tt).rootFolder.get(),t=u((yield Je(me(this.toUrl())).select("Url").get()).Url,"Lists",e.Name);return tn(this,"").getSiteScriptFromList(t)})},Reflect.defineProperty($.prototype,"siteScripts",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>tn(t).configure(e).setRuntime(r))}}),N(Ke,"siteUsers",yi),N(Ke,"currentUser",fi,"currentuser"),Ke.prototype.ensureUser=function(e){return s(this,void 0,void 0,function*(){const t=yield xe(this.clone(Je,"ensureuser"),ge({logonName:e}));return{data:t,user:fi(je(t))}})},Ke.prototype.getUserById=function(e){return fi(this,`getUserById(${e})`)};let on=class extends ke{get my(){return ln(this)}getFollowedSitesUri(){return s(this,void 0,void 0,function*(){const e=yield this.clone(sn,"FollowedSitesUri").get();return e.FollowedSitesUri||e})}getFollowedDocumentsUri(){return s(this,void 0,void 0,function*(){const e=yield this.clone(sn,"FollowedDocumentsUri").get();return e.FollowedDocumentsUri||e})}follow(e){return s(this,void 0,void 0,function*(){return yield xe(this.clone(sn,"follow"),this.createSocialActorInfoRequestBody(e))})}isFollowed(e){return s(this,void 0,void 0,function*(){return yield xe(this.clone(sn,"isfollowed"),this.createSocialActorInfoRequestBody(e))})}stopFollowing(e){return s(this,void 0,void 0,function*(){return yield xe(this.clone(sn,"stopfollowing"),this.createSocialActorInfoRequestBody(e))})}createSocialActorInfoRequestBody(e){return ge({actor:Object.assign(fe("SP.Social.SocialActorInfo"),{Id:null},e)})}};o([ve("soc.getFollowedSitesUri")],on.prototype,"getFollowedSitesUri",null),o([ve("soc.getFollowedDocumentsUri")],on.prototype,"getFollowedDocumentsUri",null),o([ve("soc.follow")],on.prototype,"follow",null),o([ve("soc.isFollowed")],on.prototype,"isFollowed",null),o([ve("soc.stopFollowing")],on.prototype,"stopFollowing",null),on=o([Me("_api/social.following")],on);const sn=(e,t)=>new on(e,t);let an=class extends ke{followed(e){return s(this,void 0,void 0,function*(){const t=yield this.clone(un,`followed(types=${e})`)();return v(t,"Followed")?t.Followed.results:t})}followedCount(e){return s(this,void 0,void 0,function*(){const t=yield this.clone(un,`followedcount(types=${e})`)();return t.FollowedCount||t})}followers(){return s(this,void 0,void 0,function*(){const e=yield this.clone(un,"followers")();return v(e,"Followers")?e.Followers.results:e})}suggestions(){return s(this,void 0,void 0,function*(){const e=yield this.clone(un,"suggestions")();return v(e,"Suggestions")?e.Suggestions.results:e})}};o([ve("msoc.followed")],an.prototype,"followed",null),o([ve("msoc.followedCount")],an.prototype,"followedCount",null),o([ve("msoc.followers")],an.prototype,"followers",null),o([ve("msoc.suggestions")],an.prototype,"suggestions",null);const ln=Fe(an=o([Me("my")],an)),un=(e,t)=>ln(e,t);var cn,dn,hn,pn;!function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(cn||(cn={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(dn||(dn={})),function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(hn||(hn={})),function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}(pn||(pn={})),Reflect.defineProperty($.prototype,"social",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>(e=>new on(e))(t).configure(e).setRuntime(r))}});const gn=Fe(class extends Be{constructor(e,t){super(me("string"==typeof e?e:e.toUrl()),`_api/SP.Utilities.Utility.${t}`)}excute(e){return xe(this,ge(e))}sendEmail(e){const t={properties:g(fe("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};var r;return e.To&&e.To.length>0&&(t.properties=g(t.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(t.properties=g(t.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(t.properties=g(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=g(t.properties,{AdditionalHeaders:(r=e.AdditionalHeaders,g(fe("Collection(SP.KeyValue)"),{results:Object.keys(r).map(e=>g(fe("SP.KeyValue"),{Key:e,Value:Reflect.get(r,e),ValueType:"Edm.String"}))}))})),ve.configure(this.clone(yn,"SendEmail",!0),"u.sendEmail").excute(t)}getCurrentUserEmailAddresses(){return ve.configure(this.clone(yn,"GetCurrentUserEmailAddresses",!0),"u.getCurrentUserEmailAddresses").excute({})}resolvePrincipal(e,t,r,i,n,o=!1){const s={addToUserInfoList:n,input:e,inputIsEmailOnly:i,matchUserInfoList:o,scopes:t,sources:r},a=this.clone(yn,"ResolvePrincipalInCurrentContext",!0);return ve.configure(a,"u.ResolvePrincipalInCurrentContext").excute(s)}searchPrincipals(e,t,r,i,n){const o={groupName:i,input:e,maxCount:n,scopes:t,sources:r},s=this.clone(yn,"SearchPrincipalsUsingContextWeb",!0);return ve.configure(s,"u.SearchPrincipalsUsingContextWeb").excute(o)}createEmailBodyForInvitation(e){const t={pageAddress:e},r=this.clone(yn,"CreateEmailBodyForInvitation",!0);return ve.configure(r,"u.CreateEmailBodyForInvitation").excute(t)}expandGroupsToPrincipals(e,t=30){const r={inputs:e,maxCount:t},i=this.clone(yn,"ExpandGroupsToPrincipals",!0);return ve.configure(i,"u.ExpandGroupsToPrincipals").excute(r)}createWikiPage(e){return s(this,void 0,void 0,function*(){const t=this.clone(yn,"CreateWikiPageInContextWeb",!0),r=yield ve.configure(t,"u.CreateWikiPageInContextWeb").excute({parameters:e});return{data:r,file:mt(je(r))}})}}),yn=(e,t)=>gn(e,t);Reflect.defineProperty($.prototype,"utility",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>gn(t,"").configure(e).setRuntime(r))}});let fn=class extends $e{getById(e){return ve.configure(Sn(this).concat(`('${e}')`),"subs.getById")}add(e,t,r){return s(this,void 0,void 0,function*(){const i={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()};r&&(i.clientState=r);const n=yield xe(this,ge(i,ye({"Content-Type":"application/json"})));return{data:n,subscription:this.getById(n.id)}})}};o([ve("subs.add")],fn.prototype,"add",null);const mn=Fe(fn=o([Me("subscriptions")],fn));class vn extends ke{update(e,t,r){return s(this,void 0,void 0,function*(){const i={};return e&&(i.expirationDateTime=e),t&&(i.notificationUrl=t),r&&(i.clientState=r),{data:yield Re(this,ge(i,ye({"Content-Type":"application/json"}))),subscription:this}})}delete(){return Ue(this)}}o([ve("sub.update")],vn.prototype,"update",null),o([ve("sub.delete")],vn.prototype,"delete",null);const Sn=Fe(vn);N(et,"subscriptions",mn);let bn=class extends ke{get groups(){return ve.configure(wn(this),"txts.groups")}get sets(){return ve.configure(xn(this),"txts.sets")}};const Pn=Fe(bn=o([Me("_api/v2.1/termstore")],bn));let In=class extends $e{getById(e){return ve.configure(Tn(this,e),"txtgs.getById")}};const wn=Fe(In=o([Me("groups")],In));const Tn=Fe(class extends ke{get sets(){return ve.configure(xn(this,"sets"),"txtg.sets")}});let Cn=class extends $e{getById(e){return ve.configure(Un(this,e),"txts.getById")}};const xn=Fe(Cn=o([Me("sets")],Cn));const Un=Fe(class extends ke{get terms(){return Fn(this)}get parentGroup(){return ve.configure(Tn(this,"parentGroup"),"txts.parentGroup")}get children(){return ve.configure(Dn(this),"txts.children")}get relations(){return ve.configure($n(this),"txts.relations")}getTermById(e){return ve.configure(this.clone(Bn,`terms/${e}`),"txts.getTermById")}getAllChildrenAsOrderedTree(){return s(this,void 0,void 0,function*(){const e=yield this.select("*","customSortOrder")(),t=[],r=(t,r,i)=>{let n=null;if(null===r&&i.length>0)n=[...i];else{const t=r.findIndex(t=>t.setId===e.id);t>=0&&(n=[...r[t].order])}if(null!==n){const e=[];return n.forEach(r=>{const i=t.find(e=>r===e.id);i&&e.push(i)}),e.push(...t.filter(e=>n.indexOf(e.id)<0)),e}return t},i=(e,t)=>s(this,void 0,void 0,function*(){const n=yield e.children.select("*","customSortOrder")();for(let e=0;e<n.length;e++){const o=n[e],s=Object.assign({children:[],defaultLabel:o.labels.find(e=>e.isDefault).name},o);o.childrenCount>0&&(yield i(this.getTermById(n[e].id),s.children),s.children=r(s.children,o.customSortOrder)),t.push(s)}});return yield i(this,t),r(t,null,e.customSortOrder)})}});let Rn=class extends $e{};const Dn=Fe(Rn=o([Me("children")],Rn));let Ln=class extends $e{getById(e){return Bn(this,e)}};const Fn=Fe(Ln=o([Me("terms")],Ln));const Bn=Fe(class extends ke{get children(){return ve.configure(Dn(this),"txt.children")}get relations(){return ve.configure($n(this),"txt.relations")}get set(){return ve.configure(Un(this,"set"),"txt.set")}});let _n=class extends $e{getById(e){return ve.configure(An(this,e),"txrs.getById")}};const $n=Fe(_n=o([Me("relations")],_n));const An=Fe(class extends ke{get fromTerm(){return ve.configure(Bn(this,"fromTerm"),"txr.fromTerm")}get toTerm(){return ve.configure(Bn(this,"toTerm"),"txr.toTerm")}get set(){return ve.configure(Un(this,"set"),"txr.set")}});Reflect.defineProperty($.prototype,"termStore",{configurable:!0,enumerable:!0,get:function(){return this.childConfigHook(({options:e,baseUrl:t,runtime:r})=>Pn(t).configure(e).setRuntime(r))}}),N(et,"userCustomActions",Yr),N(Ke,"userCustomActions",Yr),N(Ve,"userCustomActions",Yr);let kn=class extends $e{add(e,t=!1,r={}){return s(this,void 0,void 0,function*(){const i=ge(Object.assign(fe("SP.View"),{PersonalView:t,Title:e},r)),n=yield xe(this.clone(En,null),i);return{data:n,view:this.getById(n.Id)}})}getById(e){return Nn(this).concat(`('${e}')`)}getByTitle(e){return Nn(this,`getByTitle('${e}')`)}};o([ve("vs.add")],kn.prototype,"add",null);const En=Fe(kn=o([Me("views")],kn));class On extends ke{constructor(){super(...arguments),this.delete=Oe("vw"),this.update=this._update("SP.View",e=>({data:e,view:this}))}get fields(){return jn(this)}renderAsHtml(){return this.clone(Nn,"renderashtml")()}setViewXml(e){return xe(this.clone(Nn,"SetViewXml"),ge({viewXml:e}))}}o([ve("v.renderAsHtml")],On.prototype,"renderAsHtml",null),o([ve("v.setViewXml")],On.prototype,"setViewXml",null);const Nn=Fe(On);let Mn=class extends $e{getSchemaXml(){return this.clone(jn,"schemaxml")()}add(e){return xe(this.clone(jn,`addviewfield('${e}')`))}move(e,t){return xe(this.clone(jn,"moveviewfieldto"),ge({field:e,index:t}))}removeAll(){return xe(this.clone(jn,"removeallviewfields"))}remove(e){return xe(this.clone(jn,`removeviewfield('${e}')`))}};o([ve("vfs.getSchemaXml")],Mn.prototype,"getSchemaXml",null),o([ve("vfs.add")],Mn.prototype,"add",null),o([ve("vfs.move")],Mn.prototype,"move",null),o([ve("vfs.removeAll")],Mn.prototype,"removeAll",null),o([ve("vfs.remove")],Mn.prototype,"remove",null);const jn=Fe(Mn=o([Me("viewfields")],Mn));var Wn;!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.Recursive=1]="Recursive",e[e.RecursiveAll=2]="RecursiveAll",e[e.FilesOnly=3]="FilesOnly"}(Wn||(Wn={})),N(et,"views",En),N(et,"defaultView",Nn,"DefaultView"),et.prototype.getView=function(e){return Nn(this,`getView('${e}')`)};class qn extends Be{get scope(){return ve.configure(_e(this,"Scope"),"f.scope")}get webparts(){return Gn(this,"webparts")}export(e){return xe(this.clone(Vn,"ExportWebPart"),ge({webPartId:e}))}import(e){return xe(this.clone(Vn,"ImportWebPart"),ge({webPartXml:e}))}}const Hn=(e,t)=>new qn(e,t),Vn=(e,t)=>Hn(e,t);const Gn=Fe(class extends $e{getById(e){return zn(this,`getbyid('${e}')`)}getByControlId(e){return zn(this,`getByControlId('${e}')`)}});const zn=Fe(class extends ke{get webpart(){return Ee(this,"webpart")}saveChanges(){return xe(this.clone(zn,"SaveWebPartChanges"))}moveTo(e,t){return xe(this.clone(zn,`MoveWebPartTo(zoneID='${e}', zoneIndex=${t})`))}close(){return xe(this.clone(zn,"CloseWebPart"))}open(){return xe(this.clone(zn,"OpenWebPart"))}delete(){return xe(this.clone(zn,"DeleteWebPart"))}});var Xn,Kn,Jn,Qn;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(Xn||(Xn={})),ft.prototype.getLimitedWebPartManager=function(e=Xn.Shared){return Hn(this,`getLimitedWebPartManager(scope=${e})`)},function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(Kn||(Kn={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(Jn||(Jn={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(Qn||(Qn={}));const Yn=new $;var Zn=function(){return function(e,t,r,i,n){this.guid=c(),this.networkId=e,this.currentUser=t,this.siteCollection=r,this.webSite=i,this.postEventTryaneUrl=n}}(),eo=r("xeH2"),to=function(){function e(e,t){this.v="spfx",this.g=e,this.n=t,this.d=(new Date).toJSON(),this.r=document.referrer}return e.createTryaneMessage=function(t,r){var i=new e(r.guid,r.networkId);return i.t=t,i.u=r.currentUser.LoginName.toLowerCase(),i.c=r.siteCollection.Id,i.cu=r.siteCollection.Url,i.s=r.webSite.Id,i},e.sendTryaneMessage=function(e,t){eo.ajax({type:"POST",contentType:"text/plain",crossDomain:!0,data:JSON.stringify(e),url:t+"?modernuiAgent=true"})},e}(),ro=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),io=function(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},no=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.postEventTryaneUrl="",t}return ro(t,e),t.prototype.onInit=function(){return null==this.properties.networkIdParam?Promise.resolve():(Yn.setup({spfxContext:this.context}),this.startPageAnalyse(),e.prototype.onInit.call(this))},t.prototype.startPageAnalyse=function(){var e=this;try{console.debug("TRYANE START page analysis"),console.debug("Network id "+this.properties.networkIdParam);var t,r=this.properties.tryaneServerUrlParam?this.properties.tryaneServerUrlParam:this.postEventTryaneUrl;console.debug("Tryane server post url "+r);var i,n,o=Yn.web.select("Id").get().then(function(e){t=e}),s=Yn.web.currentUser.select("LoginName").get().then(function(e){i=e}),a=Yn.site.select("Id","Url").get().then(function(e){n=e});Promise.all([o,s,a]).then(function(o){console.debug("Current Site id : "+t.Id),console.debug("Current user : "+i.LoginName),console.debug("Current Site collection: "+n.Id+" "+n.Url);var s=new Zn(e.properties.networkIdParam,i,n,t,r);to.sendTryaneMessage(to.createTryaneMessage("browsing",s),r)})}catch(e){console.error(e)}},io([i.override],t.prototype,"onInit",null),t}(n.BaseApplicationCustomizer),oo=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),so=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.postEventTryaneUrl="https://analytics.tryane.com/ta4sp/api/v1/spevent",t}return oo(t,e),t}(no);t.default=so},yLpj:function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r}})});