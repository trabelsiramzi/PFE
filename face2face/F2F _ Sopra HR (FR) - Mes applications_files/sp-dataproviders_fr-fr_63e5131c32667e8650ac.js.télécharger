define("1cea229f-b208-4202-8014-22503d92a019_0.1.0",["tslib","@microsoft/sp-http-base","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);d.length;)d.shift()()}var n={},a={0:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,i){n=a[e]=[t,i]});t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({1:"sp-queryablemanagedproperties",2:"sp-retrievablemanagedproperties"}[e]||e)+"_"+"none"+"_"+{1:"b63a373f34eb9e34fc41",2:"75153f2458bf2148adce"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var c=o;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-dataproviders_fr-fr_63e5131c32667e8650ac\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2SXB":function(e,t){e.exports=a},"2q6Q":function(e,t){e.exports=i},"5pbq":function(e,t){e.exports=r},"6DSs":function(e){e.exports=JSON.parse('{"e":"Nous ne pouvons pas récupérer les données. {0} : {1}. L’appel REST a échoué. Code d’état : {2} Message d’état : {3}"}')},"9G/9":function(e){e.exports=JSON.parse('{"e":"Rechercher"}')},Pk8u:function(e,t){e.exports=o},QRxg:function(e){e.exports=JSON.parse('{"e":"Page"}')},"R/pT":function(e){e.exports=JSON.parse('{"e":"Nous ne pouvons pas récupérer les données. Un identificateur de liste ou un titre doit être spécifié."}')},UWqr:function(e,t){e.exports=s},"X+PM":function(e,t){e.exports=c},YkpB:function(e){e.exports=JSON.parse('{"t":"Liste","e":"La valeur de ListRequestType est non valide."}')},"hiL/":function(e,t){e.exports=d},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"BaseDataProvider",function(){return o}),n.d(t,"BookmarksDataProvider",function(){return L}),n.d(t,"DocumentType",function(){return k}),n.d(t,"FilterOperator",function(){return M}),n.d(t,"FilterSince",function(){return P}),n.d(t,"FilterType",function(){return T}),n.d(t,"UserType",function(){return U}),n.d(t,"TokenUtilities",function(){return F}),n.d(t,"TieredCacheHelper",function(){return v}),n.d(t,"TieredCacheHelperOnDemand",function(){return V}),n.d(t,"ContentLocation",function(){return z}),n.d(t,"ContentType",function(){return G}),n.d(t,"DeferredManagedProperties",function(){return K}),n.d(t,"KQLQueryBuilder",function(){return ae}),n.d(t,"AUDIENCE_TARGET_KQL_QUERY",function(){return ne}),n.d(t,"ManagedDataType",function(){return q.e}),n.d(t,"SortType",function(){return Y}),n.d(t,"SearchDataProvider",function(){return se}),n.d(t,"PersonaSettingsCache",function(){return ce}),n.d(t,"sanitizeSearchQueryParameter",function(){return de}),n.d(t,"CAMLQueryBuilder",function(){return ke}),n.d(t,"ListRequestType",function(){return Me}),n.d(t,"ListDataProvider",function(){return Ue}),n.d(t,"ContentRollupDataProvider",function(){return He}),n.d(t,"PageDataProvider",function(){return Ve}),n.d(t,"PageDataSource",function(){return Ne}),n.d(t,"_getWebPartDataFromPage",function(){return ze}),n.d(t,"TemplatePanelDataSource",function(){return Je}),n.d(t,"TemplateSelectedPageCopyDataSource",function(){return Xe}),n.d(t,"TemplateSelectedPageAsJsonDataSource",function(){return Ze}),n.d(t,"DefaultNewPageTemplateIdDataSource",function(){return $e}),n.d(t,"DeleteTemplatePageDataSource",function(){return et}),n.d(t,"LimitedAccessLockdownEnabledDataSource",function(){return tt}),n.d(t,"TemplatePanelDataProvider",function(){return nt}),n.d(t,"TemplatePanelSelectedPageCopyDataProvider",function(){return at}),n.d(t,"TemplatePanelSelectedPageAsJsonDataProvider",function(){return it}),n.d(t,"DefaultNewPageTemplateIdDataProvider",function(){return rt}),n.d(t,"DeleteTemplatePageDataProvider",function(){return ot}),n.d(t,"LimitedAccessLockdownEnabledDataProvider",function(){return st}),n.d(t,"RecentDocumentsDataProvider",function(){return ct}),n.d(t,"TopicFirstRunDataProvider",function(){return bt}),n.d(t,"TopicFirstRunKeys",function(){return mt}),n.d(t,"ViewCountDataProvider",function(){return gt}),n.d(t,"ListDataSource",function(){return _e}),n.d(t,"ListFieldDataSource",function(){return be}),n.d(t,"ListFieldType",function(){return ge}),n.d(t,"ListItemDataSource",function(){return De}),n.d(t,"SPRenderListDataOptions",function(){return ve}),n.d(t,"ListViewDataSource",function(){return xe}),n.d(t,"BaseDataSource",function(){return le}),n.d(t,"ODataQueryStringBuilder",function(){return pe}),n.d(t,"SPDataSource",function(){return fe}),n.d(t,"SPHomeHttpClient",function(){return I}),n.d(t,"SPHomeMicroserviceNotAvailableError",function(){return f}),n.d(t,"SPHomeMicroserviceFetchTokenError",function(){return p}),n.d(t,"hasResponseMSCV",function(){return x}),n.d(t,"getMicroServiceErrorCode",function(){return C}),n.d(t,"isThrottledResponse",function(){return O}),n.d(t,"SeeAllPageLayoutWebparts",function(){return vt}),n.d(t,"SearchAPIRequest",function(){return re}),n.d(t,"SearchAPISortDirection",function(){return Q});var a=n("X+PM"),i=n("vlQI"),r=n("UWqr"),o=function(){function e(e){return this._options=e,this._serviceScope=e.serviceScope,this}return e.prototype.requestData=function(e){var t=this;return this.resolveServices().then(function(){return t.getItems(e)})},e.prototype.resolveServices=function(){var e=this;return new Promise(function(t,n){e._serviceScope.whenFinished(function(){e._pageContext=e._serviceScope.consume(a.PageContext.serviceKey),e._baseEndPoint=r.UrlUtilities.removeEndSlash(e._pageContext.web.absoluteUrl),e._options.useHttpClient?e._httpClient=e._serviceScope.consume(i.HttpClient.serviceKey):e._spHttpClient=e._serviceScope.consume(i.SPHttpClient.serviceKey),e._options.requiresTokenProvider&&(e._tokenProvider=e._serviceScope.consume(i.OAuthTokenProvider.serviceKey)),t()})})},Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpClient",{get:function(){return this._httpClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spHttpClient",{get:function(){return this._spHttpClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenProvider",{get:function(){return this._tokenProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseEndPoint",{get:function(){return this._baseEndPoint},enumerable:!1,configurable:!0}),e}(),s=n("ut3N"),c=n("17wl"),d=n("5pbq"),l=n("hiL/"),u=n("y88i"),f=function(e){this.name="SPHomeMicroserviceNotAvailableError",this.message="SPHome Microservice not available in this environment",this.message=e||this.message},p=function(e,t){this.message="Unknown Token Error",this.name=e,this.message=t||this.message};function m(e){return e?JSON.stringify({name:e.name,message:e.message}):""}var _=function(e){function t(t){var n=e.call(this,t)||this;return n._requestUpdater=function(e){return Promise.resolve(e)},n}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"requestUpdater",{set:function(e){this._requestUpdater=e},enumerable:!1,configurable:!0}),t.prototype._fetch=function(t,n,a){var i=this;return this._requestUpdater({url:t,options:a}).then(function(t){return e.prototype._fetch.call(i,t.url,n,t.options)})},t}(i.SPHttpClient),h=r.ServiceKey.create("sp-http:SPHttpMicroserviceClient",_),b=n("2q6Q"),g=function(){function e(){}return e.applyCacheAndNetwork=function(t,n,a,i){var r=new s._QosMonitor("".concat(a.qosMonitorLabel,".getProcessedResponseInSmartRace")),o=t.serverResponse.then(function(e){return a.parseHttpClientResponse(e,n,r)}).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onServerResponseResolved,n),t}).catch(function(t){throw e._executeIfDefined(a,a.onServerResponseFailed,t),t}),c=new s._QosMonitor("".concat(a.qosMonitorLabel,".getProcessedCachedResponseInSmartRace")),d=[{raceablePromise:e.processResponseRawData(t.cachedResponse,a.isRawData,a.processRawData,n,c).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onCacheResponseResolved,n),t}).catch(function(t){throw c.writeUnexpectedFailure("ParseCacheResultsFailed",t),e._executeIfDefined(a,a.onCacheResponseFailed,t),t}),raceId:e._cachedDataPromiseId},{raceablePromise:o,raceId:e._serverDataPromiseId}];return l.SmartRace.race(d).then(function(t){return t.raceId===e._cachedDataPromiseId&&o.then(function(t){e._executeIfDefined(a,a.onServerResponseResolvedWithCache,t)}).catch(function(){}),i.writeSuccess({cacheStatus:t.raceId===e._cachedDataPromiseId?"WonRace":"LostRace"}),t.raceablePromise}).catch(function(e){throw i.writeUnexpectedFailure("SmartRaceFailed",e),e})},e.applyCacheThenNetwork=function(t,n,a,i){var r,o=t.cachedResponse?e.processResponseRawData(t.cachedResponse,a.isRawData,a.processRawData,n,i):void 0,c=new s._QosMonitor("".concat(a.qosMonitorLabel,".getProcessedResponse")),d=null===(r=t.serverResponse)||void 0===r?void 0:r.then(function(e){return a.parseHttpClientResponse(e,n,c)}).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onServerResponseResolved,n),t}).catch(function(t){throw e._executeIfDefined(a,a.onServerResponseFailed,t),t});return o?(o.then(function(t){var n=a.isEmptyResponse(t);e._executeIfDefined(a,a.onCacheResponseResolved,n),d?(e._executeIfDefined(a,a.onCacheThenNetworkServerDataReturned,d,!0,n),d.then(function(t){e._executeIfDefined(a,a.onServerResponseResolvedWithCache,t)}).catch(function(){})):e._executeIfDefined(a,a.onCacheThenNetworkServerDataNotReturned,!0,n)}).catch(function(t){e._executeIfDefined(a,a.onCacheResponseFailed,t)}),o):(i.writeSuccess(),e._executeIfDefined(a,a.onCacheThenNetworkServerDataReturned,d,!1,!0),d)},e.executeCacheStrategy=function(t,n,a){var i=new s._QosMonitor("".concat(t.qosMonitorLabel,".getData"));return n(a).then(function(n){if(n instanceof Response||(null==n?void 0:n.nativeResponse)instanceof Response)return!r._SPFlight.isEnabled(60878)||1!==b._SPPerfExperiment.getVariantAndTrackExperiment(b._PerformanceExperiment.NewsCustomerPromiseExperiment)&&!r._SPFlight.isEnabled(60872)?t.parseHttpClientResponse(n,a,i):t.parseHttpClientResponse(n,a,i).then(function(n){var a=t.isEmptyResponse(n);return e._executeIfDefined(t,t.onServerResponseResolved,a),n}).catch(function(n){throw e._executeIfDefined(t,t.onServerResponseFailed,n),n});var o=n;return o.serverResponse&&o.cachedResponse?e.applyCacheAndNetwork(o,a,t,i):o.cachedResponse||o.serverResponse?e.applyCacheThenNetwork(o,a,t,i):e.processResponseRawData(Promise.resolve(n),t.isRawData,t.processRawData,a).then(function(n){return i.writeSuccess(),e._executeIfDefined(t,t.onCacheResponseResolved,!!n),n}).catch(function(n){throw i.writeUnexpectedFailure("Error Processing cached data",n),e._executeIfDefined(t,t.onCacheResponseFailed,n),n})}).catch(function(e){throw i.hasEnded||i.writeUnexpectedFailure("Excecute Request failed",e),e})},e.processResponseRawData=function(e,t,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return e.then(function(e){return t(e)?n.apply(void 0,Object(c.__spreadArray)([e],a,!1)):e})},e.useStalePropName="useStale",e.enableDataPrefetch="enableDataPrefetch",e.dataPrefetchKey="dataPrefetchKey",e.parentKeyOverride="parentKeyOverride",e.onlyIndexedDB="onlyIndexedDB",e.onlyMySiteCache="onlyMySiteCache",e.cacheKeyOverride="cacheKeyOverride",e.mySiteCacheConfiguration="mySiteCacheConfiguration",e.defaultWebPartCachePath="WebPartCache",e.prefetchUpdateOptions="prefetchUpdateOptions",e._cachedDataPromiseId=r.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),e._serverDataPromiseId=r.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),e._executeIfDefined=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];if(t)return t.apply(e,n)},e}(),v=g;function y(){return r._SPKillSwitch.isActivated("83c7fd57-b124-44b5-98c9-19fbfa5e8826")}var S=new l.KillSwitch("0306551a-b040-4e46-ae3d-98f35375764b"),D=function(){return r._SPKillSwitch.isActivated("6605c58b-ddee-4dbc-8260-94ab68b82d04")},I=function(){function e(e){var t=this;this._isServiceAvailable=void 0,this._hasPrefetchedToken=!1,this._sphomeTokenError={PrefetchError:void 0,ApiError:void 0},this._requestUpdater=function(e){return t._fetchTokenIfExpired().then(function(){return{url:t._generateUrlVersionedPath(e.url),options:t._getRequestOptions(e.options)}})},this._isPrefetchTokenFlightEnabled&&(this._initializeFromPrefetchedToken=new Promise(function(e,n){var a=new d.Async;window._spHomeClientContextLoaded=function(){a.dispose();var i=new s._QosMonitor("SpHomeClientContextPrefetch");try{t._initializeWithPrefetchedToken(),t._hasPrefetchedToken?i.writeSuccess():i.writeUnexpectedFailure("NoPrefetchedToken")}catch(e){i.writeUnexpectedFailure("Unexpected",e),!D()&&e instanceof Error&&(t._sphomeTokenError.PrefetchError=e),n(e)}e()},D()?a.setTimeout(function(){return!t._hasPrefetchedToken&&n(new Error("Timeout"))},1e4):a.setTimeout(function(){if(!t._hasPrefetchedToken){var e=new Error("Timeout");t._sphomeTokenError.PrefetchError=e,n(e)}},1e4)})),this._stopUsingSPHttpMSClient=r._SPKillSwitch.isActivated("14b96c7e-3dcc-42e8-8a42-f56091d1f9f3"),e.whenFinished(function(){t._spHttpClient=e.consume(i.SPHttpClient.serviceKey),t._stopUsingSPHttpMSClient||(t._spHttpMicroserviceClient=e.consume(h),t._spHttpMicroserviceClient.requestUpdater=t._requestUpdater),t._httpClient=e.consume(i.HttpClient.serviceKey),t._pageContext=e.consume(a.PageContext.serviceKey),t._isPrefetchTokenFlightEnabled&&t._initializeWithPrefetchedToken(),t._isUserSupportedBySubstrate=t._isSubtrateSupportedUser(e.consume(a.PageContext.serviceKey).user)})}return e.prototype.get=function(e,t,n,a){return a?this._get(e,t,n,a):this._get_deprecated(e,t,n)},e.prototype.post=function(e,t,n,a,i){return i?this._post(e,t,n,a,i):this._post_deprecated(e,t,n,a)},Object.defineProperty(e.prototype,"isServiceAvailable",{get:function(){var e=this;return void 0!==this._isServiceAvailable?Promise.resolve(this._isServiceAvailable):this._fetchTokenIfExpired().then(function(){return e._isServiceAvailable=!0,e._isServiceAvailable}).catch(function(t){return e._isServiceAvailable=!1,e._isServiceAvailable})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUserSupportedBySubstrate",{get:function(){return this._isUserSupportedBySubstrate},enumerable:!1,configurable:!0}),e.prototype._get=function(e,t,n,a){var r=this;if(!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var o=this._generateVersionedPath(e,t);return this._spHttpMicroserviceClient.get(o,new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),this._getRequestOptions({},n),this._getCacheConfiguration(a,o))}return this._fetchTokenIfExpired().then(function(){return r._spHttpClient.get(r._generateUrl(e,t),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),r._getRequestOptions({},n),a)})},e.prototype._get_deprecated=function(e,t,n){var a=this;return this._fetchTokenIfExpired().then(function(){return S.isActivated()?a._httpClient.get(a._generateUrl(e,t),i.HttpClient.configurations.v1,a._getRequestOptions({},n)):a._spHttpClient.get(a._generateUrl(e,t),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),a._getRequestOptions({},n))})},e.prototype._post=function(e,t,n,a,r){var o=this;if(void 0===t&&(t=""),!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var s=this._generateVersionedPath(e,n);return this._spHttpMicroserviceClient.fetch(s,new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),this._getRequestOptions({body:t},a,"POST"),this._getCacheConfiguration(r,s))}return this._fetchTokenIfExpired().then(function(){return o._spHttpClient.fetch(o._generateUrl(e,n),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),o._getRequestOptions({body:t},a,"POST"),r)})},e.prototype._post_deprecated=function(e,t,n,a){var r=this;return void 0===t&&(t=""),this._fetchTokenIfExpired().then(function(){return S.isActivated()?r._httpClient.post(r._generateUrl(e,n),i.HttpClient.configurations.v1,r._getRequestOptions({body:t},a)):r._spHttpClient.post(r._generateUrl(e,n),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),r._getRequestOptions({body:t},a))})},e.prototype._getCacheConfiguration=function(e,t){return e&&(e.extraProps||(e.extraProps=new Map),e.extraProps.set(v.parentKeyOverride,t)),e},e.prototype._generateUrl=function(t,n){return void 0===n&&(n=1),r.Text.format(e.MICROSERVICE_ENDPOINT,this._url,n,t)},e.prototype._generateUrlVersionedPath=function(t){return r.Text.format(e.MICROSERVICE_ENDPOINT_V,this._url,t)},e.prototype._generateVersionedPath=function(t,n){return void 0===n&&(n=1),r.Text.format(e.VERSIONED_PATH,n,t)},e.prototype._isTokenValid=function(){return!!(this._tokenExpiry&&this._tokenExpiry>new Date)},e.prototype._getTokenAndMicroserviceDetails=function(){var e,t=this,n=new s._QosMonitor("SPHomeHttpClient"),a="".concat(this._pageContext.web.absoluteUrl,"/_api/sphomeservice/context?$expand=Token,Payload");return this._spHttpClient.get(a,i.SPHttpClient.configurations.v1).then(function(t){if(e=t.correlationId?t.correlationId.toString():void 0,t.ok)return t.json();var a=new Error(t.statusText);throw n.writeUnexpectedFailure("FailedResponse",a,{correlationId:e,Status:t.status}),a}).then(function(e){if(!e.Token||!e.Token.access_token)throw t._isServiceAvailable=!1,new f;t._isServiceAvailable=!0,t._token=e.Token.access_token,t._tokenExpiry=new Date(1e3*Number(e.Token.expires_on)-15e3),t._payload=e.Payload,t._url=e.Urls[0],t._alreadyGettingTokenPromise=void 0,n.writeSuccess()}).catch(function(a){throw a instanceof f?n.writeExpectedFailure("NotAvailable",a,{correlationId:e}):n.writeUnexpectedFailure("SPHomeHttpClient",a,{correlationId:e}),t._alreadyGettingTokenPromise=void 0,D()||(t._sphomeTokenError.ApiError=a),a})},e.prototype._getRequestOptions=function(e,t,n){var a;void 0===e&&(e={});var i={};this._token&&(i.Authorization="Bearer ".concat(this._token)),this._payload&&(i["SPHome-ApiContext"]=this._payload),i["Content-Type"]="application/json",i["SPHome-ClientType"]="PagesWeb",(null===(a=this._pageContext)||void 0===a?void 0:a.legacyPageContext)&&(i.FarmLabel=this._pageContext.legacyPageContext.farmLabel);var r=u.SPAlternativeUrls.tryGetAlternativeUrl("AFDCDNEnabled");return r&&(i["client-on-afd-spo"]=("True"===r).toString()),n&&(i["X-HTTP-Method"]=n,e.method=n),t&&t.forEach(function(e,t){i[t]=e}),Object(c.__assign)(Object(c.__assign)({},e),{headers:Object(c.__assign)(Object(c.__assign)({},e.headers||{}),i)})},e.prototype._initializeWithPrefetchedToken=function(){var e,t=new s._QosMonitor("InitializeSpHomeClientContext");try{if(!this._hasPrefetchedToken)if(window._spHomeClientContext&&window._spHomeClientContext!==[]){var n=window._spHomeClientContext,a=n.Token;this._token=null==a?void 0:a.AccessToken,this._payload=n.Payload,this._url=null===(e=n.Urls)||void 0===e?void 0:e[0],this._tokenExpiry=(null==a?void 0:a.ExpiresOn)?new Date(1e3*Number(a.ExpiresOn)-15e3):void 0,this._hasPrefetchedToken=!0,t.writeSuccess()}else window._spHomeClientContext===[]?t.writeUnexpectedFailure("SPHomeClientContextNotAvailable",new Error("EmptyTokenReturned")):t.writeExpectedFailure("SPHomeClientContextNotAvailable",new Error("TokenNotAvailable"))}catch(e){this._hasPrefetchedToken=!1,t.writeUnexpectedFailure("InitializeSPHomeClientContextFailed",e.message)}return this._hasPrefetchedToken},e.prototype._fetchTokenIfExpired=function(){var e=this;if(this._isTokenValid())return Promise.resolve();if(!this._alreadyGettingTokenPromise)if(this._initializeFromPrefetchedToken){var t=r.Guid.parse("928806ac-3e49-4e4e-9114-7c392215230f"),n=r.Guid.parse("5ff931f9-8682-4614-b4f1-9b8d1aa74942"),a=[{raceablePromise:this._initializeFromPrefetchedToken,raceId:t},{raceablePromise:this._getTokenAndMicroserviceDetails(),raceId:n}];this._alreadyGettingTokenPromise=l.SmartRace.race(a).then(function(e){return e.raceablePromise}).catch(function(t){throw D()?t:new p("SPHomeFetchTokenFailedByPrefetchAndServer","PrefetchError: ".concat(m(e._sphomeTokenError.PrefetchError),"; ApiError: ").concat(m(e._sphomeTokenError.ApiError)))})}else this._alreadyGettingTokenPromise=this._getTokenAndMicroserviceDetails().catch(function(t){if(!(D()||t instanceof f))throw new p("SPHomeFetchTokenFailedByServer",m(e._sphomeTokenError.ApiError));throw t});return this._alreadyGettingTokenPromise},Object.defineProperty(e.prototype,"_isPrefetchTokenFlightEnabled",{get:function(){return r._SPFlight.isEnabled(1265)},enumerable:!1,configurable:!0}),e.prototype._isSubtrateSupportedUser=function(e){if(e){var t=e.isAnonymousGuestUser,n=e.isExternalGuestUser;return!t&&!n}return!0},e.serviceKey=r.ServiceKey.create("sp-component-utilities:SPHomeHttpClient",e),e.MICROSERVICE_ENDPOINT="{0}/api/v{1}/{2}",e.MICROSERVICE_ENDPOINT_V="{0}/api/{1}",e.VERSIONED_PATH="v{0}/{1}",e}();function x(e,t){return!(r._BrowserDetection.getBrowserInformation().browser!==r._Browser.IE&&!t||!e)}function C(e,t){return t?O(e)?"ThrottledResponse":"ResponseNotOk":"AzureFrontDoorHeadersMissing"}function O(e){return 429===e||503===e}var w="AddBookmark",E="RemoveBookmark",A="IsBookmarked",L=function(){function e(e,t){var n=this;this._qosComponentName=e,t.whenFinished(function(){n._spHomeHttpClient=t.consume(I.serviceKey)})}return e.prototype.addBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+"."+w),n=e;return this._spHomeHttpClient.post("documents/followed/add",JSON.stringify(n)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure(w),!1})},e.prototype.removeBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+"."+E),n=decodeURI(e);return this._spHomeHttpClient.post("documents/followed/remove",JSON.stringify(n)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure(E),!1})},e.prototype.isBookmarked=function(e){var t=new s._QosMonitor(this._qosComponentName+"."+A);return this._spHomeHttpClient.isUserSupportedBySubstrate?this._isBookmarkedRequest(e).then(function(e){return t.writeSuccess(),e.json()}).then(function(e){return e.SavedForLater}).catch(function(e){return t.writeUnexpectedFailure(A),!1}):(t.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve(!1))},e.prototype._isBookmarkedRequest=function(e){var t="document/metadata?siteId=".concat(e.siteId,"&webId=").concat(e.webId)+"&listId=".concat(e.listId,"&uniqueId=").concat(e.listItemUniqueId,"&url=").concat(e.url)+(e.groupId?"&groupId=".concat(e.groupId):"");return this._spHomeHttpClient.get(t)},e}(),k={Word:1,Excel:2,PowerPoint:3,OneNote:4,Visio:5,PDF:10,Video:11,Any:99},M={Equals:1,NotEqual:2,BeginsWith:3,EndsWith:4,Contains:5,DoesNotContain:6,LessThan:7,GreaterThan:8,Between:9,GreaterThanOrEqualTo:10,LessThanOrEqualTo:11,IsNull:12},P={Today:1,Yesterday:2,ThisWeek:3,ThisMonth:4,LastMonth:5,ThisYear:6,LastYear:7},T={TitleContaining:1,AnyTextContaining:2,TaggedWith:3,CreatedBy:4,ModifiedBy:5,Field:6,RecentlyChanged:7,RecentlyAdded:8,PageAuthorByline:9},U={CurrentUser:1,SpecificUser:2},F=function(){function e(){}return e.isValidMeToken=function(e){return new RegExp("^\\[me\\]$","i").test(e)},e.isValidTodayToken=function(e){return new RegExp("^\\[today\\]([\\+|\\-]\\d+$)?$","i").test(e)},e}(),H=n("2SXB");function R(e){return"undefined"!=typeof window&&"function"==typeof window.TextEncoder?(new window.TextEncoder).encode(e):self&&"function"==typeof self.TextEncoder?(new self.TextEncoder).encode(e):new Uint8Array(function(e){for(var t=[],n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t.push(a):a<2048?t.push(192|a>>6,128|63&a):a<55296||a>=57344?t.push(224|a>>12,128|a>>6&63,128|63&a):(n++,a=65536+((1023&a)<<10|1023&e.charCodeAt(n)),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a))}return t}(e))}function N(e){return"undefined"!=typeof window?!window.crypto&&window.msCrypto?function(e){var t=window.msCrypto,n=R(e);return new Promise(function(e,a){var i=t.subtle.digest("SHA-256",n);i.oncomplete=function(t){var n=Array.from(new Uint8Array(t.target.result)).map(function(e){return e.toString(16).padStart(2,"0")}).join("");e(n)},i.onerror=function(e){!function(e,t){t({message:e.message})}(e,a)}})}(e):function(e){return function(e){return Object(c.__awaiter)(this,void 0,void 0,function(){var t;return Object(c.__generator)(this,function(n){switch(n.label){case 0:return t=R(e),[4,window.crypto.subtle.digest("SHA-256",t)];case 1:return[2,n.sent()]}})})}(e).then(function(e){return Array.from(new Uint8Array(e)).map(function(e){return e.toString(16).padStart(2,"0")}).join("")})}(e):Promise.reject()}var B="TieredCacheHelper",j=function(){function e(){}return e.getAppCacheDataProvider=function(e){return e.consume(Object(H._getCacheDataProviderServiceKey)())._provider},e.getPrefetchDataProvider=function(e){return e.consume(Object(H._getPrefetchDataProviderServiceKey)())._provider},e.generateCacheKey=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=[];return t.forEach(function(t){"string"==typeof t?a.push(t.toUpperCase()):a.push(e._serializeMap(t))}),N(a.sort().join(","))},e.getItem=function(e,t,n,a){var i=new s._QosMonitor("".concat(B,".").concat(t,".getItem"));return n.getData(e,a).then(function(e){return i.writeSuccess(),Promise.resolve(e.data)}).catch(function(e){return i.writeUnexpectedFailure("GetTieredCacheFailed",e),Promise.reject(e)})},e.getItemVerbose=function(e,t,n,a){var i=new s._QosMonitor("".concat(B,".").concat(t,".getItemVerbose"));return n.getData(e,a).then(function(e){return i.writeSuccess(),Promise.resolve(e)}).catch(function(e){return i.writeUnexpectedFailure("GetTieredCacheFailed",e),Promise.reject(e)})},e.setItem=function(e,t,n,a,i){var r=new s._QosMonitor("".concat(B,".").concat(n,".setItem"));return a.setData(e,t,i).then(function(){return r.writeSuccess(),Promise.resolve()}).catch(function(e){return r.writeUnexpectedFailure("SetItemFailed",e),Promise.reject(e)})},e.getWebPartDefaultCachePath=function(t){return"/".concat(e.defaultWebPartCachePath,"/").concat(t)},e._serializeMap=function(t){var n=t instanceof Array;return Object.keys(t).map(function(a){var i=n?"":a.toUpperCase();return t[a]instanceof Object?i+e._serializeMap(t[a]):i+"".concat(t[a]).toUpperCase()}).sort().reduce(function(e,t){return e+t},"")},e.useStalePropName="useStale",e.enableDataPrefetch="enableDataPrefetch",e.dataPrefetchKey="dataPrefetchKey",e.parentKeyOverride="parentKeyOverride",e.onlyIndexedDB="onlyIndexedDB",e.onlyMySiteCache="onlyMySiteCache",e.cacheKeyOverride="cacheKeyOverride",e.mySiteCacheConfiguration="mySiteCacheConfiguration",e.defaultWebPartCachePath="WebPartCache",e.prefetchUpdateOptions="prefetchUpdateOptions",e}(),V=j,z={CurrentSite:1,CurrentSiteCollection:2,AllSites:3,CurrentSiteDocumentLibrary:4,AllSitesInTheHub:5,CurrentSitePageLibrary:6,CurrentSiteEventsList:7,SelectedSites:99},G={Document:1,Page:2,Video:3,Event:4,Issue:5,Task:6,Link:7,Contact:8,Image:9,News:10,All:99},K=function(){function e(){}return e.ensureQueryableManagedProperties=function(){return e._loadedQueryableManagedPropertiesPromise||(e._loadedQueryableManagedPropertiesPromise=n.e(1).then(n.bind(null,"n9CK")).then(function(e){return e.default})),e._loadedQueryableManagedPropertiesPromise},e.ensureRetrievableManagedProperties=function(){return e._loadedRetrievableManagedPromise||(e._loadedRetrievableManagedPromise=n.e(2).then(n.bind(null,"oz+a")).then(function(e){return e.default})),e._loadedRetrievableManagedPromise},e}(),W=n("Pk8u"),q=n("ui8f"),Q=function(){function e(){}return e.ascending=0,e.descending=1,e}(),Y={MostRecent:1,MostViewed:2,Trending:3,FieldAscending:4,FieldDescending:5},J="Created",X="LastModifiedTime",Z="8413CD39-2156-4E00-B54D-11EFD9ABDB89",$="ContentTypeId:0x0106*",ee="ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118*",te="DepartmentId",ne="(ModernAudienceAadObjectIds:{User.Audiences} OR NOT IsAudienceTargeted:true)",ae=function(){function e(){}return e.generateKqlFromFilters=function(e){var t="",n=!1;if(!e||!e.query||!e.query.filters)return{expr:t,isFilteringByDate:n};for(var a=Object(W.clone)(e.query.filters),i=a.length;i--;)void 0!==a[i].value&&""!==a[i].value||void 0!==a[i].userType&&a[i].userType!==U.SpecificUser||a.splice(i,1);a=a.sort(function(e,t){return e.filterType-t.filterType});for(var r=!1,o=0;o<a.length;o++){o>0&&(t+=" ".concat(r?"OR":"AND"," "));var s=a[o],c=o<a.length-1?a[o+1]:void 0;r||void 0===(null==c?void 0:c.value)||s.filterType!==c.filterType||(t+="(",r=!0);var d=this._kqlFilter(s,e.queryableManagedProperties);t+=d.expr,n=n||d.isFilteringByDate,r&&s.filterType!==(null==c?void 0:c.filterType)&&(t+=")",r=!1)}return t.length>0&&(t+=" AND"),{expr:t,isFilteringByDate:n}},e.generateKqlFromFilterGroup=function(e){if(!e||!e.query||!e.query.filterGroup)return{expr:"",isFilteringByDate:!1};var t=this._buildFilterGroupExpr(e.query.filterGroup,e.queryableManagedProperties);return t.expr.length>0&&(t.expr+=" AND"),t},e.generateQuery=function(e,t){var n="";if(!e||!e.query)return{queryTemplate:n};var a=e,i=!1,o=!1;if(a.query.advancedQueryText)n=a.query.advancedQueryText;else if(a.query.filterGroup)n=(s=this.generateKqlFromFilterGroup(a)).expr,i=s.isFilteringByDate;else if(a.query.filters){var s;n=(s=this.generateKqlFromFilters(a)).expr,i=s.isFilteringByDate}n.length>0&&(o=!0),n+=" ".concat(this.generateContentLocationKqlQuery(a)),n+=this._generateContentKql(a,o);var c=void 0;return(i||!r._SPKillSwitch.isActivated("877ec1e9-752d-4af4-a970-5c22c24339cc")&&a.query.advancedQueryText)&&(c=t.user.preferUserTimeZone?t.user.timeZoneInfo.id:t.web.timeZoneInfo.id),a.audienceTarget&&(n=n.trim()+" ".concat(ne)),{queryTemplate:n.trim(),timeZoneId:c}},e.generateContentLocationKqlQuery=function(e){var t=this;switch(e.query.contentLocation){case z.AllSitesInTheHub:return"".concat(this._siteCriteria(e.hubSiteId,te));case z.CurrentSite:return this._generateSiteIdCriteria(e.siteId,e.webId);case z.CurrentSiteCollection:return"(".concat(this._siteCriteria(e.siteId,"NormSiteID"),")");case z.SelectedSites:if(e.siteIds&&e.siteIds.length>0){var n=e.siteIds.map(function(e){return t._generateSiteIdCriteria(e.siteId,e.webId)});return"(".concat(n.join(" OR "),")")}}return""},e.generateSearchAPIQueryOptions=function(e,t,n){var a=n.isPrivateGroup;!a&&n.query&&(a=n.query.contentLocation===z.AllSites||n.query.contentLocation===z.AllSitesInTheHub);var i=a?"True":"False",r=n.enableMultiGeoSearch?"True":"False",o={ClientType:n.clientType,QueryTemplate:e,TimeZoneId:t,SelectProperties:["ContentType","ContentTypeId","Title","EditorOwsUser","ModifiedBy","LastModifiedBy","FileExtension","FileType","Path","SiteName","SiteTitle","PictureThumbnailURL","DefaultEncodingURL","LastModifiedTime","ListID","ListItemID","SiteID","WebId","UniqueID"],Properties:[{Name:"TrimSelectProperties",Value:{StrVal:"1",QueryPropertyValueTypeIndex:1}},{Name:"EnableDynamicGroups",Value:{BoolVal:i,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:r,QueryPropertyValueTypeIndex:3}}]};if(o.SourceId=Z,o.TrimDuplicates=!1,e.indexOf($)>-1&&o.SelectProperties.push("UserName","WorkEmail","OrgNames","JobTitle","WorkPhone","MobilePhone"),n.query&&n.query.filters){for(var s=n.query.filters,c=!1,d=!1,l=0;l<s.length;l++)switch(s[l].filterType){case T.RecentlyAdded:c=!0;break;case T.RecentlyChanged:d=!0}c&&o.SelectProperties.push(J),d&&o.SelectProperties.push(X)}if(n.selectProperties){var u={};for(l=0;l<o.SelectProperties.length;l++)u[o.SelectProperties[l]]=!0;for(l=0;l<n.selectProperties.length;l++)this._addSelectField(o.SelectProperties,n.selectProperties[l],u)}if(n.maxItemsPerPage&&(o.RowLimit=n.maxItemsPerPage,o.RowsPerPage=n.maxItemsPerPage),n.startRow&&(o.StartRow=n.startRow),n.query)switch(n.query.sortType){case Y.MostRecent:o.SortList=[{Property:X,Direction:Q.descending}];break;case Y.MostViewed:o.SortList=[{Property:"ViewsLifeTime",Direction:Q.descending}];break;case Y.Trending:o.SortList=[{Property:"ViewsRecent",Direction:Q.descending}];break;case Y.FieldAscending:case Y.FieldDescending:n.query.sortField&&(o.SortList=[{Property:n.query.sortField,Direction:n.query.sortType===Y.FieldAscending?Q.ascending:Q.descending}])}return o},e.generateSearchAPIQueryOptionsForManagedProperties=function(e){var t,n=e.query,a=n.managedPropertiesRefinerOptions,i=isNaN(a.limit)?5e4:a.limit,r=a.managedPropertyMatchText?"*".concat(a.managedPropertyMatchText,"*"):"*",o=btoa(Object(W.unescape)(encodeURIComponent(r)));switch(n.contentLocation){case z.CurrentSite:t=e.webAbsoluteUrl;break;case z.CurrentSiteCollection:t=e.siteAbsoluteUrl;break;case z.AllSites:default:t=new URL(e.webAbsoluteUrl).origin}var s='path:"'.concat(t,'" ').concat(this._generateContentKql(e,!1));return{ClientType:e.clientType,SourceId:Z,Querytext:s,Refiners:"ManagedProperties(filter3i=".concat(i,"/0/").concat(o,",sort=name/ascending)"),EnableQueryRules:!1,ProcessBestBets:!1,ProcessPersonalFavorites:!1,Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:"False",QueryPropertyValueTypeIndex:3}},{Name:"ClientFunction",Value:{StrVal:"SchemaLookup",QueryPropertyValueTypeIndex:1}}]}},e._buildFilterGroupExpr=function(e,t){var n=this,a="",i=!1;return e.filters&&e.filters.forEach(function(r){if(void 0!==r.value&&""!==r.value||void 0!==r.userType&&r.userType!==U.SpecificUser){var o=n._kqlFilter(r,t);i=i||o.isFilteringByDate,a=n._chainKqlFilterExpr(a,o,e.logicalOperator)}}),e.filterGroups&&e.filterGroups.forEach(function(r){var o=n._buildFilterGroupExpr(r,t);i=i||o.isFilteringByDate,a=n._chainKqlFilterExpr(a,o,e.logicalOperator)}),a&&(a+=")"),{expr:a,isFilteringByDate:i}},e._chainKqlFilterExpr=function(e,t,n){var a=e;return t.expr&&(a?a+=" ".concat(n," "):a="(",a+=t.expr),a},e._generateContentKql=function(e,t){var n=e.query,a=e.languageCode,i="",o=r._SPFlight.isEnabled(60373)?"(".concat(ee," AND PromotedState=2 AND NOT ContentTypeId:").concat("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB","*)"):"(".concat(ee," AND PromotedState=2)"),s="(FileType=".concat(l.spConstants.imageExtensions.join(" OR FileType="),")"),d="(".concat("ContentTypeId:0x010108*"," OR ").concat("ContentTypeId:0x01010901*"," OR ").concat(ee," OR ").concat("ContentTypeId:0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF39*",")"),u=n.contentTypes||[G.Document],f=!1;u.indexOf(G.All)>-1&&(f=!0,n.contentLocation!==z.AllSites||t||(i+="*"));var p=!1,m=!1;if(!f)for(var _="",h=0;h<u.length;++h)switch(1===h&&(_=" OR"),u[h]){case G.Document:i=this._appendCriteriaUniquely(i,_,"IsDocument:1"),p||(i+=" AND NOT (FileType:aspx OR FileType:html OR FileType:htm OR FileType:mhtml)"),p=!0;break;case G.Page:i=this._appendCriteriaUniquely(i,_,d,a),m||(i+=" AND NOT (FileType:one OR FileType:onepkg OR FileType:ms-one-stub OR FileType:onetoc OR FileType:onetoc2)"),m=!0;break;case G.News:i=this._appendCriteriaUniquely(i,_,o,a);break;case G.Event:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x0102*");break;case G.Issue:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x0103*");break;case G.Task:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x0108*");break;case G.Link:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x0105*");break;case G.Contact:i=this._appendCriteriaUniquely(i,_,$);break;case G.Video:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x010100F3754F12A9B6490D9622A01FE9D8F012*"),""===_&&(i+=" OR "),i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(Object(c.__spreadArray)([],l.spConstants.videoExtensions,!0)));break;case G.Image:i=this._appendCriteriaUniquely(i,_,s)}if(a&&f&&(i+="".concat(y()?" AND":"")+" (SPTranslationLanguage:".concat(a," ")+"OR (NOT SPTranslatedLanguages:".concat(a," AND NOT SPIsTranslation:true))")),p||f){var b=n.documentTypes||[k.Any];if(-1===b.indexOf(k.Any))for(_="",h=0;h<b.length;++h)switch(1===h&&(_=" OR"),b[h]){case k.Word:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["doc","docm","docx"]));break;case k.Excel:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case k.PowerPoint:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case k.OneNote:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["one","onepkg","ms-one-stub","onetoc","onetoc2"]));break;case k.Visio:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case k.PDF:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["pdf"]))}}return i&&" (".concat(i.trim(),")")},e._addSelectField=function(e,t,n){n[t]||(n[t]=!0,e.push(t))},e._generateSiteIdCriteria=function(e,t){return"(".concat(this._siteCriteria(e,"NormSiteID")," AND ").concat(this._siteCriteria(t,"NormWebId"),")")},e._siteCriteria=function(e,t){return t===te?"(".concat(t,":").concat(e," OR ").concat(t,":{").concat(e,"})"):"".concat(t,":").concat(e)},e._appendCriteriaUniquely=function(e,t,n,a){return-1===e.indexOf(n)&&(a&&(n+="".concat(y()?" AND ":"")+" (SPTranslationLanguage:".concat(a," ")+"OR (NOT SPTranslatedLanguages:".concat(a," AND NOT SPIsTranslation:true))")),e+="".concat(t," ").concat(n)),e},e._kqlFilter=function(e,t){var n=" ",a=!1;if(e&&(void 0!==e.value||void 0!==e.userType)){var i=void 0!==e.value?e.value.toString():"",r=void 0;switch(e.filterType){case T.TitleContaining:n+=i?'title:"'.concat(i,'"'):"";break;case T.AnyTextContaining:n+=i?'"'.concat(i,'"'):"";break;case T.TaggedWith:n+=i?'tags:"'.concat(i,'"'):"";break;case T.CreatedBy:e.userType===U.CurrentUser?n+="createdby:{User}":i&&(F.isValidMeToken(i)?n+="createdby:{User}":n+='createdby:"'.concat(i,'"'));break;case T.ModifiedBy:e.userType===U.CurrentUser?n+="modifiedby:{User}":i&&(F.isValidMeToken(i)?n+="modifiedby:{User}":n+='modifiedby:"'.concat(i,'"'));break;case T.RecentlyAdded:r=J;break;case T.RecentlyChanged:r=X;break;case T.Field:if(t){var o=this._managedPropertyFilter(e,t);n+=o.expr,a=o.isFilteringByDate}}if(r)switch(a=!0,this._filterSince(i)){case P.Today:n+="".concat(r,"=today");break;case P.Yesterday:n+="(".concat(r,"=today OR ").concat(r,"=yesterday)");break;case P.ThisWeek:n+="".concat(r,'="this week"');break;case P.ThisMonth:n+="".concat(r,'="this month"');break;case P.LastMonth:n+="(".concat(r,'="this month" OR ').concat(r,'="last month")');break;case P.ThisYear:n+="".concat(r,'="this year"');break;case P.LastYear:n+="(".concat(r,'="this year" OR ').concat(r,'="last year")')}}return{expr:n.trim(),isFilteringByDate:a}},e._filterSince=function(e){try{return parseInt(e,10)}catch(e){return P.ThisMonth}},e._documentTypeCriteria=function(e){return"(FileType:".concat(e.join(" OR FileType:"),")")},e._managedPropertyFilter=function(e,t){var n=e.fieldInfo||t[e.fieldname];n=n||q.e.Text;var a=this._parseManagedFieldValue(e.value,n),i="",r=n===q.e.DateTime;if(""===a.trim()&&e.op!==M.Equals&&e.op!==M.NotEqual&&e.op!==M.Between)return{expr:"",isFilteringByDate:!1};switch(e.op){case M.BeginsWith:var o=a.substr(1,a.length-2);i="".concat(e.fieldname,'="').concat(o,'*"');break;case M.Between:var s=this._parseManagedFieldValue(e.value2,n);""!==a.trim()&&""!==s.trim()?i="".concat(e.fieldname,">=").concat(a," AND ").concat(e.fieldname,"<=").concat(s):""!==a.trim()?i="".concat(e.fieldname,">=").concat(a):""!==s.trim()&&(i="".concat(e.fieldname,"<=").concat(s));break;case M.Contains:i="".concat(e.fieldname,":").concat(a);break;case M.DoesNotContain:i="-".concat(e.fieldname,":").concat(a);break;case M.Equals:i="".concat(e.fieldname,"=").concat(a);break;case M.GreaterThan:i="".concat(e.fieldname,">").concat(a);break;case M.GreaterThanOrEqualTo:i="".concat(e.fieldname,">=").concat(a);break;case M.LessThan:i="".concat(e.fieldname,"<").concat(a);break;case M.LessThanOrEqualTo:i="".concat(e.fieldname,"<=").concat(a);break;case M.NotEqual:i="-".concat(e.fieldname,"=").concat(a)}return{expr:i,isFilteringByDate:r}},e._parseManagedFieldValue=function(e,t){var n="";switch(t){case q.e.DateTime:if("string"==typeof e&&F.isValidTodayToken(e)){var a=e.substr("[today]".length)||"";return a?"{Today".concat(a,"}"):"{Today}"}var i=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(i)&&(isNaN(i.getTime())||(n='"'.concat(i.toISOString(),'"')));break;case q.e.Decimal:case q.e.Double:var r=parseFloat(e.toString());isNaN(r)||(n=r.toString());break;case q.e.Integer:var o=parseInt(e.toString(),10);isNaN(o)||(n=o.toString());break;case q.e.Text:n="string"==typeof e&&F.isValidMeToken(e)?"{User}":'"'.concat(e.toString().trim(),'"');break;case q.e.YesNo:n=e?"true":"false"}return n},e}(),ie={shouldUseCachedRequest:!1,webpartId:"",alias:"",qosMonitorLabel:""},re=function(){function e(e,t,n){void 0===t&&(t=""),void 0===n&&(n=ie);var a=this;this.extraData={},this._parseHttpClientResponse=function(e,t,n){return a.extraData={correlationId:"".concat(e.correlationId),responseStatus:"".concat(e.status),message:e.statusMessage,cacheStatus:"None"},a._parseResponse(e).catch(function(e){return n.writeUnexpectedFailure("Unexpected",e.message),e}).then(function(e){return a._parseRawResponse(e,void 0,n)})},this._parseRawResponse=function(e,t,n){var i=a._simplifyResultForTemplating(e);return n.writeSuccess(a.extraData),i},this._isEmptyResponse=function(e){var t;return!(null===(t=null==e?void 0:e.rows)||void 0===t?void 0:t.length)},this._isRawData=function(e){return!(null==e?void 0:e.rows)},this._serviceScope=e,this._qosPrefix=t,this._tieredCachingProps=n,this._simplifyResultForTemplating=this._simplifyResultForTemplating.bind(this)}return Object.defineProperty(e.prototype,"_shouldUseTieredCaching",{get:function(){return(r._SPFlight.isEnabled(60469)||1===b._SPPerfExperiment.getVariantAndTrackExperiment(b._PerformanceExperiment.WEXMySiteCacheTCExpHCW))&&this._tieredCachingProps.shouldUseCachedRequest},enumerable:!1,configurable:!0}),e.prototype.getSearchQueryResponse=function(e){var t=this._qosPrefix?new b._QosMonitor("".concat(this._qosPrefix,".SearchDataProviderGetResponse")):new b._QosMonitor("SearchDataProviderGetResponse");return(this._shouldUseTieredCaching?this._getSearchQueryResponse(e):this._getRawSearchQueryResponse(e).then(this._simplifyResultForTemplating)).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure("FailedSearchPOST",e,{correlationId:e.correlationId}),Promise.reject(e)})},e.prototype.getManagedPropertiesQueryResponse=function(e){var t=new b._QosMonitor("ManagedPropertiesRequest");return this._getRawSearchQueryResponse(e).then(function(e){var n,a,i=(null===(a=null===(n=e.PrimaryQueryResult)||void 0===n?void 0:n.RefinementResults)||void 0===a?void 0:a.Refiners)||[],r=(i.length>0?i[0].Entries:[]).map(function(e){return e.RefinementName});return t.writeSuccess(),Promise.resolve(r)}).catch(function(e){return t.writeUnexpectedFailure("ManagedPropertiesRequestFailed",e),Promise.reject(e)})},e.prototype._getRawSearchQueryHeaders=function(e){e.ClientType=e.ClientType||"ModernWebPart";var t='{ "request": '+(e?JSON.stringify(e):"{}")+" }",n=new Headers;return n.append("Accept","application/json;odata=nometadata"),n.append("Content-type","application/json;charset=utf-8"),n.append("OData-Version","3.0"),this._afterServiceScopeFinished().then(function(e){var a=e.pageContext;return{spHttpClient:e.spHttpClient,postUrl:"".concat(a.web.absoluteUrl,"/_api/search/postquery"),body:t,headers:n}})},e.prototype._getRawSearchQueryResponse=function(e){var t=this;return this._getRawSearchQueryHeaders(e).then(function(e){var n=e.spHttpClient,a=e.postUrl,r=e.body,o=e.headers;return n.post(a,i.SPHttpClient.configurations.v1,{body:r,headers:o}).then(t._parseResponse)})},e.prototype._getSearchQueryResponse=function(e){var t=this;return this._getRawSearchQueryHeaders(e).then(function(e){var n=e.spHttpClient,a=e.postUrl,r=e.body,o=e.headers,s=t._tieredCachingProps,c=s.webpartId,d=s.alias;return v.executeCacheStrategy(t._cacheProps,function(){var e={method:"POST",body:r,headers:o},t={id:c,expirationDuration:6e5,cacheStrategy:H._CacheStrategy.CacheAndNetwork,alias:d,extraProps:new Map([[v.useStalePropName,!0]])};return n.fetch(a,i.SPHttpClient.configurations.v1,e,t)},void 0)})},Object.defineProperty(e.prototype,"_cacheProps",{get:function(){var e=this._tieredCachingProps,t=(e.webpartId,e.shouldUseCachedRequest,e.alias,Object(c.__rest)(e,["webpartId","shouldUseCachedRequest","alias"]));return Object(c.__assign)(Object(c.__assign)({},t),{parseHttpClientResponse:this._parseHttpClientResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._parseRawResponse})},enumerable:!1,configurable:!0}),e.prototype._simplifyResultForTemplating=function(e){var t,n,a,i={};try{var r=[],o=null===(a=null===(n=null===(t=e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.Table)||void 0===a?void 0:a.Rows;if(!o)throw new Error("Did not receive response rows.");for(var s=0;s<o.length;s++){for(var c={},d=o[s].Cells,l=0;l<d.length;l++){var u=d[l];c[u.Key]=u.Value}r.push(c)}i.rows=r}catch(e){i.rows=[]}return i},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(a.PageContext.serviceKey),spHttpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._parseResponse=function(t){return t.status>=200&&t.status<300?t.json():t.json().then(function(n){var a="BadSearchResponse: statusMessage=".concat(t.statusMessage);throw s._TraceLogger.logVerbose(e._LogSource,"".concat(a,", response inner error=").concat(JSON.stringify(n))),{message:a,status:t.status,correlationId:t.correlationId?t.correlationId.toString():"",innerError:n}})},e._LogSource=s._LogSource.create("SearchAPIRequest"),e}(),oe=n("9G/9"),se=function(){function e(e){var t=this;return this.id="Search",this.title=oe.e,this.options=e,this.options.serviceScope.whenFinished(function(){t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey),t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._initVariables()}),this._searchAPIRequest=new re(e.serviceScope,e.qosPrefix||"",e.tieredCachingProps),u.Locale.language||(u.Locale.language="en-us"),this}return e.prototype.requestData=function(e){var t,n,a;if(null===(n=null===(t=e.searchOptions)||void 0===t?void 0:t.query)||void 0===n?void 0:n.managedPropertiesRefinerOptions)return a=ae.generateSearchAPIQueryOptionsForManagedProperties(e.searchOptions),this._searchAPIRequest.getManagedPropertiesQueryResponse(a).catch(function(e){return Promise.reject(e)});if(e.returnCachedValues)return this._returnCachedResults();if(e.searchAPIQueryOptions)a=e.searchAPIQueryOptions;else if(e.searchOptions){var i=ae.generateQuery(e.searchOptions,this._pageContext);a=ae.generateSearchAPIQueryOptions(i.queryTemplate,i.timeZoneId,e.searchOptions)}return a?this._searchAPIRequest.getSearchQueryResponse(a).then(this._mapResponse).catch(function(e){return Promise.reject(e)}):Promise.resolve([])},e.prototype._initVariables=function(){},e.prototype._mapResponse=function(e){return Promise.resolve(e)},e.prototype._returnCachedResults=function(){return Promise.resolve([])},e}(),ce=function(){function e(){}return e.prototype.getPerson=function(e,t){var n,a,i,r;if(!e&&t)(o=t.split(";")).length>0&&(a=o[o.length-1]);else if(e){var o;if((o=e.split(" | ")).length>=2&&(i=o[0],a=o[1]),o.length>=3&&o[2]){var s=o[2].split(" ");s.length>1&&s[1].length>1&&(r=this._getAccountNameFromClaim(s[1]))}}return n={name:a},r&&(n.profileImageSrc=l.SPUtility.getUserPhotoUrl(r)),i?(n.email=i,n.profileImageSrc||(n.profileImageSrc=l.SPUtility.getUserPhotoUrl(i))):a?n.initials=this._getEditorInitials(a):n.profileImageSrc||(n.profileImageSrc=l.SPUtility.getUserPhotoUrl()),n},e.prototype._getEditorInitials=function(e){var t;if(e){var n=e.split("(")[0].trim().split(" ");t=(t=1===n.length?n[0].substring(0,2):n[0].charAt(0)+n[n.length-1].charAt(0)).toUpperCase()}return t},e.prototype._getAccountNameFromClaim=function(e){if(e){var t=e.lastIndexOf("|");if(t>=0)return e.substr(t+1)}},e}();function de(e){if(!e)return"";var t=new RegExp('[*{}"]',"g");return e.replace(t," ")}var le=function(){function e(e){this._pageContext=e.pageContext}return e.prototype.buildUrl=function(e,t,n){var a=r.UrlUtilities.removeEndSlash(e),i=0===t.indexOf("/")?"":"/",o=t.indexOf("?")>-1?"&":"?";return"".concat(a).concat(i).concat(t).concat(n?o+n:"")},Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),e}(),ue=n("6DSs"),fe=function(e){function t(t){var n=e.call(this,t)||this;return n._spHttpClient=t.spHttpClient,n}return Object(c.__extends)(t,e),t.prototype.get=function(e,t,n,a,r,o,s,c){var d=this.buildUrl(e,t,n);return this._getResponse(this._spHttpClient.get(d,i.SPHttpClient.configurations.v1,{headers:o}),a,r,s,c)},t.prototype.post=function(e,t,n,a,r,o,s,c,d){var l=this.buildUrl(e,t,n);return this._getResponse(this._spHttpClient.post(l,i.SPHttpClient.configurations.v1,{body:a,headers:s}),r,o,c,d)},t.prototype.patch=function(e,t,n,a,r,o,s,c,d){var l=this.buildUrl(e,t,n);return this._getResponse(this._spHttpClient.fetch(l,i.SPHttpClient.configurations.v1,{body:a,headers:s,method:"PATCH"}),r,o,c,d)},t.prototype._getResponse=function(e,t,n,a,i){return e.then(function(e){if(e.ok)return i?{}:e.json();var o=r.Text.format(ue.e,t,n,e.status,e.statusMessage);if(a)throw e;return e.json().then(function(t){throw{message:o,status:e.status,correlationId:e.correlationId?e.correlationId.toString():"",innerError:t}})})},t}(le),pe=function(){function e(){}return e.generateQueryString=function(e){var t=e.fields?e.fields.map(function(e){return u.UriEncoding.encodeURIComponent(e)}).join(","):void 0,n=new URLSearchParams(e.queryString);function a(e,t){var a="$".concat(e);t&&!n.has(a)&&n.set(a,t.toString())}return a("select",t),a("filter",e.filter),a("top",e.top),a("skip",e.skip),a("orderby",e.orderBy),a("expand",e.expand),n.toString()},e}(),me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getListsForWeb=function(e,t){return this.get(e,"/_api/web/lists",t,"ListDataSource","getListsForWeb",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t.prototype.getListFromWeb=function(e,t,n){return this.get(e,"/_api/web/lists(guid'".concat(t,"')"),n,"ListDataSource","getListFromWeb").then(function(e){return e})},t.prototype.getDefaultDocumentLibrary=function(e,t){return this.get(e,"/_api/web/DefaultDocumentLibrary",t,"ListDataSource","getDefaultDocumentLibrary").then(function(e){return e})},t}(fe),_e=me,he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getFieldsForList=function(e,t,n){return this.get(e,"/_api/web/lists('".concat(t,"')/Fields"),n,"ListFieldDataSource","getFieldsForList",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t}(fe),be=he,ge={Integer:1,Text:2,DateTime:4,Counter:5,Choice:6,Boolean:8,Number:9,Currency:10,MultiChoice:15,User:20},ve={None:0,ContextInfo:1,ListData:2,ListSchema:4},ye=n("R/pT"),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getItemsForList=function(e,t,n,a,i,o,s,c,d,l,u,f){var p,m=this;if(!a&&!t&&!n)throw ye.e;void 0===i&&(i=ve.None),s?(0===s.indexOf("?")&&(s=s.substring(1)),0!==s.indexOf("&")&&(s="&"+s)):s="",a?p="DefaultDocumentLibrary":(p="Lists",p+=t?"(guid'".concat(t,"')"):"/GetByTitle('".concat(n,"')"));var _=u?"View=".concat(u):"",h="/_api/web/".concat(p,"/RenderListDataAsStream?").concat(_).concat(s),b={parameters:{__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:i}},g=new Headers;return g.append("Content-Type","application/json;odata=verbose"),g.append("Accept","application/json;odata=nometadata"),g.append("OData-Version","3.0"),o&&(b.parameters.ViewXml=o),d&&(b.parameters.ImageFieldsToTryRewriteToCdnUrls=d),void 0!==l&&(b.parameters.AudienceTarget=l),r._SPKillSwitch.isActivated("260c3c80-b336-4a28-a0b9-56085fa507b5")?this.post(e,h,"",JSON.stringify(b),"ListItemDataSource","getItemsForList",g,c).then(function(e){return e.ListData.Row}):f?f(e).then(function(t){return t&&g.append("authorization","Bearer "+t),m._getItems(e,h,b,g,c)}):this._getItems(e,h,b,g,c)},t.prototype._getItems=function(e,t,n,a,i){return this.post(e,t,"",JSON.stringify(n),"ListItemDataSource","getItemsForList",a,i).then(function(e){return e.ListData.Row})},t}(fe),De=Se,Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.addView=function(e,t){var n="/_api/web/lists('".concat(t,"')/Views/Add"),a=JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},PersonalView:!1}});return this.post(e,n,void 0,a,"ListViewDataSource","addView",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},t.prototype.updateViewXml=function(e,t,n,a){var i="/_api/web/lists('".concat(t,"')/views('").concat(n,"')/SetViewXml()"),r=JSON.stringify({viewXml:a});return this.post(e,i,void 0,r,"ListViewDataSource","updateViewXml",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},Object(c.__decorate)([Object(l.monitor)("ListViewDataSource.addView")],t.prototype,"addView",null),Object(c.__decorate)([Object(l.monitor)("ListViewDataSource.updateViewXml")],t.prototype,"updateViewXml",null),t}(fe),xe=Ie,Ce="Author",Oe="_AuthorByline",we="Editor",Ee="Created",Ae="Modified",Le="Modified",ke=function(){function e(){}return e.generateCAMLQuery=function(t,n,a){var i=this;(t=t||{}).documentTypes=t.documentTypes||[k.Any],t.fields=t.fields||["Editor","FileLeafRef","File_x0020_Type","ID","Modified","Title","UniqueID"],t.filters=t.filters||[],t.fieldDictionary=t.fieldDictionary||{};var r=[],o=[],s=!1;t.documentTypes.map(function(e){switch(e){case k.Any:s=!0;break;case k.Word:r.push(i._documentTypeCriteria(["doc","docm","docx"]));break;case k.Excel:r.push(i._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case k.PowerPoint:r.push(i._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case k.OneNote:r.push(i._documentTypeCriteria(["one","onepkg","ms-one-stub"]));break;case k.Visio:r.push(i._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case k.PDF:r.push(i._documentTypeCriteria(["pdf"]));break;case k.Video:r.push(i._documentTypeCriteria(Object(c.__spreadArray)([],l.spConstants.videoExtensions,!0)))}}),s&&(r=[]),r.length&&(r=['<And><In><FieldRef Name="File_x0020_Type" /><Values>'].concat(r,"</Values></In>"),o.push("</And>")),s&&(r=['<And><And><Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'.concat(e._generateNotIn("File_x0020_Type",["onetoc","onetoc2"]),"</And>")],o.push("</And>")),t.contentTypes&&t.contentTypes.indexOf(G.News)>-1&&(r.push('<And><Eq><FieldRef Name="PromotedState" /><Value Type="Integer">2</Value></Eq>'),o.push("</And>")),(l.Multilingual.isWEXRollupWebpartLanguageCheckFlightEnabled()?Boolean(t.languageCode&&l.Multilingual.isEnabled(n)):Boolean(t.languageCode))&&this._filterByLanguage(t,r,o);var d=t.sortField||Le,u="true";d===Le&&(u="false");var f="";t.maxItemsPerPage&&(f='<RowLimit Paged="false">'.concat(t.maxItemsPerPage,"</RowLimit>"));var p=t.fields.map(function(e){return'<FieldRef Name="'.concat(e,'" />')}).join("");return'<View Scope="RecursiveAll"><Query>'+e.generateCAMLFilter(t,r,o,a)+"<OrderBy>"+'<FieldRef Name="'.concat(d,'" Ascending="').concat(u,'" />')+"</OrderBy></Query><ViewFields>"+p+"</ViewFields>"+f+"</View>"},e.generateCAMLFilter=function(e,t,n,a){var i=this;if(t=t||[],n=n||[],e.filterGroup){var r=this._generateCriteriaFromFilterGroup(e.filterGroup,e.fieldDictionary,a);return"<Where>"+t.join("")+(r?"<And>":"")+r+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+(r?"</And>":"")+n.join("")+"</Where>"}var o=new Map;return e.filters.map(function(t){if(t){var n=i._generateFieldName(t),r=i._generateCriteria(t,e.fieldDictionary,a);n&&r&&(o.get(t.filterType)||o.set(t.filterType,new Map),o.get(t.filterType).get(n)||o.get(t.filterType).set(n,[]),o.get(t.filterType).get(n).push(r))}}),o.forEach(function(e){e.forEach(function(e){t.push("<And>".concat(i._combineCriteria(e,"Or"))),n.push("</And>")})}),"<Where>"+t.join("")+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+n.join("")+"</Where>"},e._generateNotIn=function(e,t){return t.map(function(t){return'<Neq><FieldRef Name="'.concat(e,'" /><Value Type="Text">').concat(t,"</Value></Neq>")}).reduceRight(function(e,t){return""===e?t:"<And>".concat(t).concat(e,"</And>")},"")},e._generateCriteriaFromFilterGroup=function(t,n,a){var i=this,r="";return t.filters&&(r=t.filters.reduce(function(r,o){var s=i._generateCriteria(o,n,a);return e._appendCriteria(t.logicalOperator,r,s)},r)),t.filterGroups&&(r=t.filterGroups.reduce(function(a,r){var o=i._generateCriteriaFromFilterGroup(r,n);return e._appendCriteria(t.logicalOperator,a,o)},r)),r},e._appendCriteria=function(e,t,n){var a="AND"===e?"And":"Or";return t&&n?"<".concat(a,">").concat(t).concat(n,"</").concat(a,">"):t+n},e._generateFieldName=function(e){switch(e.filterType){case T.TitleContaining:return"Title";case T.CreatedBy:return Ce;case T.PageAuthorByline:return Oe;case T.ModifiedBy:return we;case T.RecentlyAdded:return Ee;case T.RecentlyChanged:return Ae;case T.Field:return e.fieldname}return""},e._generateCriteria=function(e,t,n){var a=e.value?this._encodeUserEntryForXML(e.value.toString(),n):"";switch(e.filterType){case T.TitleContaining:return a?'<Contains><FieldRef Name="Title"/><Value Type="Text">'.concat(a,"</Value></Contains>"):"";case T.CreatedBy:return this._userTypeCriteria(e.userType,a,Ce,e.op);case T.PageAuthorByline:return this._userTypeCriteria(e.userType,a,Oe,e.op);case T.ModifiedBy:return this._userTypeCriteria(e.userType,a,we,e.op);case T.RecentlyAdded:return this._dateTimeTypeCriteria(e.value,Ee);case T.RecentlyChanged:return this._dateTimeTypeCriteria(e.value,Ae);case T.Field:return this._fieldTypeCriteria(e,t,n)}return""},e._encodeUserEntryForXML=function(e,t){var n=document.createElement("div");return n.appendChild(document.createTextNode(e)),t?encodeURIComponent(n.innerHTML).replace(new RegExp("'","g"),"%27%27"):n.innerHTML},e._documentTypeCriteria=function(e){return e.map(function(e){return'<Value Type="Text">'.concat(e,"</Value>")}).join("")},e._getISODateString=function(e){return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate())},e._getDateTimeTypeComparisonValueElement=function(e,t,n){return["<And>",this._comparisonElement("Geq",e,'<Value Type="DateTime">'.concat(this._getISODateString(t),"</Value>")),this._comparisonElement("Leq",e,'<Value Type="DateTime">'.concat(this._getISODateString(n),"</Value>")),"</And>"].join("")},e._dateTimeTypeCriteria=function(e,t){var n=new Date;if("number"==typeof e)switch(e){case P.Today:return this._comparisonElement("Eq",t,'<Value Type="DateTime"><Today /></Value>');case P.Yesterday:return this._comparisonElement(r._SPKillSwitch.isActivated("ef5c6708-0170-4da4-899d-1ed585adfb70")?"Eq":"Geq",t,'<Value Type="DateTime"><Today OffsetDays="-1" /></Value>');case P.ThisWeek:var a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-n.getDay());return this._getDateTimeTypeComparisonValueElement(t,a,n);case P.ThisMonth:var i=new Date(n.getFullYear(),n.getMonth(),1),o=new Date(n.getFullYear(),n.getMonth()+1,0);return this._getDateTimeTypeComparisonValueElement(t,i,o);case P.LastMonth:var s=new Date(n.getFullYear(),n.getMonth()-1,1),c=new Date(n.getFullYear(),n.getMonth(),0);return this._getDateTimeTypeComparisonValueElement(t,s,c);case P.ThisYear:var d=new Date(n.getFullYear(),0,1),l=new Date(n.getFullYear(),11,31);return this._getDateTimeTypeComparisonValueElement(t,d,l);case P.LastYear:var u=new Date(n.getFullYear()-1,0,1),f=new Date(n.getFullYear()-1,11,31);return this._getDateTimeTypeComparisonValueElement(t,u,f)}return""},e._userTypeCriteria=function(e,t,n,a){switch(a){case M.IsNull:return this._comparisonElement("IsNull",n,"");case M.Equals:default:var i=this._comparisonElement("Eq",n,'<Value Type="Integer"><UserID Type="Integer" /></Value>');return e===U.CurrentUser?i:e===U.SpecificUser&&t?F.isValidMeToken(t)?i:this._comparisonElement("Eq",n,'<Value Type="User">'.concat(t.toString(),"</Value>")):""}},e._criteriaElement=function(e,t,n,a){var i=a?this._encodeUserEntryForXML(n,a):n,r='<Value Type="'.concat(t.TypeAsString,'">').concat(i,"</Value>");if(t.FieldTypeKind===ge.User&&F.isValidMeToken(i))r='<Value Type="Integer"><UserID Type="Integer" /></Value>';else if(t.FieldTypeKind===ge.DateTime&&F.isValidTodayToken(i)){var o=i.substr("[today]".length)||"0",s=parseInt(o,0);r='<Value Type="DateTime"><Today OffsetDays="'.concat(s,'" /></Value>')}return this._comparisonElement(e,t.InternalName,r)},e._comparisonElement=function(e,t,n){return"<".concat(e,'><FieldRef Name="').concat(t,'"/>').concat(n,"</").concat(e,">")},e._includeElement=function(e,t,n){var a=this,i=t.map(function(t){return t?a._criteriaElement("Eq",e,t,n):'<IsNull><FieldRef Name="'.concat(e.InternalName,'"/></IsNull>')});return this._combineCriteria(i,"Or")},e._combineCriteria=function(e,t){if(!e||0===e.length)return"";for(var n="",a=1;a<e.length;a++)n+="<".concat(t,">");for(n+=e[0],a=1;a<e.length;a++)n+="".concat(e[a],"</").concat(t,">");return n},e._fieldTypeCriteria=function(e,t,n){var a=this;if(!e.fieldInfo&&!t)return"";var i=e.fieldInfo||t[e.fieldname];if(!i)return"";var r=this._parseListFieldValue(e.value,i.FieldTypeKind);if(""===r.trim()&&e.op!==M.Equals&&e.op!==M.NotEqual&&e.op!==M.Between)return"";var o="";switch(e.op){case M.BeginsWith:o=this._criteriaElement("BeginsWith",i,r,n);break;case M.Between:var s=this._parseListFieldValue(e.value2,i.FieldTypeKind);""!==r.trim()&&""!==s.trim()?o="<And>"+this._criteriaElement("Geq",i,r,n)+this._criteriaElement("Leq",i,s,n)+"</And>":""!==r.trim()?o=this._criteriaElement("Geq",i,r,n):""!==s.trim()&&(o=this._criteriaElement("Leq",i,s,n));break;case M.Contains:o=this._criteriaElement("Contains",i,r,n);break;case M.Equals:o=e.values&&e.values.length>0?this._includeElement(i,e.values.map(function(e){return a._parseListFieldValue(e,i.FieldTypeKind)}),n):this._criteriaElement("Eq",i,r,n);break;case M.GreaterThan:o=this._criteriaElement("Gt",i,r,n);break;case M.GreaterThanOrEqualTo:o=this._criteriaElement("Geq",i,r,n);break;case M.LessThan:o=this._criteriaElement("Lt",i,r,n);break;case M.LessThanOrEqualTo:o=this._criteriaElement("Leq",i,r,n);break;case M.NotEqual:o=this._criteriaElement("Neq",i,r,n)}return o},e._parseListFieldValue=function(e,t){var n="";if(void 0===e)return n;switch(t){case ge.DateTime:if("string"==typeof e&&F.isValidTodayToken(e)){n=e.trim();break}var a=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(a)&&(isNaN(a.getTime())||(n="".concat(a.toISOString())));break;case ge.Number:case ge.Currency:var i=parseFloat(e.toString());isNaN(i)||(n=i.toString());break;case ge.Integer:case ge.Counter:var r=parseInt(e.toString(),10);isNaN(r)||(n=r.toString());break;case ge.User:case ge.Text:default:n="".concat(e.toString().trim())}return this._encodeUserEntryForXML(n)},e._filterByLanguage=function(e,t,n){var a=e.contentTypes&&e.contentTypes.indexOf(G.All)>-1,i=!1,r=!1;if(e.contentTypes&&!a)for(var o=0;o<e.contentTypes.length;++o)switch(e.contentTypes[o]){case G.Page:i=!0;break;case G.News:r=!0}if(e.languageCode&&(a||i||r)){var s=e.languageCode,c='<FieldRef Name="_SPTranslationLanguage" />',d='<Value Type="Choice">'.concat(s,"</Value>"),l="<Eq>".concat(c).concat(d,"</Eq>"),u='<Value Type="MultiChoice">'.concat(s,"</Value>"),f="<Neq>".concat('<FieldRef Name="_SPTranslatedLanguages" />').concat(u,"</Neq>"),p="<IsNull>".concat(c,"</IsNull>");t.push("<And><Or>".concat(l,"<And>").concat(f).concat(p,"</And></Or>")),n.push("</And>")}},e}(),Me={List:1,Item:2,Field:3},Pe=n("YkpB"),Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="List",t.title=Pe.t,t._logSource=s._LogSource.create("ListDataProvider"),t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){var t=this;switch(e.requestType){case Me.List:return this._listDataSource||(this._listDataSource=new _e({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listDataSource.getListsForWeb(this.baseEndPoint,pe.generateQueryString(e));case Me.Item:return this._listItemDataSource||(this._listItemDataSource=new De({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),e.viewId?(this._listViewDataSource||(this._listViewDataSource=new xe({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listViewDataSource.updateViewXml(this.baseEndPoint,e.id,e.viewId,e.caml).then(function(){return t._listItemDataSource.getItemsForList(t.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,void 0,void 0,void 0,void 0,e.audienceTarget,e.viewId)})):this._listItemDataSource.getItemsForList(this.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,e.caml,void 0,void 0,void 0,e.audienceTarget);case Me.Field:return this._listFieldDataSource||(this._listFieldDataSource=new be({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listFieldDataSource.getFieldsForList(this.baseEndPoint,e.id,pe.generateQueryString(e));default:var n=new Error(Pe.e);return s._TraceLogger.logError(this._logSource,n),Promise.reject(n)}},t.prototype.addView=function(e){return this._listViewDataSource||(this._listViewDataSource=new xe({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listViewDataSource.addView(this.baseEndPoint,e)},t}(o),Ue=Te,Fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){for(var n=[],a=["aspx","html","htm"],i=0,r=e.rows;i<r.length;i++){var o=r[i],s=t._personaSettingsCache.getPerson(o.EditorOwsUser,o.ModifiedBy),c=a.indexOf(o.FileExtension)>-1?o.Path:l.SPUtility.getWebPathOfFile(o.DefaultEncodingURL?o.DefaultEncodingURL:o.Path),d=o.LastModifiedTimeForRetention,u=o.SitePath;u&&(u=u.split(";")[0]);var f=l.SPFormatDateTime.formatTimestampToDisplayDate(d,t._pageContext,{skeleton:"yMMMd"}),p=W.extend(o,{Name:s.name,Email:s.email,ProfileImageSrc:s.profileImageSrc,Initials:s.initials,InitialsColor:s.initials,WebPath:c,ModifiedDate:f,SitePath:u});p.SiteName&&(p.SiteName=encodeURI(p.SiteName)),n.push(p)}return new Promise(function(e,t){return e(n)})},t}return Object(c.__extends)(t,e),t.prototype._initVariables=function(){this._personaSettingsCache=new ce},t}(se),He=Fe,Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getPageJsonBlob=function(e,t,n){return this.get(e,"_api/sitepages/pages/GetByUrl('".concat(u.UriEncoding.encodeRestUriStringToken(t),"')"),n,"PageDataSource","getPageJsonBlob").then(function(e){return[e]})},t.prototype.getPageCanvasContent=function(e){return this.get("/",e,"asjson=1","PageDataSource","getPageCanvasContent").then(function(e){return e.page.Content.CanvasContent1})},t}(fe),Ne=Re,Be=n("QRxg"),je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="Page",t.title=Be.e,t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){return this._pageDataSource||(this._pageDataSource=new Ne({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._pageDataSource.getPageCanvasContent(e.pageRelativeUrl).then(function(e){return[e]})},t}(o),Ve=je;function ze(e){var t=e.pageRelativeUrl,n=e.webPartInstanceId,a=e.componentName,i=e.webPartAlias,r=e.defaultWebPartData,o=e.serviceScope,s=e.processWebPartDataCallback,c=new b._QosMonitor("".concat(a,".ParseWebPartDataFromPage"));return new Ve({serviceScope:o}).requestData({pageRelativeUrl:t}).then(function(e){var t=null==e?void 0:e[0],n=t.CanvasJson1||t;return n||function(e,t){var n=new Error("StockContent");throw e.writeExpectedFailure(n.message,n,Ge(t)),n}(c,i),JSON.parse(n)}).then(function(e){return function(e,t){if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i.id===e)return i}}(n,e)}).then(function(e){var t;if(e&&(t=e.webPartData),!t){var a=new Error("NoInstanceDataFound");throw c.writeUnexpectedFailure(a.message,a,Ge(i)),a}return t.instanceId=n,s&&(t=s(t)),c.writeSuccess(Ge(i)),t}).catch(function(e){return c.hasEnded||c.writeUnexpectedFailure("FailedToParse",e,Ge(i)),b._EngagementLogger.logEvent("".concat(a,".LoadDefaultWebPartData")),r}).then(function(e){return e})}function Ge(e){return{webpart:e}}var Ke,We="Content-Type",qe="application/json; odata=verbose",Qe="Accept",Ye="application/json; odata.metadata=minimal",Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getPages=function(e){var t=new s._QosMonitor("TemplatePanelDataSource.getPages");return this.get(e,"_api/sitepages/pages/templates","asjson=1","TemplatePanelDataSource","getPages").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return 404===e.status?t.writeExpectedFailure("TemplatePanelError",Error(e.statusMessage||"getPage returned 404"),{correlationId:e.correlationId,status:e.status}):t.writeUnexpectedFailure("TemplatePanelError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(fe),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getPage=function(e,t){var n=new s._QosMonitor("TemplateSelectedPageCopyDataSource.getPage");return this.get(e,"_api/sitepages/pages(".concat(t,")"),"$select=CanvasContent1,LayoutWebpartsContent","TemplateCopyDataSource","getPage").then(function(e){return n.writeSuccess(),[e]}).catch(function(e){return n.writeUnexpectedFailure("TemplateSelectedPageCopyError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(fe),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getPage=function(e){var t=new s._QosMonitor("TemplateSelectedPageAsJsonDataSource.getPage");return this.get(e,"","as=json","TemplateSelectedPageAsJsonDataSource","getPage").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return t.writeUnexpectedFailure("TemplateSelectedPageAsJsonError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(fe),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){var n="GetDefaultNewPageTemplateId",a=new s._QosMonitor(t._dataSourceName+"."+n);return this.get(e,"_api/web/DefaultNewPageTemplateId","",t._dataSourceName,n,this._headers).then(function(e){var t=e.value;return a.writeSuccess(),t}).catch(function(e){return a.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to get DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t.prototype.setDefaultNewPageTemplateId=function(e,n){var a="SetDefaultNewPageTemplateId",i=new s._QosMonitor(t._dataSourceName+"."+a,!1,!0);return this.post(e,"_api/web/SetDefaultNewPageTemplateId","",JSON.stringify({defaultNewPageTemplateId:n}),t._dataSourceName,a,this._headers,!0,!0).then(function(){return i.writeSuccess(),!0}).catch(function(e){return i.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to set DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append(We,qe),e.append(Qe,Ye),e},enumerable:!1,configurable:!0}),t._dataSourceName="DefaultNewPageTemplateIdDataSource",t._errorTag="DefaultNewPageTemplateIdError",t}(fe),et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.deleteTemplatePage=function(e,n){var a="deleteTemplatePage",i=new s._QosMonitor(t._dataSourceName+"."+a),r="".concat(t._apiRelativePath,"('").concat(n,"')");return this.post(e,"".concat(r,"/recycle()"),"","",t._dataSourceName,a,this._headers,!0,!0).then(function(){return i.writeSuccess(),!0}).catch(function(e){return i.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to delete template page"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append(We,qe),e.append(Qe,Ye),e.append("IF-MATCH","*"),e},enumerable:!1,configurable:!0}),t._apiRelativePath="_api/web/GetFileByServerRelativeUrl",t._dataSourceName="DeleteTemplatePageDataSource",t._errorTag="DeleteTemplatePageError",t}(fe),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getLimitedAccessLockdownEnabled=function(e){var n="_api/site/features/GetById(guid'".concat("7c637b23-06c4-472d-9a9a-7c175762c5c4","')"),a="getLimitedAccessLockdownEnabled",i=new s._QosMonitor(t._dataSourceNamePrefix+"."+a);return this.get(e,n,"",t._dataSourceNamePrefix,a,this._headers).then(function(e){return i.writeSuccess(),void 0!==e.DefinitionId}).catch(function(e){return i.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to get LimitedAccessLockDownEnabled"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(!0)})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append(We,qe),e.append(Qe,Ye),e},enumerable:!1,configurable:!0}),t._dataSourceNamePrefix="LimitedAccessLockdownEnabledDataSource",t._errorTag="LimitedAccessLockdownEnabledError",t}(fe),nt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplates",t.title="Template Data Provider",t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){return this._templatePanelDataSource||(this._templatePanelDataSource=new Je({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._templatePanelDataSource.getPages(e.webAbsoluteUrl)},t}(o),at=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesCopy",t.title="Template Copy Data Provider",t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageCopyDataSource||(this._templateSelectedPageCopyDataSource=new Xe({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._templateSelectedPageCopyDataSource.getPage(e.webAbsoluteUrl,e.page.Id)},t}(o),it=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesAsJson",t.title="Template As Json Data Provider",t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageAsJsonDataSource||(this._templateSelectedPageAsJsonDataSource=new Ze({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._templateSelectedPageAsJsonDataSource.getPage(e.page.AbsoluteUrl)},t}(o),rt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DefaultNewPageTemplateId",t.title="Default New Page Template Id Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(c.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){return this._ensureDefaultNewPageTemplateIdDataSourceAsync().then(function(t){return t.getDefaultNewPageTemplateId(e.RequestingWebUrl)})},t.prototype.setDefaultNewPageTemplateId=function(e){return this._ensureDefaultNewPageTemplateIdDataSourceAsync().then(function(t){return t.setDefaultNewPageTemplateId(e.RequestingWebUrl,e.DefaultNewPageTemplateId)})},t.prototype._ensureDefaultNewPageTemplateIdDataSourceAsync=function(){var e=this;return this._defaultNewPageTemplateIdDataSourcePromise||(this._defaultNewPageTemplateIdDataSourcePromise=this.resolveServices().then(function(){return new $e({spHttpClient:e.spHttpClient,pageContext:e.pageContext})})),this._defaultNewPageTemplateIdDataSourcePromise},t}(o),ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DeleteTemplatePage",t.title="Delete Template Page Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(c.__extends)(t,e),t.prototype.deleteTemplatePage=function(e){var t=this;return this._defaultDeleteTemplatePageDataSourcePromise||(this._defaultDeleteTemplatePageDataSourcePromise=this.resolveServices().then(function(){return new et({spHttpClient:t.spHttpClient,pageContext:t.pageContext})})),this._defaultDeleteTemplatePageDataSourcePromise.then(function(t){return t.deleteTemplatePage(e.RequestingWebUrl,e.RelativePageUrl)})},t}(o),st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="LimitedAccessLockdownEnabled",t.title="Is Limited Access Lockdown Enabled Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(c.__extends)(t,e),t.prototype.getLimitedAccessLockdownEnabled=function(e){return this._ensureDataSourceAsync().then(function(t){return t.getLimitedAccessLockdownEnabled(e.RequestingWebUrl)})},t.prototype._ensureDataSourceAsync=function(){var e=this;return this._dataSourcePromise||(this._dataSourcePromise=this.resolveServices().then(function(){return new tt({spHttpClient:e.spHttpClient,pageContext:e.pageContext})})),this._dataSourcePromise},t}(o),ct=function(){function e(e){this.id="RecentDocuments",this.title="Recent documents",this._pageContext=e}return e.prototype.requestData=function(e){var t=this,n=new b._QosMonitor("RecentDocumentsDataProvider.getRecentDocuments");return e.authToken.then(function(n){return fetch(t._getApiUrl(e),t._getHttpConfig(n))}).then(function(e){return n.writeSuccess(),e.json()}).catch(function(e){n.writeUnexpectedFailure("Unexpected",e)}).then(function(e){return e&&e.documents&&e.documents.items?e.documents.items.map(function(e){var t=new Date(e.time_stamp),n=e.url.substring(0,e.url.lastIndexOf("/")),a="OneNote"===e.app?"one":e.extension,i=new u.Uri(e.url);return i.setQueryParameter("web","1"),{fileName:e.title,fileUrl:i.toString(),filePathSegments:e.display_path,filePathUrl:n,fileType:e.app,fileExtension:a,lastAccessedRelative:t}}):[]})},e.prototype._getApiUrl=function(e){var t=this._pageContext.legacyPageContext.msMruEndpointUrl,n="apps=Word,Excel,PowerPoint,Visio,OneNote,Sway,PdfViewer&show=".concat(e.numDocsToRequest||50,"&sort=Date");return"".concat(t).concat("/ocs/v2/recent/docs","?").concat(n)},e.prototype._getHttpConfig=function(e){var t=new Headers;return t.set("Authorization","Bearer ".concat(e)),t.set("Content-Type","application/json"),t.set("X-Office-Application","120"),t.set("X-Office-Platform","Web"),t.set("X-Office-Version","aec61d34-20ca-455f-ba08-4fbe7e366f81"),t.set("X-CorrelationId",r.Guid.newGuid().toString()),{headers:t}},e}();!function(e){e.GetFirstRunHTTPError403="GetFirstErrorHTTP403",e.GetFirstRunHTTPStatusError="GetFirstHTTPStatusError",e.GetFirstRunHTTPRequestError="GetFirstHTTPRequestError"}(Ke||(Ke={}));var dt,lt=Ke,ut={true:!0,false:!1},ft=function(){function e(){}return e.getIsFirstRun=function(e){var t=window.localStorage.getItem(e);return t?ut[t]:void 0},e.setIsFirstRun=function(t,n){var a=window.localStorage.getItem(t),i=String(n);if(a!==i)try{window.localStorage.setItem(t,i)}catch(t){s._TraceLogger.logError(e._logSource,t)}},e._logSource=s._LogSource.create("CortexFirstRunCacheManager"),e}();!function(e){e.KnowledgeCenter="KnowledgeCenterFirstRun",e.KnowledgeManagementTopicPage="KnowledgeManagementTopicPageFirstRun",e.TopicPageEditButton="TopicPageEditFirstRun",e.TopicPagePrivacyPermissionBanner="TopicPagePrivacyPermissionFirstRun",e.TopicPagePublishButton="TopicPagePublishFirstRun",e.TopicManualHighlight="TopicManualHighlightFirstRun",e.TopicAutoHighlight="TopicAutoHighlightFirstRun",e.AddTopicHighlight="AddTopicHighlightFirstRun"}(dt||(dt={}));var pt,mt=dt,_t=function(){function e(){}return e.topicFirstRun="CSIKM.FirstRun",e.topicFirstRunDPLogPrefix="".concat(e.topicFirstRun,".DP"),e.topicFirstRunGetAPIDPPrefix="".concat(e.topicFirstRun,"GetAPI.DP"),e.topicFirstRunSetAPIDPPrefix="".concat(e.topicFirstRun,"SetAPI.DP"),e}(),ht=((pt={})[mt.KnowledgeCenter]="sharePointKnowledgeCenterFirstRun",pt[mt.KnowledgeManagementTopicPage]="sharePointKnowledgeManagementTopicPageFirstRun",pt[mt.TopicPageEditButton]="sharePointTopicPageEditFirstRun",pt[mt.TopicPagePrivacyPermissionBanner]="sharePointTopicPagePrivacyPermissionFirstRun",pt[mt.TopicPagePublishButton]="sharePointTopicPagePublishFirstRun",pt[mt.TopicManualHighlight]="sharePointTopicManualHighlightFirstRun",pt[mt.TopicAutoHighlight]="sharePointTopicAutoHighlightFirstRun",pt[mt.AddTopicHighlight]="sharePointAddTopicHighlightFirstRun",pt),bt=function(){function e(e,t){this._polishFREDataProvider=!r._SPKillSwitch.isActivated("d85cd581-d743-463a-946c-3fa5ffd420f4"),this._spHttpClient=t,this._pageContext=e}return e._domainUrl=function(){return decodeURIComponent("".concat(window.location.protocol,"//").concat(window.location.host))},e._getErrorExtraData=function(e){var t=e.headers.get("sprequestguid")||"",n=e.headers.get("microsoftsharepointteamservices")||"";return{status:e.status,correlationId:t,spVersion:n}},e.prototype.getIsFirstRun=function(t){return Object(c.__awaiter)(this,void 0,void 0,function(){var n;return Object(c.__generator)(this,function(a){switch(a.label){case 0:return!r._SPKillSwitch.isActivated("4d4ca241-7195-4013-83ae-b1b70dbce756")&&Object(l.isRunCortexTAB)()?[2,!1]:"boolean"!=typeof(n=ft.getIsFirstRun(t))?[3,1]:(s._TraceLogger.logVerbose(e._logSource,"".concat(_t.topicFirstRun," is ").concat(n," in the local storage")),[2,n]);case 1:return[4,this._getServerIsFirstRun(t)];case 2:return[2,a.sent()]}})})},e.prototype.setIsFirstRun=function(e,t){return Object(c.__awaiter)(this,void 0,void 0,function(){return Object(c.__generator)(this,function(n){switch(n.label){case 0:return[4,this.setServerIsFirstRun(e,t)];case 1:return n.sent(),this.setLocalIsFirstRun(e,t),[2]}})})},e.prototype.setServerIsFirstRun=function(t,n){return Object(c.__awaiter)(this,void 0,void 0,function(){var a,r,o,d,l;return Object(c.__generator)(this,function(c){switch(c.label){case 0:return a=!n,r=new b._QosMonitor(_t.topicFirstRunGetAPIDPPrefix),(o={})[ht[t]]=a,[4,this._spHttpClient.post(this._bitRestUrl,i.SPHttpClient.configurations.v1,{body:JSON.stringify(o),headers:{Accept:"*/*, application/json; odata=minimalmetadata","X-HTTP-Method":"PATCH","Content-Type":"application/json; odata=minimalmetadata","X-ClientType":"PageAuthoring_SetFirstRunBit"}})];case 1:if(!(d=c.sent()).ok)throw l=new Error(d.statusText),s._TraceLogger.logError(e._logSource,l),r.writeUnexpectedFailure(_t.topicFirstRunSetAPIDPPrefix,l,e._getErrorExtraData(d)),l;return s._TraceLogger.logVerbose(e._logSource,"Request successfully for setting page authoring first run, the status: ".concat(a)),r.writeSuccess(),[2]}})})},e.prototype.setLocalIsFirstRun=function(e,t){ft.setIsFirstRun(e,t)},e.prototype._getServerIsFirstRun=function(t){return Object(c.__awaiter)(this,void 0,void 0,function(){var n,a,r,o,d,l,u;return Object(c.__generator)(this,function(c){switch(c.label){case 0:n=new b._QosMonitor(_t.topicFirstRunGetAPIDPPrefix),c.label=1;case 1:return c.trys.push([1,6,,7]),[4,this._spHttpClient.get(this._retrieveBitRestUrl(t),i.SPHttpClient.configurations.v1,{headers:{"X-ClientType":"PageAuthoring_GetFirstRunBit"}})];case 2:return(a=c.sent()).ok?[4,a.json()]:[3,4];case 3:return r=c.sent(),o=!r[ht[t]],this._polishFREDataProvider&&"boolean"!=typeof ft.getIsFirstRun(t)&&this.setLocalIsFirstRun(t,o),s._TraceLogger.logVerbose(e._logSource,"Retrieving first run bit ".concat(t," successfully, the status: ").concat(o)),n.writeSuccess(),[2,o];case 4:return d=new Error(a.statusText),l=e._getErrorExtraData(a),403===a.status?(n.writeExpectedFailure(lt.GetFirstRunHTTPError403,d,l),[2,!1]):(s._TraceLogger.logError(e._logSource,d),n.writeUnexpectedFailure(lt.GetFirstRunHTTPStatusError,d,l),this._polishFREDataProvider?[2,!1]:[2,Promise.reject(d)]);case 5:return[3,7];case 6:return u=c.sent(),s._TraceLogger.logError(e._logSource,u),n.writeUnexpectedFailure(lt.GetFirstRunHTTPRequestError,u),this._polishFREDataProvider?[2,!1]:[2,Promise.reject(u)];case 7:return[2]}})})},e.prototype._retrieveBitRestUrl=function(e){return"".concat(this._bitRestUrl,"?$select=").concat(ht[e])},Object.defineProperty(e.prototype,"_bitRestUrl",{get:function(){return"".concat(e._domainUrl(),"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='").concat(u.UriEncoding.encodeURIComponent(this._pageContext.legacyPageContext.userLoginName),"')")},enumerable:!1,configurable:!0}),e._logSource=s._LogSource.create(_t.topicFirstRunDPLogPrefix),e}(),gt=function(){function e(e){var t=this;e.whenFinished(function(){t._sphomeHttpClient=e.consume(I.serviceKey)})}return e.prototype.getViewCounts=function(e){var t=this;if(0===e.length)return Promise.resolve([]);var n=new b._QosMonitor("ExchangeViewCountsFetch");if(!this._sphomeHttpClient.isUserSupportedBySubstrate)return n.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve([]);var a=this._requestForItem(e);return this._sphomeHttpClient.post("documents/metadata",JSON.stringify(a)).then(function(e){if(e.ok)return e.json();var t=function(e){var t=e.headers.get("MS-CV"),n=x(t,e.url);return{MSCV:t,responseStatus:e.status.toString(),errorCode:C(e.status,n)}}(e),a=t.errorCode,i=new Error(a);throw n.writeUnexpectedFailure(a,i,t),i}).then(function(a){return n.writeSuccess(),e.map(function(e){return t._addMicroserviceViewCount(e,a.Items)})}).catch(function(e){return n.hasEnded||n.writeUnexpectedFailure("ExchangeViewCountsFetchSearchFallback",e),[]})},e.prototype._addMicroserviceViewCount=function(e,t){var n=this,a=t.filter(function(t){return n._guidEquals(t.Site.ItemReference.SiteId,e.siteId)&&n._guidEquals(t.Site.ItemReference.WebId,e.webId)&&n._guidEquals(t.UniqueId,e.uniqueId)})[0];return a&&void 0!==a.Views&&(e.viewCount=a.Views),e},e.prototype._guidEquals=function(e,t){var n=r.Guid.tryParse(e),a=r.Guid.tryParse(t);return!(!n||!a)&&n.equals(a)},e.prototype._requestForItem=function(e){return[].concat.apply([],e.map(function(e){return[{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"},{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"GroupReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"}]}))},e.serviceKey=r.ServiceKey.create("sp-dataproviders:ViewCountDataProvider",e),e}(),vt={HighlightedContent:1,SiteActivity:2,Sites:3,RecentDocuments:4,OfficeFeed:5,MyTopics:6,Other:999}},ui8f:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Text:1,Integer:2,Decimal:3,DateTime:4,YesNo:5,Binary:6,Double:7}},ut3N:function(e,t){e.exports=l},vlQI:function(e,t){e.exports=u},y88i:function(e,t){e.exports=f}})});