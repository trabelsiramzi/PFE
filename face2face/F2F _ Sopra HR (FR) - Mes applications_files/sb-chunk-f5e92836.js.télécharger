(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["sug-news"],{"2Lzt":function(e,t,n){"use strict";n.r(t),n.d(t,"mapDataPropsToComponentProps",(function(){return D}));var r=n("265C"),c=n("wuwP"),a=n("/krt"),i=n("NaTl"),o=n("wAGM"),s=n("pgot"),u=n("zt+T"),l=n("Dxhy"),h=n("j4bS"),p=n("VXsH"),d=n("IqD9"),f=n("uXSp"),m=n("qITa"),v=n("cDcd"),g=n("y1hr"),b=n("X+5C"),O=n("3lF4"),j=n("PS6g"),y=n("n1J5"),I=n("I1yH"),x=n("npGR"),_=Object(I.b)((function(e){void 0===e&&(e=j.b);var t=Object(x.a)(e);return Object(y.b)(Object(c.__assign)(Object(c.__assign)({},t),{newsIcon:[t.suggestionIcon,{fontSize:"24px",width:"1em",height:"1em"}],iconWrapper:[t.suggestionIconWrapper,{height:"initial !important"}]}))}));var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.render=function(){var e,t=(e=this.props.theme,Object(s.a)()&&e?_(e):n("yGLR"));return v.createElement(b.a,{theme:this.props.theme,displayText:m.a.getTextFromHtml(this.props.displayText)},v.createElement(i.a,null,v.createElement("a",{href:this.props.url,target:"_blank",className:t.suggestion,onClick:this.onClick,onContextMenu:this.onContextMenu,onMouseUp:function(e){return e.button===p.a&&!e.ctrlKey&&e.currentTarget.blur()}},v.createElement("div",{className:t.iconWrapper},v.createElement(f.a,Object(c.__assign)({},Object(d.a)({type:8,size:Object(s.a)()?g.b:g.c}),{className:t.newsIcon}))),v.createElement("div",{className:t.textWrapper},v.createElement("div",{className:t.displayText,"data-tooltip":!0},v.createElement(a.a,{markType:"mark",text:this.props.displayText,highlightCssClass:t.highlighted})),v.createElement(O.a,Object(c.__assign)({},{tidbits:[this.props.secondaryDisplayText||""],styles:t,theme:this.props.theme}))))))},t.prototype.onClick=function(e){var t,n;null===(n=(t=this.props).onClick)||void 0===n||n.call(t,e)},t.prototype.onContextMenu=function(){},t.defaultProps={onClick:function(){return null}},Object(c.__decorate)([u.a,Object(l.a)(),h.a],t.prototype,"onClick",null),Object(c.__decorate)([u.a,Object(l.a)()],t.prototype,"onContextMenu",null),t=Object(c.__decorate)([Object(o.a)("NewsSuggestion")],t)}(v.Component),w=n("svMQ"),S=n("n5ha"),C=(Object(S.declareStringWithPlaceholders)("search-dl.searchux.strings.News.publishedByWhen")),k=(Object(S.declareStringWithPlaceholders)("search-dl.searchux.strings.News.publishedByYouWhen")),P=n("OJcW"),R=n("jTRx");function E(e){if(Object(P.b)(e.lastModifiedBy)||Object(P.b)(e.lastModifiedTime))return"";var t=w.a.timeSince(e.lastModifiedTime);return function(e){if(!e||!e.lastModifiedByAccountName||!e.personalAccountName)return!1;return Object(R.a)(e.lastModifiedByAccountName,e.personalAccountName)}(e)?k({when:t}):C({user:e.lastModifiedBy,when:t})}function D(e){return{id:e.id,url:e.url,displayText:e.title,secondaryDisplayText:E(e),iconClass:"news",searchText:e.searchText,onClick:e.onClick,theme:e.theme}}t.default=Object(r.a)(T,D)},"3WoE":function(e,t,n){"use strict";function r(e){return e>=200&&e<=300||0===e}n.d(t,"a",(function(){return r}))},"7IHB":function(e,t,n){"use strict";var r=n("n/Gf"),c=n("bKfh"),a=n("vy+U");var i=function(e){return function(t,n,i){var o=Object(t);if(!Object(c.a)(t)){var s=Object(r.a)(n,3);t=Object(a.a)(t),n=function(e){return s(o[e],e,o)}}var u=e(t,n,i);return u>-1?o[s?t[u]:u]:void 0}}(n("kYkd").a);t.a=i},"K+fw":function(e,t,n){"use strict";n.r(t),n.d(t,"registration",(function(){return g}));var r=n("wuwP"),c=n("rpSO"),a=n("KmCS"),i=n("F6lS"),o=n("POWj"),s=n("a7o/"),u=n("ohlq"),l=n("xo1z"),h=n("qGDX"),p=n("i8tK"),d=n("Xopu"),f=n("q9uV"),m=/<(\/?)B>/g,v=function(){function e(e,t,n,r){this.searchBox=t,this.config=e,this.fetcher=n,this.conversation=r}return e.prototype.getId=function(){return"AutoSuggestTextSuggestionProvider"},e.prototype.createStream=function(e){var t=this;return Object(h.b)(this.fetcher,"Text",{searchText:e,entityTypes:Object(f.b)(this.config,e),scenario:Object(l.a)(Object(u.a)()),appOverride:Object(o.a)(),logicalSearchId:this.conversation&&this.conversation.getLogicalSearchId("sb"),conversationId:this.conversation&&this.conversation.conversationId}).where((function(e){return!e.Attributes||!1===e.Attributes.IsHistory})).select((function(n){var r=n.ReferenceId,c=n.Text,a=n.logProps,i=n.originalLogicalSearchId,o=n.entityType,u=n.Attributes,l=Object(p.a)()?s.g:s.b;return{logProps:a,id:r,searchText:e,url:"",displayText:l([e],c),onClick:function(e){e.preventDefault();var n=(c||"").replace(m,"");t.searchBox.submitSearch(n),t.searchBox.setSearchText(n)},originalLogicalSearchId:i,entityType:o,isHistory:Boolean(u&&u.IsHistory)}}))},e=Object(r.__decorate)([Object(f.a)({entityType:"Text"}),Object(r.__param)(0,Object(c.a)("config")),Object(r.__param)(1,Object(c.a)("searchBox")),Object(r.__param)(2,Object(c.a)("fetcher")),Object(r.__param)(3,Object(c.a)("conversation"))],e)}();t.default=v;var g=Object(a.regs)("".concat(i.a,".").concat(d.g),v)},WcHi:function(e,t,n){"use strict";n.r(t);var r=n("wAGM"),c=n("wuwP"),a=n("3twC"),i=n("cDcd"),o=n("3c19"),s=Object(a.a)("suggestion","InvokerSuggestionProviderHost")((function(e){return i.createElement(o.a,Object(c.__assign)({},e,{invokeSuggestionOnSubmit:!0}))}));t.default=Object(r.a)("InvokerSuggestionProviderHost")(s)},aU0P:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return null}},k6ph:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,c=n("wuwP"),a=n("2CHH"),i=n("3UHF"),o=!1,s=!1;function u(e,t,n){var r;p(n);var c=l();try{var i=c.getItem(e);if(!i)return null;r=JSON.parse(i)}catch(e){return!o&&Object(a.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",detail:"Failed to read from storage."}),o=!0,null}return r?r.cacheVersion!==t?(c.removeItem(e),null):r.puid&&r.puid===n?r:(c.removeItem(e),!!0&&Object(a.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",detail:"Invalid puid detected."}),null):null}var l=function(){return r||(r={getItem:function(e){return sessionStorage.getItem(h(e))},removeItem:function(e){return sessionStorage.removeItem(h(e))},setItem:function(e,t){return sessionStorage.setItem(h(e),t)}})};function h(e){return"mssearchux-cache-".concat(e)}function p(e){!e&&Object(i.a)("Puid not set.")}function d(e,t,n){var r=u(e,t,n);if(!r)return null;var c=r.cacheItems;return Object.keys(c).reduce((function(e,t){return e[t]={value:Promise.resolve({xhr:{responseText:c[t].value,status:c[t].status||0}}),expiryTime:c[t].expiryTime,cacheItemType:"storage",cacheItemResolved:!0},e}),{})}function f(e,t){return e.cacheItems[t]=null}function m(e,t,n,r,i){var o=t.cacheId,h=t.cacheVersion,d=t.cacheItemLifetime;p(n);var m=e.cacheItems,g=v(m,i,{value:r,expiryTime:Date.now()+d,cacheItemType:"memory",cacheItemResolved:!1});return r.then((function(e){return v(m,i,Object(c.__assign)(Object(c.__assign)({},g),{cacheItemResolved:!0})),function(e,t,n,r,c,i,o){p(n);var h=u(e,t,n)||{cacheCreationTime:Date.now(),cacheVersion:t,puid:n,cacheItems:{}};h.cacheItems[r]={value:c,expiryTime:i,status:o};try{l().setItem(e,JSON.stringify(h))}catch(t){!s&&Object(a.getDispatcher)().dispatch({eventType:"ERROR",name:"StorageCache",nameDetail:e,detail:"Failed to write to session storage."}),s=!0}}(o,h,n,i,e.xhr.responseText,g.expiryTime,e.xhr.status),Object(c.__assign)(Object(c.__assign)({},e),{cacheItemResolved:!1,cacheItemType:null,expiryTime:g.expiryTime})}),(function(t){throw f(e,i),t}))}var v=function(e,t,n){return e[t]=n};function g(e,t){var n=t.cacheId,r=t.cacheVersion,a=t.cacheItemLifetime,i=t.userInfoPuid;return{operation:function(t,o,s){var u=function(e,t,n,r){p(r);var c=e[t];return c&&c.puid!==r&&(c=null),c||(e[t]={puid:r,cacheItems:d(t,n,r)||{}})}(e,n,r,i);return"setItem"!==t&&function(e,t){var n=e.cacheItems[t];if(n){if(Date.now()<n.expiryTime)return n.value.then((function(e){return Object(c.__assign)(Object(c.__assign)({},e),{cacheItemType:n.cacheItemType,cacheItemResolved:n.cacheItemResolved,expiryTime:n.expiryTime})}));f(e,t)}return null}(u,o)||m(u,{cacheId:n,cacheVersion:r,cacheItemLifetime:a},i,s(),o)}}}function b(e){return"object"==typeof e&&null!==e}var O=n("DeF7"),j=n("xn41");function y(e){return function(t){var n=t.cacheId,r=t.cacheVersion,c=t.cacheItemLifetime,a=t.cacheKeyExtractor,i=t.forceRefresh;return function(t){var o=t.prefetchCacheCollection||x,s=function(e){if(!b(e))throw new Error("Key argument must be an object.");for(var t=Object.keys(e).sort(),n=t.length,r=[],c=0;c<n;c++){var a=t[c],i=e[a];void 0===i||b(i)||"function"==typeof i||r.push(a+":"+i)}return r.join(",")}(a(function(e){return Object.keys(e).reduce((function(t,n){return n.length>"prefetch".length&&0===n.indexOf("prefetch")||(t[n]=e[n]),t}),{})}(t))||{}),u=(null==i?void 0:i())?"setItem":"getItem";return o.bind({cacheConsumer:I,cacheId:n,cacheVersion:r,cacheItemLifetime:c,userInfoPuid:t.prefetchUserInfoPuid||Object(O.c)()}).operation(u,s,(function(){return e(t)}))}}}var I={packageName:"@1js/search-prefetch",packageVersion:j.a},x={bind:function(e){return g(Object(O.a)().caches,e)}}},kYkd:function(e,t,n){"use strict";var r=n("d/aS"),c=n("n/Gf"),a=n("n6ea"),i=Math.max;t.a=function(e,t,n){var o=null==e?0:e.length;if(!o)return-1;var s=null==n?0:Object(a.a)(n);return s<0&&(s=i(o+s,0)),Object(r.a)(e,Object(c.a)(t,3),s)}},nPTt:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("DHVw");function c(e){return function(t){return(t.prefetchFetch||r.a)(e(t))}}},x2tm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("wuwP");function c(e,t){var n={};if(e.getAllResponseHeaders){var r=e.getAllResponseHeaders();t.forEach((function(t){e.getResponseHeader&&-1!==r.indexOf(t)&&(n[t]=e.getResponseHeader(t)||"")}))}return n}var a=n("uKfc");function i(e,t){var n=e.monitorName,c=e.monitorType,i=void 0===c?"prefetch_request":c,s=e.additionalSuccessPropsExtractor,u=e.additionalFailurePropsExtractor;return Object(a.a)({monitorName:n,monitorType:i,successPropExtractor:function(e){var t=e.xhr,n=e.tokenAttemptCount,c=e.tokenFetchDuration,a=e.cacheItemResolved,i=e.cacheItemType;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},o(t)),n?{tokenAttemptCount:n,tokenFetchDuration:Math.round(c)}:{}),{cacheItemResolved:a,cacheItemType:i}),null==s?void 0:s(t))},failurePropExtractor:function(e){var t;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},null==u?void 0:u(e)),o(e)),{errorCode:null===(t=e.status)||void 0===t?void 0:t.toString()})}},(function(e){return void 0===e?Promise.reject("undefined options"):t(e)}))}function o(e){if(!e||!e.getAllResponseHeaders)return{};var t=c(e,["sprequestduration","spclientservicerequestduration","sprequestguid"]),n={};return n.sprequestguid=t.sprequestguid,n.sprequestduration=t.sprequestduration||t.spclientservicerequestduration||void 0,n}}}]);