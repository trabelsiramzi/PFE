(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["cpl-host"],{"/MB/":function(e,t,n){"use strict";var r=n("KmCS");t.a=Object(r.regs)("searchux.microserviceFlights",[])},"1gqI":function(e,t,n){"use strict";var r=n("awfZ"),a=n("mR4G"),c=n("n/Gf"),s=n("cdgJ");var i=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e},o=n("Ana3"),u=n("CH8J");var l=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,a=e==e,c=Object(u.a)(e),s=void 0!==t,i=null===t,o=t==t,l=Object(u.a)(t);if(!i&&!l&&!c&&e>t||c&&s&&o&&!i&&!l||r&&s&&o||!n&&o||!a)return 1;if(!r&&!c&&!l&&e<t||l&&n&&a&&!r&&!c||i&&n&&a||!s&&a||!o)return-1}return 0};var d=function(e,t,n){for(var r=-1,a=e.criteria,c=t.criteria,s=a.length,i=n.length;++r<s;){var o=l(a[r],c[r]);if(o)return r>=i?o:o*("desc"==n[r]?-1:1)}return e.index-t.index},f=n("1bmX");var g=function(e,t,n){var r=-1;t=Object(a.a)(t.length?t:[f.a],Object(o.a)(c.a));var u=Object(s.a)(e,(function(e,n,c){return{criteria:Object(a.a)(t,(function(t){return t(e)})),index:++r,value:e}}));return i(u,(function(e,t){return d(e,t,n)}))},h=n("kEbn"),p=n("X//s"),b=Object(h.a)((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Object(p.a)(e,t[0],t[1])?t=[]:n>2&&Object(p.a)(t[0],t[1],t[2])&&(t=[t[0]]),g(e,Object(r.a)(t,1),[])}));t.a=b},"4Zy8":function(e,t,n){"use strict";var r=n("/krt"),a=n("NaTl"),c=n("a7o/"),s=n("cDcd"),i=n("qk4e"),o=n("C30r"),u=n("X+5C");t.a=function(e){var t=e.theme,n=e.styles,l=e.ariaLabel,d=e.captionText,f=e.displayName,g=e.icon,h=e.userPrincipalName,p=e.children,b=Object(c.c)([f],d);return s.createElement(u.a,{theme:t},s.createElement(a.a,null,s.createElement("a",{href:"#",className:n.suggestion,"aria-label":l},s.createElement("div",{className:n.iconWrapper},s.createElement(o.a,{personaCoinSize:Object(i.getDefaultPersonaCoinSize)(),userName:f,className:n.image,userId:h,imageSrc:g})),s.createElement("div",{className:n.textWrapper},s.createElement("div",{className:n.secondaryDisplayText,"data-tooltip":!0},s.createElement(r.a,{text:b,markType:"mark",highlightCssClass:n.highlighted})),p&&s.createElement("div",{className:n.displayText},p)))))}},"7vLv":function(e,t,n){"use strict";var r=n("mR4G"),a=n("n/Gf"),c=n("cdgJ"),s=n("EJZo");t.a=function(e,t){return(Object(s.a)(e)?r.a:c.a)(e,Object(a.a)(t,3))}},"CE7+":function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",(function(){return r}))},"I+0g":function(e,t,n){"use strict";n.r(t);var r=n("3c19");t.default=r.c},JCJM:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return O}));var r=n("wuwP"),a=n("CVAo");function c(e,t){var n=s();return{iframe:n,initialize:function(){return document.body.contains(n)||(n.src=e,n.style.display="none",document.body.appendChild(n)),n},postMessage:function(r,a,c){var s=function(e,r){return i(n.contentWindow,t,e,r)}(a,c);return n.contentWindow&&n.contentWindow.postMessage(r,e),s}}}var s=function(){return document.createElement("iframe")},i=function(e,t,n,r){return new Promise((function(a,c){return o((function s(i){if(i.source===e&&i.origin===t){var o=void 0,l=!1;try{o=n(i)}catch(e){return u(s),void c(e)}try{l=r(o,i)}catch(e){return u(s),void c(e)}l&&(u(s),a(o))}}))}))},o=function(e){return addEventListener("message",e,!1)},u=function(e){return removeEventListener("message",e,!1)},l=n("LLyz");var d=n("qBZW"),f={},g={},h={};function p(e){return f[e]?f[e]:function(e,t,n){if(e){var r=document.getElementById("ms-searchux-3s-proxy"),a=function(e,t){if(e&&e.src===t&&e.ready&&e.postMessage)return{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}};return null}(r,t);f[n]=a||b(!r,t,n)}else f[n]=b(!1,t,n);return f[n]}((t=window).mssearchux&&t.mssearchux.reuseIframe||!1,e+"/search/api/v2/resources",e);var t}function b(e,t,n){var a=c(t,n),s=a.initialize(),o=i(s.contentWindow,n,(function(e){return e.data}),(function(e){return"loaded"===e}));return e&&(s.id="ms-searchux-3s-proxy",s.postMessage=a.postMessage,s.ready=o),Object(r.__assign)(Object(r.__assign)({},a),{ready:o})}var m=function(e,t){return void 0===t&&(t="https://substrate.office.com"),t=Object(d.a)(t),h[t]?v(e,t):function(e){return void 0===e&&(e="https://substrate.office.com"),e=Object(d.a)(e),void 0===g[e]&&(g[e]=p(e).ready),g[e].then((function(){return h[e]=!0,function(t){return v(t,e)}}))}(t).then((function(t){return t(e)}))};function v(e,t){var n=Object(a.a)(),r=e.action,c=e.token,s=e.prefix,i=e.cvid,o=e.additionalInfo,u=e.headers;return p(t).postMessage(JSON.stringify({requestId:n,action:r,token:c,prefix:s,cvid:i,additionalInfo:o,headers:u}),j,(function(e){return e.requestId===n}))}function O(e){var t=JSON.parse(e)[0];t.name;return Object(r.__rest)(t,["name"])}function j(e){try{return JSON.parse(e.data)}catch(e){return Object(l.a)("Failed to parse substrate API JSON response.")}}},RPdE:function(e,t,n){"use strict";var r=n("BJCC"),a=n("g5mr"),c=n("SwhW");var s=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},i=Object.prototype.hasOwnProperty;var o=function(e){if(!Object(a.a)(e))return s(e);var t=Object(c.a)(e),n=[];for(var r in e)("constructor"!=r||!t&&i.call(e,r))&&n.push(r);return n},u=n("bKfh");t.a=function(e){return Object(u.a)(e)?Object(r.a)(e,!0):o(e)}},TkU3:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"j",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return h}));var r=n("n5ha"),a=function(e,t,n){return n?"".concat(e," ").concat(t,". ").concat(i()):"".concat(e," ").concat(t,".")},c=(Object(r.declareString)("search-box-suggestion-components.extractedPeopleAnswers.emailAddressLabel")),s=(Object(r.declareString)("search-box-suggestion-components.extractedPeopleAnswers.phoneNumberLabel")),i=(Object(r.declareString)("search-box-suggestion-components.extractedPeopleAnswers.actionsAriaText")),o=(Object(r.declareStringWithPlaceholders)("search-box-suggestion-components.extractedPeopleAnswers.emailAddressSuggestion")),u=(Object(r.declareStringWithPlaceholders)("search-box-suggestion-components.extractedPeopleAnswers.emailAddressMissingSuggestion")),l=(Object(r.declareStringWithPlaceholders)("search-box-suggestion-components.extractedPeopleAnswers.phoneNumberSuggestion")),d=(Object(r.declareStringWithPlaceholders)("search-box-suggestion-components.extractedPeopleAnswers.phoneNumberMissingSuggestion")),f=(Object(r.declareStringWithPlaceholders)("search-box-suggestion-components.extractedPeopleAnswers.officeLocationSuggestion")),g=(Object(r.declareStringWithPlaceholders)("search-box-suggestion-components.extractedPeopleAnswers.managerSuggestion")),h=(Object(r.declareStringWithPlaceholders)("search-box-suggestion-components.extractedPeopleAnswers.managerMissingSuggestion"))},cdgJ:function(e,t,n){"use strict";var r=n("lRRq"),a=n("bKfh");t.a=function(e,t){var n=-1,c=Object(a.a)(e)?Array(e.length):[];return Object(r.a)(e,(function(e,r,a){c[++n]=t(e,r,a)})),c}},cxFh:function(e,t,n){"use strict";n.r(t);var r=n("wuwP"),a=n("rpSO"),c=n("KmCS"),s=n("F6lS"),i=n("NBkt"),o=n("/EUm"),u=function(){function e(e){this.conversation=e}return e.prototype.getId=function(){return"BingConsumerHistorySuggestionProvider"},e.prototype.createStream=function(e){var t=this;return Object(i.a)({searchText:e,groupName:"SearchHistory",conversationId:this.conversation?this.conversation.conversationId:void 0}).select((function(n){return{id:n.query||"",url:t.getSearchHistoryUrl(n),title:n.displayText,searchText:e,displayText:n.displayText||"",fileType:"SearchHistory",iconName:"Clock",onClick:n.sendInstrumentationData}}))},e.prototype.getSearchHistoryUrl=function(e){var t=Object(o.a)().fromPhotos?"v=photos&ft=8&":"";return"https://onedrive.live.com/?".concat(t,"qt=search&q=").concat(e.query)},e=Object(r.__decorate)([Object(r.__param)(0,Object(a.a)("conversation"))],e)}();t.default=u,Object(c.regs)("".concat(s.a,".bingConsumerHistory"),u)},hlAE:function(e,t,n){"use strict";n.r(t),n.d(t,"registration",(function(){return x}));var r=n("wuwP"),a=n("KUM7"),c=n("UlRC"),s=n("rpSO"),i=n("KmCS"),o=n("F6lS"),u=n("FzQG"),l=n("2qGI"),d=n("2VtW"),f=n("POWj"),g=n("TBqy"),h=n("a7o/"),p=n("ohlq"),b=n("xo1z"),m=function(e){return"hierarchy.manager.hops:1"===e},v=n("7IHB"),O=n("q9uV");function j(e){return{displayName:e.DisplayName,userPrincipalName:e.UserPrincipalName||e.EmailAddresses[e.EmailAddresses.length-1],icon:Object(g.b)(g.a.m,e.EmailAddresses[0],!1)}}var y=function(){function e(e,t,n,r){this.searchBox=e,this.config=t,this.fetcher=n,this.conversation=r}return e.prototype.getId=function(){return"AutoSuggestExtractedPeopleAnswerSuggestionProvider"},e.prototype.fetchSuggestionGroups=function(e){return Object(l.a)({searchText:e,entityTypes:Object(O.b)(this.config,e),scenario:Object(b.a)(Object(p.a)()),appOverride:Object(f.a)(),logicalSearchId:this.conversation&&this.conversation.getLogicalSearchId("sb"),conversationId:this.conversation&&this.conversation.conversationId},Object(u.a)(this.fetcher)).selectMany((function(e){return c.Observable.fromArray(e.value.body.Groups||[]).where((function(e){return"People"===e.Type})).select((function(t){var n;return Object(r.__assign)(Object(r.__assign)({},t),{logProps:{traceId:Object(d.a)(e.value.body),entityId:null===(n=t.Suggestions[0])||void 0===n?void 0:n.ReferenceId},originalLogicalSearchId:e.value.logicalSearchId})}))}))},e.prototype.isValidExtractedPeopleAnswerSuggestionGroup=function(e){if(!e.Intent)return!1;if(!e.Suggestions||e.Suggestions.length<1)return!1;if("Organization"===e.Intent){if(e.Suggestions.length<2)return!1;for(var t=!1,n=1;n<e.Suggestions.length;++n){if(t=e.Suggestions[n].PropertyHits.some(m))break}if(!t)return!1}return!0},e.prototype.createStream=function(e){return this.fetchSuggestionGroups(e).where(this.isValidExtractedPeopleAnswerSuggestionGroup).select((function(t){var n=t.Suggestions[0],c={id:"ExtractedPeopleAnswerSuggestion",searchText:e,url:"",displayText:""};switch(t.Intent){case"PhoneNumber":return Object(r.__assign)(Object(r.__assign)({},c),function(e){var t,n=Object(v.a)(e.Phones,(function(e){return"Mobile"===e.Type})),a=null!=n?n:null===(t=e.Phones)||void 0===t?void 0:t[0];return Object(r.__assign)(Object(r.__assign)({},j(e)),{kind:"PhoneNumber",phone:a})}(n));case"EmailAddress":return Object(r.__assign)(Object(r.__assign)({},c),function(e){var t=j(e);return Object(r.__assign)(Object(r.__assign)({},t),{kind:"EmailAddress",emailAddress:t.userPrincipalName})}(n));case"OfficeLocation":return Object(r.__assign)(Object(r.__assign)({},c),function(e){return Object(r.__assign)(Object(r.__assign)({},j(e)),{kind:"OfficeLocation",officeLocation:e.OfficeLocation})}(n));case"Organization":return Object(r.__assign)(Object(r.__assign)({},c),function(e,t,n){for(var a=function(e){return{id:e.Id,searchText:t,url:"",displayText:Object(h.c)([t],e.DisplayName),secondaryDisplayText:Object(h.c)([t],e.JobTitle||""),userUpn:e.UserPrincipalName||e.EmailAddresses[e.EmailAddresses.length-1],displayName:e.DisplayName,icon:Object(g.b)(g.a.m,e.EmailAddresses[0],!1)}},c=1;c<n.length;++c){var s=n[c];if(s.PropertyHits.indexOf("hierarchy.manager.hops:1")>-1)return Object(r.__assign)(Object(r.__assign)({},j(e)),{kind:"Manager",relatedPerson:a(s)})}}(n,e,t.Suggestions));default:return Object(a.b)(t.Intent,void 0)}}))},e=Object(r.__decorate)([Object(O.a)({entityType:"People"}),Object(r.__param)(0,Object(s.a)("searchBox")),Object(r.__param)(1,Object(s.a)("config")),Object(r.__param)(2,Object(s.a)("fetcher")),Object(r.__param)(3,Object(s.a)("conversation"))],e)}(),x=(t.default=y,Object(i.regs)("".concat(o.a,".autosuggestextractedpeopleanswer"),y))},j4bS:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("wuwP"),a=n("A9i1"),c=n("ghw8");function s(e,t,n,r){if(!e)return e;var a=e;return a.__catchAll__||(a.__catchAll__=function(){try{return e.apply(this,arguments)}catch(e){var a=Object(c.a)([this&&this.context&&this.context.logContext&&this.context.logContext.context||null,this&&this.constructor&&this.constructor.displayName||null,n]).join("."),s=r||e.message;return a?e.message="".concat(a,": ").concat(s):r&&(e.message=r),t(e)}}),a.__catchAll__}var i=function(e){throw e};function o(e,t,n){var c=e.constructor;return c.contextTypes&&!c.contextTypes.logContext?c.contextTypes=Object(r.__assign)(Object(r.__assign)({},c.contextTypes),{logContext:a.object}):c.contextTypes||(c.contextTypes={logContext:a.object}),{value:s(n.value,i,t,"Callback had an error.")}}},mR4G:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length,a=Array(r);++n<r;)a[n]=t(e[n],n,e);return a}},qBZW:function(e,t,n){"use strict";function r(e){return function(e){return!!e&&(0===e.toLocaleLowerCase().indexOf("http://")||0===e.toLocaleLowerCase().indexOf("https://"))}(e)?e:"https://".concat(e)}n.d(t,"a",(function(){return r}))}}]);