(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["cpl-host~cpl-invoker~cpl-no-submit~stream"],{"3c19":function(e,t,r){"use strict";r.d(t,"a",(function(){return Se})),r.d(t,"b",(function(){return ye}));var n=r("wuwP"),o=r("NeXG"),i=r("UlRC"),s=r("ldpi"),a=Object(s.a)((function(e){var t=(null==e?void 0:e.document)||document,r=t.createElement("div");return r.setAttribute("aria-live","polite"),r.style.position="absolute",r.style.top="-999em",r.style.height="1px",r.style.width="1px",r.style.overflow="hidden",t.body.appendChild(r),r})),c=r("grEz"),u=r("3twC");var p=r("W4Bk"),l=r("wAGM"),d=r("Ak5F"),g=r("D7WJ"),h=r("ljXs"),f=r("NQus"),m=r("w9Rb"),v=r("4zpW"),b=r("cDcd"),S=r("zH9T"),y=r("pgot"),O=r("QlCf"),_=r("PS6g"),j=r("GIWw"),E=r("n1J5"),x=r("I1yH"),I=Object(x.b)((function(e){void 0===e&&(e=_.b);var t=e.themeStyles,r=e.componentStyles.PanelHeader,o=_.a.SuggestionPanel;return Object(E.b)({groups:{paddingBottom:8},group:{display:"block",listStyleType:"none",margin:0,padding:"".concat(o.paddingTop," 0 ").concat(o.paddingBottom," 0"),background:t.palette.white,color:t.palette.neutralPrimary,fontSize:t.fonts.medium.fontSize,fontWeight:t.fonts.medium.fontWeight,borderBottomStyle:"solid",borderBottomWidth:o.borderBottomWidth,borderBottomColor:t.palette.neutralLight},metaInfo:Object(O.a)().offScreen,offScreen:Object(O.a)().offScreen,selectedItem:{selectors:{'[data-nav="true"]':{background:t.palette.neutralLighter}}},groupTitle:Object(n.__assign)(Object(n.__assign)({color:t.palette.neutralSecondary,fontFamily:j.a,margin:"0 0 ".concat(o.marginBottom," 0"),padding:"".concat(r.paddingTop," 0 ").concat(r.paddingBottom," ").concat(r.paddingLeft),display:"table-cell",verticalAlign:"middle"},r),{selectors:{"&:empty":{position:"absolute",left:"-100vw",top:"-100vh"}}})})}));var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.groups,i=t.fetchStartTime,s=t.activatedTime,a=t.inputTime,c=t.searchText,u=t.searchSuggestionFactory,l=t.conversation,d=t.instrumenter,m=t.theme,v=t.searchBox,O=function(e){return Object(y.a)()&&e?I(e):r("7p0W")}(m),_=function(e){return e.filter((function(e){return e.suggestions&&e.suggestions.length}))}(o),j=this.impression=function(e,t,r,n,o,i,s){var a=n?n.getLogicalSearchId("sb"):Object(p.a)();return Object(S.a)(e,Object(f.a)(t),a,n&&n.conversationId||"",r.reduce((function(e,t){var r=t.suggestions;return e.concat(r.map((function(t,r){var n=t.providerId,o=t.emitTime,i=t.groupId,s=t.logProps,c=t.originalLogicalSearchId,u=t.entityType;return{pos:e.length+r,emitTime:o,groupId:i,providerId:n,delayTime:Object(g.a)()-o,fromCache:void 0!==c&&c!==a,entityId:s&&s.entityId||"",traceId:s&&s.traceId||"",originalLogicalSearchId:c||"",entityType:u}})))}),[]),o,i,s)}(i,c,_,l,d,s,a),E=0;return 0===_.length?null:b.createElement("div",{className:O.groups},_.map((function(t){var r=t.ariaLabel||t.heading,o="history"===t.id&&1===_.length,i=r?"gh_".concat(t.id,"_").concat(Object(h.a)()):void 0,s=o?"div":"li",a=t.suggestions.map((function(r,o){return b.createElement(s,{role:"presentation",className:e.props.indicateFirstItemAsSelected&&0===E?O.selectedItem:void 0,key:"".concat(r.id,"(").concat(r.searchText,")"),"data-suggestion-position":E},u(t.id,Object(n.__assign)(Object(n.__assign)({searchBox:v},r),{logProps:Object(n.__assign)(Object(n.__assign)({},r.logProps),{position:String(E),groupPosition:String(o)}),theme:m,onClick:k(e,j,E++,r.onClick,r.logProps||{})})))}));return b.createElement(P,{key:t.id,groupId:t.id},o?a:b.createElement("ul",{role:"group",className:O.group,id:t.id,"aria-labelledby":i},r&&b.createElement("li",{role:"presentation","aria-label":t.ariaLabel,id:i,className:O.groupTitle},t.heading),a))})))},t.prototype.componentDidMount=function(){this.dispatchImpressionAfterDelay(this.impression)},t.prototype.componentDidUpdate=function(){this.dispatchImpressionAfterDelay(this.impression)},t.prototype.componentWillUnmount=function(){this.dispatchImpressionAfterDelay(this.impression,0)},t.prototype.dispatchImpressionAfterDelay=function(e,t){void 0===t&&(t=1e3),e&&(clearTimeout(this.cancellationToken),t?this.cancellationToken=window.setTimeout((function(){return e.dispatch()}),t):e.dispatch())},t=Object(n.__decorate)([Object(l.a)("GroupedSearchSuggestions")],t)}(b.Component),T=w;function k(e,t,r,o,i){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=t.items[r],u=c.groupId,p=c.providerId,l=c.entityType;return e.dispatchImpressionAfterDelay(t,0),Object(m.a)(C(e.context),Object(n.__assign)({impressionId:t.logicalSearchId,conversationId:t.conversationId,pos:r,groupId:u,providerId:p,entityType:l},i)),"function"==typeof o&&o.apply(void 0,Object(n.__spreadArray)([],Object(n.__read)(s),!1))}}var D=w,C=Object(v.a)(D,"onImpressionItemClicked"),R={},P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasError:!1},t}return Object(n.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(){R[this.props.groupId]||(R[this.props.groupId]=!0,Object(d.a)({eventType:"ERROR",name:"SUGGESTION_GROUP_RENDER_ERROR",detail:'Suggestion group with id "'.concat(this.props.groupId,'" failed to render.')}))},t.prototype.render=function(){return this.state.hasError?null:this.props.children},t}(b.Component),A=r("ghw8"),B=r("SQh4"),N=r("zFwc"),W=r("mkze"),G=r("nbvZ"),L=function(){function e(e,t,r){if(this.config=e,this.groupConfig=t,!t.providers)throw new Error("Search box suggestion type configuration must contain a list of providers.");if(this.providerInstances=t.providers.map((function(o){return Object(W.a)(o,Object(n.__assign)(Object(n.__assign)({},r),{config:e,groupConfig:t,rxjs:i}))})),!this.providerInstances.every((function(e){return J(e.getId)&&J(e.createStream)})))throw new Error("Suggestion providers must implement methods getId and createStream.")}return e.prototype.createStream=function(e){for(var t=[],r=[],o=this.providerInstances,s=this.groupConfig.id,a=0;a<o.length;a++)!function(o){try{var a=o.getId();r.push(o.createStream(e).select((function(e){return Object(n.__assign)(Object(n.__assign)({},e),{emitTime:Object(g.a)(),groupId:s,providerId:a})})).catchException((function(e){var r;return G.a.DEBUG_SB_PROVIDER&&(null===(r=null===console||void 0===console?void 0:console.error)||void 0===r||r.call(console,"In provider:",a,e)),t.push(F(a,e)),i.Observable.empty()})))}catch(e){t.push(F(o.getId(),e))}}(o[a]);return r.push(i.Observable.defer((function(){return t.length?i.Observable.throwException(U(s,t)):i.Observable.empty()}))),Object.freeze(r)},e}(),F=function(e,t){var r=new Error('Error in suggestion provider "'.concat(e,'". See inner error for details.'));return r.providerId=e,r.innerError=t,r},U=function(e,t){var r=new Error('Error in suggestion provider group "'.concat(e,'". See inner error for details.'));return r.providerGroupId=e,r.innerErrors=t,r};function J(e){return"function"==typeof e}var z=function(e){return e.id},H=r("rP0q");i.Observable.prototype.debounce=function(e,t,r){void 0===t&&(t=!1);i.helpers.isScheduler(r)||(r=i.Scheduler.timeout);var n=this;return new i.AnonymousObservable((function(o){var s,a=new i.SerialDisposable,c=!1,u=0,p=n.subscribe((function(t){c=!0,s=t;var n=++u,p=new i.SingleAssignmentDisposable;a.setDisposable(p),p.setDisposable(r.scheduleWithRelative(e,(function(){c&&u===n&&o.onNext(s),c=!1})))}),(function(e){a.dispose(),t&&c&&o.onNext(s),o.onError(e),c=!1,u++}),(function(){a.dispose(),c&&o.onNext(s),o.onCompleted(),c=!1,u++}));return new i.CompositeDisposable(p,a)}))};r("PWby");var M=r("Gelb"),Q=r("c6IG"),V=r("iD1a"),Z=r("jTRx"),q=r("S/Ck"),X=r("81PS"),$=r("Az8T"),K=r("Wr3k"),Y=r("EJZo");function ee(e){return"innerErrors"in e&&Object(Y.a)(e.innerErrors)?(t=e.innerErrors,{message:(r=t.reduce((function(e,t){var r=e.message,o=e.groups,i=e.providers,s=t.providerGroupId,a=t.innerErrors;return{message:r,groups:Object(n.__spreadArray)(Object(n.__spreadArray)([],Object(n.__read)(o),!1),[s],!1),providers:Object(n.__spreadArray)(Object(n.__spreadArray)([],Object(n.__read)(i),!1),Object(n.__read)(a.map((function(e){return e.providerId}))),!1)}}),{message:"Expected suggestion stream error.",groups:[],providers:[]})).message,groups:JSON.stringify(r.groups),providers:JSON.stringify(r.providers)}):{message:"Unexpected suggestion stream error."};var t,r}var te=r("deeS"),re=r("n5ha"),ne=r("cQB/"),oe=r("6e3C"),ie=r("jTHf"),se=["->","–>","-","–"],ae=/^\d+$/;function ce(e){var t=Object(ne.a)(se,(function(t){return e.indexOf(t)>=0})),r=t?e.split(t).map((function(e){return e.trim()})):[e.trim()];if(1===r.length){var n=r[0];if(Object(oe.d)(n,"*")){var o=n.substring("*".length);return o.match(ae)?function(e){return Object(oe.a)(e.toString(),o)}:null}return n.match(ae)?function(e){return e.toString()===n}:null}if(2===r.length){if(!r[0].match(ae))return null;var i=parseInt(r[0],10);if(isNaN(i))return null;if("INF"===r[1])return function(e){return e>=i};if(!r[1].match(ae))return null;var s=parseInt(r[1],10);return isNaN(s)?null:function(e){return e>=i&&e<s}}return null}function ue(e,t){var r,o,i,s,a=function(t){throw new Error('pluralized string "'.concat(e,'" ').concat(t))};try{for(var c=Object(n.__values)(e.split("||")),u=c.next();!u.done;u=c.next()){var p=u.value,l=p.split("::");2!==l.length&&a("is missing separator ".concat("::",' in clause "').concat(p,'"'));var d=Object(n.__read)(l,2),g=d[0],h=d[1];try{for(var f=(i=void 0,Object(n.__values)(g.split(","))),m=f.next();!m.done;m=f.next()){var v=m.value,b=ce(v);if(null===b)a('contains invalid range "'.concat(v,'"'));else if(!t(h,b))return}}catch(e){i={error:e}}finally{try{m&&!m.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}}function pe(e,t){if(void 0===t)return e;try{return function(e,t){if(t<0||t!==1/0&&!Object(ie.a)(t))throw new Error("count must be a positive integer or Infinity");var r="";return ue(e,(function(e,n){return!n(t)||(r=e,!1)})),r}(e,t)}catch(t){return e}}var le=(Object(re.declareStringWithPlaceholders)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.suggestionsAvailable")),de=(Object(re.declareStringWithPlaceholders)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.suggestionsAvailableForQueryIntervals")),ge=(Object(re.declareStringWithPlaceholders)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.numSuggestionsInGroup")),he=(Object(re.declareString)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.unnamedGroup")),fe=Object(s.a)(d.a);function me(e,t,r){try{var n=0,o=null==r?void 0:r.map((function(e){var t=e.suggestions.length;return n+=t,ge({count:t.toString(),group:e.title||e.heading||e.ariaLabel||he()})})).join(", "),i=t?function(e){var t=e.suggestionCount,r=e.searchText;return pe(de({suggestionCount:t,searchText:r}),parseInt(t,0))}({suggestionCount:n.toString(),searchText:t}):(s={suggestionCount:n.toString()},a=s.suggestionCount,pe(le({suggestionCount:a}),parseInt(a,0)));e.innerText="",e.innerText=i+o}catch(s){fe({eventType:"ERROR",name:"SUGGESTIONS_ARIALIVE_ERROR",detail:"Suggestions failed to create aria live region"})}var s,a}var ve=Object(s.a)(d.a),be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasError:!1},t}return Object(n.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(){ve({eventType:"ERROR",name:"SUGGESTIONS_RENDER_ERROR",detail:"Suggestions failed to render."})},t.prototype.render=function(){return this.state.hasError?null:b.createElement(b.Suspense,{fallback:null},this.props.children)},t}(b.Component),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resources=new i.CompositeDisposable,t.debouncedFetchSuggestions=Object(M.a)(t.fetchSuggestions,t.props.debounceStream||0),t}return Object(n.__extends)(t,e),t.prototype.registerRefetchListener=function(){var e=this,t=this.props.updateSearchBoxListener;this.searchBoxListenerToken=null==t?void 0:t.register((function(){return e.fetchSuggestionsBasedOnDebounceStream(e.props)}))},t.prototype.UNSAFE_componentWillMount=function(){this.fetchSuggestionsBasedOnDebounceStream(this.props),a(this.props.hostWindow||window),this.registerRefetchListener()},t.prototype.fetchSuggestions=function(e){var t=this;if(e.configuration){var r=this.props.instrumenter,n=Object(te.a)(e);n&&n.createLogicalSearchId("sb");var o=e&&e.searchText||"",s=Object(f.a)(o);r&&r.setProps({searchTextCharacteristics:s});var c=this,u=Object(g.a)(),p=!1;this.setState({error:null,allComplete:!1}),this.resources.dispose(),this.resources=new i.CompositeDisposable;var l,d=this.getDependencies(e.configuration),h=e.configuration,m=ye(h,Object(Q.a)(d,d.map((function(t){return e[t]}))),e.searchText||"","suggestion_stream","suggestion_provider_host");e.debounceStream&&(m=m.debounce(0,!0)),this.resources.add(m.subscribe((function(r){return p=!0,l=r,t.setState({data:{configuration:h,groups:r,fetchStartTime:u,activatedTime:e.activatedTime,inputTime:e.inputTime}})}),(function(r){t.setState({error:r}),v();try{e.onError&&e.onError(r)}catch(e){}}),v))}function v(){p||c.setState({data:{configuration:h,groups:[],fetchStartTime:u,activatedTime:e.activatedTime,inputTime:e.inputTime}}),me(a(e.hostWindow||window),o,l)}},t.prototype.getDependencies=function(e){var t,r,n,o=e.groups;return t=Object(V.a)(o.map((function(e){return e.providers}))),r=[],n={},t.forEach((function(e){(e.__parameters||[]).forEach((function(e){var t=e.name;n[t]||(n[t]=!0,r.push(t))}))})),r},t.prototype.render=function(){var e=this,t=this.props.errorComponent;if(!this.state)return null;var r=this.state.data,n=(this.props.hostWindow||window).document;return b.createElement(c.a.Consumer,null,(function(o){return o.clearActive(),o.clearHovered(),b.createElement(be,null,b.createElement(b.Fragment,null,e.props.invokeSuggestionOnSubmit&&!e.props.noSubmit?b.createElement("button",{hidden:!0,onClick:function(t){var r;t.preventDefault();var o=n.querySelector("#"+e.props.popupId),i=o&&o.querySelector("[data-suggestion-position='0'] [data-nav='true']");null===(r=null==i?void 0:i.click)||void 0===r||r.call(i)}}):null,e.props.noSubmit&&b.createElement("button",{hidden:!0,onClick:function(e){return e.preventDefault(),e.stopPropagation()}}),r&&b.createElement(T,{fetchStartTime:r.fetchStartTime,activatedTime:r.activatedTime,inputTime:r.inputTime,groups:r.groups.slice(0),searchText:e.props.searchText||"",conversation:Object(te.a)(e.props),instrumenter:e.props.instrumenter,searchSuggestionFactory:Oe(r.configuration).suggestionFactory,theme:e.props.theme?e.props.theme:_.b,indicateFirstItemAsSelected:e.props.invokeSuggestionOnSubmit}),e.state.error&&t?b.createElement(t,{error:e.state.error}):null))}))},t.prototype.fetchSuggestionsBasedOnDebounceStream=function(e){this.props.debounceStream?this.debouncedFetchSuggestions(e):this.fetchSuggestions(e)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.relevantPropsChanged(e)&&this.fetchSuggestionsBasedOnDebounceStream(e)},t.prototype.relevantPropsChanged=function(e){var t,r=this;return e.searchText!==this.props.searchText||e.configuration!==this.props.configuration||(t=e.configuration?r.getDependencies(e.configuration):[],!Object(Z.a)(Object(q.a)(r.props,t),Object(q.a)(e,t)))},t.prototype.componentWillUnmount=function(){var e;this.resources.dispose(),a(this.props.hostWindow||window).innerText="",this.searchBoxListenerToken&&(null===(e=this.props.updateSearchBoxListener)||void 0===e||e.unregister(this.searchBoxListenerToken),this.searchBoxListenerToken=void 0)},t.defaultProps={onError:X.a,errorComponent:function(){return b.createElement("div",null)}},t=Object(n.__decorate)([H.a],t)}(b.Component);t.c=Object(u.a)("suggestion","BasicSuggestionProviderHost")((function(e){return b.createElement(Se,Object(n.__assign)({},e))}));function ye(e,t,r,o,s){return function(e,t,r){if(!e)throw new Error("Search box configuration must be specified.");var n=e.streamPolicy,o=e.groups,s=o.map((function(n){return new L(e,n,t).createStream(r)})),a=s.map((function(e){return e.slice(0,e.length-1)})),c=i.Observable.fromArray(Object(A.a)(s.map((function(e){return Object(B.a)(e)})))).selectMany((function(e){return e.catchException((function(e){return i.Observable.returnValue(e)}))})).toArray().where((function(e){return!!e.length})).select((function(e){throw Object(N.a)(new Error("Suggestion stream error. See inner errors for details."),{innerErrors:e})}));return(n(o,z,a,i,{searchText:r})||i.Observable.empty()).concat(c)}(e,t,r).select((function(t){return t.map((function(t){return Object(n.__assign)(Object(n.__assign)({},t),Oe(e).stringsIndex[t.id])}))})).monitor({eventName:o,nameDetail:s,isHot:!1},void 0,ee)}var Oe=Object(o.a)((function(e){var t=e.groups,r=Object($.a)(Object(K.a)(t.map((function(e){return{id:e.id,component:e.component}})),_e),(function(e){return e[0]}));return{stringsIndex:Object($.a)(Object(K.a)(t.map((function(e){return{id:e.id,heading:e.heading,ariaLabel:e.ariaLabel}})),(function(e){return e.id})),(function(e){return e[0]})),suggestionFactory:function(e,t){var o=r[e].component;return b.createElement(o,Object(n.__assign)({},t))}}}));function _e(e){return e.id}},"7p0W":function(e,t,r){var n=r("VufS"),o=r("vbE8");"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)o.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},VufS:function(e,t,r){(t=e.exports=r("juMS")(!1)).push([e.i,'._2iF_EPp8{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}._1Dlewp4k{display:block;list-style-type:none;font-size:14px;font-weight:400;color:"[theme:neutralPrimary, default: #333333]"}html[dir] ._1Dlewp4k{margin:0;padding:3px 0 12px;border-bottom:1px solid "[theme:neutrallight, default: #eaeaea]";background:"[theme:white, default: #ffffff]"}html[dir] .dZduCJin [data-nav=true]{background:"[theme:neutralLighter, default: #f4f4f4]"}.JpvkDkU4{line-height:1.1em}html[dir] .JpvkDkU4{padding:1.1em 18px .4em;margin:0 0 .2em}.JpvkDkU4:empty{position:absolute;top:-100vh}html[dir=ltr] .JpvkDkU4:empty{left:-100vw}html[dir=rtl] .JpvkDkU4:empty{right:-100vw}',""]),t.locals={metaInfo:"_2iF_EPp8",group:"_1Dlewp4k",selectedItem:"dZduCJin",groupTitle:"JpvkDkU4"}}}]);