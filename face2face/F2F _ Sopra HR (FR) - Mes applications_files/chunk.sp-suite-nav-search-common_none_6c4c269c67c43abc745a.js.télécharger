(window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0=window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0||[]).push([[1],{gbBp:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return j});var a=n("Pk8u"),i=n("UWqr");function r(e,t,n){return void 0===n&&(n=!1),function(a,r,o,s,c){void 0===o&&(o=!1),void 0===s&&(s=""),void 0===c&&(c=!1);var d,l,u=0,f=function(){return c&&u>0&&u<=2};return a.withPeriodicRefresh(e,(d=function(){return(o?a.fetchSharePointDigestV2({endpoint:r,overrideDigest:s,tokenProvider:function(){return Promise.resolve("")}}):a.fetchSharePointDigest({endpoint:r,forceDigestRefresh:f})).then(function(e){return JSON.parse(e.xhr.responseText).d.GetContextWebInformation.FormDigestValue}).then(function(e){return a.fetchAcquireToken({portalUrl:r,resourceUrl:t,digest:e,useSTI:n})}).then(function(e){var t=JSON.parse(e.xhr.responseText),n=t.access_token,a=t.expires_on;return u=0,i._SPKillSwitch.isActivated("add015d8-3cd4-4362-b552-524729334435")?n:a?{token:n,expiry:a}:n}).catch(function(e){throw e&&e.status&&403===e.status&&c&&u++,new Error("Failed to retrieve a valid token")})},l=void 0,function(e){return!e.attempt&&l?l:l=d()}))}}var o,s=Object(a.once)(r("bingSerpTokenProvider","https://www.bing.com")),c=Object(a.once)(r("lokiAadSearchBoxTokenProvider","https://loki.delve.office.com")),d=Object(a.once)(r("stiSubstrateTokenProvider","https://substrate.office.com",!0)),l=Object(a.once)(r("aadSubstrateTokenProvider","https://outlook.office365.com/search",!1)),u=Object(a.once)(r("aadGallatinSubstrateTokenProvider","https://partner.outlook.cn/search",!1)),f=function(e,t,n,a,i,r,o){return void 0===a&&(a=!1),void 0===o&&(o="Prod"),t?function(e){return"Gallatin"===e?u:l}(o)(e,n,a,i,r):d(e,n,a,i,r)},p=n("K9kD");function m(e){return function(){return i._SPFlight.isEnabled(e)}}var _=m(1407),h=m(1369),b=m(1323),g=m(1324),v=(m(1356),m(1574)),y=m(1575),S=(m(1102),m(1260),m(218),m(1411),m(1571)),D=m(1572),I=(m(1095),m(1240),m(1810),m(1291),m(1565),m(1563),m(1579)),x=m(1580),C=(m(1598),m(1313)),O=m(1321),w=(m(1421),m(1422),m(1166),m(1682)),E=m(1720),A=(m(1721),m(1853)),L=m(1888);m(1823),m(60095);var k,M,P,T,U=n("zLqp");Object(a.once)(function(e){T=e,k=new U.Dispatcher,M=[],k.register(function(e){return M.push(e)}),T.setDispatcher(k),P=!0});var F=!1;function H(e,t,n,a,i,r,s,c){return void 0===r&&(r=.5),void 0===s&&(s=!0),void 0===c&&(c=!1),function(d){var l,u=o;if(!u)throw new Error("checking experiment ".concat(e," before calling initSearchExperiments"));if(F||(p.ABExperiment.Init(u),F=!0),!s&&(l=u)&&(l.isAnonymousGuestUser||l.isExternalGuestUser))return!1;if(t())return!0;if(n()){var f=new p.ABExperiment({name:a,startDate:i,segmentPopulation:r}).IsExperimentOn();return c&&function(){if(!P||!T)throw new Error("Dispatcher is not yet initialized.");return T.getDispatcher()}().dispatch({eventType:"USAGE",nameDetail:"searchux.".concat(a),name:"experiments",properties:{inTreatment:f}}),d&&d.sets&&d.sets("searchux.".concat(e,"Experiment"),f),f}return!1}}var R,N,B=H("aadTokenForSubstrate",I,x,"AadTokenForSubstrateExperiment","06/01/2019");function j(e,t,n,a,i){var r;r=t.legacyPageContext,o=r;var d=function(e,t,n){return R||(R={BingForBusiness:s(n,t),Loki:c(n,t),Substrate:f(n,B(),t),SharePointSites:function(a){return!a.attempt&&N||(N=function(e,t){return t.fetch({url:"".concat(e,"/_api/sphomeservice/context?$expand=Token,Payload"),method:"GET",headers:{Accept:"application/json","SPHome-ClientType":"Web"}}).then(function(e){var t=e.responseText;return JSON.parse(t)})}(t,n).then(function(t){var n=t.Payload,a=t.Token,i=a.access_token,r=a.resource;if(!e||!e.Search)throw new Error("No search shim available.");return e.Search.SetSharePointHomeApiRequestInfo({url:"".concat(r,"/api/v1"),context:JSON.parse(n)}),i}))}})}(e,t.web.absoluteUrl,i);return n.markHeaderBoot(),{tokenProviders:d}}H("digestV2",C,O,"DigestV2Experiment","06/25/2019"),H("enableQueryRules",S,D,"EnableQueryRulesExperiment","08/05/2019"),H("answerBlock",_,h,"showAnswerBlock","03/26/2019"),H("useSubstrateSearch",b,g,"SubstrateSearchExperiment","15/05/2019",.5,!1),H("use3SAnswers",v,y,"Use3SAnswersExperiment","05/01/2019"),H("use3SFileSuggestions",function(){return!1},function(){return!1},"3SFileSuggestionsExperiment","10/01/2019"),H("use3SPeopleSuggestions",function(){return!1},function(){return!1},"3SPeopleSuggestionsExperiment","16/01/2019"),H("use3SSiteSuggestions",function(){return!1},function(){return!1},"3SSiteSuggestionsExperiment","10/01/2019"),H("use3SEarlyWarmup",w,E,"3SEarlyWarmupExperiment","11/10/2019"),H("personalizedSpeller",A,L,"personalizedSpellerExperiment","01/03/2020",.5,!0,!0)},mqVB:function(e,t,n){"use strict";t.__esModule=!0;var a=n("yeHm"),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return e.prototype.register=function(e){var t="ID_"+this._lastID++;return this._callbacks[t]=e,t},e.prototype.unregister=function(e){this._callbacks[e]||a(!1),delete this._callbacks[e]},e.prototype.waitFor=function(e){this._isDispatching||a(!1);for(var t=0;t<e.length;t++){var n=e[t];this._isPending[n]?this._isHandled[n]||a(!1):(this._callbacks[n]||a(!1),this._invokeCallback(n))}},e.prototype.dispatch=function(e){this._isDispatching&&a(!1),this._startDispatching(e);try{for(var t in this._callbacks)this._isPending[t]||this._invokeCallback(t)}finally{this._stopDispatching()}},e.prototype.isDispatching=function(){return this._isDispatching},e.prototype._invokeCallback=function(e){this._isPending[e]=!0,this._callbacks[e](this._pendingPayload),this._isHandled[e]=!0},e.prototype._startDispatching=function(e){for(var t in this._callbacks)this._isPending[t]=!1,this._isHandled[t]=!1;this._pendingPayload=e,this._isDispatching=!0},e.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},e}();e.exports=i},yeHm:function(e,t,n){"use strict";e.exports=function(e,t,n,a,i,r,o,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[n,a,i,r,o,s],l=0;c=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return d[l++]}))}throw c.framesToPop=1,c}}},zLqp:function(e,t,n){e.exports.Dispatcher=n("mqVB")}}]);