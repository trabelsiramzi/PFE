(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-spnews"],{irXh:function(e,t,r){"use strict";r.r(t);var n=r("wuwP"),s=r("UlRC"),a=r("rpSO"),i=r("KmCS"),o=r("XgOi"),c=(r("Jvpx"),r("RkML")),u=r("4icL");var l=r("YL+5");var d=r("7IHB");var p,h=function(){var e=new Date;e.setFullYear(e.getFullYear()-1);var t=new Date;t.setMonth(t.getMonth()-3);var r=new Date;r.setMonth(r.getMonth()-1);var n=new Date;n.setDate(n.getDate()-7);var s=new Date;return s.setDate(s.getDate()-1),[e,t,r,n,s].map((function(e){return e.toISOString()}))}();var m=r("kKJH"),f=r("iI/e"),b=r("oDh2"),g=r("Az8T"),S=r("6cUF"),v=r("nQaj"),O=r("S/Ck"),x=r("CVAo"),y=r("D7WJ"),j={},I=[],q=Object(y.b)("measure")?function(e,t,r){try{window.performance.measure(e,t,r)}catch(e){return null}var n=window.performance.getEntriesByName(e,"measure");return n.length>0?n[n.length-1]:null}:function(e,t,r){var n=j[t],s=r?j[r]:Object(y.a)();return n&&s?{duration:s-n,entryType:"measure",name:e,startTime:n,toJSON:function(){return null}}:null},k=Object(y.b)("mark")?window.performance.mark.bind(window.performance):function(e){I.push({entryType:"mark",name:e,startTime:y.c,duration:0,toJSON:function(){return null}}),j[e]=Object(y.a)()},w=(Object(y.b)("getEntriesByType")&&window.performance.getEntriesByType.bind(window.performance),Object(y.b)("getEntriesByName")&&window.performance.getEntriesByName.bind(window.performance),r("Q7sZ")),D=r("bXaI"),T=r("qZHI");function R(e){var t="".concat(e,"-start-").concat(P),r="".concat(e,"-end-").concat(P);k(t);var n=Object(y.a)(),s=_(),a=!1;return function(i){if(void 0===i&&(i=!0),!a){a=!0,k(r),i&&q("".concat(e,"-").concat(s),t,r);var o=Object(y.a)();return{name:e,startName:t,endName:r,duration:o-n,start:n,end:o}}}}var P=0;function _(){return P++}function F(e){var t="".concat(e,"-").concat(_());return k(t),{name:t,time:Object(y.a)()}}!function(){function e(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=[]),void 0===r&&(r=Object(x.a)()),this.firstSearch=e,this.excludedErrorSources=t,this.id=r,this.ended=!1,this.sessionStartMark=F("session-start"),this.numRequests=0,this.numDataRequests=0,this.requests=[],this.dataRequests=[],this.sessionFailures=[]}e.prototype.getId=function(){return this.id},e.prototype.fetchStart=function(){return this.fetchStartMark=F("fetch-start")},e.prototype.request=function(e){var t=this;this.numRequests++;var r=R("request-".concat(e));return function(){return t.requests[t.requests.push(r(!1))-1]}},e.prototype.dataRequest=function(e){var t=this;this.numDataRequests++;var r=R("data-request-".concat(e));return function(){return t.dataRequests[t.dataRequests.push(r(!1))-1]}},e.prototype.setStateStart=function(){return this.setStateStartMark=F("set-state-start")},e.prototype.setStateEnd=function(){if(this.numRequests!==this.requests.length)throw new Error("Not all requests have been measured.");if(this.numDataRequests!==this.dataRequests.length)throw new Error("Not all data requests have been measured.");if(this.ended)return this.statistics;this.ended=!0;var e=F("session-end"),t=N("request-overhead-time",this.requests),r=t?t.latestStartedRequest.start:-1,n=t?t.latestStoppedRequest.end:-1,s=N("request-data-time",this.dataRequests),a=s?s.latestStartedRequest.start:-1;(t||s)&&q("client-overhead-".concat(_()),this.fetchStartMark.name,(t||s).latestStartedRequest.startName);var i=s?(q("process-data-time-".concat(_()),s.latestStoppedRequest.endName,this.setStateStartMark.name),q("client-overhead-".concat(_()),s.latestStoppedRequest.endName,e.name),s.latestStoppedRequest.end):-1;q("render-time-".concat(_()),this.setStateStartMark.name,e.name),q("session-".concat(_()),this.sessionStartMark.name,e.name);var o=this.sessionStartMark.time,c=this.setStateStartMark.time,u=e.time,l=this.requests.length,d=this.dataRequests.length,p=e.time;return this.statistics={id:this.id,firstSearch:this.firstSearch,overheadRequestCount:l,dataRequestCount:d,sessionStartTime:o,searchInitiationTime:-1,fetchStartTime:this.fetchStartMark.time,requestOverheadStartTime:r,requestDataStartTime:a,requestDataEndTime:i,setStateStartTime:c,setStateEndTime:u,sessionEndTime:p,sessionDuration:p-o,preClientOverheadDuration:Object(w.a)([r,a,c].filter((function(e){return-1!==e})))-o,requestOverheadDuration:l?Object(D.a)([n,a].filter((function(e){return-1!==e})))-r:0,requestDataDuration:d?i-a:0,dataProcessingDuration:d?c-i:l?c-n:0,renderDuration:u-c}},e.prototype.addFailure=function(e){var t=e.correlationId,r=e.errorCode,n=e.errorSource,s=e.errorDescription,a=e.isPageFailure,i=e.isPartialFailure,o=e.diagnosticDetails;return-1===this.excludedErrorSources.indexOf(n)&&this.sessionFailures.push({correlationId:t,errorCode:r,errorSource:n,errorDescription:s,isPageFailure:a,isPartialFailure:i,diagnosticDetails:o}),this.sessionFailures[this.sessionFailures.length-1]},e.prototype.getFailures=function(){return this.sessionFailures}}();function N(e,t){if(!t.length)return null;var r=Object(T.a)(t,(function(e){return e.start})),n=Object(T.a)(t,(function(e){return e.end}));return q("".concat(e,"-").concat(_()),r.startName,n.endName),{latestStartedRequest:r,latestStoppedRequest:n}}var C={getId:L,fetchStart:L,request:E,dataRequest:E,setStateStart:L,setStateEnd:L,addFailure:L,getFailures:L};function L(){return null}function E(){return L}var z=["token","digest","session"];var M={session:function(){return C}},U=r("eTzd"),A=r("qDPO"),H=function(e){function t(t){var r=t.id,n=t.version,s=t.refreshIntervalMs,a=t.ignoreCache,i=t.microserviceFlights,o=t.refine,c=e.call(this,{id:r,version:n,refreshIntervalMs:s,ignoreCache:a,microserviceFlights:i})||this;return c._refine=!1,c.requestType="data",c._refine=o,c}return Object(n.__extends)(t,e),t.prototype.fetchItem=function(e,t){var r=this;void 0===t&&(t=M);var s,a,i,o=function(e){return Object(b.a)(Object(g.a)(Object(S.a)(Object(v.a)(Object(O.a)(e,z)).filter((function(e){var t=Object(n.__read)(e,2);t[0];return"function"==typeof t[1]}))),(function(e){return e()})),{session:C})}(t);e.query+=this._refine?"&Refiners='".concat((p||(p="LastModifiedTime(discretize=manual/".concat(h.join("/"),")")),p),"'"):"",e.query=(s=e.query,a=this.getId(),(i=new l.a(s||"")).setQueryParameter("suxrid",a),i.toString());var c=this.createRequest(e.query,o).selectMany((function(e){return A.a.CreateObservableSPResponseFromXHR(e,r.parseResponse.bind(r))}));return A.a.applyToBody(c,(function(e){return r.map(e,o)}))},t.prototype.createRequest=function(e,t){var r=this,n=t.token,s=t.session;return"token"in t?Object(f.a)(this.createOptions(e,n)).stopPerfMeasure("data"===this.requestType?s.dataRequest(this.getId()):s.request(this.getId())):Object(m.a)(Object(U.g)(),(function(){return r.createOptions(e,n)}))},t.prototype.createOptions=function(e,t){return{url:e,method:"GET",headers:Object(n.__assign)({Accept:"application/json;odata=verbose"},t?{Authorization:"Bearer ".concat(t)}:{})}},t.prototype.map=function(e,t){throw new Error("Not implemented.")},t}(A.b),B=r("sUxJ"),W=r("ncub"),Q=r("OJcW"),J=r("lJaw"),G=(r("0uoq"),["ai","bmp","gif","heic","ico","jpeg","jpg","png","svg","tiff","tif","webp"]),X=G.concat(["dib","eps","odg","rle","psd","wmf","wpd"]),V=["ai","webp"];G.filter((function(e){return V.indexOf(e)<0}));var Y={docx:["doc","docx","docm","dot","dotx","dotm","odt","docb","wbk","rtf"],xlsx:["xls","xlsx","xlsm","xlb","xlsb","xlc","xlm","xltm","xlam","xlt","xltx","xla","xll","xlam","xlw","excel","csv","odc"],pptx:["ppt","pptx","pptm","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","odp","powerpoint"],video:["wmv","avi","mpg","asf","mp4","ogg","ogv","webm","mov","mkv","3gp","mpeg"],photo:X,pdf:["pdf"],one:["one","note"],html:["aspx"]};var K="ContentTypeId:".concat("0x0101009D1CB255DA76424F860D91F20E6C4118","* AND PromotedState:2");function Z(e,t){return void 0===t&&(t=""),e.map((function(e){return e&&e.expression})).filter((function(e){return!Object(Q.b)(e)})).join(" "+t+" ")}function $(e,t){var r="(";return t.forEach((function(n,s){r+=e+":"+n,r+=s!==t.length-1?" OR ":")"})),r}var ee=function(e){return e?{expression:'Path:"'.concat(e,'/"'),description:"Scoping search to a site using Path"}:{expression:""}};var te=function(e,t,r,n){return n?'((NormWebID:"'.concat(e,'" AND NormSiteID:"').concat(t,'") OR (NormSiteID:"').concat(t,'" AND Path:"').concat(r,'/"))'):'((NormWebID:"'.concat(e,'" AND NormSiteID:"').concat(t,'") OR Path:"').concat(r,'/")')};function re(e){var t=e.departmentId,r=e.isHubSite,n=e.relatedHubSites,s=e.sitePath,a=e.webId,i=e.siteId,o=e.SPSiteUrl,c=e.SPWebUrl,u=e.shouldUseAndForPathFilter,l=c&&o&&c.toLowerCase()===o.toLowerCase()?function(e,t,r){return e?{expression:'(NormSiteID:"'.concat(e,'" ').concat(r?"AND":"OR",' Path:"').concat(t,'/")'),description:"Scoping search to a site using Site ID"}:ee(t)}(i,s,u):function(e,t,r,n){return e?{expression:te(e,t,r,n),description:"Scoping search to a site using Web ID"}:ee(r)}(a,i,s,u);return r&&t?n?function(e,t){return e&&t?{expression:"(DepartmentId:".concat(e," OR DepartmentId:").concat(e.replace(/[{}]/g,"")," OR RelatedHubSites:").concat(e.replace(/[{}]/g,""),")"),description:"Scoping search to a department and hub-sites using DepartmentId and RelatedHubSites"}:{expression:""}}(t,n):function(e){return e?{expression:$("DepartmentId",[e,e.replace(/[{}]/g,"")]),description:"Scoping search to a department/hub-site using DepartmentId"}:{expression:""}}(t):l}var ne=r("o2F0"),se=["".concat("0x0120","*")],ae=[ne.a,"".concat(ne.b,"*")],ie={expression:"".concat($("Title",["OneNote_DeletedPages","OneNote_RecycleBin"])),description:"OneNote deleted pages and trash files"},oe=("".concat($("ContentClass",["STS_List_544","STS_ListItem_544"])),"".concat($("FileType",Y.docx.concat(Y.pptx).concat(Y.xlsx))),"(".concat($("filetype",J.c),")"),"(".concat($("ContentTypeId",ae))," OR ".concat($("SecondaryFileExtension",Y.video),")"),"".concat($("FileType",Y.photo)),"".concat($("FileType",G)),"(".concat($("ContentTypeId",se)," NOT ").concat(ie.expression,")"),{expression:"(".concat(K,")"),description:"News articles"});"".concat($("ContentClass",["STS_ListItem_GenericList","STS_ListItem_Events","STS_ListItem_Contacts","STS_ListItem_851","STS_ListItem_Categories"]));var ce={af:null,am:null,ar:"ar-sa","ar-sa":"ar-sa","as-in":null,"az-latn-az":"az-latn-az","be-by":null,bg:"bg-bg","bg-bg":"bg-bg","bn-in":null,"bn-bd":null,"bs-latn-ba":"bs-latn-ba",ca:"ca-es","ca-es":"ca-es","ca-es-valencia":"ca-es",cs:"cs-cz","cs-cz":"cs-cz",cy:"cy-gb","cy-gb":"cy-gb",da:"da-dk","da-dk":"da-dk",de:"de-de","de-de":"de-de",el:"el-gr","el-gr":"el-gr","en-gb":"en-us","en-us":"en-us",es:"es-es","es-es":"es-es","es-mx":"es-es",et:"et-ee","et-ee":"et-ee",eu:"eu-es","eu-es":"eu-es",fa:null,fi:"fi-fi","fi-fi":"fi-fi",fil:null,fr:"fr-fr","fr-ca":"fr-fr","fr-fr":"fr-fr","ga-ie":"ga-ie","gd-gb":null,gl:"gl-es","gl-es":"gl-es",gu:null,"ha-latn-ng":null,he:"he-il","he-il":"he-il",hi:"hi-in","hi-in":"hi-in",hr:"hr-hr","hr-hr":"hr-hr",hu:"hu-hu","hu-hu":"hu-hu",hy:null,id:"id-id","id-id":"id-id",is:"null",it:"it-it","it-it":"it-it",ja:"ja-jp","ja-jp":"ja-jp",ka:null,kk:"kk-kz","kk-kz":"kk-kz","km-kh":null,kn:null,ko:"ko-kr","ko-kr":"ko-kr",kok:null,ky:null,"lb-lu":null,"lo-la":null,lt:"lt-lt","lt-lt":"lt-lt",lv:"lv-lv","lv-lv":"lv-lv","mi-nz":null,mk:"mk-mk","mk-mk":"mk-mk",ml:null,"mn-mn":null,mr:null,ms:"ms-my","ms-my":"ms-my","mt-mt":null,"ne-np":null,nl:"nl-nl","nl-nl":"nl-nl","nn-no":"nb-no",no:"nb-no",nb:"nb-no","nb-no":"nb-no",or:null,"pa-in":null,pl:"pl-pl","pl-pl":"pl-pl",prs:"prs-af","prs-af":"prs-af",pt:"pt-pt","pt-pt":"pt-pt","pt-br":"pt-br","quz-pe":null,ro:"ro-ro","ro-ro":"ro-ro",ru:"ru-ru","ru-ru":"ru-ru","sd-arab-pk":null,"si-lk":null,sk:"sk-sk","sk-sk":"sk-sk",sl:"sl-si","sl-si":"sl-si",sq:null,sr:"sr-Latn-rs","sr-Latn-rs":"sr-Latn-rs","sr-cyrl":"sr-cyrl-rs","sr-cyrl-ba":"sr-cyrl-rs","sr-cyrl-rs":"sr-cyrl-rs",sv:"sv-se","sv-se":"sv-se",sw:null,ta:null,te:null,th:"th-th","th-th":"th-th","tk-tm":null,tr:"tr-tr","tr-tr":"tr-tr",tt:null,"ug-cn":null,uk:"uk-ua","uk-ua":"uk-ua",ur:null,uz:null,vi:"vi-vn","vi-vn":"vi-vn","zh-hans":"zh-cn","zh-cn":"zh-cn","zh-hant":"zh-tw","zh-tw":"zh-tw","zu-za":null},ue=r("YXgF"),le=r("ohlq"),de=Object(i.regs)("searchux.enableQueryRules",!1);var pe,he=function(e,t){function r(r){return function(e,t,r,n){if(!e.exists(t))return r;var s=e.get(t);return function(e,t){return typeof e===t}(s,n)?s:(console.error("Type mismatch for setting '".concat(t,"': expected '").concat(n,"' but got '").concat(typeof s,"' instead")),r)}(r,e,t,typeof t)}return r.settingName=e,r.defaultValue=t,r}("searchux.UseAndForPathFilterForSiteScopedQueries",!1),me=Object(i.regs)(he.settingName,he.defaultValue),fe=(Object(i.regs)("searchux.clientSideRelevance",!1,{required:!0,includeInLogs:!0}),Object(i.regs)("searchux.isCrossGeoEnabled",!1,{required:!0,includeInLogs:!0}));Object(i.regs)("searchux.isGuestUser",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.use3sInPeopleVertical",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.noSourceIdForFiles",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.use3SEcho",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.use3SConnectorEcho",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.use3SEchoAnswers",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.3SUDTConnectorsEcho.enable3SUDTConnectorsEcho",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.mergeSpAndOdbFilesForEcho",!0,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.useSearchApp",!1,{required:!0,includeInLogs:!0}),Object(i.regs)("searchux.useSearchBoxInTheSuiteNav",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.aadTokenForSubstrate",!1,{required:!1,includeInLogs:!0});function be(){var e=pe&&pe.getState(),t=e&&e.sites;return t?Object(d.a)(t,(function(e){return!0===e.isDefaultSite})):null}var ge=r("qTII"),Se=Object(i.regs)("searchux.searchResultsPerPage",15);function ve(e){var t,r=e.searchText,n=e.pageNumber,s=e.timeRefiner,a=e.sitePath,i=e.departmentId,o=e.isHubSite,c=e.selectProperties,u=e.searchCenterUrl,l=e.relatedHubSites,d=e.webId,p=e.siteId,h=e.SPSiteUrl,m=e.SPWebUrl,f=Object(Q.b)(s)?"":"&RefinementFilters='"+s+"'";return t=u,(be()?Object(U.b)():Object(U.e)(t))+"?QueryText='"+Object(ue.a)(r)+"'&QueryTemplate='"+function(e){var t=e.isHubSite,r=e.departmentId,n=e.sitePath,s=e.relatedHubSites,a=e.extendedQueryTemplate,i=void 0===a?"":a,o=e.webId,c=e.siteId,u=e.SPSiteUrl,l=e.SPWebUrl,d=me(),p=[oe,re({departmentId:r,isHubSite:t,relatedHubSites:s,sitePath:n,webId:o,siteId:c,SPSiteUrl:u,SPWebUrl:l,shouldUseAndForPathFilter:d})],h=ce[Object(ge.a)().toLowerCase()];h&&p.push(function(e){return{expression:"(SPTranslationLanguage:".concat(e," OR(NOT SPTranslatedLanguages:").concat(e," AND NOT SPIsTranslation:true))"),description:"Show pages in your language or those that are not translated to your language"}}(h));return function(e,t){return t?"".concat(e," AND (").concat(t,")"):e}("({searchterms}) "+Z(p,"AND"),i)}({isHubSite:o,departmentId:i,sitePath:a,relatedHubSites:l,webId:d,siteId:p,SPSiteUrl:h,SPWebUrl:m})+"'&HitHighlightedProperties='Title'&StartRow="+(n?function(e){return 1===e||0===e?0:Se()*(e-1)}(n):0)+"&RowLimit="+(n?Se():100)+"&Properties='ClientFunction:News"+(fe()?",EnableMultiGeoSearch:true":",EnableMultiGeoSearch:false")+"'&sortlist='LastModifiedTime:descending'&SelectProperties='"+c+"'&ClientType='"+Object(le.a)()+"'&EnableQueryRules="+de()+f}var Oe=null;function xe(e,t,r,s){var a,i,o=(a=c.a,i=[],a.forEach((function(e){i=Object(n.__spreadArray)(Object(n.__spreadArray)([],Object(n.__read)(i),!1),Object(n.__read)(e.getSources()),!1)})),Object(u.a)(i).sort().join(","));if(!Oe){Oe=new H({id:"search-news-suggestions",version:Object(W.a)(),refreshIntervalMs:9e5});var l=Object(B.a)(c.a);Oe.map=function(e,t){return e.select((function(e){return l(e)}))}}return Oe.getItem({query:ve({searchText:"*",sitePath:e,departmentId:t,isHubSite:r,selectProperties:o,searchCenterUrl:s})})}var ye=r("F6lS"),je=r("Xopu"),Ie="".concat(ye.a,".").concat(je.o),qe=function(){function e(e,t){this.site=e,this.searchCenterUrl=t}return e.prototype.getId=function(){return"SearchNewsSuggestionProvider"},e.prototype.createStream=function(e){return this.site?xe(this.site.sitePath,this.site.departmentId,this.site.isHubSite,this.searchCenterUrl).select((function(e){return e.body})).selectMany((function(e){return s.Observable.fromArray(e)})).specFilter(e,new o.a):s.Observable.empty()},e=Object(n.__decorate)([Object(n.__param)(0,Object(a.a)("site")),Object(n.__param)(1,Object(a.a)("searchCenterUrl"))],e)}();t.default=qe;Object(i.regs)(Ie,qe)}}]);