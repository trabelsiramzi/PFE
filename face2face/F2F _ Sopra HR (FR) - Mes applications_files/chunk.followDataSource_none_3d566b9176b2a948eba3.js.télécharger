(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[13],{KoXO:function(e,t,n){"use strict";n.r(t),n.d(t,"FollowDataSource",function(){return C});var a=n("17wl"),i=n("y88i"),r=n("dq6a"),o=n("3HEj"),s=n("aABS"),c=n("K9kD"),d=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor,this._caller=e.caller}return e.prototype.follow=function(e,t){var n="".concat(e,"/_api/v2.1"),a="".concat(n,"/favorites/followedSites/oneDrive.add"),i=JSON.stringify({value:[{webUrl:e,id:t}]}),r={Caller:this._caller};return this._dataRequestor.send({apiName:"vroomFollowSite",path:a,requestType:"POST",postData:i,headers:r,allowCookies:!0,apiVersion:"v2.1",endpoint:n}).then(function(e){return c.Promise.resolve(e)}).catch(function(e){return c.Promise.reject(e)})},e.prototype.unfollow=function(e,t){var n="".concat(e,"/_api/v2.1"),a="".concat(n,"/favorites/followedSites/oneDrive.remove"),i=JSON.stringify({value:[{webUrl:e,id:t}]}),r={Caller:this._caller};return this._dataRequestor.send({apiName:"vroomUnfollowSite",path:a,requestType:"POST",postData:i,headers:r,allowCookies:!0,apiVersion:"v2.1",endpoint:n}).then(function(e){return c.Promise.resolve(e)}).catch(function(e){return c.Promise.reject(e)})},e.prototype.isFollowed=function(e,t){var n="".concat(e,"/_api/v2.1"),a="".concat(n,"/sites/").concat(t,"?$select=followed");return this._dataRequestor.send({apiName:"vroomIsSiteFollowed",path:a,requestType:"GET",allowCookies:!0,apiVersion:"v2.1",endpoint:n,expectedErrors:[{code:"generalException",message:"Social list is not available"}]}).then(function(e){return void 0!==e.followed}).catch(function(e){return"Social list is not available"!==(null==e?void 0:e.message)&&c.Promise.reject(e)})},e.prototype.getVroomId=function(e){var t="".concat(e,"/_api/v2.1"),n="".concat(t,"/sites/id?$select=id");return this._dataRequestor.send({apiName:"vroomGetId",path:n,requestType:"GET",getErrorAsMessage:!0,allowCookies:!0,apiVersion:"v2.1",endpoint:t}).then(function(e){return e.id}).catch(function(e){return c.Promise.reject(e)})},e}();function l(e,t,n){return"".concat(new URL(e).host,",").concat(c.Guid.normalizeLower(t),",").concat(c.Guid.normalizeLower(n))}var u=n("w0LS"),f=n("4ERF"),p=n("P8RM"),m=n("m1i4"),_=function(){function e(e,t){var n=t.pageContext;this._apiUrlHelper=new m.t({webAbsoluteUrl:n.webAbsoluteUrl}),this._dataRequestor=new c.DataRequestor({},{pageContext:n})}return e.prototype.getFormDigest=function(e){var t=e||this._getContextInfoUrl();return this._dataRequestor.getData({url:t,qosName:"IdentityDataSource.getFormDigest",method:"POST"}).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},e.prototype._getContextInfoUrl=function(){return this._apiUrlHelper.build().segment("contextInfo").toString()},e}(),h=function(){function e(e){var t=e.getToken,n=e.pageContext;this._getToken=t,this._identityDataSource=new _({},{pageContext:n})}return e.prototype.getSessionToken=function(e){return this._getToken(e.endpoint)},e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)},e}(),b=function(){function e(e){var t=e.webAbsoluteUrl;this._webAbsoluteUrl=t}return e.prototype.getApiBaseUrl=function(e){var t=e.apiVersion,n=void 0===t?"v2.0":t;return"".concat(this._webAbsoluteUrl,"/_api/").concat(n)},e}(),g=function(e){var t=e.pageContext,n=e.getToken,a=e.cookieOrigin;return new p.e({},{cookieOrigin:a,sessionManagementProvider:new h({pageContext:t,getToken:n}),urlDataSource:new b({webAbsoluteUrl:t.webAbsoluteUrl})})},v={"SPHome-ClientType":"PagesWeb"},y=500007,S=500019,D=500020,I=500021,x="04B280A8-D635-4437-89BB-E051B80C000F",C=function(e){function t(t,n){var i=n.pageContext,r=n.vroomDataRequestor,o=n.getVroomDataRequestorParams,l=e.call(this,{dataSourceName:"FollowDataSource"},{pageContext:i})||this;return l._useVroom=c.FeatureOverrides.isFeatureEnabled({ODB:60857}),l._isSiteFollowedCacheKey="isSiteFollowed"+"_".concat(i.siteId+i.webId),l._persistentRequestCache=new s.e({dataSourceName:"FollowDataSource",id:"FavoriteFeed"},{pageContext:i}),l._vroomFollowSiteService=new d({caller:"PagesWeb"},{vroomDataRequestor:null!=r?r:g(Object(a.__assign)({pageContext:i},o))}),l}return Object(a.__extends)(t,e),t.prototype._getVroomId=function(e){var t=this;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:u.e.useCacheAndUpdateInTheBackground,cacheRequestKey:"vroomId_".concat(e),getData:function(){return t._vroomFollowSiteService.getVroomId(e)}})},t.prototype.followSite=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return this._useVroom?t&&n?(r=l(e,t,n),[3,3]):[3,1]:[3,5];case 1:return[4,this._getVroomId(e)];case 2:r=a.sent(),a.label=3;case 3:return i=r,[4,this._vroomFollowSiteService.follow(e,i)];case 4:return a.sent(),[3,7];case 5:return[4,this.dataRequestor.getData({url:Object(o.o)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/add",qosName:"FollowSite",additionalPostData:'"'.concat(e,'"'),additionalHeaders:v,noRedirect:!0})];case 6:a.sent(),a.label=7;case 7:return this._persistentRequestCache.flushCache(this._isSiteFollowedCacheKey),[2]}})})},t.prototype.unfollowSite=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return this._useVroom?t&&n?(r=l(e,t,n),[3,3]):[3,1]:[3,5];case 1:return[4,this._getVroomId(e)];case 2:r=a.sent(),a.label=3;case 3:return i=r,[4,this._vroomFollowSiteService.unfollow(e,i)];case 4:return a.sent(),[3,7];case 5:return[4,this.dataRequestor.getData({url:Object(o.o)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/remove",qosName:"UnfollowSite",additionalPostData:'"'.concat(e,'"'),additionalHeaders:v,noRedirect:!0})];case 6:a.sent(),a.label=7;case 7:return this._persistentRequestCache.flushCache(this._isSiteFollowedCacheKey),[2]}})})},t.prototype.isSiteFollowed=function(e,t,n,r,s){return void 0===t&&(t=!1),void 0===n&&(n=!1),Object(a.__awaiter)(this,void 0,void 0,function(){var d,f,p,m=this;return Object(a.__generator)(this,function(_){switch(_.label){case 0:return d=u.e.useCacheAndUpdateInTheBackground,n?d=u.e.bypassCache:t&&(d=u.e.onlyCache),this._useVroom?r&&s?(p=l(e,r,s),[3,3]):[3,1]:[3,4];case 1:return[4,this._getVroomId(e)];case 2:p=_.sent(),_.label=3;case 3:return f=p,[2,this._persistentRequestCache.getDataUtilizingCache({getData:function(){return m._vroomFollowSiteService.isFollowed(e,f)},cachingStrategy:d,cacheRequestKey:this._isSiteFollowedCacheKey})];case 4:return r&&s?[2,this._persistentRequestCache.getDataUtilizingCache({getData:function(){return m.dataRequestor.getData({url:Object(o.o)(m._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/isFollowed?"+"siteId=".concat(r,"&webId=").concat(s,"&url=").concat(i.UriEncoding.encodeURIComponent(e)),parseResponse:function(e){return"true"===e},qosName:"isSiteFollowed",telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=!1;if(t.responseData&&t.responseData.ErrorCode){var r=t.responseData.ErrorCode;r!==y&&r!==S&&r!==D&&r!==I||(i=!0)}var o=i?c.ResultTypeEnum.ExpectedFailure:c.ResultTypeEnum.Failure;return{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultType:o})}}return{eventData:n}},additionalHeaders:v,noRedirect:!0,method:"GET"})},cachingStrategy:d,cacheRequestKey:this._isSiteFollowedCacheKey}).catch(function(e){if(e&&e.responseData&&e.responseData.ErrorCode){var t=e.responseData.ErrorCode;if(t===y||t===S||t===D||t===I)return!1}throw e})]:[2,this._persistentRequestCache.getDataUtilizingCache({getData:function(){return m.dataRequestor.getData({url:"".concat(Object(o.o)(m._pageContext),"/_api/social.following/IsFollowed"),parseResponse:function(e){return JSON.parse(e).d.IsFollowed},qosName:"isSiteFollowed",noRedirect:!0,method:"POST",additionalPostData:JSON.stringify({actor:{__metadata:{type:"SP.Social.SocialActorInfo"},ActorType:1,ContentUri:e,Id:null}})})},cachingStrategy:d,cacheRequestKey:this._isSiteFollowedCacheKey})];case 5:return[2]}})})},t.prototype.isFollowFeatureEnabled=function(){var e=this;if(!c.KillSwitch.isActivated("A7A2793E-67CD-4dc1-9FD0-43F61581207A")&&this._pageContext.featureInfo){var t=new f.e(this._pageContext.featureInfo);if(t){var n=t.get("FollowingContent");if(n)return c.KillSwitch.isActivated(x)||new c.Qos({name:"FollowingContent.SQLRTsSaved"}).end({resultType:c.ResultTypeEnum.Success}),Promise.resolve(n.enabled)}}return this._persistentRequestCache.getDataUtilizingCache({cacheRequestKey:"followEnabled_".concat(this._pageContext.webId+this._pageContext.siteId),cachingStrategy:u.e.useCacheAndUpdateInTheBackground,getData:function(){return e.dataRequestor.getData({url:"".concat(e._pageContext.webAbsoluteUrl,"/_api/SP.Utilities.SPSocialSwitch.IsFollowingFeatureEnabled"),method:"POST",noRedirect:!0,qosName:"isFollowFeatureEnabled",parseResponse:function(e){var t=JSON.parse(e);return c.KillSwitch.isActivated("A7A2793E-67CD-4dc1-9FD0-43F61581207A")||c.KillSwitch.isActivated(x)?c.KillSwitch.isActivated(x)||new c.Qos({name:"FollowingContent.SQLRTsSaved"}).end({resultType:c.ResultTypeEnum.ExpectedFailure}):new c.Qos({name:"FollowingContent.SQLRTsSaved"}).end({resultType:c.ResultTypeEnum.Failure}),t.d.IsFollowingFeatureEnabled}})}})},t}(r.t);t.default=C},m1i4:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n("17wl"),i=n("y88i"),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n,r=Object(a.__spreadArray)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments,!0);return"".concat(r.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.UriEncoding.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.UriEncoding.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.__extends)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()}}]);