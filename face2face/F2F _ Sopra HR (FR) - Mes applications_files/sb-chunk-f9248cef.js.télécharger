(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-spnews~pro-sptext"],{YXgF:function(e,r,t){"use strict";function s(e){return encodeURIComponent(e).replace(/'+/g,"''")}t.d(r,"a",(function(){return s}))},ncub:function(e,r,t){"use strict";var s=t("KmCS");r.a=Object(s.regs)("searchux.clientVersion","",{required:!0,tags:["session","global","obsolete"]})},qDPO:function(e,r,t){"use strict";t.d(r,"a",(function(){return O})),t.d(r,"c",(function(){return q})),t.d(r,"b",(function(){return j}));var s,a,o,n=t("wuwP"),i=t("UlRC");t("PWby");!function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn"}(s||(s={})),function(e){e.test="test",e.inner="inner",e.outer="outer",e.insiders="insiders",e.generalAudience="generalAudience"}(a||(a={})),function(e){e.Select="Select",e.Deselect="Deselect"}(o||(o={}));var c,u=t("nwXE"),h=t("9PIf"),l=t("g5mr"),m=t("rcVC");!function(e){e.persRankCtxStream="ms-oil-datasource-spopersonalcontext",e.withAnySpDigest="ms-oil-datasource-SharePointDigest",e.persResStream="ms-oil-datasource-personalizedalldatasource",e.persPeopleStream="ms-oil-datasource-personalized-person",e.newsStream="ms-oil-datasource-newsdatasource",e.bestBetsStream="ms-oil-datasource-bestbetDataSource",e.unpersResStream="ms-oil-datasource-alldatasource",e.unpersPeopleStream="ms-oil-datasource-person",e.substrateSearchForAnswersEchoStream="mssearchux-cache-3s-answersEcho-iframe",e.substrateSearchForAssociatedSitesStream="mssearchux-cache-3s-associated-sites-iframe",e.substrateSearchForFilesStream="mssearchux-cache-3s-files-iframe",e.substrateSearchForPeopleStream="mssearchux-cache-3s-people-iframe",e.substrateSearchForNewsStream="mssearchux-cache-3s-news-iframe",e.substrateSearchForSiteStream="mssearchux-cache-3s-site-iframe",e.substrateSearchForAllStream="mssearchux-cache-3s-all-iframe",e.substrateSearchForBestBetsStream="mssearchux-cache-3s-bestBest-iframe",e.substrateSearchForOneDriveStream="mssearchux-cache-3s-onedrive-iframe",e.substrateSearchForConnectorStream="mssearchux-cache-3s-connector-iframe",e.substrateSearchForConversationStream="mssearchux-cache-3s-conversation-iframe",e.substrateSearchForCustomResults="mssearchux-cache-3s-custom-results-iframe",e.substrateSearchForCustomResultsEchoQuery="mssearchux-cache-3s-customQueryEcho-results-iframe",e.substrateSearchForSharepointCustomResults="mssearchux-cache-3s-sharepoint-custom-results-iframe",e.substrateSearchForSingleQueryEchoStream="mssearchux-cache-3s-singleQueryEcho-iframe",e.substrateSearchcombinedAnswerAndSerpQueryEchoStream="mssearchux-cache-3s-combinedAnswerAndSerpQueryEcho-iframe",e.substrateSearchForConnectorQueryEchoStream="mssearchux-cache-3s-connectorQueryEcho-iframe",e.substrateSearchForSingleQueryStream="mssearchux-cache-3s-singleQuery-iframe",e.substrateSearchForSingleQueryWithAnswerStream="mssearchux-cache-3s-singleQueryWithAnswer-iframe",e.substrateSearchForSingleQueryWprStream="mssearchux-cache-3s-singleQueryWpr-iframe",e.substrateSearchForSiteSingleQueryStream="mssearchux-cache-3s-siteSingleQuery-iframe",e.substrateSearchForSiteSingleQueryWprStream="mssearchux-cache-3s-siteSingleQueryWpr-iframe",e.substrateSearchForMergedFilesQueryStream="mssearchux-cache-3s-mergedFilesQueryForFilesVertical-iframe",e.substrateSearchForVideosQueryStream="mssearchux-cache-3s-queryForVideosVertical-iframe",e.substrateSearchForStreamVideosQueryStream="mssearchux-cache-3s-queryForStreamVideosVertical-iframe",e.substrateSearchForTopicsQueryStream="mssearchux-cache-3s-queryForTopicsVertical-iframe",e.substrateSearchForImagesQueryStream="mssearchux-cache-3s-queryForImages-iframe",e.substrateActionSearchChannelStream="mssearchux-cache-3s-actionSearchChannel-iframe",e.substrateSearchForPersonContentQueryStream="mssearchux-cache-3s-queryForPersonContent-iframe",e.substrateSearchForPersonConversationsQueryStream="mssearchux-cache-3s-queryForPersonConversations-iframe",e.substrateSearchForPersonContentAndConversationsQueryStream="mssearchux-cache-3s-queryForPersonContentAndConversations-iframe",e.spStream="ms-oil-datasource-personalized-files",e.hubSitesStream="mssearchux-cache-spohubsitesinfo",e.personalizedSitesStream="ms-oil-datasource-personalized-sites",e.unPersonalizedSitesStream="ms-oil-datasource-sites"}(c||(c={}));var d=t("2rja");var p=t("EPqA");function f(e,r){if(!r)throw new Error("Parameter "+e+" must be specified.")}var g,S="logMessage",b="errorMessage",y=function(){function e(e,r,t){f("type",e),f("source",r),f("data",t),this._type=e,this._source=r,this._data=t}return e.prototype.getType=function(){return this._type},e.prototype.getSource=function(){return this._source},e.prototype.getData=function(){return this._data},e}();!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error"}(g||(g={}));var v=function(e,r,t,s){var a=(new Date).getTime(),o=s||{};return new y(S,e,{getLevel:Object(p.a)(t),getType:Object(p.a)(r),getTimestamp:Object(p.a)(a),getProperties:Object(p.a)(s),serialize:Object(p.a)(JSON.stringify(Object(n.__assign)(Object(n.__assign)({},o),{msoilSource:e.getId(),msoilType:r,msoilTimestamp:a,msoilLevel:g[t]})))})},_=t("OJcW"),x="http_client_error",C="http_server_error",I="json_parse_error";var O,w=function(){function e(e){this.params=e}return e.tryCreateOilErrorFromXhr=function(e,r){if(!e)return null;var t=e.status,s=null==t?"":t.toString(),a=e.statusText,o=e.getResponseHeader("SPRequestGuid");if(!Object(_.c)(e.responseText))try{var n=JSON.parse(e.responseText);n&&(Object(_.c)(n.ErrorCode)||(s=n.ErrorCode),Object(_.c)(n.ErrorMessage)||(a=n.ErrorMessage))}catch(e){}return{originalError:a,errorCode:s,serverCorrelationId:o,requestType:r}},e.prototype.createErrorMessage=function(e){return new y(b,e,this)},e}(),F=g,E={itemFetched:"itemFetched",cacheReset:"cacheReset",mismatchingQueryHash:"mismatchingQueryHash",serverSideQueryTimeout:"serverSideQueryTimeout"};!function(e){function r(e,r,t,s){return i.Observable.returnValue({correlationID:e,sprequestduration:r,status:t,body:s})}function t(e,t){var s=e.getResponseHeader("SPRequestGuid"),a=e.status;if(a>=400&&a<500)throw new w({originalError:e.responseText,errorCode:x,xhr:e,queryId:s});if(a>=500&&a<600)throw new w({originalError:e.responseText,errorCode:C,xhr:e,queryId:s});var o="";-1!==e.getAllResponseHeaders().toLowerCase().indexOf("sprequestduration")&&(o=e.getResponseHeader("sprequestduration"));try{return r(s,o,a,t(e))}catch(r){throw new w({originalError:"Failed to parse JSON from SPResponse",errorCode:I,xhr:e,queryId:s})}}function s(e,t){return e.selectMany((function(e){return t(i.Observable.returnValue(Object(n.__assign)(Object(n.__assign)({},e.body),{headers:{sprequestguid:e.correlationID}}))).selectMany((function(t){return r(e.correlationID,e.sprequestduration,e.status,t)}))}))}e.CreateObservableSPResponseFromXHR=t,e.CreateObservableSPResponseFromID=function(e,t,s){return r(e,"",t,s)},e.mapBody=function(e,t){return e.selectMany((function(e){return t(i.Observable.fromArray(e.body)).toArray().selectMany((function(t){return r(e.correlationID,e.sprequestduration,e.status,t)}))}))},e.applyToBody=s,e.parseAndExtractSPXHR=function(e,r,a){return s(t(e,r),(function(e){return e.select(a)}))}}(O||(O={}));var D,P=function(){function e(){}return e.prototype.load=function(e){try{return sessionStorage.getItem(e)}catch(e){return null}},e.prototype.save=function(e,r){try{sessionStorage.setItem(e,r)}catch(e){}},e}();!function(e){var r=function(){function e(e,r,t,s){this._obs=e,r&&(this._fetched=r),s&&(this._value=s),this._subscribed=t||!1}return e.prototype.expired=function(e){var r=(new Date).valueOf()-e;return this._fetched<=r},e.prototype.fetchPending=function(){return!!this._obs},e.prototype.getObservable=function(){return this._obs},e.prototype.getSubscribed=function(){return this._subscribed},e.prototype.setSubscribed=function(){if(this._subscribed)throw Error("Subcription cannot be set more than once.");this._subscribed=!0},e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(e){this._fetched=(new Date).valueOf(),this._obs=null,this._value=e},e}();e.DataSourceCacheItem=r}(D||(D={}));var q=function(e){function r(r){var t=r.id,s=r.version,a=r.refreshIntervalMs,o=r.ignoreCache,n=void 0!==o&&o,i=r.microserviceFlights,c=e.call(this,{id:t,version:s,refreshIntervalMs:a,ignoreCache:n,storage:new P})||this;return i&&(c._microserviceFlights=i.join(";")),c}return Object(n.__extends)(r,e),r}(function(){function e(e){var r=e.id,t=e.version,s=e.storage,a=e.refreshIntervalMs,o=e.ignoreCache,n=void 0!==o&&o;this._id=r,this._refreshIntervalMs=a||Number.MAX_VALUE,this._version=t,this.load=s.load,this.save=s.save,this._logger=new i.Subject,n?this.clearCache():this.initCache()}return e.prototype.fetchItem=function(e,r){throw new Error("Not implemented")},e.prototype.getId=function(){return"ms-oil-datasource-"+this._id},e.prototype.loadCache=function(r,t,s){var a=this;t=t||{};var o=e.key(r),c=this._cache;if(this.queriesLoading||(this.queriesLoading={}),s)return c[o]=new D.DataSourceCacheItem(null,(new Date).getTime(),!1,s),i.Observable.empty();if(!this.queriesLoading[o]){var u=(new Date).getTime();this.queriesLoading[o]=new i.Subject,this.fetchItem(r,t).subscribe((function(e){t=Object(n.__assign)(Object(n.__assign)({},t),{msoilDurationMs:(new Date).getTime()-u}),a._logger.onNext(v(a,E.itemFetched,F.Info,t)),c[o]=new D.DataSourceCacheItem(null,(new Date).getTime(),!1,e),a.updateCache(),a.queriesLoading[o].onNext(e),a.queriesLoading[o].onCompleted(),a.queriesLoading[o]=null}),(function(e){delete c[o],a.updateCache(),a.queriesLoading[o].onError(e),a.queriesLoading[o].onCompleted(),a.queriesLoading[o]=null}))}return this.queriesLoading[o]?this.queriesLoading[o]:i.Observable.returnValue(c[o].getValue())},e.prototype.resetCache=function(){this._cache={},this.updateCache(),this._logger.onNext(v(this,E.cacheReset,F.Info,{}))},e.prototype.key=function(r){return e.key(r)},e.prototype.getItem=function(r,t,a){var o=this;t=t||{};var h=this.key(r),l=this._cache,m=l[h],p=m&&m.expired(this._refreshIntervalMs);if(!m||p&&!t.useStale){if(t.onlyCache){if(t.serverCtxKey){var f=e.key(t.serverCtxKey),g=l[f];if(g){var S=g.getValue();return t.flushCacheEntry&&(delete l[f],this.updateCache()),i.Observable.returnValue(S)}return i.Observable.empty()}return i.Observable.empty()}if(t.persistent)return this.loadCache(r,t);var b=(new Date).getTime(),y=t,_=y&&"function"==typeof y.session?y.session():void 0,x=_&&"function"==typeof _.getId?_.getId():void 0,C=function(e){return e&&e.name?{version:u.a.current,status:0,providerName:o.getId(),properties:{promiseFactoryFailed:!1,error:e.name}}:{version:u.a.current,status:e.status,traceId:e.correlationID,providerName:o.getId(),properties:{diagnostics:JSON.stringify(e.diagnostics),latencies:e.latencies}}};return([c.persResStream,c.unpersResStream,c.bestBetsStream,c.persPeopleStream,c.unpersPeopleStream,c.spStream,c.unPersonalizedSitesStream,c.personalizedSitesStream,c.newsStream].map((function(e){return e.toString()})).indexOf(o.getId())>-1?i.Observable.fromPromise(Object(d.a)({monitorName:this.getId(),factoryErrorPropExtractor:function(e){return{version:u.a.current,status:e&&e.status||0,providerName:o.getId(),properties:{promiseFactoryFailed:!0}}},successPropExtractor:C,failurePropExtractor:C},(function(e){return o.fetchItem(e.key,e.props).toPromise(Promise)}))({key:r,props:t})):this.fetchItem(r,t)).monitor({isHot:!1,eventName:"oil_ds_base_fetch",nameDetail:this.getId(),additionalLogProperties:Object(n.__assign)({dataSource:this.getId(),searchSessionId:x},a)},(function(e){if(!e)return{};var r={diagnostics:JSON.stringify(e.diagnostics),correlationID:e.correlationID,correlationType:e.correlationType,latencies:e.latencies,status:e.status};return e.bodyElapsedTime?r.bodyElapsedTime=e.bodyElapsedTime:e.body&&e.body.bodyElapsedTime&&(r.bodyElapsedTime=e.body.bodyElapsedTime),e.sprequestduration&&(r.sprequestduration=e.sprequestduration),r}),(function(e){var r,t,a=null;if(e instanceof XMLHttpRequest)a=w.tryCreateOilErrorFromXhr(e,o._id),r=e.statusText;else if(e instanceof Error){var n=e.message;t=n,a={errorCode:"",originalError:n,requestType:o._id}}return{correlationID:a&&a.serverCorrelationId,errorCode:a&&a.errorCode,responseStatusText:r,clientExceptionText:{value:t,pii:s.GenericData}}})).doAction((function(e){var r=(new Date).getTime()-b;t=Object(n.__assign)(Object(n.__assign)({},t),{msoilDurationMs:r}),o._logger.onNext(v(o,E.itemFetched,F.Info,t)),l[h]=new D.DataSourceCacheItem(null,(new Date).getTime(),!1,e),o.updateCache()})).catchException((function(e){throw delete l[h],o.updateCache(),e}))}if(t.onlyCache)return i.Observable.empty();var I=m.getValue();return i.Observable.returnValue(I)},e.prototype.log=function(){if(!this._connectableLogger){var e=this._logger.asObservable();this._connectableLogger=e.publish(),this._connectableLogger.connect()}return this._connectableLogger.select((function(e){return e}))},e.prototype.parseJSON=function(e){try{return JSON.parse(e)}catch(e){throw new Error(this.getId()+", parsing JSON : "+e.message)}},e.prototype.parseResponse=function(e){var r=this.getId()+", parsing JSON, status:"+e.status+", type:"+e.getResponseHeader("content-type"),t=e.responseText;if(null!=t&&(r+=", length:"+t.length,t.length)){var s=t.trim();r+=", starts:"+s.substr(0,5),r+=", ends:"+s.substr(Math.max(0,s.length-5),5)}try{return JSON.parse(t)}catch(e){throw new Error(r+e.message)}},e.prototype.traverseObject=function(e,r){var t=Object(h.a)(r,e);if(!t)throw new Error("traversing path '"+e+"'");return t},e.prototype.getVersionId=function(){return this.getId()+"-version"},e.prototype.initCache=function(){this._version===JSON.parse(this.load(this.getVersionId()))?(this._cache=JSON.parse(this.load(this.getId()))||{},this.completeLoad()):(this.clearCache(),this.save(this.getVersionId(),JSON.stringify(this._version)))},e.prototype.clearCache=function(){this._cache={},this.updateCache()},e.prototype.completeLoad=function(){for(var e in this._cache)if(this._cache.hasOwnProperty(e)){var r=this._cache[e];r._value?this._cache[e]=new D.DataSourceCacheItem(null,r._fetched,r._subscribed,r._value):delete this._cache[e]}},e.prototype.updateCache=function(){this.save(this.getId(),JSON.stringify(this._cache))},e.key=function(e){!function(e,r,t){if(!e(t))throw new Error(r)}(l.a,"Key argument must be an object.",e);for(var r,t,s=0,a=Object.keys(e).sort(),o=a.length,n=[];s<o;s++)null===(r=e[t=a[s]])||void 0===r||Object(l.a)(r)||Object(m.a)(r)||(r+="")&&n.push(t+":"+r);return n.join(",")},e}()),j=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(r,e),r}(q)}}]);