(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[31],{FzFR:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a,i=n("17wl"),r=n("3HEj"),o=n("1tKF"),s=n("K9kD"),c=n("y88i");!function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed"}(a||(a={}));var d=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"],l=function(e){function t(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors"},{pageContext:t})||this}return Object(i.__extends)(t,e),t.decodeAcronymColor=function(e){return d.indexOf(e)+1},t.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0,text:void 0}})},t.prototype.getAcronyms=function(e,t){var n=this;if(void 0===t&&(t={}),this._pageContext.webServerRelativeUrl){var a=t.qosName,i=void 0===a?"GetSiteHeaderLogoAcronym":a;return this.getDataUtilizingPersistentCache({getUrl:function(){var t=e.map(function(e){return"{Text: ".concat(c.UriEncoding.encodeURIComponent('"'+e+'"'),"}")}).join(",");return Object(r.o)(n._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=[".concat(t,"]")},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}})},method:"GET",qosName:i})}return s.Promise.reject(new Error("No web URL specified for request."))},t}(o.e);t.t=l},KarG:function(e,t,n){"use strict";n.r(t),n.d(t,"FOLLOWED_SITES_IN_STORE_KEY",function(){return F}),n.d(t,"SiteHeaderContainerStateManager",function(){return H});var a,i=n("17wl"),r=n("l9Kh"),o=n("2FRe"),s=n("iNGM"),c=n("Vlqv"),d=n("Y7TA"),l=n("K9kD"),u={ODB:1075},f=n("a4sQ"),p=n("3HEj"),m=n("FzFR"),_=n("NacN"),h=n("fTUh"),b=n("OpjN"),g=n("71k8"),v=n("43Mb"),y=n("Te0f"),S=n("vyKV"),D=n("jidH"),I=n("UoEp"),x=n("ynV5"),C=n("Tqto"),O=n("85Bv"),w={ODB:1075},E={ODB:1559},A={ODB:60299,ODC:null,Fallback:!1},L={ODB:60328},k={ODB:60340},M={ODB:60703},P={ODB:60752},T={ODB:60652},U=[{name:"inboxUrl",eid:"Mail",trimIfAnonymous:!0},{name:"calendarUrl",eid:"Calendar",trimIfAnonymous:!0},{name:"filesUrl",eid:"Files",trimIfAnonymous:!1},{name:"notebookUrl",eid:"Notebook",trimIfAnonymous:!1},{name:"siteUrl",eid:"Home",trimIfAnonymous:!1},{name:"membersUrl",eid:"Members",trimIfAnonymous:!0},{name:"plannerUrl",eid:"Planner",trimIfAnonymous:!0}],F="FollowedSites";!function(e){e[e.quickLaunch=0]="quickLaunch",e[e.globalNav=1]="globalNav",e[e.none=2]="none"}(a||(a={}));var H=function(){function e(e){var t=this;this._openTeamsChannel=function(e){window.open("".concat(t._pageContext.webAbsoluteUrl,"/_layouts/15/GroupStatus.aspx?id=").concat(t._pageContext.relatedGroupId,"&Target=").concat(t._pageContext.isTeamsConnectedSite?"TEAM":"TEAMSWEBAPP"),"_blank")},this._onGoToMembersClick=function(e){l.Engagement.logData({name:"SiteHeader.GoToMembers.Click"}),t._params.goToMembersOnClick(e),e&&(e.stopPropagation(),e.preventDefault())},this._onCreateSiteClick=function(e,n){l.Engagement.logData({name:"SiteHeader.CreateSite.Click"}),t._params.createSiteOnClick&&t._params.createSiteOnClick(e,n),e&&(e.stopPropagation(),e.preventDefault())},this._onUserExpirationDismissClick=function(e){l.Engagement.logData({name:"SiteHeader.UserExpirationMessageBarDismiss.Click"}),t.setState({hideUserExpirationBar:!0})},this._onFollowClick=function(e){l.Engagement.logData({name:"SiteHeader.Follow.Click"});var n=t._params.siteHeader.state.followState;t.setState({followState:o.e.transitioning});var a=l.FeatureOverrides.isFeatureEnabled({ODB:60857});n===o.e.followed?(a?t._followDataSource.unfollowSite(t._pageContext.webAbsoluteUrl,t._pageContext.siteId,t._pageContext.webId):t._followDataSource.unfollowSite(t._pageContext.webAbsoluteUrl)).then(function(){t.setState({followState:o.e.notFollowing})},function(e){t.setState({followState:o.e.followed})}):(a?t._followDataSource.followSite(t._pageContext.webAbsoluteUrl,t._pageContext.siteId,t._pageContext.webId):t._followDataSource.followSite(t._pageContext.webAbsoluteUrl)).then(function(){t.setState({followState:o.e.followed})},function(e){t.setState({followState:o.e.notFollowing})})},this._getUrlFromEnum=function(e,n){var a=n[U[e].name];return a||e!==r.e.site||(a=t._params.pageContext.webAbsoluteUrl),a},this._updateUsageGuidelineCallback=function(){t._noThrowPromise(t._updateUsageGuidelineUrl()).then(function(e){!l.Killswitch.isActivated("5f6679c5-071c-4e60-8506-6eaead9007ea","8/02/2022","Using Security and Compliance Link for Label helper document")&&e&&(e.usageGuidelineUrl||e.urlForCustomHelpPageSensitivityLabel)?t.setState({usageGuidelineUrl:e.usageGuidelineUrl,urlForCustomHelpPageSensitivityLabel:e.urlForCustomHelpPageSensitivityLabel}):e&&e.usageGuidelineUrl&&t.setState({usageGuidelineUrl:e.usageGuidelineUrl})})},this._params=e;var n=e.pageContext;this._pageContext=n,this._isGroup=Object(p.d)(n),this._async=new l.Async,this._asyncFetchTopNav=!1,this._isNavigationSwitcherEnabled=O.e(k,this._pageContext,{killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"}),this._isMultipleHomeSitesFeatureEnabled=l.FeatureOverrides.isFeatureEnabled(T),this._isAnonymousGuest=n.isAnonymousGuestUser||n.isEmailAuthenticationGuestUser,this._isGuest=this._isAnonymousGuest||n.isExternalGuestUser,this._hasManageLists=S.e.hasPermission(n.webPermMasks,S.e.manageLists),this._chrome=Object(c.e)(this._pageContext);var a,i="";this.shouldUseSiteIconManager(n)?(i="".concat(n.webAbsoluteUrl,"/_api/siteiconmanager/getsitelogo?type='1'"),n.headerLogoHash&&(i+="&hash=".concat(n.headerLogoHash))):i=e.pageContext.webLogoUrl;var s=e.pageContext.webAbsoluteUrl;s&&(a=function(t){l.Engagement.logData({name:"SiteHeader.Logo.Click"}),e.logoOnClick&&(e.logoOnClick(s,t),t.stopPropagation(),t.preventDefault())});var d=this._setupHorizontalNav(),u=this._isGroup?"".concat(n.webAbsoluteUrl,"/_layouts/15/groupstatus.aspx?id=").concat(n.groupId,"&target=conversations"):void 0;this._params.siteHeader.state={membersText:void 0,siteClassification:this._getSiteClassification(),usageGuidelineUrl:void 0,siteLogoUrl:i,horizontalNavItems:d,logoOnClick:a,webAbsoluteUrl:s,outlookUrl:u,showCreateSiteButton:!1,urlForCustomHelpPageSensitivityLabel:void 0},N()&&!i&&(this._acronymDatasource=this._params.acronymDatasource||new m.e(n))}return e.prototype.componentDidMount=function(){var e=this,t=[this._isGroup||N()&&!this._acronymDatasource?Promise.resolve(void 0):this._noThrowPromise(this._loadSiteAcronym()),this._noThrowPromise(this._setupSiteReadOnlyBar()),this._noThrowPromise(this._setupSiteResourceQuotaBar()),this._noThrowPromise(this._setupFollowButton()),this._noThrowPromise(this._setupUserExpirationBar()),this._noThrowPromise(this._processGroups()),this._noThrowPromise(this._setupCreateSiteButton()),this._noThrowPromise(this._setupSiteStatusBar()),this._noThrowPromise(this._setupSitePolicyBar()),this._noThrowPromise(this._setupFraudTenantBar()),this._noThrowPromise(this._fetchTopNavigation()),this._noThrowPromise(this._setupNoSharePointSyntexLicenseBar()),this._noThrowPromise(this._syncTeamSiteSettings())];Promise.all(t).then(function(t){var n={};t.forEach(function(e){e&&(n=Object(i.__assign)(Object(i.__assign)({},n),e))}),e.setState(n)}),this._isNavigationSwitcherEnabled&&(this._ensureEventGroup(),this._eventGroup.on(window,"UPDATE_NAV_PLACEMENT",function(t){var n=t.args,i=n.placement,r=n.quickLaunchEnabled,o=i===_.i.HORIZONTAL&&r;if(e._horizontalNavType=o?a.quickLaunch:a.none,o){var s=e._transformToNavItems(e._pageContext.navigationInfo.quickLaunch);e.updateHorizontalNav(s)}}))},e.prototype.componentWillUnmount=function(){this._async.dispose(),this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=null)},e.prototype.getRenderProps=function(e,t,n,i){var r,o,u=this._params,m=u.siteHeader.state,h=u.strings,b=u.pageContext,v=Number(b.webTemplate),D={siteLogoUrl:m.siteLogoUrl,siteAcronym:m.siteAcronym},I=this._computeGoToMembersAction(m.membersUrl),x=m.facepilePersonas?{personas:m.facepilePersonas,getPersonaProps:function(e){return{onRenderCoin:function(a,i){var r,o={personaType:(r=e&&e.data&&e.data.groupPerson)&&r.entityType===y.e.group?"Group":"User",identifier:r&&r.email,pageContext:b,moduleLoader:t,customWaiter:n,addGroupMembersCallback:function(e){I(void 0)},lpcHoverTargetProps:{upn:r&&r.email,hostAppPersonaInfo:{PersonaDisplayName:r&&r.name}}};return Object(d.t)(o,i(a))}}}}:{personas:m.facepilePersonas},C={membersText:m.membersText,goToMembersAction:I},O=m.webAbsoluteUrl,w={siteTitle:b.webTitle,headerOptions:this._chrome&&this._chrome.header,groupInfoString:this._getGroupInfoString(b,h),siteClassification:this._getSiteClassification(),siteLogo:D,logoHref:O,logoOnClick:m.logoOnClick,disableSiteLogoFallback:!0,facepile:x,showGroupCard:!!m.groupLinks,groupLinks:m.groupLinks,membersInfoProps:C,moduleLoader:e,lpcModuleLoader:t,lpcModuleLoaderWaiter:n,usageGuidelineUrl:m.usageGuidelineUrl,updateUsageGuidelineUrl:this._updateUsageGuidelineCallback,urlForCustomHelpPageSensitivityLabel:m.urlForCustomHelpPageSensitivityLabel,pageContext:b,groupEmail:m.groupEmail,waitForPLT:this._params.waitForPLT,openTeamsChannel:this._params.openTeamsChannel||this._openTeamsChannel},E=Object(c.e)(this._pageContext),A=!!u.onEditClicked&&!m.isSiteReadOnly&&!this._isAnonymousGuest&&this._hasManageLists&&(!this._isNavigationSwitcherEnabled||E.nav.placement===_.i.HORIZONTAL),L=this._chrome.nav.megaMenuEnabled,k={items:m.horizontalNavItems,editLink:A?Object(s.a)(b,!1,u.onEditClicked,void 0,f.t):void 0,moduleLoader:e,isEditMode:m.isEditMode,ariaLabel:h.horizontalNavAriaLabel||f.e,splitButtonAriaLabel:f.a,moreOptionsAriaLabel:h.horizontalNavMoreOptionsAriaLabel||f.n,hasSelectedState:this._horizontalNavType===a.quickLaunch,pageContext:this._pageContext,useMegaMenu:L};b&&b.navigationInfo&&b.navigationInfo.isAudienceTargeted&&(k.isAudienceTargeted=!0),this._horizontalNavType===a.quickLaunch?r=k:this._horizontalNavType===a.globalNav&&(o=k);var M=void 0!==m.followState?{followLabel:h.follow,followAction:this._onFollowClick,followState:m.followState,followedAriaLabel:h.followButtonAriaLabel,notFollowedAriaLabel:h.followButtonAriaLabel,followedHoverText:h.followedHover,notFollowedHoverText:h.notFollowedHover,notFollowedLabel:h.notFollowed}:void 0,P={pageContext:b,moduleLoader:i,moduleLoaderWaiter:n,imageUrls:this._params.imageUrls},T=void 0;this._isAnonymousGuest||!S.e.hasPermission(this._pageContext.webPermMasks,S.e.editListItems)||b.groupId&&"00000000-0000-0000-0000-000000000000"!==b.groupId||(T={url:b.webAbsoluteUrl+"/_layouts/15/share.aspx?isDlg=1&OpenInTopFrame=1",shareLabel:h.shareLabel,loadingLabel:h.loadingLabel},u.shareButtonOnClick&&(T.url="",T.onShare=u.shareButtonOnClick));var U,F=m.showCreateSiteButton?{createSiteAction:this._onCreateSiteClick}:void 0;m.isSiteReadOnly?(U={isSiteReadOnly:!0,siteReadOnlyString:h.siteIsReadOnly,siteReadOnlyState:m.siteReadOnlyState,siteIsMovingString:h.siteIsMoving,siteMoveCompletedString:h.siteMoveComplete},b.isArchived&&v===g.e.teamChannel&&(U.siteReadOnlyString=h.siteIsArchived)):U=void 0;var H=void 0;m.siteResourceQuotaState!==p.i.NoWarning&&(H={siteResourceQuotaState:m.siteResourceQuotaState,siteResourceOverQuota:h.siteIsOverQuota,siteResourceQuotaWarning:h.siteIsCloseToQuota});var R=l.Killswitch.isActivated("F88CC3D7-8906-4639-A8FD-DE719C2446F9","2/16/2021","Add create site action to composite header props")?null:{createSiteAction:this._onCreateSiteClick},N=this._horizontalNavType===a.quickLaunch?_.n.FULLBLEED:void 0,B=l.FeatureOverrides.isFeatureEnabled({ODB:1179})?this._pageContext.headerLayout:void 0,j=!m.hideUserExpirationBar&&m.expiringUsers>0&&{userExpirationOnClick:this._params.userExpirationOnClick,onDismiss:this._onUserExpirationDismissClick,expiringUserCount:m.expiringUsers};return{siteHeaderProps:w,horizontalNavProps:r,topNavProps:o,onRenderHorizontalNav:u.onRenderHorizontalNav,createSiteButton:F,shareButton:T,follow:M,siteScriptProgressIndicator:P,messageBarProps:m.messageBarState,siteReadOnlyProps:U,siteResourceQuotaProps:H,policyBarProps:m.policyBarState,fraudTenantBarProps:m.fraudTenantBarState,noSharePointSyntexLicenseBarProps:m.noSharePointSyntexLicenseBarState,layout:N,unifiedLayout:B,userExpirationBarProps:j,getAccessToken:u.getAccessToken,groupsProvider:this._groupsProvider,createSiteAction:R}},e.prototype.updateHorizontalNav=function(e,t){this.setState({horizontalNavItems:e,editModeHorizontalNav:!1},t)},e.prototype._getGroupInfoString=function(e,t){var n;if(this._isGroup)n=e.groupType===h.e.public?t.publicGroup:t.privateGroup;else if(e.isTeamsChannelSite||Number(e.webTemplate)===g.e.teamChannel){var a=e.teamsChannelType;n=a===p.r.StandardChannel?t.standardChannel:a===p.r.SharedChannel?t.sharedChannel:t.privateChannel}return n},e.prototype._computeGoToMembersAction=function(e){var t=void 0;return this._isGuest||(t=this._onGoToMembersClick),t},e.prototype.setState=function(e,t){this._params.siteHeader.setState(e,t)},e.prototype._noThrowPromise=function(e){return e.catch(function(){})},e.prototype.shouldUseSiteIconManager=function(e){return e.webLogoUrl||e.webLogoUrl.indexOf(p.e)>=0||this.containsSiteAssetsRelativePath(e)||this._isGroup},e.prototype.containsSiteAssetsRelativePath=function(e){return e.webLogoUrl&&e.webAbsoluteUrl&&e.webLogoUrl.toLowerCase().indexOf(e.webAbsoluteUrl.toLowerCase()+"/siteassets")>=0},e.prototype._loadSiteAcronym=function(){return this._acronymDatasource.getAcronymData(this._pageContext.webTitle).then(function(e){return{siteAcronym:e.acronym,siteLogoColor:e.color}})},e.prototype._setupHorizontalNav=function(){var e,t=this._pageContext,n=t.navigationInfo,i=n&&n.quickLaunch,r=n&&n.topNav,o=this._chrome.nav.placement===_.i.HORIZONTAL,s=a.none;return o&&this._params.horizontalQuickLaunchEnabled&&i&&i.length?(e=i,s=a.quickLaunch):t.isHubSite?s=a.none:t.PublishingFeatureOn?(this._asyncFetchTopNav=!0,s=a.globalNav):r&&r.length&&((this._isMultipleHomeSitesFeatureEnabled?Object(C.t)(t):t.isGlobalNavEnabled)&&Object(C.n)(t)?s=a.none:(s=a.globalNav,e=r)),this._horizontalNavType=s,this._transformToNavItems(e)},e.prototype._syncTeamSiteSettings=function(){var e=this;return l.Features.isFeatureEnabled(L)&&this._pageContext.isTeamsChannelSite&&this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(t){t.GetTeamSiteData().then(function(n){e._pageContext.themeCacheToken===n.ThemeToken&&e._pageContext.headerEmphasis===n.HeaderEmphasis||t.SyncTeamSiteSettings()})}):Promise.resolve(void 0)},e.prototype._fetchTopNavigation=function(){return this._asyncFetchTopNav?new D.e(this._pageContext,I.n.publishingGlobalNav).getMenuState({useCache:!0,depth:3}).then(function(e){if((!R||e)&&e.links)return{horizontalNavItems:e.links}}):Promise.resolve(void 0)},e.prototype._transformToNavItems=function(e){var t=this,n=[];if(e&&e.length>0){var i=this._horizontalNavType===a.quickLaunch;n=D.e.transformNodesToLinks(e,function(e,n){(!n||""!==n.url&&n.url!==s.t)&&t._params.topNavNodeOnClick(e,n),e.stopPropagation(),e.preventDefault()},function(e,t){return t>0||!(i&&e.Id===Number(I.t.quickLaunchRecent))})}return n},e.prototype._processGroups=function(){var e=this;return this._isGroup?this._params.getGroupsProvider().then(function(t){return t&&(e._groupsProvider=t,e._groupsProvider.group)?(e._groupsProvider.group.membership.load(),e._updateGroupsInfo()):Promise.resolve(void 0)}):Promise.resolve(void 0)},e.prototype._updateGroupsInfo=function(){var e,t,n,a=this,r={};if(this._isGroup){var o=this._groupsProvider.group,s=function(e){var t={};if(e!==b.e.None&&o.membership&&a._totalNumberOfMembers!==o.membership.totalNumberOfMembers){var n=a._updateFacepilePersonas(o.membership),r=a._getMembersText(o.membership);a._totalNumberOfMembers=o.membership.totalNumberOfMembers,t=Object(i.__assign)(Object(i.__assign)({},t),{membersText:r,facepilePersonas:n})}return Promise.resolve(t)},c=function(r){var s={};if(r!==b.e.None&&!a._hasParsedMembers){a._hasParsedMembers=!0,n=a._getSiteClassification(),e=a._isGuest?void 0:o.inboxUrl,t=a._isGuest?void 0:o.membersUrl;var c=a._groupCardLinksFromGroupCardLinkParams(a._params.groupCardInfo,o);if(s={siteClassification:n,outlookUrl:e,membersUrl:t,groupLinks:c,groupEmail:o.mail},!N()||a._acronymDatasource)return a._noThrowPromise(a._loadSiteAcronym()).then(function(e){return Object(i.__assign)(Object(i.__assign)({},e),s)})}return Promise.resolve(s)};return this._ensureEventGroup(),this._eventGroup.on(o,"source",function(e){c(e).then(function(e){a.setState(e)})}),this._eventGroup.on(o.membership,"source",function(e){s(e).then(function(e){a.setState(e)})}),Promise.all([c(o.source),s(o.membership.source)]).then(function(e){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},e[0]),e[1]),r)})}return Promise.resolve(r)},e.prototype._ensureEventGroup=function(){this._eventGroup||(this._eventGroup=new l.EventGroup(this))},e.prototype._groupCardLinksFromGroupCardLinkParams=function(e,t){var n=[];if(this._isGroup&&t&&e&&e.length){for(var a=0;a<e.length;a++){var i=e[a].linkType,r=this._getUrlFromEnum(i,t);if(r&&(!this._isAnonymousGuest||!U[i].trimIfAnonymous)){var o="GroupCard."+U[i].eid+".Click";n.push({title:e[a].title,icon:e[a].icon,href:r,engagementId:o})}}return n}return null},e.prototype._updateUsageGuidelineUrl=function(){var e=this;return!Object(p.c)(this._pageContext)&&this._getSiteClassification()&&this._params.getGroupSiteProvider?this._params.getGroupSiteProvider().then(function(t){e._groupSiteProvider=t}).then(function(){var t;return e._groupSiteProvider&&(t=e._groupSiteProvider.getGroupCreationContext()),t}).then(function(e){return l.Killswitch.isActivated("5f6679c5-071c-4e60-8506-6eaead9007ea","8/02/2022","Using Security and Compliance Link for Label helper document")?{usageGuidelineUrl:e.usageGuidelineUrl}:{usageGuidelineUrl:e.usageGuidelineUrl,urlForCustomHelpPageSensitivityLabel:e.urlForCustomHelpPageSensitivityLabel}}):Promise.resolve(void 0)},e.prototype._getHubDataSource=function(){var e=this;return this._hubDataSource?Promise.resolve(this._hubDataSource):Promise.resolve().then(n.bind(null,"bugI")).then(function(t){return e._hubDataSource=new t.default(e._pageContext),e._hubDataSource})},e.prototype._setupCreateSiteButton=function(){var e=this;if(l.FeatureOverrides.isFeatureEnabled(w)){var t=this._params.waitForPLT;if(t)return t.then(function(){return e._getHubDataSource()}).then(function(t){return function(e,t){return l.FeatureOverrides.isFeatureEnabled(u)&&t&&e&&e.isHubSite?t.canCreateHubJoinedSite(e.hubSiteId):l.Promise.resolve(!1)}(e._pageContext,t)}).then(function(e){return{showCreateSiteButton:!!e}})}return Promise.resolve(void 0)},e.prototype._setupFollowButton=function(){var e=this;return this._isGuest?Promise.resolve(void 0):this._params.getFollowDataSource().then(function(t){e._followDataSource=t}).then(function(){return e._followDataSource.isFollowFeatureEnabled().then(function(t){var n;return t?e._followDataSource.isSiteFollowed(e._pageContext.webAbsoluteUrl,!1,!1,e._pageContext.siteId,e._pageContext.webId).then(function(e){return void 0!==e&&(n={followState:e?o.e.followed:o.e.notFollowing}),n}):{followState:void 0}})})},e.prototype._setupSiteStatusBar=function(){return this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(e){return e.getStatusBarInfo()}).then(function(e){return e.StatusBarText?{messageBarState:{message:e.StatusBarText,linkText:e.StatusBarLinkText,linkTarget:e.StatusBarLinkTarget}}:Promise.resolve(void 0)}):Promise.resolve(void 0)},e.prototype._setupSitePolicyBar=function(){if(this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||this._pageContext.m365GroupsBlockDownloadsExperienceEnabled||this._pageContext.readOnlyExperienceEnabled){var e=void 0;return e=this._params.strings.authenticationPolicyActive&&this._params.strings.messageBarMoreInfo?{message:this._params.strings.authenticationPolicyActive,linkText:this._params.strings.messageBarMoreInfo,linkTarget:"http://go.microsoft.com/fwlink/p/?LinkId=823640"}:{message:void 0,linkText:void 0,linkTarget:void 0},l.FeatureOverrides.isFeatureEnabled(M)&&this._pageContext.m365GroupsBlockDownloadsExperienceEnabled&&(e={message:this._params.strings.blockDownloadPolicyActive,linkText:void 0,linkTarget:void 0}),l.FeatureOverrides.isFeatureEnabled(P)&&this._pageContext.readOnlyExperienceEnabled&&(e={message:this._params.strings.readOnlyAccessPolicyActive,linkText:void 0,linkTarget:void 0}),Promise.resolve({policyBarState:e})}return Promise.resolve(void 0)},e.prototype._setupFraudTenantBar=function(){var e;return l.Features.isFeatureEnabled(A)&&this._pageContext.isFraudTenant?(e=this._params.strings.fraudTenantActive&&this._params.strings.messageBarMoreInfo&&void 0!==this._pageContext.fraudTenantAccessRevokeTime?{message:x.format(this._params.strings.fraudTenantActive,this._fetchTimestampFormat(this._pageContext.fraudTenantAccessRevokeTime)),linkText:this._params.strings.messageBarMoreInfo,linkTarget:"http://go.microsoft.com/fwlink/p/?LinkId=2092321"}:{message:void 0,linkText:void 0,linkTarget:void 0},Promise.resolve({fraudTenantBarState:e})):Promise.resolve(void 0)},e.prototype._fetchTimestampFormat=function(e){var t=e.split("T")[0],n=e.split("T")[1];return new Date(t).toDateString()+", "+n+" UTC"},e.prototype._setupNoSharePointSyntexLicenseBar=function(){var e=this;if(Number(this._pageContext.webTemplate)===g.e.contentCenter){var t={noSharePointSyntexLicenseBarState:void 0};if(this._params.getSyntexDataSource)return this._params.getSyntexDataSource().then(function(n){return n.getMachineLearningEnabled().then(function(n){var a;if(!n.MachineLearningCaptureEnabled&&!n.MachineLearningExperienceEnabled){var i=null===(a=e._params.strings)||void 0===a?void 0:a.default;t.noSharePointSyntexLicenseBarState={message:e._params.strings.noSharePointSyntexLicense?e._params.strings.noSharePointSyntexLicense:i.noSharePointSyntexLicense,linkText:void 0,linkTarget:void 0}}return t})})}return Promise.resolve(void 0)},e.prototype._setupSiteReadOnlyBar=function(){if(l.Killswitch.isActivated("40EBE94D-11BC-4926-A75E-6827E8FB6CD8","8/11/2020","Remove Readonly XHR"))return this._setupSiteReadOnlyBarOld();var e={};return void 0===this._pageContext.readOnlyState?e.siteReadOnlyState=v.e.unknown:null===this._pageContext.readOnlyState?e.siteReadOnlyState=v.e.notReadOnly:(e.siteReadOnlyState=this._pageContext.readOnlyState,e.isSiteReadOnly=this._pageContext.readOnlyState>=0),this._pageContext.isArchived&&(e.isSiteReadOnly=!0),Promise.resolve(e)},e.prototype._setupSiteReadOnlyBarOld=function(){var e=this;return this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(t){return t.getReadOnlyState().then(function(n){var a={siteReadOnlyState:t.getFullSiteReadOnlyState()};return(n||e._pageContext.isArchived)&&(a.isSiteReadOnly=!0),a})}):Promise.resolve(void 0)},e.prototype._setupSiteResourceQuotaBar=function(){var e={siteResourceQuotaState:this._pageContext.resourceQuotaExceeded};return Promise.resolve(e)},e.prototype._setupUserExpirationBar=function(){var e=this,t=this._pageContext.isSiteAdmin&&l.Features.isFeatureEnabled(E);return this._params.userExpirationOnClick&&this._params.getUserExpirationProvider&&t?this._userExpirationProvider?this._userExpirationProvider.getUsersWithExpirations("UserExpiration",!0,50,0,void 0).then(function(t){return e._countExpiringUsers(t)}).then(function(e){if(e>0)return{expiringUsers:e}}):this._params.getUserExpirationProvider().then(function(t){e._userExpirationProvider=t}).then(function(){return e._userExpirationProvider.getUsersWithExpirations("UserExpiration",!0,50,0,void 0).then(function(t){return e._countExpiringUsers(t)}).then(function(e){if(e>0)return{expiringUsers:e}})}):Promise.resolve(void 0)},e.prototype._countExpiringUsers=function(e){var t=0,n=new Date,a=new Date(n.getTime()+18144e5);return e.forEach(function(e){e.expiration<a&&!(e.isSiteAdmin&&e.expiration<n)&&t++}),t},e.prototype._getMembersText=function(e){var t=e.totalNumberOfMembers;if(t){var n=this._params.strings,a=x.getLocalizedCountValue(n.membersCount,n.membersCountIntervals,t);return x.format(a,t)}},e.prototype._updateFacepilePersonas=function(e){return e.membersList.members.slice(0,3).map(function(e,t){return{personaName:e.name,imageUrl:e.image,data:{groupPerson:e,personaType:e.entityType},"data-automationid":"SiteHeaderFacepilePersona_"+t.toString()}})},e.prototype._getSiteClassification=function(){return l.Killswitch.isActivated("149A9D34-BEC1-4FD1-950C-8E5CB81348D2","03-17-2021","Fix classification for channels.")?this._getSiteClassificationOld():(this._pageContext&&(e=this._pageContext.sensitivityLabelName),!e&&this._groupsProvider&&this._groupsProvider.group&&(t=this._groupsProvider.group.classification),e||t||this._pageContext&&this._pageContext.siteClassification);var e,t},e.prototype._getSiteClassificationOld=function(){var e,t;return this._groupsProvider&&this._groupsProvider.group&&(this._pageContext&&(e=this._pageContext.sensitivityLabelName),e||(t=this._groupsProvider.group.classification)),e||t||this._pageContext&&this._pageContext.siteClassification},e}();function R(){return l.Killswitch.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}function N(){return!l.Killswitch.isActivated("4f8452f7-e57d-4fcd-978c-fb72127955a9","09/08/2020","Skip call to get acronym if cusotm site logo exists")}t.default=H},OpjN:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(a||(a={}))},Te0f:function(e,t,n){"use strict";var a,i,r;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),function(e){e[e.regularUser=0]="regularUser",e[e.externalUser=1]="externalUser",e[e.group=2]="group",e[e.application=3]="application",e[e.linkedinUser=4]="linkedinUser"}(a||(a={})),function(e){e.graph="graph",e.sharepointSearch="sharepointSearch",e.substrate="substrate"}(i||(i={})),function(e){e.unified="unifiedGroup",e.securityGroup="securityGroup",e.SPGroup="SPGroup",e.PublicDistributionList="PublicDistributionList",e.family="family"}(r||(r={}))},Vlqv:function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a,i,r=n("17wl"),o=n("K9kD"),s=n("85Bv"),c=n("71k8"),d=n("3HEj"),l=n("NacN"),u={ODB:60340},f="c8b3137a-ca4c-48a9-b356-a8e7987dd693",p="96c933ac-3698-44c7-9f4a-5fd17d71af9e",m="6142d2a0-63a5-4ba0-aede-d9fefca2c767",_="f6cc5403-0d63-442e-96c0-285923709ffc",h="400955b3-329f-4b22-ade5-002653506aee",b="ab120c41-0d36-490b-a048-b39f65675858",g="67f52693-99aa-428d-8670-0b1b2d291aa8",v="5e8b2de3-2f17-43a2-b020-2f666b2891c9",y="ab407e62-bf10-4e8a-aa2e-af77c5a94634",S=((a={})[c.t.teamSite]=f,a[c.t.group]=f,a[c.t.sitePagePublishing]=p,a[c.t.pointPublishingPersonal]=h,a[c.t.contentCenter]=b,a[c.t.teamChannel]=v,a[c.t.mySite]=y,a),D=((i={})[f]=function(){return{id:f,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.LEFT},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.teamSite,c.t.group]}},i[p]=function(){return{id:p,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[c.t.sitePagePublishing]}},i[m]=function(){return{id:m,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[c.t.sitePagePublishing]}},i[_]=function(){return{id:_,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[c.t.sitePagePublishing]}},i[h]=function(){return{id:h,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.LEFT,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.pointPublishingPersonal]}},i[b]=function(){return{id:b,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.contentCenter]}},i[g]=function(){return{id:g,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.contentCenter]}},i[v]=function(){return{id:v,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.LEFT,megaMenuEnabled:!1},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.teamChannel]}},i[y]=function(){return{id:y,title:void 0,description:void 0,chromeOptions:{header:{hidden:!0,layout:l.r.none},nav:{hidden:!0,placement:l.i.HORIZONTAL,megaMenuEnabled:!1},footer:{hidden:!0},search:{hidden:!1}},supportedTemplates:[c.t.mySite]}},i);function I(e){var t,n=function(e){if(!e)throw new Error("pageContext missing");var t=function(e){var t,n=o.Guid.Empty;return e.DesignPackageId&&(t=e.DesignPackageId,void 0!==D[t])&&(n=e.DesignPackageId),n===o.Guid.Empty&&void 0!==S[e.webTemplate]&&(n=S[e.webTemplate]),n===o.Guid.Empty&&(n=f),n}(e);return Object(r.__assign)(Object(r.__assign)({},D[t]().chromeOptions),{footer:{emphasis:l.e.Strong,hidden:!0,layout:l.t.SIMPLE}})}(e),a=(e.webPropertyFlags2&d.n.FooterEmphasis1)>>8,i=(e.webPropertyFlags2&d.n.FooterEmphasis0)>>8;n.footer.emphasis=a|i;var p=(e.webPropertyFlags2&d.n.FooterLayout1)>>10,m=(e.webPropertyFlags2&d.n.FooterLayout0)>>10;if(n.footer.layout=p|m,n.footer.hidden=0==(2&e.webPropertyFlags2),n.nav&&!n.nav.hidden){if(n.nav.megaMenuEnabled=0!=(128&e.webPropertyFlags2),o.Killswitch.isActivated("93B26AAC-7D48-4AE2-9471-5A0B485A6066","10/14/2021","Preserve quickLaunch on Publishing sites."))n.nav.quickLaunchEnabled=!!(null===(t=e.navigationInfo)||void 0===t?void 0:t.quickLaunch);else{var _=e.navigationInfo;_&&(n.nav.quickLaunchEnabled=!!_.quickLaunch)}if(s.e(u,e,{killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"})&&[c.t.teamSite,c.t.group].indexOf(Number(e.webTemplate))>-1){var h=1==(e.webPropertyFlags2&d.n.HorizontalQuickLaunch);n.nav.placement=h?l.i.HORIZONTAL:l.i.LEFT,e.PublishingFeatureOn&&(n.nav.placement=l.i.LEFT)}}n.header.layout=e.headerLayout,n.header.emphasis=e.headerEmphasis,n.header.logoAlignment=e.logoAlignment;var b=0!=(e.webPropertyFlags2&d.n.HideTitleInHeader);return n.header.hideTitle=b,n}}}]);