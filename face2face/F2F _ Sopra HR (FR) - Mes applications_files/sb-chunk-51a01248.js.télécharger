(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["sug-univ"],{"85Gg":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return d}));var r=n("YL+5"),a=n("KmCS"),o=n("OJcW"),c=n("QHBp"),i=Object(a.regs)("searchux.useStrictSearchCenterUrlValidation",!1,!1),u=Object(a.regs)("searchux.api.sharePointSearchCenter.url","");function s(e){return r.a.concatenate(d(e),c.b)}var l=new RegExp("^(https?://)?((([a-zd]([a-zd-]*[a-zd])*).)+[a-z]{2,}|((d{1,3}.){3}d{1,3}))(:d+)?(/[-a-zd%_.~+]*)*");function d(e){if(!function(e){var t=Object(o.b)(e)?u():e;return!(i()&&!l.test(t))&&/\/search\/?/i.test(t)}(e))return"";var t=Object(o.b)(e)?u().toLowerCase()+"/":e,n=t.lastIndexOf("/search/");return n<0?"":t.substring(0,n+"/search/".length).replace(/\/$/,"")}},AJTS:function(e,t,n){"use strict";function r(e,t,n,r){return r.Observable.merge(n.map((function(e){return r.Observable.merge(e).distinct(t)})))}n.d(t,"a",(function(){return r}))},QHBp:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n("YL+5"),a="_api",o=r.a.concatenate(a,"search")},"Z/gI":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("wuwP"),a=n("Az8T"),o=n("Wr3k");function c(e,t,n){var c=Object(a.a)(Object(o.a)(t,(function(e){return e.id})),(function(e){return e[0]})),i=e.map((function(e){var t=e.id;return c[t]})),u=i.map((function(e){return e?e.suggestions.length:0})),s=u.reduce((function(e,t){return e+t}),0),l=e.map((function(e){return e.optimalCount}));return(s<=l.reduce((function(e,t){return e+t}))?i:function(e,t){var n=e.reduce((function(e,t){return e+t}),0),r=t.map((function(t,n){return Math.min(t,e[n])})),a=n-r.reduce((function(e,t){return e+t}),0);return r.map((function(e,n){var r=Math.min(e+a,t[n]);return a-=r-e,r}))}(l,u).map((function(e,t){return e?Object(r.__assign)(Object(r.__assign)({},i[t]),{suggestions:i[t].suggestions.slice(0,e)}):null}))).filter((function(e){return e}))}n("AJTS");var i=n("W4Bk"),u=n("UlRC"),s=n("eHwz");function l(){var e={},t={};return this.select((function(e){if(e.logProps&&e.logProps.traceId&&e.logProps.entityId)return e;var n=e.providerId;t[n]=t[n]||Object(i.a)();var a=e.logProps&&e.logProps.traceId||t[n],o=e.logProps&&e.logProps.entityId||Object(i.a)();return Object(r.__assign)(Object(r.__assign)({},e),{entityType:"External",logProps:{traceId:a,entityId:o}})})).select((function(t){return function(t){var n=t.groupId;e[n]=e[n]?e[n].addSuggestion(t):new d(n,[t])}(t),Object(s.a)(e)}))}var d=function(){function e(e,t){this.id=e,this.suggestions=t}return e.prototype.addSuggestion=function(t){return new e(this.id,this.suggestions.concat(t))},e}();function p(e){return f(c,e)}function f(e,t){return function(n,r,a,o,c){var i=n.map((function(e){return e.optimalCount})),u=n.map((function(e){return e.maxCount||Number.MAX_VALUE}));return(t({optimals:i,maxes:u},r,a,o)||o.Observable.empty()).toSuggestionGroups().select((function(t){return e(n,t,c)}))}}u.Observable.prototype.toSuggestionGroups=l},dn8U:function(e,t,n){"use strict";n.r(t),n.d(t,"UniversalSuggestion",(function(){return B}));var r=n("wuwP"),a=n("cDcd"),o=n("NaTl"),c=n("wAGM"),i=n("Dxhy"),u=n("j4bS"),s=n("zt+T"),l=n("VXsH"),d=n("gp5W"),p=n("R+K2"),f=n("t5x4"),g=function(e){var t=e.children,n=e.theme,o=e.handlers,c=Object(p.a)(n);return a.createElement("div",Object(r.__assign)({className:c.suggestionContainer},o,{onKeyDown:f.a}),t&&t)},m=n("n5ha"),b=(Object(m.declareString)("search-box-suggestion-components.universalSuggestion.accessEndButtonsLabel")),h=n("n1J5"),v=n("I1yH"),y=n("y1hr"),O=Object(v.b)((function(e,t,n){void 0===n&&(n=24);var a=Object(y.a)(e),o=e.themeStyles,c=o.palette,i=o.fonts;return Object(h.b)(Object(r.__assign)(Object(r.__assign)({},a),{universalSuggestion:[a.suggestion,{padding:0,height:t,selectors:{"&:hover":{cursor:"pointer"}}}],iconWrapper:[a.suggestionIconWrapper,{selectors:{"> img, > canvas":{verticalAlign:"middle"}}}],startIcon:[{color:c.neutralPrimary,verticalAlign:"middle",fontSize:"16px",width:n,height:n,lineHeight:n}],endButtonContainer:{height:"100%",display:"flex"},endButton:{height:t,border:"none",background:"transparent",fontFamily:i.medium.fontFamily,color:c.neutralPrimaryAlt,padding:"0 16px",selectors:{":hover":{background:c.neutralLight,cursor:"pointer"},":focus":{background:c.neutralLight}}},rounded:{borderRadius:"50%"},squared:{borderRadius:"2px"}}))})),j=n("M3wH"),x=n("uXSp");function E(e){var t=e.endButtons,n=e.styles,r=e.theme,c=e.onEndButtonClick;return t?a.createElement("div",{className:n.endButtonContainer},t.map((function(e){return function(e,t,n,r){var c=e.content,i=e.onClick,u=e.styleCustomizer,s=c.text,l=c.icon;return a.createElement(o.a,{navType:"subnav",key:"end-button-".concat(s)},a.createElement("button",{className:Object(j.a)(t.endButton,n&&(null==u?void 0:u(n))),onClick:function(e){return r(e,i)},"aria-label":s,type:"button"},l?a.createElement(x.a,{iconName:l.fluentIcon}):s))}(e,n,r,c)}))):null}var _=n("/RXi"),C=n("D/hQ"),w=n("qArz"),S={width:72,height:72},I=a.lazy((function(){return Promise.all([n.e("pro-3sapp"),n.e("cpl-hidemasub"),n.e(0)]).then(n.bind(null,"r5K3"))}));function k(e){var t=e.primaryDisplayText,n=e.styles,o=t.icon,c=t.text,i=t.rawText,u=Object(r.__read)(a.useState(null),2),s=u[0],l=u[1];if(a.useEffect((function(){var e=!1;return!s&&(null==o?void 0:o.iconUrl)&&"object"==typeof o.iconUrl&&o.iconUrl.then((function(t){return!e&&l(t)})),function(){e=!0}}),[]),!o)return null;o.iconUrl&&"string"==typeof o.iconUrl&&o.iconUrl!==s&&l(o.iconUrl);var d=o.acronymIcon,p=o.fluentIcon,f=o.ariaLabel;return a.createElement("div",{className:n.iconWrapper},d&&function(e,t,n){var r=e.text,o=e.rawText,c=e.icon;if(!c||!c.acronymIcon)return null;var i=c.ariaLabel,u=c.acronymIcon,s=u.acronym,l=u.color,d=u.isRounded;return a.createElement(a.Suspense,{fallback:null},a.createElement(I,{ref:function(e){return e&&e.dispose()},acronym:s,color:l||Object(w.a)(Object(_.a)({text:s}),void 0,!0),dimensions:S},a.createElement("img",{className:Object(j.a)(t.startIcon,d?t.rounded:t.squared),src:n||"",alt:i||o||r})))}(t,n,s),!d&&s&&a.createElement("img",{className:n.startIcon,src:s,alt:f||i||c}),p&&a.createElement(a.Fragment,null,a.createElement("span",{className:n.offScreen}," ",f),a.createElement(C.a,{className:n.startIcon,iconName:p,"aria-hidden":"true","aria-label":f})))}var P=n("/krt"),T=n("3lF4");function U(e){var t=e.displayTexts,n=e.styles,o=e.theme,c=function(e){var t={icons:[],texts:[]};return e.slice(1).forEach((function(e){var n=e.icon,r=e.text;t.icons.push(n&&n.fluentIcon?{icon:n.fluentIcon,ariaLabel:n.ariaLabel}:void 0),t.texts.push(r)})),t}(t);return a.createElement("div",{className:n.suggestionTextWrapper},a.createElement("div",{className:n.suggestionTitle,"data-tooltip":!0},a.createElement(P.a,{markType:"mark",text:t[0].text,highlightCssClass:n.highlighted}),a.createElement("span",{className:n.offScreen},",")),a.createElement(T.a,Object(r.__assign)({},{styles:n,theme:o,tidbits:c.texts,tidbitIcons:c.icons})))}var B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.displayTexts,n=e.theme,c=e.endButtons,i=e.id,u=e.entityType;if(!n||0===t.length||!u)return null;var s=O(n,t.length>1?"48px":"38px","People"===u?28:24),p="univ-endbtn-".concat(i),f=c&&c.length>0;return a.createElement(g,{theme:n},a.createElement(o.a,null,a.createElement("a",{href:this.props.url||"#",className:s.universalSuggestion,target:"_blank",rel:"noopener noreferrer",onClick:this.onClick,onMouseUp:function(e){return e.button===l.a&&!e.ctrlKey&&e.currentTarget.blur()},"aria-describedby":f?p:void 0},a.createElement(k,{primaryDisplayText:t[0],styles:s}),a.createElement(U,{displayTexts:t,styles:s,theme:n}),a.createElement(E,{endButtons:c,theme:n,styles:s,onEndButtonClick:this.onEndButtonClick}),a.createElement(d.a,{entityType:u,entityId:this.props.id,theme:n,customProps:Object(r.__assign)({},this.props.customProps)}),f&&a.createElement("p",{id:p,hidden:!0},b()))))},t.prototype.onClick=function(e){var t,n;null===(n=(t=this.props).onClick)||void 0===n||n.call(t,e),e.currentTarget.blur()},t.prototype.onEndButtonClick=function(e,t){e.preventDefault(),e.stopPropagation(),t(e,this.props)},Object(r.__decorate)([s.a,Object(i.a)(),u.a],t.prototype,"onClick",null),Object(r.__decorate)([s.a,Object(i.a)(),u.a],t.prototype,"onEndButtonClick",null),t}(a.Component);t.default=Object(c.a)("UniversalSuggestion")(B)},eTzd:function(e,t,n){"use strict";n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return v})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return j}));var r=n("YL+5"),a=n("KmCS"),o=n("OJcW"),c=n("e24R"),i=Object(a.regs)("searchux.isCheckSharePointAndSearchCenterUrlsInDifferentDomainFlighted",!1),u=n("QHBp"),s=n("85Gg"),l=Object(c.a)("sharePoint"),d=Object(a.regs)("searchux.api.sharePoint.url","",{required:!1,tags:["session","global","obsolete"]}),p=(r.a.concatenate(u.a,"contextinfo"),r.a.concatenate(u.a,"SP.UserProfiles.PeopleManager"),r.a.concatenate(u.b,"query")),f=r.a.concatenate(u.b,"postquery"),g=(r.a.concatenate(u.b,"searchcenterurl"),r.a.concatenate(u.b,"RecordPageClick"));function m(e){var t=Object(s.a)(e),n=d();return Object(o.b)(t)||i()&&!function(e,t){try{return window&&new window.URL(e).host===new window.URL(t).host}catch(e){return!1}}(n,t)?n:t}function b(e){return r.a.concatenate(m(e),p)}function h(){return r.a.concatenate(m(),f)}function v(){return r.a.concatenate(d(),"_layouts/15")}function y(){return r.a.concatenate(d(),f)}function O(){return r.a.concatenate(d(),p)}function j(){return r.a.concatenate(d(),g)}}}]);