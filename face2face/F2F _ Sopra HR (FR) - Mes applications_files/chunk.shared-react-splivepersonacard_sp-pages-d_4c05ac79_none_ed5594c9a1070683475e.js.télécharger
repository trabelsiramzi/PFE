(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[15],{Gu0Z:function(e,t,n){"use strict";var a,i=n("17wl"),r=function(){function e(){}return e.tokenCacheSessionStorageId="tokenCache",e.aboutToExpireIntervalSeconds=600,e.apiUrl="/_api/SP.OAuth.Token/Acquire",e.retries=3,e.retriableErrorCodes=[10006,10008],e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>",e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format",e.npmPackageVersion="0.1.5",e}();!function(e){e[e.unknownError=0]="unknownError",e[e.malformedResponseBody=1]="malformedResponseBody",e[e.serverError=2]="serverError"}(a||(a={}));var o=function(e){function t(n,a){var i=e.call(this,a.message)||this;return i.__proto__=t.prototype,i._type=n,i._httpResponseStatus=a.httpResponseStatus,i._cultureName=a.cultureName,i._message=a.message,i._serverErrorCode=a.serverErrorCode,i._correlationId=a.correlationId,i._redirectUrl=a.redirectUrl,i}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==a.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!1,configurable:!0}),t}(Error),s=function(){function e(e){var t=this;this._context=e,this._dispose=this._dispose.bind(this),window.addEventListener("unload",this._dispose),window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()},window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}return e._getCorrelationId=function(e){return e.headers.get("sprequestguid")},e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e},e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})},e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var a=this._getCachedTokenData(e);if(a&&!this._isExpiring(a)){var i={token:a.accessToken,isGuest:!1,expirationTimeMs:a.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:a.correlationId,spRequestTimestamp:a.requestTimestamp})}return this._retriableFetchWithDigest(e,r.retries,t).then(function(t){return n._storeTokenData(e,t),{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})},e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)},Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){return this._keysToDispose||(this._keysToDispose=new Array),this._keysToDispose},enumerable:!1,configurable:!0}),e.prototype._retriableFetchWithDigest=function(t,n,i){var r=this,s=this._context.qosMonitor(),c=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(d){if(200!==d.status){r._context.logger.logError("fetchWithDigest failed. Server responded with "+d.statusText);var l=new o(a.unknownError,{httpResponseStatus:d.status,message:d.statusText,correlationId:e._getCorrelationId(d)});return 400!==d.status?(s.writeUnexpectedFailure("UnknownError",l),Promise.reject(l)):d.json().then(function(a){var o=e._extractRealError(a),c=r._getErrorCodeFromResponseCode(o);if(!r._isRetriableError(c)||0===n){var d=r._buildErrorFromResponse(o);return s.writeUnexpectedFailure("SharepointServerError",d),Promise.reject(d)}return r._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n),r._retriableFetchWithDigest(t,n-1,i)})}return r._instrumentedParseResponseData(d,s,c)})},e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))},e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))},e.prototype._getCacheKey=function(e){var t=["sp-client-shared",r.npmPackageVersion,"OAuthUtility",e].join(";");return-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t),t},e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<r.aboutToExpireIntervalSeconds},e.prototype._isRetriableError=function(e){return-1!==r.retriableErrorCodes.indexOf(e)},e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8"),n.append("Odata-Version","4.0"),n.append("Accept","application/json;odata.metadata=minimal");var a={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;return i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1)),new Request(i+r.apiUrl,a)},e.prototype._buildRequestBody=function(e){return{resource:e}},e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(a.malformedResponseBody,{httpResponseStatus:400,message:r.unexpectedErrorCodeFormat,correlationId:e.correlationId});e.message&&("string"==typeof e.message?t=e.message:(t=e.message.value,n=e.message.lang));var s="error.redirectUrl";return new o(a.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e[s]||e["@".concat(s)]})},e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var a=t.indexOf(",");-1!==a&&(n=Number(t.substr(0,a)))}return n},e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(a){return n.writeSuccess(),{accessToken:a.access_token,expiresOn:Number(a.expires_on),notBefore:Number(a.not_before),resource:a.resource,tokenType:a.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){return n.writeUnexpectedFailure("ResponseParseError",i),Promise.reject(new o(a.malformedResponseBody,{httpResponseStatus:200,message:r.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}},e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var a=n[t];window.sessionStorage.removeItem(a)}},e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e),window._spMSBT=void 0}},e}(),c=n("dq6a"),d=n("K9kD"),l=n("3HEj"),u=function(){function e(){this._qos=new d.Qos({name:"OAuthTokenDataSource"})}return e.prototype.writeSuccess=function(){this._qos.end({resultType:d.ResultTypeEnum.Success})},e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:d.ResultTypeEnum.Failure,error:JSON.stringify(t)})},e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:d.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})},e}(),f=function(){function e(){}return e.prototype.logWarning=function(e){},e.prototype.logError=function(e){},e}(),p=function(e){function t(t,n){var a=e.call(this,{},{pageContext:t})||this;return a.logger=new f,n&&(n.logger&&(a.logger=n.logger),n.useAbsoluteUrlForOAuth&&(a._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)),a._oAuthUtility=new s(a),a}return Object(i.__extends)(t,e),t.prototype.qosMonitor=function(){return new u},Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.i)(this._pageContext)},enumerable:!1,configurable:!0}),t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var a=e.headers.get("Content-Type");return e.headers.delete("Content-Type"),t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),a,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})},t.prototype.getToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))},t.prototype.getInstrumentedToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))},t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};return t.forEach(function(e,t){n[t]=e}),n},t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t.prototype._es6PromiseToOdspPromise=function(e){return new d.Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t}(c.t);t.e=p},dq6a:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("K9kD"),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.dataRequestorType,s=void 0===o?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r})||this}return Object(a.__extends)(t,e),t}(i.DataRequestor):o,c=e.dataSourceName,d=void 0===c?"DataSource":c;this.dataRequestor=new s({qosName:d})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p){void 0===i&&(i="POST");var m=e(),_=a&&a(),h=this.needsRequestDigest(m);return this.dataRequestor.getData({url:m,parseResponse:t,qosName:n,additionalPostData:_,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:h,authToken:f,webAbsoluteUrl:p})},e}();t.t=r},gM97:function(e,t,n){"use strict";var a,i=n("K9kD");!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(a||(a={}));var r=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new i.Qos({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:i.ResultTypeEnum.Success}),e},function(e){return n.end({resultType:i.ResultTypeEnum.Failure}),i.Promise.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new i.Qos({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:i.ResultTypeEnum.Success}),e},function(e){return n.end({resultType:i.ResultTypeEnum.Failure}),i.Promise.reject(e)})},e}();t.e=r}}]);