(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-3sfile2"],{"2CCo":function(e,t,r){"use strict";r.r(t);var n=r("3twC"),i=r("GtFt"),o=r("cDcd"),c=r("KmCS"),a=Object(c.regs)("searchux.focusModeDimElementParentId","O365_NavHeader"),u=r("I1yH"),s=r("n1J5"),l=r("wuwP"),d=r("CE7+"),f=r("TgUa"),h=Object(d.a)((function(){return{dimmerOverlay:function(e){var t=e.isDarkMode;return Object(l.__assign)(Object(l.__assign)({},f.b.fadeIn200),{position:"fixed",width:"100vw",height:"100vh",background:t?"rgba(0,0,0,0.75)":"rgba(0,0,0,0.3)",zIndex:9998})}}}))(r("kQyP").a).dimmerOverlay,p=Object(u.b)((function(e){return Object(s.b)({dimmerOverlay:h({isDarkMode:null==e?void 0:e.isDarkMode})})})),m=Object(n.a)("endButton",i.e)((function(e){var t=e.searchBox,r=e.expanded,n=e.theme,i=p(n);o.useEffect((function(){return r?f():h(),h}),[r]);var c=function(e){var r,n,i;return null===(i=null===(n=e||(null===(r=null==t?void 0:t.getInputElement)||void 0===r?void 0:r.call(t)))||void 0===n?void 0:n.closest("form"))||void 0===i?void 0:i.closest("div")},u=function(){return document.querySelector("#".concat(a()))},s=function(){return document.querySelector("#".concat(l))},l="searchux-searchbox-focus-mode__bg",d="0",f=function(){var e;if(!s()){var r=null===(e=null==t?void 0:t.getInputElement)||void 0===e?void 0:e.call(t);if(r){var n=c(r);if(n){var o=u();if(!o)return null;var a=document.createElement("div");a.setAttribute("id",l),a.setAttribute("class",(null==i?void 0:i.dimmerOverlay)||""),o.appendChild(a),d=n.style.zIndex,n.style.zIndex="9999"}}}},h=function(){var e=s(),t=u();e&&(null==t||t.removeChild(e));var r=c();r&&(r.style.zIndex=d)};return null}));t.default=m},"6AAz":function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:c}catch(e){n=c}}();var u,s=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?s=u.concat(s):d=-1,s.length&&h())}function h(){if(!l){var e=a(f);l=!0;for(var t=s.length;t;){for(u=s,s=[];++d<t;)u&&u[d].run();d=-1,t=s.length}u=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];s.push(new p(e,t)),1!==s.length||l||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},Az8T:function(e,t,r){"use strict";var n=r("Rcmk"),i=r("3MGJ"),o=r("n/Gf");t.a=function(e,t){var r={};return t=Object(o.a)(t,3),Object(i.a)(e,(function(e,i,o){Object(n.a)(r,i,t(e,i,o))})),r}},DePt:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return c}));var n=r("n5ha"),i=(n.declareString("search-dl.querySuggestion.manageHistoryButtonText")),o=(n.declareString("search-dl.querySuggestion.accessManageHistoryButtonLabel")),c=(n.declareString("search-dl.querySuggestion.removePQRedirectWarningTooltip"))},Utwq:function(e,t,r){"use strict";r.r(t),r.d(t,"registration",(function(){return y}));var n=r("wuwP"),i=r("rpSO"),o=r("KmCS"),c=r("F6lS"),a=r("POWj"),u=r("mGoP"),s=r("bs+K"),l=r("Q+QT"),d=r("ohlq"),f=r("xo1z"),h=r("qGDX"),p=r("Xopu"),m=r("ldpi"),v=r("q9uV"),b=function(){function e(e,t,r){this.config=e,this.fetcher=t,this.conversation=r}return e.prototype.getId=function(){return"AutoSuggestFileSuggestionProvider2"},e.prototype.createStream=function(e){return Object(h.b)(this.fetcher,"File",{searchText:e,entityTypes:Object(v.b)(this.config,e),scenario:Object(f.a)(Object(d.a)()),appOverride:Object(a.a)(),logicalSearchId:this.conversation&&this.conversation.getLogicalSearchId("sb"),conversationId:this.conversation&&this.conversation.conversationId}).select((function(t){var r=t.AccessUrl,n=t.Author,i=t.DateCreated,o=t.DateModified,c=t.DateAccessed,a=t.FileExtension,d=t.FileName,f=t.FileSourceType,h=t.FileType,p=t.ModifiedBy,v=t.ModifiedByDisplayName,b=t.PropertyHits,y=t.SourceTitle,g=t.logProps,O=t.originalLogicalSearchId,T=t.entityType,S=t.From,j=t.SharedDateTime,w=t.UserRelationshipType,x=Object(s.a)(d),I=Object(m.a)((function(){return Object(u.b)(e,"FileName",x,b)})),P=Object(m.a)((function(){var t;return Object(u.a)({createdDate:i,authorDisplayName:n||(null===(t=null==S?void 0:S.EmailAddress)||void 0===t?void 0:t.Name)||"",dateModified:o,modifiedByDisplayName:v,propertyHits:b,searchText:e,lastAccessedDate:c,fileType:h,fileSourceType:f,modifiedBy:p,fromObject:S,sharedDateTime:j,userRelationshipType:w})})),D=Object(l.a)(t);return{logProps:g,id:r,searchText:e,url:"".concat(r,"?web=1"),fileExtension:a,fileSourceType:f,fileType:h,lazyDisplayText:I,lastModifiedTime:o,lastModifiedBy:v,lastModifiedByAccountName:p,parentSiteTitle:y,lazySecondaryDisplayText:function(){return P()},originalLogicalSearchId:O,entityType:T,displayTextRaw:x,tidbitIconName:null==D?void 0:D.icon,customProps:{tidbitIconLabel:null==D?void 0:D.label},title:"",displayText:"",secondaryDisplayText:"",tertiaryDisplayText:""}}))},e=Object(n.__decorate)([Object(v.a)({entityType:"File"}),Object(n.__param)(0,Object(i.a)("config")),Object(n.__param)(1,Object(i.a)("fetcher")),Object(n.__param)(2,Object(i.a)("conversation"))],e)}();t.default=b;var y=Object(o.regs)("".concat(c.a,".").concat(p.d,"2"),b)},dWn0:function(e,t,r){"use strict";var n=r("byhq"),i=r("EJZo"),o=r("TakZ");t.a=function(e){return"string"==typeof e||!Object(i.a)(e)&&Object(o.a)(e)&&"[object String]"==Object(n.a)(e)}},ghw8:function(e,t,r){"use strict";t.a=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i}},lRRq:function(e,t,r){"use strict";var n=r("3MGJ"),i=r("bKfh");var o=function(e,t){return function(r,n){if(null==r)return r;if(!Object(i.a)(r))return e(r,n);for(var o=r.length,c=t?o:-1,a=Object(r);(t?c--:++c<o)&&!1!==n(a[c],c,a););return r}}(n.a);t.a=o},"yM/U":function(e,t,r){"use strict";r.r(t);var n=r("wuwP"),i=r("UlRC"),o=r("rpSO"),c=r("KmCS"),a=r("XgOi"),u=(r("Jvpx"),r("ohlq")),s=(r("6SpP"),r("eTzd")),l=r("DHVw"),d=r("/hiP");function f(e,t,r){return"".concat(r.sitePath,"/_api/search/query?QueryText='*'").concat(function(e){var t=e.departmentId,r=e.isHubSite;return"&QueryTemplate='({searchterms}) ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118*"+" AND PromotedState:2 AND ".concat((r&&t?p:h)(e),"'")}(r))+"&HitHighlightedProperties='Title'&StartRow=0&RowLimit=100"+"&Properties='ClientFunction:News,EnableMultiGeoSearch:".concat(e?"true":"false","'")+"&sortlist='LastModifiedTime:descending'&SelectProperties='ContentClass,ContentTypeId,DefaultEncodingURL,DocId,EditorOWSUSER,FileExtension,GeoLocationSource,LastModifiedTime,ModifiedBy,Path,SPWebUrl,SPSiteURL,SecondaryFileExtension,ServerRedirectedUrl,SiteId,Title,UniqueId,WebId'"+"&ClientType='".concat(t,"'&EnableQueryRules=false")}function h(e){var t=e.sitePath;return'Path:"'.concat(t,'"')}function p(e){var t=e.departmentId;return"(DepartmentId:".concat(t," OR DepartmentId:").concat(t.replace(/[{}]/g,""),")")}var m=Object(d.a)((function(e){return function(t){var r=t.clientId,i=t.site;return Object(l.a)({url:f(!0,r,i),method:"GET",headers:Object(n.__assign)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{})})}}),{monitorName:"sitenews-rawPrefetch",cacheId:"sitenews-rawPrefetch",cacheVersion:"0",cacheItemLifetime:9e5,cacheKeyExtractor:function(e){return{sitePath:e.site.sitePath}}}),v=r("RkML"),b=r("sUxJ");var y=r("F6lS"),g="".concat(y.a,".sharePointSearchSiteNewsSuggestions"),O=function(){function e(e){this.site=e}return e.prototype.getId=function(){return"SearchSiteNewsSuggestionProvider"},e.prototype.createStream=function(e){return this.site?(t={site:this.site,clientId:Object(u.a)()},r=t.clientId,n=t.site,o=Object(b.a)(v.a),i.Observable.fromPromise(m({clientId:r,site:n,tokenProvider:Object(s.g)()})).select((function(e){return JSON.parse(e.xhr.responseText)})).select((function(e){return o(e)})).cache("mssearchux-cache-sitenews-mapped",{key:n.sitePath},"1.0.0",9e5,(function(){return!1}))).select((function(e){return e.value})).selectMany((function(e){return i.Observable.fromArray(e)})).specFilter(e,new a.a):i.Observable.empty();var t,r,n,o},e=Object(n.__decorate)([Object(n.__param)(0,Object(o.a)("site"))],e)}();t.default=O;Object(c.regs)(g,O)}}]);